(function(){const ye=document.createElement("link").relList;if(ye&&ye.supports&&ye.supports("modulepreload"))return;for(const Ve of document.querySelectorAll('link[rel="modulepreload"]'))Q(Ve);new MutationObserver(Ve=>{for(const $e of Ve)if($e.type==="childList")for(const Fe of $e.addedNodes)Fe.tagName==="LINK"&&Fe.rel==="modulepreload"&&Q(Fe)}).observe(document,{childList:!0,subtree:!0});function Me(Ve){const $e={};return Ve.integrity&&($e.integrity=Ve.integrity),Ve.referrerPolicy&&($e.referrerPolicy=Ve.referrerPolicy),Ve.crossOrigin==="use-credentials"?$e.credentials="include":Ve.crossOrigin==="anonymous"?$e.credentials="omit":$e.credentials="same-origin",$e}function Q(Ve){if(Ve.ep)return;Ve.ep=!0;const $e=Me(Ve);fetch(Ve.href,$e)}})();var pg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ym(ne){return ne&&ne.__esModule&&Object.prototype.hasOwnProperty.call(ne,"default")?ne.default:ne}var mp={exports:{}},Od={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Np;function _m(){if(Np)return Od;Np=1;var ne=Symbol.for("react.transitional.element"),ye=Symbol.for("react.fragment");function Me(Q,Ve,$e){var Fe=null;if($e!==void 0&&(Fe=""+$e),Ve.key!==void 0&&(Fe=""+Ve.key),"key"in Ve){$e={};for(var f in Ve)f!=="key"&&($e[f]=Ve[f])}else $e=Ve;return Ve=$e.ref,{$$typeof:ne,type:Q,key:Fe,ref:Ve!==void 0?Ve:null,props:$e}}return Od.Fragment=ye,Od.jsx=Me,Od.jsxs=Me,Od}var Fp;function vm(){return Fp||(Fp=1,mp.exports=_m()),mp.exports}var ee=vm(),gp={exports:{}},ti={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Up;function xm(){if(Up)return ti;Up=1;var ne=Symbol.for("react.transitional.element"),ye=Symbol.for("react.portal"),Me=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),Ve=Symbol.for("react.profiler"),$e=Symbol.for("react.consumer"),Fe=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),Oe=Symbol.for("react.suspense"),U=Symbol.for("react.memo"),ut=Symbol.for("react.lazy"),Ue=Symbol.for("react.activity"),pe=Symbol.iterator;function ft(se){return se===null||typeof se!="object"?null:(se=pe&&se[pe]||se["@@iterator"],typeof se=="function"?se:null)}var ct={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Qe=Object.assign,nt={};function Ge(se,Ie,Ze){this.props=se,this.context=Ie,this.refs=nt,this.updater=Ze||ct}Ge.prototype.isReactComponent={},Ge.prototype.setState=function(se,Ie){if(typeof se!="object"&&typeof se!="function"&&se!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,se,Ie,"setState")},Ge.prototype.forceUpdate=function(se){this.updater.enqueueForceUpdate(this,se,"forceUpdate")};function it(){}it.prototype=Ge.prototype;function bt(se,Ie,Ze){this.props=se,this.context=Ie,this.refs=nt,this.updater=Ze||ct}var St=bt.prototype=new it;St.constructor=bt,Qe(St,Ge.prototype),St.isPureReactComponent=!0;var Vt=Array.isArray;function Dt(){}var Pe={H:null,A:null,T:null,S:null},Et=Object.prototype.hasOwnProperty;function pi(se,Ie,Ze){var ht=Ze.ref;return{$$typeof:ne,type:se,key:Ie,ref:ht!==void 0?ht:null,props:Ze}}function qt(se,Ie){return pi(se.type,Ie,se.props)}function xi(se){return typeof se=="object"&&se!==null&&se.$$typeof===ne}function bi(se){var Ie={"=":"=0",":":"=2"};return"$"+se.replace(/[=:]/g,function(Ze){return Ie[Ze]})}var va=/\/+/g;function Bi(se,Ie){return typeof se=="object"&&se!==null&&se.key!=null?bi(""+se.key):Ie.toString(36)}function Kt(se){switch(se.status){case"fulfilled":return se.value;case"rejected":throw se.reason;default:switch(typeof se.status=="string"?se.then(Dt,Dt):(se.status="pending",se.then(function(Ie){se.status==="pending"&&(se.status="fulfilled",se.value=Ie)},function(Ie){se.status==="pending"&&(se.status="rejected",se.reason=Ie)})),se.status){case"fulfilled":return se.value;case"rejected":throw se.reason}}throw se}function Se(se,Ie,Ze,ht,kt){var Rt=typeof se;(Rt==="undefined"||Rt==="boolean")&&(se=null);var Pt=!1;if(se===null)Pt=!0;else switch(Rt){case"bigint":case"string":case"number":Pt=!0;break;case"object":switch(se.$$typeof){case ne:case ye:Pt=!0;break;case ut:return Pt=se._init,Se(Pt(se._payload),Ie,Ze,ht,kt)}}if(Pt)return kt=kt(se),Pt=ht===""?"."+Bi(se,0):ht,Vt(kt)?(Ze="",Pt!=null&&(Ze=Pt.replace(va,"$&/")+"/"),Se(kt,Ie,Ze,"",function(Wi){return Wi})):kt!=null&&(xi(kt)&&(kt=qt(kt,Ze+(kt.key==null||se&&se.key===kt.key?"":(""+kt.key).replace(va,"$&/")+"/")+Pt)),Ie.push(kt)),1;Pt=0;var Oi=ht===""?".":ht+":";if(Vt(se))for(var ii=0;ii<se.length;ii++)ht=se[ii],Rt=Oi+Bi(ht,ii),Pt+=Se(ht,Ie,Ze,Rt,kt);else if(ii=ft(se),typeof ii=="function")for(se=ii.call(se),ii=0;!(ht=se.next()).done;)ht=ht.value,Rt=Oi+Bi(ht,ii++),Pt+=Se(ht,Ie,Ze,Rt,kt);else if(Rt==="object"){if(typeof se.then=="function")return Se(Kt(se),Ie,Ze,ht,kt);throw Ie=String(se),Error("Objects are not valid as a React child (found: "+(Ie==="[object Object]"?"object with keys {"+Object.keys(se).join(", ")+"}":Ie)+"). If you meant to render a collection of children, use an array instead.")}return Pt}function Ye(se,Ie,Ze){if(se==null)return se;var ht=[],kt=0;return Se(se,ht,"","",function(Rt){return Ie.call(Ze,Rt,kt++)}),ht}function gt(se){if(se._status===-1){var Ie=se._result;Ie=Ie(),Ie.then(function(Ze){(se._status===0||se._status===-1)&&(se._status=1,se._result=Ze)},function(Ze){(se._status===0||se._status===-1)&&(se._status=2,se._result=Ze)}),se._status===-1&&(se._status=0,se._result=Ie)}if(se._status===1)return se._result.default;throw se._result}var Gt=typeof reportError=="function"?reportError:function(se){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof se=="object"&&se!==null&&typeof se.message=="string"?String(se.message):String(se),error:se});if(!window.dispatchEvent(Ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",se);return}console.error(se)},si={map:Ye,forEach:function(se,Ie,Ze){Ye(se,function(){Ie.apply(this,arguments)},Ze)},count:function(se){var Ie=0;return Ye(se,function(){Ie++}),Ie},toArray:function(se){return Ye(se,function(Ie){return Ie})||[]},only:function(se){if(!xi(se))throw Error("React.Children.only expected to receive a single React element child.");return se}};return ti.Activity=Ue,ti.Children=si,ti.Component=Ge,ti.Fragment=Me,ti.Profiler=Ve,ti.PureComponent=bt,ti.StrictMode=Q,ti.Suspense=Oe,ti.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Pe,ti.__COMPILER_RUNTIME={__proto__:null,c:function(se){return Pe.H.useMemoCache(se)}},ti.cache=function(se){return function(){return se.apply(null,arguments)}},ti.cacheSignal=function(){return null},ti.cloneElement=function(se,Ie,Ze){if(se==null)throw Error("The argument must be a React element, but you passed "+se+".");var ht=Qe({},se.props),kt=se.key;if(Ie!=null)for(Rt in Ie.key!==void 0&&(kt=""+Ie.key),Ie)!Et.call(Ie,Rt)||Rt==="key"||Rt==="__self"||Rt==="__source"||Rt==="ref"&&Ie.ref===void 0||(ht[Rt]=Ie[Rt]);var Rt=arguments.length-2;if(Rt===1)ht.children=Ze;else if(1<Rt){for(var Pt=Array(Rt),Oi=0;Oi<Rt;Oi++)Pt[Oi]=arguments[Oi+2];ht.children=Pt}return pi(se.type,kt,ht)},ti.createContext=function(se){return se={$$typeof:Fe,_currentValue:se,_currentValue2:se,_threadCount:0,Provider:null,Consumer:null},se.Provider=se,se.Consumer={$$typeof:$e,_context:se},se},ti.createElement=function(se,Ie,Ze){var ht,kt={},Rt=null;if(Ie!=null)for(ht in Ie.key!==void 0&&(Rt=""+Ie.key),Ie)Et.call(Ie,ht)&&ht!=="key"&&ht!=="__self"&&ht!=="__source"&&(kt[ht]=Ie[ht]);var Pt=arguments.length-2;if(Pt===1)kt.children=Ze;else if(1<Pt){for(var Oi=Array(Pt),ii=0;ii<Pt;ii++)Oi[ii]=arguments[ii+2];kt.children=Oi}if(se&&se.defaultProps)for(ht in Pt=se.defaultProps,Pt)kt[ht]===void 0&&(kt[ht]=Pt[ht]);return pi(se,Rt,kt)},ti.createRef=function(){return{current:null}},ti.forwardRef=function(se){return{$$typeof:f,render:se}},ti.isValidElement=xi,ti.lazy=function(se){return{$$typeof:ut,_payload:{_status:-1,_result:se},_init:gt}},ti.memo=function(se,Ie){return{$$typeof:U,type:se,compare:Ie===void 0?null:Ie}},ti.startTransition=function(se){var Ie=Pe.T,Ze={};Pe.T=Ze;try{var ht=se(),kt=Pe.S;kt!==null&&kt(Ze,ht),typeof ht=="object"&&ht!==null&&typeof ht.then=="function"&&ht.then(Dt,Gt)}catch(Rt){Gt(Rt)}finally{Ie!==null&&Ze.types!==null&&(Ie.types=Ze.types),Pe.T=Ie}},ti.unstable_useCacheRefresh=function(){return Pe.H.useCacheRefresh()},ti.use=function(se){return Pe.H.use(se)},ti.useActionState=function(se,Ie,Ze){return Pe.H.useActionState(se,Ie,Ze)},ti.useCallback=function(se,Ie){return Pe.H.useCallback(se,Ie)},ti.useContext=function(se){return Pe.H.useContext(se)},ti.useDebugValue=function(){},ti.useDeferredValue=function(se,Ie){return Pe.H.useDeferredValue(se,Ie)},ti.useEffect=function(se,Ie){return Pe.H.useEffect(se,Ie)},ti.useEffectEvent=function(se){return Pe.H.useEffectEvent(se)},ti.useId=function(){return Pe.H.useId()},ti.useImperativeHandle=function(se,Ie,Ze){return Pe.H.useImperativeHandle(se,Ie,Ze)},ti.useInsertionEffect=function(se,Ie){return Pe.H.useInsertionEffect(se,Ie)},ti.useLayoutEffect=function(se,Ie){return Pe.H.useLayoutEffect(se,Ie)},ti.useMemo=function(se,Ie){return Pe.H.useMemo(se,Ie)},ti.useOptimistic=function(se,Ie){return Pe.H.useOptimistic(se,Ie)},ti.useReducer=function(se,Ie,Ze){return Pe.H.useReducer(se,Ie,Ze)},ti.useRef=function(se){return Pe.H.useRef(se)},ti.useState=function(se){return Pe.H.useState(se)},ti.useSyncExternalStore=function(se,Ie,Ze){return Pe.H.useSyncExternalStore(se,Ie,Ze)},ti.useTransition=function(){return Pe.H.useTransition()},ti.version="19.2.0",ti}var jp;function Sp(){return jp||(jp=1,gp.exports=xm()),gp.exports}var Mt=Sp(),yp={exports:{}},Pd={},_p={exports:{}},vp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vp;function bm(){return Vp||(Vp=1,(function(ne){function ye(Se,Ye){var gt=Se.length;Se.push(Ye);e:for(;0<gt;){var Gt=gt-1>>>1,si=Se[Gt];if(0<Ve(si,Ye))Se[Gt]=Ye,Se[gt]=si,gt=Gt;else break e}}function Me(Se){return Se.length===0?null:Se[0]}function Q(Se){if(Se.length===0)return null;var Ye=Se[0],gt=Se.pop();if(gt!==Ye){Se[0]=gt;e:for(var Gt=0,si=Se.length,se=si>>>1;Gt<se;){var Ie=2*(Gt+1)-1,Ze=Se[Ie],ht=Ie+1,kt=Se[ht];if(0>Ve(Ze,gt))ht<si&&0>Ve(kt,Ze)?(Se[Gt]=kt,Se[ht]=gt,Gt=ht):(Se[Gt]=Ze,Se[Ie]=gt,Gt=Ie);else if(ht<si&&0>Ve(kt,gt))Se[Gt]=kt,Se[ht]=gt,Gt=ht;else break e}}return Ye}function Ve(Se,Ye){var gt=Se.sortIndex-Ye.sortIndex;return gt!==0?gt:Se.id-Ye.id}if(ne.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var $e=performance;ne.unstable_now=function(){return $e.now()}}else{var Fe=Date,f=Fe.now();ne.unstable_now=function(){return Fe.now()-f}}var Oe=[],U=[],ut=1,Ue=null,pe=3,ft=!1,ct=!1,Qe=!1,nt=!1,Ge=typeof setTimeout=="function"?setTimeout:null,it=typeof clearTimeout=="function"?clearTimeout:null,bt=typeof setImmediate<"u"?setImmediate:null;function St(Se){for(var Ye=Me(U);Ye!==null;){if(Ye.callback===null)Q(U);else if(Ye.startTime<=Se)Q(U),Ye.sortIndex=Ye.expirationTime,ye(Oe,Ye);else break;Ye=Me(U)}}function Vt(Se){if(Qe=!1,St(Se),!ct)if(Me(Oe)!==null)ct=!0,Dt||(Dt=!0,bi());else{var Ye=Me(U);Ye!==null&&Kt(Vt,Ye.startTime-Se)}}var Dt=!1,Pe=-1,Et=5,pi=-1;function qt(){return nt?!0:!(ne.unstable_now()-pi<Et)}function xi(){if(nt=!1,Dt){var Se=ne.unstable_now();pi=Se;var Ye=!0;try{e:{ct=!1,Qe&&(Qe=!1,it(Pe),Pe=-1),ft=!0;var gt=pe;try{t:{for(St(Se),Ue=Me(Oe);Ue!==null&&!(Ue.expirationTime>Se&&qt());){var Gt=Ue.callback;if(typeof Gt=="function"){Ue.callback=null,pe=Ue.priorityLevel;var si=Gt(Ue.expirationTime<=Se);if(Se=ne.unstable_now(),typeof si=="function"){Ue.callback=si,St(Se),Ye=!0;break t}Ue===Me(Oe)&&Q(Oe),St(Se)}else Q(Oe);Ue=Me(Oe)}if(Ue!==null)Ye=!0;else{var se=Me(U);se!==null&&Kt(Vt,se.startTime-Se),Ye=!1}}break e}finally{Ue=null,pe=gt,ft=!1}Ye=void 0}}finally{Ye?bi():Dt=!1}}}var bi;if(typeof bt=="function")bi=function(){bt(xi)};else if(typeof MessageChannel<"u"){var va=new MessageChannel,Bi=va.port2;va.port1.onmessage=xi,bi=function(){Bi.postMessage(null)}}else bi=function(){Ge(xi,0)};function Kt(Se,Ye){Pe=Ge(function(){Se(ne.unstable_now())},Ye)}ne.unstable_IdlePriority=5,ne.unstable_ImmediatePriority=1,ne.unstable_LowPriority=4,ne.unstable_NormalPriority=3,ne.unstable_Profiling=null,ne.unstable_UserBlockingPriority=2,ne.unstable_cancelCallback=function(Se){Se.callback=null},ne.unstable_forceFrameRate=function(Se){0>Se||125<Se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Et=0<Se?Math.floor(1e3/Se):5},ne.unstable_getCurrentPriorityLevel=function(){return pe},ne.unstable_next=function(Se){switch(pe){case 1:case 2:case 3:var Ye=3;break;default:Ye=pe}var gt=pe;pe=Ye;try{return Se()}finally{pe=gt}},ne.unstable_requestPaint=function(){nt=!0},ne.unstable_runWithPriority=function(Se,Ye){switch(Se){case 1:case 2:case 3:case 4:case 5:break;default:Se=3}var gt=pe;pe=Se;try{return Ye()}finally{pe=gt}},ne.unstable_scheduleCallback=function(Se,Ye,gt){var Gt=ne.unstable_now();switch(typeof gt=="object"&&gt!==null?(gt=gt.delay,gt=typeof gt=="number"&&0<gt?Gt+gt:Gt):gt=Gt,Se){case 1:var si=-1;break;case 2:si=250;break;case 5:si=1073741823;break;case 4:si=1e4;break;default:si=5e3}return si=gt+si,Se={id:ut++,callback:Ye,priorityLevel:Se,startTime:gt,expirationTime:si,sortIndex:-1},gt>Gt?(Se.sortIndex=gt,ye(U,Se),Me(Oe)===null&&Se===Me(U)&&(Qe?(it(Pe),Pe=-1):Qe=!0,Kt(Vt,gt-Gt))):(Se.sortIndex=si,ye(Oe,Se),ct||ft||(ct=!0,Dt||(Dt=!0,bi()))),Se},ne.unstable_shouldYield=qt,ne.unstable_wrapCallback=function(Se){var Ye=pe;return function(){var gt=pe;pe=Ye;try{return Se.apply(this,arguments)}finally{pe=gt}}}})(vp)),vp}var qp;function wm(){return qp||(qp=1,_p.exports=bm()),_p.exports}var xp={exports:{}},dr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gp;function Sm(){if(Gp)return dr;Gp=1;var ne=Sp();function ye(Oe){var U="https://react.dev/errors/"+Oe;if(1<arguments.length){U+="?args[]="+encodeURIComponent(arguments[1]);for(var ut=2;ut<arguments.length;ut++)U+="&args[]="+encodeURIComponent(arguments[ut])}return"Minified React error #"+Oe+"; visit "+U+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Me(){}var Q={d:{f:Me,r:function(){throw Error(ye(522))},D:Me,C:Me,L:Me,m:Me,X:Me,S:Me,M:Me},p:0,findDOMNode:null},Ve=Symbol.for("react.portal");function $e(Oe,U,ut){var Ue=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ve,key:Ue==null?null:""+Ue,children:Oe,containerInfo:U,implementation:ut}}var Fe=ne.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(Oe,U){if(Oe==="font")return"";if(typeof U=="string")return U==="use-credentials"?U:""}return dr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Q,dr.createPortal=function(Oe,U){var ut=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!U||U.nodeType!==1&&U.nodeType!==9&&U.nodeType!==11)throw Error(ye(299));return $e(Oe,U,null,ut)},dr.flushSync=function(Oe){var U=Fe.T,ut=Q.p;try{if(Fe.T=null,Q.p=2,Oe)return Oe()}finally{Fe.T=U,Q.p=ut,Q.d.f()}},dr.preconnect=function(Oe,U){typeof Oe=="string"&&(U?(U=U.crossOrigin,U=typeof U=="string"?U==="use-credentials"?U:"":void 0):U=null,Q.d.C(Oe,U))},dr.prefetchDNS=function(Oe){typeof Oe=="string"&&Q.d.D(Oe)},dr.preinit=function(Oe,U){if(typeof Oe=="string"&&U&&typeof U.as=="string"){var ut=U.as,Ue=f(ut,U.crossOrigin),pe=typeof U.integrity=="string"?U.integrity:void 0,ft=typeof U.fetchPriority=="string"?U.fetchPriority:void 0;ut==="style"?Q.d.S(Oe,typeof U.precedence=="string"?U.precedence:void 0,{crossOrigin:Ue,integrity:pe,fetchPriority:ft}):ut==="script"&&Q.d.X(Oe,{crossOrigin:Ue,integrity:pe,fetchPriority:ft,nonce:typeof U.nonce=="string"?U.nonce:void 0})}},dr.preinitModule=function(Oe,U){if(typeof Oe=="string")if(typeof U=="object"&&U!==null){if(U.as==null||U.as==="script"){var ut=f(U.as,U.crossOrigin);Q.d.M(Oe,{crossOrigin:ut,integrity:typeof U.integrity=="string"?U.integrity:void 0,nonce:typeof U.nonce=="string"?U.nonce:void 0})}}else U==null&&Q.d.M(Oe)},dr.preload=function(Oe,U){if(typeof Oe=="string"&&typeof U=="object"&&U!==null&&typeof U.as=="string"){var ut=U.as,Ue=f(ut,U.crossOrigin);Q.d.L(Oe,ut,{crossOrigin:Ue,integrity:typeof U.integrity=="string"?U.integrity:void 0,nonce:typeof U.nonce=="string"?U.nonce:void 0,type:typeof U.type=="string"?U.type:void 0,fetchPriority:typeof U.fetchPriority=="string"?U.fetchPriority:void 0,referrerPolicy:typeof U.referrerPolicy=="string"?U.referrerPolicy:void 0,imageSrcSet:typeof U.imageSrcSet=="string"?U.imageSrcSet:void 0,imageSizes:typeof U.imageSizes=="string"?U.imageSizes:void 0,media:typeof U.media=="string"?U.media:void 0})}},dr.preloadModule=function(Oe,U){if(typeof Oe=="string")if(U){var ut=f(U.as,U.crossOrigin);Q.d.m(Oe,{as:typeof U.as=="string"&&U.as!=="script"?U.as:void 0,crossOrigin:ut,integrity:typeof U.integrity=="string"?U.integrity:void 0})}else Q.d.m(Oe)},dr.requestFormReset=function(Oe){Q.d.r(Oe)},dr.unstable_batchedUpdates=function(Oe,U){return Oe(U)},dr.useFormState=function(Oe,U,ut){return Fe.H.useFormState(Oe,U,ut)},dr.useFormStatus=function(){return Fe.H.useHostTransitionStatus()},dr.version="19.2.0",dr}var Zp;function Tm(){if(Zp)return xp.exports;Zp=1;function ne(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ne)}catch(ye){console.error(ye)}}return ne(),xp.exports=Sm(),xp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $p;function Em(){if($p)return Pd;$p=1;var ne=wm(),ye=Sp(),Me=Tm();function Q(t){var n="https://react.dev/errors/"+t;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Ve(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $e(t){var n=t,o=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,(n.flags&4098)!==0&&(o=n.return),t=n.return;while(t)}return n.tag===3?o:null}function Fe(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function f(t){if(t.tag===31){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function Oe(t){if($e(t)!==t)throw Error(Q(188))}function U(t){var n=t.alternate;if(!n){if(n=$e(t),n===null)throw Error(Q(188));return n!==t?null:t}for(var o=t,c=n;;){var _=o.return;if(_===null)break;var b=_.alternate;if(b===null){if(c=_.return,c!==null){o=c;continue}break}if(_.child===b.child){for(b=_.child;b;){if(b===o)return Oe(_),t;if(b===c)return Oe(_),n;b=b.sibling}throw Error(Q(188))}if(o.return!==c.return)o=_,c=b;else{for(var D=!1,N=_.child;N;){if(N===o){D=!0,o=_,c=b;break}if(N===c){D=!0,c=_,o=b;break}N=N.sibling}if(!D){for(N=b.child;N;){if(N===o){D=!0,o=b,c=_;break}if(N===c){D=!0,c=b,o=_;break}N=N.sibling}if(!D)throw Error(Q(189))}}if(o.alternate!==c)throw Error(Q(190))}if(o.tag!==3)throw Error(Q(188));return o.stateNode.current===o?t:n}function ut(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t;for(t=t.child;t!==null;){if(n=ut(t),n!==null)return n;t=t.sibling}return null}var Ue=Object.assign,pe=Symbol.for("react.element"),ft=Symbol.for("react.transitional.element"),ct=Symbol.for("react.portal"),Qe=Symbol.for("react.fragment"),nt=Symbol.for("react.strict_mode"),Ge=Symbol.for("react.profiler"),it=Symbol.for("react.consumer"),bt=Symbol.for("react.context"),St=Symbol.for("react.forward_ref"),Vt=Symbol.for("react.suspense"),Dt=Symbol.for("react.suspense_list"),Pe=Symbol.for("react.memo"),Et=Symbol.for("react.lazy"),pi=Symbol.for("react.activity"),qt=Symbol.for("react.memo_cache_sentinel"),xi=Symbol.iterator;function bi(t){return t===null||typeof t!="object"?null:(t=xi&&t[xi]||t["@@iterator"],typeof t=="function"?t:null)}var va=Symbol.for("react.client.reference");function Bi(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===va?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qe:return"Fragment";case Ge:return"Profiler";case nt:return"StrictMode";case Vt:return"Suspense";case Dt:return"SuspenseList";case pi:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case ct:return"Portal";case bt:return t.displayName||"Context";case it:return(t._context.displayName||"Context")+".Consumer";case St:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Pe:return n=t.displayName||null,n!==null?n:Bi(t.type)||"Memo";case Et:n=t._payload,t=t._init;try{return Bi(t(n))}catch{}}return null}var Kt=Array.isArray,Se=ye.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ye=Me.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,gt={pending:!1,data:null,method:null,action:null},Gt=[],si=-1;function se(t){return{current:t}}function Ie(t){0>si||(t.current=Gt[si],Gt[si]=null,si--)}function Ze(t,n){si++,Gt[si]=t.current,t.current=n}var ht=se(null),kt=se(null),Rt=se(null),Pt=se(null);function Oi(t,n){switch(Ze(Rt,n),Ze(kt,t),Ze(ht,null),n.nodeType){case 9:case 11:t=(t=n.documentElement)&&(t=t.namespaceURI)?qe(t):0;break;default:if(t=n.tagName,n=n.namespaceURI)n=qe(n),t=zt(n,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}Ie(ht),Ze(ht,t)}function ii(){Ie(ht),Ie(kt),Ie(Rt)}function Wi(t){t.memoizedState!==null&&Ze(Pt,t);var n=ht.current,o=zt(n,t.type);n!==o&&(Ze(kt,t),Ze(ht,o))}function pn(t){kt.current===t&&(Ie(ht),Ie(kt)),Pt.current===t&&(Ie(Pt),kd._currentValue=gt)}var Tr,wo;function mn(t){if(Tr===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);Tr=n&&n[1]||"",wo=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Tr+t+wo}var ps=!1;function jr(t,n){if(!t||ps)return"";ps=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var Ne=function(){throw Error()};if(Object.defineProperty(Ne.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ne,[])}catch(Te){var we=Te}Reflect.construct(t,[],Ne)}else{try{Ne.call()}catch(Te){we=Te}t.call(Ne.prototype)}}else{try{throw Error()}catch(Te){we=Te}(Ne=t())&&typeof Ne.catch=="function"&&Ne.catch(function(){})}}catch(Te){if(Te&&we&&typeof Te.stack=="string")return[Te.stack,we.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=c.DetermineComponentFrameRoot(),D=b[0],N=b[1];if(D&&N){var te=D.split(`
`),be=N.split(`
`);for(_=c=0;c<te.length&&!te[c].includes("DetermineComponentFrameRoot");)c++;for(;_<be.length&&!be[_].includes("DetermineComponentFrameRoot");)_++;if(c===te.length||_===be.length)for(c=te.length-1,_=be.length-1;1<=c&&0<=_&&te[c]!==be[_];)_--;for(;1<=c&&0<=_;c--,_--)if(te[c]!==be[_]){if(c!==1||_!==1)do if(c--,_--,0>_||te[c]!==be[_]){var ke=`
`+te[c].replace(" at new "," at ");return t.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",t.displayName)),ke}while(1<=c&&0<=_);break}}}finally{ps=!1,Error.prepareStackTrace=o}return(o=t?t.displayName||t.name:"")?mn(o):""}function ms(t,n){switch(t.tag){case 26:case 27:case 5:return mn(t.type);case 16:return mn("Lazy");case 13:return t.child!==n&&n!==null?mn("Suspense Fallback"):mn("Suspense");case 19:return mn("SuspenseList");case 0:case 15:return jr(t.type,!1);case 11:return jr(t.type.render,!1);case 1:return jr(t.type,!0);case 31:return mn("Activity");default:return""}}function Vr(t){try{var n="",o=null;do n+=ms(t,o),o=t,t=t.return;while(t);return n}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var qr=Object.prototype.hasOwnProperty,Ee=ne.unstable_scheduleCallback,an=ne.unstable_cancelCallback,Kn=ne.unstable_shouldYield,Pi=ne.unstable_requestPaint,$t=ne.unstable_now,Er=ne.unstable_getCurrentPriorityLevel,js=ne.unstable_ImmediatePriority,Ar=ne.unstable_UserBlockingPriority,Vs=ne.unstable_NormalPriority,So=ne.unstable_LowPriority,Gr=ne.unstable_IdlePriority,qs=ne.log,et=ne.unstable_setDisableYieldValue,En=null,di=null;function An(t){if(typeof qs=="function"&&et(t),di&&typeof di.setStrictMode=="function")try{di.setStrictMode(En,t)}catch{}}var xa=Math.clz32?Math.clz32:Ft,tt=Math.log,Xt=Math.LN2;function Ft(t){return t>>>=0,t===0?32:31-(tt(t)/Xt|0)|0}var Fa=256,Nn=262144,Ut=4194304;function gn(t){var n=t&42;if(n!==0)return n;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Z(t,n,o){var c=t.pendingLanes;if(c===0)return 0;var _=0,b=t.suspendedLanes,D=t.pingedLanes;t=t.warmLanes;var N=c&134217727;return N!==0?(c=N&~b,c!==0?_=gn(c):(D&=N,D!==0?_=gn(D):o||(o=N&~t,o!==0&&(_=gn(o))))):(N=c&~b,N!==0?_=gn(N):D!==0?_=gn(D):o||(o=c&~t,o!==0&&(_=gn(o)))),_===0?0:n!==0&&n!==_&&(n&b)===0&&(b=_&-_,o=n&-n,b>=o||b===32&&(o&4194048)!==0)?n:_}function k(t,n){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&n)===0}function R(t,n){switch(t){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function F(){var t=Ut;return Ut<<=1,(Ut&62914560)===0&&(Ut=4194304),t}function H(t){for(var n=[],o=0;31>o;o++)n.push(t);return n}function Y(t,n){t.pendingLanes|=n,n!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function de(t,n,o,c,_,b){var D=t.pendingLanes;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=o,t.entangledLanes&=o,t.errorRecoveryDisabledLanes&=o,t.shellSuspendCounter=0;var N=t.entanglements,te=t.expirationTimes,be=t.hiddenUpdates;for(o=D&~o;0<o;){var ke=31-xa(o),Ne=1<<ke;N[ke]=0,te[ke]=-1;var we=be[ke];if(we!==null)for(be[ke]=null,ke=0;ke<we.length;ke++){var Te=we[ke];Te!==null&&(Te.lane&=-536870913)}o&=~Ne}c!==0&&ae(t,c,0),b!==0&&_===0&&t.tag!==0&&(t.suspendedLanes|=b&~(D&~n))}function ae(t,n,o){t.pendingLanes|=n,t.suspendedLanes&=~n;var c=31-xa(n);t.entangledLanes|=n,t.entanglements[c]=t.entanglements[c]|1073741824|o&261930}function W(t,n){var o=t.entangledLanes|=n;for(t=t.entanglements;o;){var c=31-xa(o),_=1<<c;_&n|t[c]&n&&(t[c]|=n),o&=~_}}function le(t,n){var o=n&-n;return o=(o&42)!==0?1:Ae(o),(o&(t.suspendedLanes|n))!==0?0:o}function Ae(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Ce(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Le(){var t=Ye.p;return t!==0?t:(t=window.event,t===void 0?32:Ip(t.type))}function At(t,n){var o=Ye.p;try{return Ye.p=t,n()}finally{Ye.p=o}}var It=Math.random().toString(36).slice(2),st="__reactFiber$"+It,pt="__reactProps$"+It,Bt="__reactContainer$"+It,mi="__reactEvents$"+It,Ii="__reactListeners$"+It,ci="__reactHandles$"+It,ai="__reactResources$"+It,za="__reactMarker$"+It;function ki(t){delete t[st],delete t[pt],delete t[mi],delete t[Ii],delete t[ci]}function Ki(t){var n=t[st];if(n)return n;for(var o=t.parentNode;o;){if(n=o[Bt]||o[st]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(t=fn(t);t!==null;){if(o=t[st])return o;t=fn(t)}return n}t=o,o=t.parentNode}return null}function ga(t){if(t=t[st]||t[Bt]){var n=t.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return t}return null}function nn(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t.stateNode;throw Error(Q(33))}function Gs(t){var n=t[ai];return n||(n=t[ai]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function la(t){t[za]=!0}var Zs=new Set,Ec={};function hi(t,n){gs(t,n),gs(t+"Capture",n)}function gs(t,n){for(Ec[t]=n,t=0;t<n.length;t++)Zs.add(n[t])}var Pl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ha={},zn={};function Nh(t){return qr.call(zn,t)?!0:qr.call(Ha,t)?!1:Pl.test(t)?zn[t]=!0:(Ha[t]=!0,!1)}function yn(t,n,o){if(Nh(n))if(o===null)t.removeAttribute(n);else{switch(typeof o){case"undefined":case"function":case"symbol":t.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(n);return}}t.setAttribute(n,""+o)}}function Ma(t,n,o){if(o===null)t.removeAttribute(n);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttribute(n,""+o)}}function Qn(t,n,o,c){if(c===null)t.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(o);return}t.setAttributeNS(n,o,""+c)}}function Xa(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Qi(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function yi(t,n,o){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,n);if(!t.hasOwnProperty(n)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var _=c.get,b=c.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return _.call(this)},set:function(D){o=""+D,b.call(this,D)}}),Object.defineProperty(t,n,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(D){o=""+D},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function Zr(t){if(!t._valueTracker){var n=Qi(t)?"checked":"value";t._valueTracker=yi(t,n,""+t[n])}}function ea(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var o=n.getValue(),c="";return t&&(c=Qi(t)?t.checked?"true":"false":t.value),t=c,t!==o?(n.setValue(t),!0):!1}function $s(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Jn=/[\n"\\]/g;function Mn(t){return t.replace(Jn,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function zr(t,n,o,c,_,b,D,N){t.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?t.type=D:t.removeAttribute("type"),n!=null?D==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+Xa(n)):t.value!==""+Xa(n)&&(t.value=""+Xa(n)):D!=="submit"&&D!=="reset"||t.removeAttribute("value"),n!=null?Jo(t,D,Xa(n)):o!=null?Jo(t,D,Xa(o)):c!=null&&t.removeAttribute("value"),_==null&&b!=null&&(t.defaultChecked=!!b),_!=null&&(t.checked=_&&typeof _!="function"&&typeof _!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?t.name=""+Xa(N):t.removeAttribute("name")}function Au(t,n,o,c,_,b,D,N){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(t.type=b),n!=null||o!=null){if(!(b!=="submit"&&b!=="reset"||n!=null)){Zr(t);return}o=o!=null?""+Xa(o):"",n=n!=null?""+Xa(n):o,N||n===t.value||(t.value=n),t.defaultValue=n}c=c??_,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=N?t.checked:!!c,t.defaultChecked=!!c,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(t.name=D),Zr(t)}function Jo(t,n,o){n==="number"&&$s(t.ownerDocument)===t||t.defaultValue===""+o||(t.defaultValue=""+o)}function $r(t,n,o,c){if(t=t.options,n){n={};for(var _=0;_<o.length;_++)n["$"+o[_]]=!0;for(o=0;o<t.length;o++)_=n.hasOwnProperty("$"+t[o].value),t[o].selected!==_&&(t[o].selected=_),_&&c&&(t[o].defaultSelected=!0)}else{for(o=""+Xa(o),n=null,_=0;_<t.length;_++){if(t[_].value===o){t[_].selected=!0,c&&(t[_].defaultSelected=!0);return}n!==null||t[_].disabled||(n=t[_])}n!==null&&(n.selected=!0)}}function Wo(t,n,o){if(n!=null&&(n=""+Xa(n),n!==t.value&&(t.value=n),o==null)){t.defaultValue!==n&&(t.defaultValue=n);return}t.defaultValue=o!=null?""+Xa(o):""}function Hr(t,n,o,c){if(n==null){if(c!=null){if(o!=null)throw Error(Q(92));if(Kt(c)){if(1<c.length)throw Error(Q(93));c=c[0]}o=c}o==null&&(o=""),n=o}o=Xa(n),t.defaultValue=o,c=t.textContent,c===o&&c!==""&&c!==null&&(t.value=c),Zr(t)}function ys(t,n){if(n){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=n;return}}t.textContent=n}var el=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zu(t,n,o){var c=n.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?t.setProperty(n,""):n==="float"?t.cssFloat="":t[n]="":c?t.setProperty(n,o):typeof o!="number"||o===0||el.has(n)?n==="float"?t.cssFloat=o:t[n]=(""+o).trim():t[n]=o+"px"}function Ac(t,n,o){if(n!=null&&typeof n!="object")throw Error(Q(62));if(t=t.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var _ in n)c=n[_],n.hasOwnProperty(_)&&o[_]!==c&&zu(t,_,c)}else for(var b in n)n.hasOwnProperty(b)&&zu(t,b,n[b])}function tl(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Nl(t){return zc.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Mr(){}var Fl=null;function To(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hs=null,Xs=null;function Ul(t){var n=ga(t);if(n&&(t=n.stateNode)){var o=t[pt]||null;e:switch(t=n.stateNode,n.type){case"input":if(zr(t,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),n=o.name,o.type==="radio"&&n!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Mn(""+n)+'"][type="radio"]'),n=0;n<o.length;n++){var c=o[n];if(c!==t&&c.form===t.form){var _=c[pt]||null;if(!_)throw Error(Q(90));zr(c,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(n=0;n<o.length;n++)c=o[n],c.form===t.form&&ea(c)}break e;case"textarea":Wo(t,o.value,o.defaultValue);break e;case"select":n=o.value,n!=null&&$r(t,!!o.multiple,n,!1)}}}var il=!1;function _s(t,n,o){if(il)return t(n,o);il=!0;try{var c=t(n);return c}finally{if(il=!1,(Hs!==null||Xs!==null)&&(cc(),Hs&&(n=Hs,t=Xs,Xs=Hs=null,Ul(n),t)))for(n=0;n<t.length;n++)Ul(t[n])}}function vs(t,n){var o=t.stateNode;if(o===null)return null;var c=o[pt]||null;if(c===null)return null;o=c[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(Q(231,n,typeof o));return o}var Ca=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Eo=!1;if(Ca)try{var xs={};Object.defineProperty(xs,"passive",{get:function(){Eo=!0}}),window.addEventListener("test",xs,xs),window.removeEventListener("test",xs,xs)}catch{Eo=!1}var Wn=null,Ao=null,Xr=null;function Yr(){if(Xr)return Xr;var t,n=Ao,o=n.length,c,_="value"in Wn?Wn.value:Wn.textContent,b=_.length;for(t=0;t<o&&n[t]===_[t];t++);var D=o-t;for(c=1;c<=D&&n[o-c]===_[b-c];c++);return Xr=_.slice(t,1<c?1-c:void 0)}function Jt(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function Ys(){return!0}function Cn(){return!1}function Gi(t){function n(o,c,_,b,D){this._reactName=o,this._targetInst=_,this.type=c,this.nativeEvent=b,this.target=D,this.currentTarget=null;for(var N in t)t.hasOwnProperty(N)&&(o=t[N],this[N]=o?o(b):b[N]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Ys:Cn,this.isPropagationStopped=Cn,this}return Ue(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ys)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ys)},persist:function(){},isPersistent:Ys}),n}var Kr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ks=Gi(Kr),bs=Ue({},Kr,{view:0,detail:0}),Cu=Gi(bs),al,zo,Qs,Mo=Ue({},bs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ql,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Qs&&(Qs&&t.type==="mousemove"?(al=t.screenX-Qs.screenX,zo=t.screenY-Qs.screenY):zo=al=0,Qs=t),al)},movementY:function(t){return"movementY"in t?t.movementY:zo}}),nl=Gi(Mo),Mc=Ue({},Mo,{dataTransfer:0}),Cc=Gi(Mc),Co=Ue({},bs,{relatedTarget:0}),Du=Gi(Co),Fh=Ue({},Kr,{animationName:0,elapsedTime:0,pseudoElement:0}),Uh=Gi(Fh),jh=Ue({},Kr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Vh=Gi(jh),qh=Ue({},Kr,{data:0}),jl=Gi(qh),Vl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Iu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ku={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Do(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=ku[t])?!!n[t]:!1}function ql(){return Do}var Dc=Ue({},bs,{key:function(t){if(t.key){var n=Vl[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=Jt(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Iu[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ql,charCode:function(t){return t.type==="keypress"?Jt(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Jt(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Lu=Gi(Dc),Js=Ue({},Mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ru=Gi(Js),ws=Ue({},bs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ql}),Io=Gi(ws),Ic=Ue({},Kr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bu=Gi(Ic),_i=Ue({},Mo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ta=Gi(_i),Gh=Ue({},Kr,{newState:0,oldState:0}),ni=Gi(Gh),Ws=[9,13,27,32],Zi=Ca&&"CompositionEvent"in window,Li=null;Ca&&"documentMode"in document&&(Li=document.documentMode);var rl=Ca&&"TextEvent"in window&&!Li,Ou=Ca&&(!Zi||Li&&8<Li&&11>=Li),Gl=" ",sl=!1;function ol(t,n){switch(t){case"keyup":return Ws.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zl(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qr=!1;function Pu(t,n){switch(t){case"compositionend":return Zl(n);case"keypress":return n.which!==32?null:(sl=!0,Gl);case"textInput":return t=n.data,t===Gl&&sl?null:t;default:return null}}function ll(t,n){if(Qr)return t==="compositionend"||!Zi&&ol(t,n)?(t=Yr(),Xr=Ao=Wn=null,Qr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Ou&&n.locale!=="ko"?null:n.data;default:return null}}var ul={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ko(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!ul[t.type]:n==="textarea"}function kc(t,n,o,c){Hs?Xs?Xs.push(c):Xs=[c]:Hs=c,n=P(n,"onChange"),0<n.length&&(o=new Ks("onChange","change",null,o,c),t.push({event:o,listeners:n}))}var eo=null,cl=null;function Lc(t){y(t,0)}function to(t){var n=nn(t);if(ea(n))return t}function $l(t,n){if(t==="change")return n}var Nu=!1;if(Ca){var Hl;if(Ca){var io="oninput"in document;if(!io){var hl=document.createElement("div");hl.setAttribute("oninput","return;"),io=typeof hl.oninput=="function"}Hl=io}else Hl=!1;Nu=Hl&&(!document.documentMode||9<document.documentMode)}function dl(){eo&&(eo.detachEvent("onpropertychange",Fu),cl=eo=null)}function Fu(t){if(t.propertyName==="value"&&to(cl)){var n=[];kc(n,cl,t,To(t)),_s(Lc,n)}}function ua(t,n,o){t==="focusin"?(dl(),eo=n,cl=o,eo.attachEvent("onpropertychange",Fu)):t==="focusout"&&dl()}function ao(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return to(cl)}function Dn(t,n){if(t==="click")return to(n)}function Lo(t,n){if(t==="input"||t==="change")return to(n)}function fl(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var rn=typeof Object.is=="function"?Object.is:fl;function fr(t,n){if(rn(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var o=Object.keys(t),c=Object.keys(n);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var _=o[c];if(!qr.call(n,_)||!rn(t[_],n[_]))return!1}return!0}function Ro(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function no(t,n){var o=Ro(t);t=0;for(var c;o;){if(o.nodeType===3){if(c=t+o.textContent.length,t<=n&&c>=n)return{node:o,offset:n-t};t=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Ro(o)}}function Uu(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?Uu(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function ju(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var n=$s(t.document);n instanceof t.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)t=n.contentWindow;else break;n=$s(t.document)}return n}function Xl(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}var Rc=Ca&&"documentMode"in document&&11>=document.documentMode,ro=null,er=null,Jr=null,_n=!1;function Bo(t,n,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;_n||ro==null||ro!==$s(c)||(c=ro,"selectionStart"in c&&Xl(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Jr&&fr(Jr,c)||(Jr=c,c=P(er,"onSelect"),0<c.length&&(n=new Ks("onSelect","select",null,n,o),t.push({event:n,listeners:c}),n.target=ro)))}function Ss(t,n){var o={};return o[t.toLowerCase()]=n.toLowerCase(),o["Webkit"+t]="webkit"+n,o["Moz"+t]="moz"+n,o}var so={animationend:Ss("Animation","AnimationEnd"),animationiteration:Ss("Animation","AnimationIteration"),animationstart:Ss("Animation","AnimationStart"),transitionrun:Ss("Transition","TransitionRun"),transitionstart:Ss("Transition","TransitionStart"),transitioncancel:Ss("Transition","TransitionCancel"),transitionend:Ss("Transition","TransitionEnd")},Yl={},Wr={};Ca&&(Wr=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function Ts(t){if(Yl[t])return Yl[t];if(!so[t])return t;var n=so[t],o;for(o in n)if(n.hasOwnProperty(o)&&o in Wr)return Yl[t]=n[o];return t}var Fn=Ts("animationend"),Cr=Ts("animationiteration"),pl=Ts("animationstart"),es=Ts("transitionrun"),ts=Ts("transitionstart"),Zh=Ts("transitioncancel"),Kl=Ts("transitionend"),Vu=new Map,Oo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Oo.push("scrollEnd");function sn(t,n){Vu.set(t,n),hi(n,[t])}var tr=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},rt=[],is=0,Dr=0;function as(){for(var t=is,n=Dr=is=0;n<t;){var o=rt[n];rt[n++]=null;var c=rt[n];rt[n++]=null;var _=rt[n];rt[n++]=null;var b=rt[n];if(rt[n++]=null,c!==null&&_!==null){var D=c.pending;D===null?_.next=_:(_.next=D.next,D.next=_),c.pending=_}b!==0&&Ql(o,_,b)}}function ml(t,n,o,c){rt[is++]=t,rt[is++]=n,rt[is++]=o,rt[is++]=c,Dr|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function ot(t,n,o,c){return ml(t,n,o,c),Jl(t)}function ns(t,n){return ml(t,null,null,n),Jl(t)}function Ql(t,n,o){t.lanes|=o;var c=t.alternate;c!==null&&(c.lanes|=o);for(var _=!1,b=t.return;b!==null;)b.childLanes|=o,c=b.alternate,c!==null&&(c.childLanes|=o),b.tag===22&&(t=b.stateNode,t===null||t._visibility&1||(_=!0)),t=b,b=b.return;return t.tag===3?(b=t.stateNode,_&&n!==null&&(_=31-xa(o),t=b.hiddenUpdates,c=t[_],c===null?t[_]=[n]:c.push(n),n.lane=o|536870912),b):null}function Jl(t){if(50<kl)throw kl=0,mu=null,Error(Q(185));for(var n=t.return;n!==null;)t=n,n=t.return;return t.tag===3?t.stateNode:null}var Es={};function Bc(t,n,o,c){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function In(t,n,o,c){return new Bc(t,n,o,c)}function Wl(t){return t=t.prototype,!(!t||!t.isReactComponent)}function rs(t,n){var o=t.alternate;return o===null?(o=In(t.tag,n,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=n,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&65011712,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,n=t.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o.refCleanup=t.refCleanup,o}function eu(t,n){t.flags&=65011714;var o=t.alternate;return o===null?(t.childLanes=0,t.lanes=n,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,n=o.dependencies,t.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t}function Po(t,n,o,c,_,b){var D=0;if(c=t,typeof t=="function")Wl(t)&&(D=1);else if(typeof t=="string")D=Tn(t,o,ht.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case pi:return t=In(31,o,n,_),t.elementType=pi,t.lanes=b,t;case Qe:return ss(o.children,_,b,n);case nt:D=8,_|=24;break;case Ge:return t=In(12,o,n,_|2),t.elementType=Ge,t.lanes=b,t;case Vt:return t=In(13,o,n,_),t.elementType=Vt,t.lanes=b,t;case Dt:return t=In(19,o,n,_),t.elementType=Dt,t.lanes=b,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case bt:D=10;break e;case it:D=9;break e;case St:D=11;break e;case Pe:D=14;break e;case Et:D=16,c=null;break e}D=29,o=Error(Q(130,t===null?"null":typeof t,"")),c=null}return n=In(D,o,n,_),n.elementType=t,n.type=c,n.lanes=b,n}function ss(t,n,o,c){return t=In(7,t,c,n),t.lanes=o,t}function gl(t,n,o){return t=In(6,t,null,n),t.lanes=o,t}function vn(t){var n=In(18,null,null,0);return n.stateNode=t,n}function Ir(t,n,o){return n=In(4,t.children!==null?t.children:[],t.key,n),n.lanes=o,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}var No=new WeakMap;function kn(t,n){if(typeof t=="object"&&t!==null){var o=No.get(t);return o!==void 0?o:(n={value:t,source:n,stack:Vr(n)},No.set(t,n),n)}return{value:t,source:n,stack:Vr(n)}}var kr=[],As=0,yl=null,Ya=0,oi=[],xn=0,Lr=null,pr=1,mr="";function Rr(t,n){kr[As++]=Ya,kr[As++]=yl,yl=t,Ya=n}function Oc(t,n,o){oi[xn++]=pr,oi[xn++]=mr,oi[xn++]=Lr,Lr=t;var c=pr;t=mr;var _=32-xa(c)-1;c&=~(1<<_),o+=1;var b=32-xa(n)+_;if(30<b){var D=_-_%5;b=(c&(1<<D)-1).toString(32),c>>=D,_-=D,pr=1<<32-xa(n)+_|o<<_|c,mr=b+t}else pr=1<<b|o<<_|c,mr=t}function Ka(t){t.return!==null&&(Rr(t,1),Oc(t,1,0))}function Fo(t){for(;t===yl;)yl=kr[--As],kr[As]=null,Ya=kr[--As],kr[As]=null;for(;t===Lr;)Lr=oi[--xn],oi[xn]=null,mr=oi[--xn],oi[xn]=null,pr=oi[--xn],oi[xn]=null}function wt(t,n){oi[xn++]=pr,oi[xn++]=mr,oi[xn++]=Lr,pr=n.id,mr=n.overflow,Lr=t}var mt=null,Ri=null,li=!1,Br=null,wi=!1,_l=Error(Q(519));function ka(t){var n=Error(Q(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw os(kn(n,t)),_l}function qu(t){var n=t.stateNode,o=t.type,c=t.memoizedProps;switch(n[st]=t,n[pt]=c,o){case"dialog":v("cancel",n),v("close",n);break;case"iframe":case"object":case"embed":v("load",n);break;case"video":case"audio":for(o=0;o<h.length;o++)v(h[o],n);break;case"source":v("error",n);break;case"img":case"image":case"link":v("error",n),v("load",n);break;case"details":v("toggle",n);break;case"input":v("invalid",n),Au(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":v("invalid",n);break;case"textarea":v("invalid",n),Hr(n,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||n.textContent===""+o||c.suppressHydrationWarning===!0||he(n.textContent,o)?(c.popover!=null&&(v("beforetoggle",n),v("toggle",n)),c.onScroll!=null&&v("scroll",n),c.onScrollEnd!=null&&v("scrollend",n),c.onClick!=null&&(n.onclick=Mr),n=!0):n=!1,n||ka(t,!0)}function zs(t){for(mt=t.return;mt;)switch(mt.tag){case 5:case 31:case 13:wi=!1;return;case 27:case 3:wi=!0;return;default:mt=mt.return}}function Ni(t){if(t!==mt)return!1;if(!li)return zs(t),li=!0,!1;var n=t.tag,o;if((o=n!==3&&n!==27)&&((o=n===5)&&(o=t.type,o=!(o!=="form"&&o!=="button")||xt(t.type,t.memoizedProps)),o=!o),o&&Ri&&ka(t),zs(t),n===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));Ri=ei(t)}else if(n===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));Ri=ei(t)}else n===27?(n=Ri,ra(t.type)?(t=Ea,Ea=null,Ri=t):Ri=n):Ri=mt?sa(t.stateNode.nextSibling):null;return!0}function zi(){Ri=mt=null,li=!1}function Ms(){var t=Br;return t!==null&&(sr===null?sr=t:sr.push.apply(sr,t),Br=null),t}function os(t){Br===null?Br=[t]:Br.push(t)}var oo=se(null),Un=null,gr=null;function Or(t,n,o){Ze(oo,n._currentValue),n._currentValue=o}function Ln(t){t._currentValue=oo.current,Ie(oo)}function vl(t,n,o){for(;t!==null;){var c=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),t===o)break;t=t.return}}function xl(t,n,o,c){var _=t.child;for(_!==null&&(_.return=t);_!==null;){var b=_.dependencies;if(b!==null){var D=_.child;b=b.firstContext;e:for(;b!==null;){var N=b;b=_;for(var te=0;te<n.length;te++)if(N.context===n[te]){b.lanes|=o,N=b.alternate,N!==null&&(N.lanes|=o),vl(b.return,o,t),c||(D=null);break e}b=N.next}}else if(_.tag===18){if(D=_.return,D===null)throw Error(Q(341));D.lanes|=o,b=D.alternate,b!==null&&(b.lanes|=o),vl(D,o,t),D=null}else D=_.child;if(D!==null)D.return=_;else for(D=_;D!==null;){if(D===t){D=null;break}if(_=D.sibling,_!==null){_.return=D.return,D=_;break}D=D.return}_=D}}function ri(t,n,o,c){t=null;for(var _=n,b=!1;_!==null;){if(!b){if((_.flags&524288)!==0)b=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var D=_.alternate;if(D===null)throw Error(Q(387));if(D=D.memoizedProps,D!==null){var N=_.type;rn(_.pendingProps.value,D.value)||(t!==null?t.push(N):t=[N])}}else if(_===Pt.current){if(D=_.alternate,D===null)throw Error(Q(387));D.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(t!==null?t.push(kd):t=[kd])}_=_.return}t!==null&&xl(n,t,o,c),n.flags|=262144}function p(t){for(t=t.firstContext;t!==null;){if(!rn(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function i(t){Un=t,gr=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function s(t){return d(Un,t)}function u(t,n){return Un===null&&i(t),d(t,n)}function d(t,n){var o=n._currentValue;if(n={context:n,memoizedValue:o,next:null},gr===null){if(t===null)throw Error(Q(308));gr=n,t.dependencies={lanes:0,firstContext:n},t.flags|=524288}else gr=gr.next=n;return o}var m=typeof AbortController<"u"?AbortController:function(){var t=[],n=this.signal={aborted:!1,addEventListener:function(o,c){t.push(c)}};this.abort=function(){n.aborted=!0,t.forEach(function(o){return o()})}},x=ne.unstable_scheduleCallback,w=ne.unstable_NormalPriority,T={$$typeof:bt,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function A(){return{controller:new m,data:new Map,refCount:0}}function M(t){t.refCount--,t.refCount===0&&x(w,function(){t.controller.abort()})}var C=null,B=0,q=0,V=null;function $(t,n){if(C===null){var o=C=[];B=0,q=xc(),V={status:"pending",value:void 0,then:function(c){o.push(c)}}}return B++,n.then(j,j),n}function j(){if(--B===0&&C!==null){V!==null&&(V.status="fulfilled");var t=C;C=null,q=0,V=null;for(var n=0;n<t.length;n++)(0,t[n])()}}function re(t,n){var o=[],c={status:"pending",value:null,reason:null,then:function(_){o.push(_)}};return t.then(function(){c.status="fulfilled",c.value=n;for(var _=0;_<o.length;_++)(0,o[_])(n)},function(_){for(c.status="rejected",c.reason=_,_=0;_<o.length;_++)(0,o[_])(void 0)}),c}var ge=Se.S;Se.S=function(t,n){vf=$t(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&$(t,n),ge!==null&&ge(t,n)};var K=se(null);function oe(){var t=K.current;return t!==null?t:qi.pooledCache}function _e(t,n){n===null?Ze(K,K.current):Ze(K,n.pool)}function xe(){var t=oe();return t===null?null:{parent:T._currentValue,pool:t}}var ze=Error(Q(460)),je=Error(Q(474)),Re=Error(Q(542)),He={then:function(){}};function yt(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Wt(t,n,o){switch(o=t[o],o===void 0?t.push(n):o!==n&&(n.then(Mr,Mr),n=o),n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,Ai(t),t;default:if(typeof n.status=="string")n.then(Mr,Mr);else{if(t=qi,t!==null&&100<t.shellSuspendCounter)throw Error(Q(482));t=n,t.status="pending",t.then(function(c){if(n.status==="pending"){var _=n;_.status="fulfilled",_.value=c}},function(c){if(n.status==="pending"){var _=n;_.status="rejected",_.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,Ai(t),t}throw Tt=n,ze}}function Je(t){try{var n=t._init;return n(t._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Tt=o,ze):o}}var Tt=null;function _t(){if(Tt===null)throw Error(Q(459));var t=Tt;return Tt=null,t}function Ai(t){if(t===ze||t===Re)throw Error(Q(483))}var Ht=null,jt=0;function Qt(t){var n=jt;return jt+=1,Ht===null&&(Ht=[]),Wt(Ht,t,n)}function $i(t,n){n=n.props.ref,t.ref=n!==void 0?n:null}function Mi(t,n){throw n.$$typeof===pe?Error(Q(525)):(t=Object.prototype.toString.call(n),Error(Q(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t)))}function Ua(t){function n(me,ue){if(t){var ve=me.deletions;ve===null?(me.deletions=[ue],me.flags|=16):ve.push(ue)}}function o(me,ue){if(!t)return null;for(;ue!==null;)n(me,ue),ue=ue.sibling;return null}function c(me){for(var ue=new Map;me!==null;)me.key!==null?ue.set(me.key,me):ue.set(me.index,me),me=me.sibling;return ue}function _(me,ue){return me=rs(me,ue),me.index=0,me.sibling=null,me}function b(me,ue,ve){return me.index=ve,t?(ve=me.alternate,ve!==null?(ve=ve.index,ve<ue?(me.flags|=67108866,ue):ve):(me.flags|=67108866,ue)):(me.flags|=1048576,ue)}function D(me){return t&&me.alternate===null&&(me.flags|=67108866),me}function N(me,ue,ve,Be){return ue===null||ue.tag!==6?(ue=gl(ve,me.mode,Be),ue.return=me,ue):(ue=_(ue,ve),ue.return=me,ue)}function te(me,ue,ve,Be){var Ot=ve.type;return Ot===Qe?ke(me,ue,ve.props.children,Be,ve.key):ue!==null&&(ue.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===Et&&Je(Ot)===ue.type)?(ue=_(ue,ve.props),$i(ue,ve),ue.return=me,ue):(ue=Po(ve.type,ve.key,ve.props,null,me.mode,Be),$i(ue,ve),ue.return=me,ue)}function be(me,ue,ve,Be){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==ve.containerInfo||ue.stateNode.implementation!==ve.implementation?(ue=Ir(ve,me.mode,Be),ue.return=me,ue):(ue=_(ue,ve.children||[]),ue.return=me,ue)}function ke(me,ue,ve,Be,Ot){return ue===null||ue.tag!==7?(ue=ss(ve,me.mode,Be,Ot),ue.return=me,ue):(ue=_(ue,ve),ue.return=me,ue)}function Ne(me,ue,ve){if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return ue=gl(""+ue,me.mode,ve),ue.return=me,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case ft:return ve=Po(ue.type,ue.key,ue.props,null,me.mode,ve),$i(ve,ue),ve.return=me,ve;case ct:return ue=Ir(ue,me.mode,ve),ue.return=me,ue;case Et:return ue=Je(ue),Ne(me,ue,ve)}if(Kt(ue)||bi(ue))return ue=ss(ue,me.mode,ve,null),ue.return=me,ue;if(typeof ue.then=="function")return Ne(me,Qt(ue),ve);if(ue.$$typeof===bt)return Ne(me,u(me,ue),ve);Mi(me,ue)}return null}function we(me,ue,ve,Be){var Ot=ue!==null?ue.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return Ot!==null?null:N(me,ue,""+ve,Be);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case ft:return ve.key===Ot?te(me,ue,ve,Be):null;case ct:return ve.key===Ot?be(me,ue,ve,Be):null;case Et:return ve=Je(ve),we(me,ue,ve,Be)}if(Kt(ve)||bi(ve))return Ot!==null?null:ke(me,ue,ve,Be,null);if(typeof ve.then=="function")return we(me,ue,Qt(ve),Be);if(ve.$$typeof===bt)return we(me,ue,u(me,ve),Be);Mi(me,ve)}return null}function Te(me,ue,ve,Be,Ot){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return me=me.get(ve)||null,N(ue,me,""+Be,Ot);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case ft:return me=me.get(Be.key===null?ve:Be.key)||null,te(ue,me,Be,Ot);case ct:return me=me.get(Be.key===null?ve:Be.key)||null,be(ue,me,Be,Ot);case Et:return Be=Je(Be),Te(me,ue,ve,Be,Ot)}if(Kt(Be)||bi(Be))return me=me.get(ve)||null,ke(ue,me,Be,Ot,null);if(typeof Be.then=="function")return Te(me,ue,ve,Qt(Be),Ot);if(Be.$$typeof===bt)return Te(me,ue,ve,u(ue,Be),Ot);Mi(ue,Be)}return null}function Ct(me,ue,ve,Be){for(var Ot=null,Ui=null,Lt=ue,ui=ue=0,Ei=null;Lt!==null&&ui<ve.length;ui++){Lt.index>ui?(Ei=Lt,Lt=null):Ei=Lt.sibling;var ji=we(me,Lt,ve[ui],Be);if(ji===null){Lt===null&&(Lt=Ei);break}t&&Lt&&ji.alternate===null&&n(me,Lt),ue=b(ji,ue,ui),Ui===null?Ot=ji:Ui.sibling=ji,Ui=ji,Lt=Ei}if(ui===ve.length)return o(me,Lt),li&&Rr(me,ui),Ot;if(Lt===null){for(;ui<ve.length;ui++)Lt=Ne(me,ve[ui],Be),Lt!==null&&(ue=b(Lt,ue,ui),Ui===null?Ot=Lt:Ui.sibling=Lt,Ui=Lt);return li&&Rr(me,ui),Ot}for(Lt=c(Lt);ui<ve.length;ui++)Ei=Te(Lt,me,ui,ve[ui],Be),Ei!==null&&(t&&Ei.alternate!==null&&Lt.delete(Ei.key===null?ui:Ei.key),ue=b(Ei,ue,ui),Ui===null?Ot=Ei:Ui.sibling=Ei,Ui=Ei);return t&&Lt.forEach(function(Eu){return n(me,Eu)}),li&&Rr(me,ui),Ot}function Zt(me,ue,ve,Be){if(ve==null)throw Error(Q(151));for(var Ot=null,Ui=null,Lt=ue,ui=ue=0,Ei=null,ji=ve.next();Lt!==null&&!ji.done;ui++,ji=ve.next()){Lt.index>ui?(Ei=Lt,Lt=null):Ei=Lt.sibling;var Eu=we(me,Lt,ji.value,Be);if(Eu===null){Lt===null&&(Lt=Ei);break}t&&Lt&&Eu.alternate===null&&n(me,Lt),ue=b(Eu,ue,ui),Ui===null?Ot=Eu:Ui.sibling=Eu,Ui=Eu,Lt=Ei}if(ji.done)return o(me,Lt),li&&Rr(me,ui),Ot;if(Lt===null){for(;!ji.done;ui++,ji=ve.next())ji=Ne(me,ji.value,Be),ji!==null&&(ue=b(ji,ue,ui),Ui===null?Ot=ji:Ui.sibling=ji,Ui=ji);return li&&Rr(me,ui),Ot}for(Lt=c(Lt);!ji.done;ui++,ji=ve.next())ji=Te(Lt,me,ui,ji.value,Be),ji!==null&&(t&&ji.alternate!==null&&Lt.delete(ji.key===null?ui:ji.key),ue=b(ji,ue,ui),Ui===null?Ot=ji:Ui.sibling=ji,Ui=ji);return t&&Lt.forEach(function(gm){return n(me,gm)}),li&&Rr(me,ui),Ot}function oa(me,ue,ve,Be){if(typeof ve=="object"&&ve!==null&&ve.type===Qe&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case ft:e:{for(var Ot=ve.key;ue!==null;){if(ue.key===Ot){if(Ot=ve.type,Ot===Qe){if(ue.tag===7){o(me,ue.sibling),Be=_(ue,ve.props.children),Be.return=me,me=Be;break e}}else if(ue.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===Et&&Je(Ot)===ue.type){o(me,ue.sibling),Be=_(ue,ve.props),$i(Be,ve),Be.return=me,me=Be;break e}o(me,ue);break}else n(me,ue);ue=ue.sibling}ve.type===Qe?(Be=ss(ve.props.children,me.mode,Be,ve.key),Be.return=me,me=Be):(Be=Po(ve.type,ve.key,ve.props,null,me.mode,Be),$i(Be,ve),Be.return=me,me=Be)}return D(me);case ct:e:{for(Ot=ve.key;ue!==null;){if(ue.key===Ot)if(ue.tag===4&&ue.stateNode.containerInfo===ve.containerInfo&&ue.stateNode.implementation===ve.implementation){o(me,ue.sibling),Be=_(ue,ve.children||[]),Be.return=me,me=Be;break e}else{o(me,ue);break}else n(me,ue);ue=ue.sibling}Be=Ir(ve,me.mode,Be),Be.return=me,me=Be}return D(me);case Et:return ve=Je(ve),oa(me,ue,ve,Be)}if(Kt(ve))return Ct(me,ue,ve,Be);if(bi(ve)){if(Ot=bi(ve),typeof Ot!="function")throw Error(Q(150));return ve=Ot.call(ve),Zt(me,ue,ve,Be)}if(typeof ve.then=="function")return oa(me,ue,Qt(ve),Be);if(ve.$$typeof===bt)return oa(me,ue,u(me,ve),Be);Mi(me,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint"?(ve=""+ve,ue!==null&&ue.tag===6?(o(me,ue.sibling),Be=_(ue,ve),Be.return=me,me=Be):(o(me,ue),Be=gl(ve,me.mode,Be),Be.return=me,me=Be),D(me)):o(me,ue)}return function(me,ue,ve,Be){try{jt=0;var Ot=oa(me,ue,ve,Be);return Ht=null,Ot}catch(Lt){if(Lt===ze||Lt===Re)throw Lt;var Ui=In(29,Lt,null,me.mode);return Ui.lanes=Be,Ui.return=me,Ui}finally{}}}var Ji=Ua(!0),ya=Ua(!1),Da=!1;function Fi(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ir(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Qa(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function bn(t,n,o){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Ci&2)!==0){var _=c.pending;return _===null?n.next=n:(n.next=_.next,_.next=n),c.pending=n,n=Jl(t),Ql(t,null,o),n}return ml(t,c,n,o),Jl(t)}function yr(t,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194048)!==0)){var c=n.lanes;c&=t.pendingLanes,o|=c,n.lanes=o,W(t,o)}}function Cs(t,n){var o=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var _=null,b=null;if(o=o.firstBaseUpdate,o!==null){do{var D={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};b===null?_=b=D:b=b.next=D,o=o.next}while(o!==null);b===null?_=b=n:b=b.next=n}else _=b=n;o={baseState:c.baseState,firstBaseUpdate:_,lastBaseUpdate:b,shared:c.shared,callbacks:c.callbacks},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=n:t.next=n,o.lastBaseUpdate=n}var ja=!1;function ba(){if(ja){var t=V;if(t!==null)throw t}}function La(t,n,o,c){ja=!1;var _=t.updateQueue;Da=!1;var b=_.firstBaseUpdate,D=_.lastBaseUpdate,N=_.shared.pending;if(N!==null){_.shared.pending=null;var te=N,be=te.next;te.next=null,D===null?b=be:D.next=be,D=te;var ke=t.alternate;ke!==null&&(ke=ke.updateQueue,N=ke.lastBaseUpdate,N!==D&&(N===null?ke.firstBaseUpdate=be:N.next=be,ke.lastBaseUpdate=te))}if(b!==null){var Ne=_.baseState;D=0,ke=be=te=null,N=b;do{var we=N.lane&-536870913,Te=we!==N.lane;if(Te?(gi&we)===we:(c&we)===we){we!==0&&we===q&&(ja=!0),ke!==null&&(ke=ke.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var Ct=t,Zt=N;we=n;var oa=o;switch(Zt.tag){case 1:if(Ct=Zt.payload,typeof Ct=="function"){Ne=Ct.call(oa,Ne,we);break e}Ne=Ct;break e;case 3:Ct.flags=Ct.flags&-65537|128;case 0:if(Ct=Zt.payload,we=typeof Ct=="function"?Ct.call(oa,Ne,we):Ct,we==null)break e;Ne=Ue({},Ne,we);break e;case 2:Da=!0}}we=N.callback,we!==null&&(t.flags|=64,Te&&(t.flags|=8192),Te=_.callbacks,Te===null?_.callbacks=[we]:Te.push(we))}else Te={lane:we,tag:N.tag,payload:N.payload,callback:N.callback,next:null},ke===null?(be=ke=Te,te=Ne):ke=ke.next=Te,D|=we;if(N=N.next,N===null){if(N=_.shared.pending,N===null)break;Te=N,N=Te.next,Te.next=null,_.lastBaseUpdate=Te,_.shared.pending=null}}while(!0);ke===null&&(te=Ne),_.baseState=te,_.firstBaseUpdate=be,_.lastBaseUpdate=ke,b===null&&(_.shared.lanes=0),go|=D,t.lanes=D,t.memoizedState=Ne}}function Ds(t,n){if(typeof t!="function")throw Error(Q(191,t));t.call(n)}function ca(t,n){var o=t.callbacks;if(o!==null)for(t.callbacks=null,t=0;t<o.length;t++)Ds(o[t],n)}var ia=se(null),Ja=se(0);function ha(t,n){t=rr,Ze(Ja,t),Ze(ia,n),rr=t|n.baseLanes}function ls(){Ze(Ja,rr),Ze(ia,ia.current)}function Uo(){rr=Ja.current,Ie(ia),Ie(Ja)}var Rn=se(null),jn=null;function Is(t){var n=t.alternate;Ze(Si,Si.current&1),Ze(Rn,t),jn===null&&(n===null||ia.current!==null||n.memoizedState!==null)&&(jn=t)}function bl(t){Ze(Si,Si.current),Ze(Rn,t),jn===null&&(jn=t)}function _r(t){t.tag===22?(Ze(Si,Si.current),Ze(Rn,t),jn===null&&(jn=t)):Bn()}function Bn(){Ze(Si,Si.current),Ze(Rn,Rn.current)}function _a(t){Ie(Rn),jn===t&&(jn=null),Ie(Si)}var Si=se(0);function Vn(t){for(var n=t;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||dn(o)||en(o)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var vr=0,Nt=null,Hi=null,Ra=null,da=!1,jo=!1,Vo=!1,ks=0,us=0,lo=null,$h=0;function wa(){throw Error(Q(321))}function Hh(t,n){if(n===null)return!1;for(var o=0;o<n.length&&o<t.length;o++)if(!rn(t[o],n[o]))return!1;return!0}function Pc(t,n,o,c,_,b){return vr=b,Nt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Se.H=t===null||t.memoizedState===null?Kc:rd,Vo=!1,b=o(c,_),Vo=!1,jo&&(b=Nc(n,o,c,_)),Ud(t),b}function Ud(t){Se.H=Ku;var n=Hi!==null&&Hi.next!==null;if(vr=0,Ra=Hi=Nt=null,da=!1,us=0,lo=null,n)throw Error(Q(300));t===null||qa||(t=t.dependencies,t!==null&&p(t)&&(qa=!0))}function Nc(t,n,o,c){Nt=t;var _=0;do{if(jo&&(lo=null),us=0,jo=!1,25<=_)throw Error(Q(301));if(_+=1,Ra=Hi=null,t.updateQueue!=null){var b=t.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}Se.H=Qc,b=n(o,c)}while(jo);return b}function Qf(){var t=Se.H,n=t.useState()[0];return n=typeof n.then=="function"?Go(n):n,t=t.useState()[0],(Hi!==null?Hi.memoizedState:null)!==t&&(Nt.flags|=1024),n}function Gu(){var t=ks!==0;return ks=0,t}function Fc(t,n,o){n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~o}function Uc(t){if(da){for(t=t.memoizedState;t!==null;){var n=t.queue;n!==null&&(n.pending=null),t=t.next}da=!1}vr=0,Ra=Hi=Nt=null,jo=!1,us=ks=0,lo=null}function Va(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ra===null?Nt.memoizedState=Ra=t:Ra=Ra.next=t,Ra}function Ba(){if(Hi===null){var t=Nt.alternate;t=t!==null?t.memoizedState:null}else t=Hi.next;var n=Ra===null?Nt.memoizedState:Ra.next;if(n!==null)Ra=n,Hi=t;else{if(t===null)throw Nt.alternate===null?Error(Q(467)):Error(Q(310));Hi=t,t={memoizedState:Hi.memoizedState,baseState:Hi.baseState,baseQueue:Hi.baseQueue,queue:Hi.queue,next:null},Ra===null?Nt.memoizedState=Ra=t:Ra=Ra.next=t}return Ra}function qo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Go(t){var n=us;return us+=1,lo===null&&(lo=[]),t=Wt(lo,t,n),n=Nt,(Ra===null?n.memoizedState:Ra.next)===null&&(n=n.alternate,Se.H=n===null||n.memoizedState===null?Kc:rd),t}function wl(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Go(t);if(t.$$typeof===bt)return s(t)}throw Error(Q(438,String(t)))}function jc(t){var n=null,o=Nt.updateQueue;if(o!==null&&(n=o.memoCache),n==null){var c=Nt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(_){return _.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),o===null&&(o=qo(),Nt.updateQueue=o),o.memoCache=n,o=n.data[n.index],o===void 0)for(o=n.data[n.index]=Array(t),c=0;c<t;c++)o[c]=qt;return n.index++,o}function Ls(t,n){return typeof n=="function"?n(t):n}function Vc(t){var n=Ba();return on(n,Hi,t)}function on(t,n,o){var c=t.queue;if(c===null)throw Error(Q(311));c.lastRenderedReducer=o;var _=t.baseQueue,b=c.pending;if(b!==null){if(_!==null){var D=_.next;_.next=b.next,b.next=D}n.baseQueue=_=b,c.pending=null}if(b=t.baseState,_===null)t.memoizedState=b;else{n=_.next;var N=D=null,te=null,be=n,ke=!1;do{var Ne=be.lane&-536870913;if(Ne!==be.lane?(gi&Ne)===Ne:(vr&Ne)===Ne){var we=be.revertLane;if(we===0)te!==null&&(te=te.next={lane:0,revertLane:0,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),Ne===q&&(ke=!0);else if((vr&we)===we){be=be.next,we===q&&(ke=!0);continue}else Ne={lane:0,revertLane:be.revertLane,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},te===null?(N=te=Ne,D=b):te=te.next=Ne,Nt.lanes|=we,go|=we;Ne=be.action,Vo&&o(b,Ne),b=be.hasEagerState?be.eagerState:o(b,Ne)}else we={lane:Ne,revertLane:be.revertLane,gesture:be.gesture,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},te===null?(N=te=we,D=b):te=te.next=we,Nt.lanes|=Ne,go|=Ne;be=be.next}while(be!==null&&be!==n);if(te===null?D=b:te.next=N,!rn(b,t.memoizedState)&&(qa=!0,ke&&(o=V,o!==null)))throw o;t.memoizedState=b,t.baseState=D,t.baseQueue=te,c.lastRenderedState=b}return _===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Zo(t){var n=Ba(),o=n.queue;if(o===null)throw Error(Q(311));o.lastRenderedReducer=t;var c=o.dispatch,_=o.pending,b=n.memoizedState;if(_!==null){o.pending=null;var D=_=_.next;do b=t(b,D.action),D=D.next;while(D!==_);rn(b,n.memoizedState)||(qa=!0),n.memoizedState=b,n.baseQueue===null&&(n.baseState=b),o.lastRenderedState=b}return[b,c]}function qc(t,n,o){var c=Nt,_=Ba(),b=li;if(b){if(o===void 0)throw Error(Q(407));o=o()}else o=n();var D=!rn((Hi||_).memoizedState,o);if(D&&(_.memoizedState=o,qa=!0),_=_.queue,uo(jd.bind(null,c,_,t),[t]),_.getSnapshot!==n||D||Ra!==null&&Ra.memoizedState.tag&1){if(c.flags|=2048,au(9,{destroy:void 0},tu.bind(null,c,_,o,n),null),qi===null)throw Error(Q(349));b||(vr&127)!==0||Xh(c,n,o)}return o}function Xh(t,n,o){t.flags|=16384,t={getSnapshot:n,value:o},n=Nt.updateQueue,n===null?(n=qo(),Nt.updateQueue=n,n.stores=[t]):(o=n.stores,o===null?n.stores=[t]:o.push(t))}function tu(t,n,o,c){n.value=o,n.getSnapshot=c,Zu(n)&&Vd(t)}function jd(t,n,o){return o(function(){Zu(n)&&Vd(t)})}function Zu(t){var n=t.getSnapshot;t=t.value;try{var o=n();return!rn(t,o)}catch{return!0}}function Vd(t){var n=ns(t,2);n!==null&&Hn(n,t,2)}function Gc(t){var n=Va();if(typeof t=="function"){var o=t;if(t=o(),Vo){An(!0);try{o()}finally{An(!1)}}}return n.memoizedState=n.baseState=t,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:t},n}function Yh(t,n,o,c){return t.baseState=o,on(t,Hi,typeof c=="function"?c:Ls)}function qd(t,n,o,c,_){if(Yc(t))throw Error(Q(485));if(t=n.action,t!==null){var b={payload:_,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){b.listeners.push(D)}};Se.T!==null?o(!0):b.isTransition=!1,c(b),o=n.pending,o===null?(b.next=n.pending=b,Gd(n,b)):(b.next=o.next,n.pending=o.next=b)}}function Gd(t,n){var o=n.action,c=n.payload,_=t.state;if(n.isTransition){var b=Se.T,D={};Se.T=D;try{var N=o(_,c),te=Se.S;te!==null&&te(D,N),Zc(t,n,N)}catch(be){$u(t,n,be)}finally{b!==null&&D.types!==null&&(b.types=D.types),Se.T=b}}else try{b=o(_,c),Zc(t,n,b)}catch(be){$u(t,n,be)}}function Zc(t,n,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Kh(t,n,c)},function(c){return $u(t,n,c)}):Kh(t,n,o)}function Kh(t,n,o){n.status="fulfilled",n.value=o,iu(n),t.state=o,n=t.pending,n!==null&&(o=n.next,o===n?t.pending=null:(o=o.next,n.next=o,Gd(t,o)))}function $u(t,n,o){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=o,iu(n),n=n.next;while(n!==c)}t.action=null}function iu(t){t=t.listeners;for(var n=0;n<t.length;n++)(0,t[n])()}function ar(t,n){return n}function Qh(t,n){if(li){var o=qi.formState;if(o!==null){e:{var c=Nt;if(li){if(Ri){t:{for(var _=Ri,b=wi;_.nodeType!==8;){if(!b){_=null;break t}if(_=sa(_.nextSibling),_===null){_=null;break t}}b=_.data,_=b==="F!"||b==="F"?_:null}if(_){Ri=sa(_.nextSibling),c=_.data==="F!";break e}}ka(c)}c=!1}c&&(n=o[0])}}return o=Va(),o.memoizedState=o.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ar,lastRenderedState:n},o.queue=c,o=Hc.bind(null,Nt,c),c.dispatch=o,c=Gc(!1),b=Xc.bind(null,Nt,!1,c.queue),c=Va(),_={state:n,dispatch:null,action:t,pending:null},c.queue=_,o=qd.bind(null,Nt,_,b,o),_.dispatch=o,c.memoizedState=t,[n,o,!1]}function Zd(t){var n=Ba();return Jh(n,Hi,t)}function Jh(t,n,o){if(n=on(t,n,ar)[0],t=Vc(Ls)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var c=Go(n)}catch(D){throw D===ze?Re:D}else c=n;n=Ba();var _=n.queue,b=_.dispatch;return o!==n.memoizedState&&(Nt.flags|=2048,au(9,{destroy:void 0},Jf.bind(null,_,o),null)),[c,b,t]}function Jf(t,n){t.action=n}function $d(t){var n=Ba(),o=Hi;if(o!==null)return Jh(n,o,t);Ba(),n=n.memoizedState,o=Ba();var c=o.queue.dispatch;return o.memoizedState=t,[n,c,!1]}function au(t,n,o,c){return t={tag:t,create:o,deps:c,inst:n,next:null},n=Nt.updateQueue,n===null&&(n=qo(),Nt.updateQueue=n),o=n.lastEffect,o===null?n.lastEffect=t.next=t:(c=o.next,o.next=t,t.next=c,n.lastEffect=t),t}function Hd(){return Ba().memoizedState}function nu(t,n,o,c){var _=Va();Nt.flags|=t,_.memoizedState=au(1|n,{destroy:void 0},o,c===void 0?null:c)}function Sl(t,n,o,c){var _=Ba();c=c===void 0?null:c;var b=_.memoizedState.inst;Hi!==null&&c!==null&&Hh(c,Hi.memoizedState.deps)?_.memoizedState=au(n,b,o,c):(Nt.flags|=t,_.memoizedState=au(1|n,b,o,c))}function Wh(t,n){nu(8390656,8,t,n)}function uo(t,n){Sl(2048,8,t,n)}function Hu(t){Nt.flags|=4;var n=Nt.updateQueue;if(n===null)n=qo(),Nt.updateQueue=n,n.events=[t];else{var o=n.events;o===null?n.events=[t]:o.push(t)}}function Xd(t){var n=Ba().memoizedState;return Hu({ref:n,nextImpl:t}),function(){if((Ci&2)!==0)throw Error(Q(440));return n.impl.apply(void 0,arguments)}}function Yd(t,n){return Sl(4,2,t,n)}function Kd(t,n){return Sl(4,4,t,n)}function Qd(t,n){if(typeof n=="function"){t=t();var o=n(t);return function(){typeof o=="function"?o():n(null)}}if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function Jd(t,n,o){o=o!=null?o.concat([t]):null,Sl(4,4,Qd.bind(null,n,t),o)}function ed(){}function Wd(t,n){var o=Ba();n=n===void 0?null:n;var c=o.memoizedState;return n!==null&&Hh(n,c[1])?c[0]:(o.memoizedState=[t,n],t)}function $c(t,n){var o=Ba();n=n===void 0?null:n;var c=o.memoizedState;if(n!==null&&Hh(n,c[1]))return c[0];if(c=t(),Vo){An(!0);try{t()}finally{An(!1)}}return o.memoizedState=[c,n],c}function td(t,n,o){return o===void 0||(vr&1073741824)!==0&&(gi&261930)===0?t.memoizedState=n:(t.memoizedState=o,t=wh(),Nt.lanes|=t,go|=t,o)}function Tl(t,n,o,c){return rn(o,n)?o:ia.current!==null?(t=td(t,o,c),rn(t,n)||(qa=!0),t):(vr&42)===0||(vr&1073741824)!==0&&(gi&261930)===0?(qa=!0,t.memoizedState=o):(t=wh(),Nt.lanes|=t,go|=t,n)}function ef(t,n,o,c,_){var b=Ye.p;Ye.p=b!==0&&8>b?b:8;var D=Se.T,N={};Se.T=N,Xc(t,!1,n,o);try{var te=_(),be=Se.S;if(be!==null&&be(N,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var ke=re(te,c);El(t,n,ke,or(t))}else El(t,n,c,or(t))}catch(Ne){El(t,n,{then:function(){},status:"rejected",reason:Ne},or())}finally{Ye.p=b,D!==null&&N.types!==null&&(D.types=N.types),Se.T=D}}function Sa(){}function ru(t,n,o,c){if(t.tag!==5)throw Error(Q(476));var _=id(t).queue;ef(t,_,n,gt,o===null?Sa:function(){return Xu(t),o(c)})}function id(t){var n=t.memoizedState;if(n!==null)return n;n={memoizedState:gt,baseState:gt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:gt},next:null};var o={};return n.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:o},next:null},t.memoizedState=n,t=t.alternate,t!==null&&(t.memoizedState=n),n}function Xu(t){var n=id(t);n.next===null&&(n=t.alternate.memoizedState),El(t,n.next.queue,{},or())}function su(){return s(kd)}function ou(){return Ba().memoizedState}function ad(){return Ba().memoizedState}function tf(t){for(var n=t.return;n!==null;){switch(n.tag){case 24:case 3:var o=or();t=Qa(o);var c=bn(n,t,o);c!==null&&(Hn(c,n,o),yr(c,n,o)),n={cache:A()},t.payload=n;return}n=n.return}}function Yu(t,n,o){var c=or();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Yc(t)?nd(n,o):(o=ot(t,n,o,c),o!==null&&(Hn(o,t,c),lu(o,n,c)))}function Hc(t,n,o){var c=or();El(t,n,o,c)}function El(t,n,o,c){var _={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Yc(t))nd(n,_);else{var b=t.alternate;if(t.lanes===0&&(b===null||b.lanes===0)&&(b=n.lastRenderedReducer,b!==null))try{var D=n.lastRenderedState,N=b(D,o);if(_.hasEagerState=!0,_.eagerState=N,rn(N,D))return ml(t,n,_,0),qi===null&&as(),!1}catch{}finally{}if(o=ot(t,n,_,c),o!==null)return Hn(o,t,c),lu(o,n,c),!0}return!1}function Xc(t,n,o,c){if(c={lane:2,revertLane:xc(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Yc(t)){if(n)throw Error(Q(479))}else n=ot(t,o,c,2),n!==null&&Hn(n,t,2)}function Yc(t){var n=t.alternate;return t===Nt||n!==null&&n===Nt}function nd(t,n){jo=da=!0;var o=t.pending;o===null?n.next=n:(n.next=o.next,o.next=n),t.pending=n}function lu(t,n,o){if((o&4194048)!==0){var c=n.lanes;c&=t.pendingLanes,o|=c,n.lanes=o,W(t,o)}}var Ku={readContext:s,use:wl,useCallback:wa,useContext:wa,useEffect:wa,useImperativeHandle:wa,useLayoutEffect:wa,useInsertionEffect:wa,useMemo:wa,useReducer:wa,useRef:wa,useState:wa,useDebugValue:wa,useDeferredValue:wa,useTransition:wa,useSyncExternalStore:wa,useId:wa,useHostTransitionStatus:wa,useFormState:wa,useActionState:wa,useOptimistic:wa,useMemoCache:wa,useCacheRefresh:wa};Ku.useEffectEvent=wa;var Kc={readContext:s,use:wl,useCallback:function(t,n){return Va().memoizedState=[t,n===void 0?null:n],t},useContext:s,useEffect:Wh,useImperativeHandle:function(t,n,o){o=o!=null?o.concat([t]):null,nu(4194308,4,Qd.bind(null,n,t),o)},useLayoutEffect:function(t,n){return nu(4194308,4,t,n)},useInsertionEffect:function(t,n){nu(4,2,t,n)},useMemo:function(t,n){var o=Va();n=n===void 0?null:n;var c=t();if(Vo){An(!0);try{t()}finally{An(!1)}}return o.memoizedState=[c,n],c},useReducer:function(t,n,o){var c=Va();if(o!==void 0){var _=o(n);if(Vo){An(!0);try{o(n)}finally{An(!1)}}}else _=n;return c.memoizedState=c.baseState=_,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:_},c.queue=t,t=t.dispatch=Yu.bind(null,Nt,t),[c.memoizedState,t]},useRef:function(t){var n=Va();return t={current:t},n.memoizedState=t},useState:function(t){t=Gc(t);var n=t.queue,o=Hc.bind(null,Nt,n);return n.dispatch=o,[t.memoizedState,o]},useDebugValue:ed,useDeferredValue:function(t,n){var o=Va();return td(o,t,n)},useTransition:function(){var t=Gc(!1);return t=ef.bind(null,Nt,t.queue,!0,!1),Va().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,n,o){var c=Nt,_=Va();if(li){if(o===void 0)throw Error(Q(407));o=o()}else{if(o=n(),qi===null)throw Error(Q(349));(gi&127)!==0||Xh(c,n,o)}_.memoizedState=o;var b={value:o,getSnapshot:n};return _.queue=b,Wh(jd.bind(null,c,b,t),[t]),c.flags|=2048,au(9,{destroy:void 0},tu.bind(null,c,b,o,n),null),o},useId:function(){var t=Va(),n=qi.identifierPrefix;if(li){var o=mr,c=pr;o=(c&~(1<<32-xa(c)-1)).toString(32)+o,n="_"+n+"R_"+o,o=ks++,0<o&&(n+="H"+o.toString(32)),n+="_"}else o=$h++,n="_"+n+"r_"+o.toString(32)+"_";return t.memoizedState=n},useHostTransitionStatus:su,useFormState:Qh,useActionState:Qh,useOptimistic:function(t){var n=Va();n.memoizedState=n.baseState=t;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=o,n=Xc.bind(null,Nt,!0,o),o.dispatch=n,[t,n]},useMemoCache:jc,useCacheRefresh:function(){return Va().memoizedState=tf.bind(null,Nt)},useEffectEvent:function(t){var n=Va(),o={impl:t};return n.memoizedState=o,function(){if((Ci&2)!==0)throw Error(Q(440));return o.impl.apply(void 0,arguments)}}},rd={readContext:s,use:wl,useCallback:Wd,useContext:s,useEffect:uo,useImperativeHandle:Jd,useInsertionEffect:Yd,useLayoutEffect:Kd,useMemo:$c,useReducer:Vc,useRef:Hd,useState:function(){return Vc(Ls)},useDebugValue:ed,useDeferredValue:function(t,n){var o=Ba();return Tl(o,Hi.memoizedState,t,n)},useTransition:function(){var t=Vc(Ls)[0],n=Ba().memoizedState;return[typeof t=="boolean"?t:Go(t),n]},useSyncExternalStore:qc,useId:ou,useHostTransitionStatus:su,useFormState:Zd,useActionState:Zd,useOptimistic:function(t,n){var o=Ba();return Yh(o,Hi,t,n)},useMemoCache:jc,useCacheRefresh:ad};rd.useEffectEvent=Xd;var Qc={readContext:s,use:wl,useCallback:Wd,useContext:s,useEffect:uo,useImperativeHandle:Jd,useInsertionEffect:Yd,useLayoutEffect:Kd,useMemo:$c,useReducer:Zo,useRef:Hd,useState:function(){return Zo(Ls)},useDebugValue:ed,useDeferredValue:function(t,n){var o=Ba();return Hi===null?td(o,t,n):Tl(o,Hi.memoizedState,t,n)},useTransition:function(){var t=Zo(Ls)[0],n=Ba().memoizedState;return[typeof t=="boolean"?t:Go(t),n]},useSyncExternalStore:qc,useId:ou,useHostTransitionStatus:su,useFormState:$d,useActionState:$d,useOptimistic:function(t,n){var o=Ba();return Hi!==null?Yh(o,Hi,t,n):(o.baseState=t,[t,o.queue.dispatch])},useMemoCache:jc,useCacheRefresh:ad};Qc.useEffectEvent=Xd;function Qu(t,n,o,c){n=t.memoizedState,o=o(c,n),o=o==null?n:Ue({},n,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var Ju={enqueueSetState:function(t,n,o){t=t._reactInternals;var c=or(),_=Qa(c);_.payload=n,o!=null&&(_.callback=o),n=bn(t,_,c),n!==null&&(Hn(n,t,c),yr(n,t,c))},enqueueReplaceState:function(t,n,o){t=t._reactInternals;var c=or(),_=Qa(c);_.tag=1,_.payload=n,o!=null&&(_.callback=o),n=bn(t,_,c),n!==null&&(Hn(n,t,c),yr(n,t,c))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var o=or(),c=Qa(o);c.tag=2,n!=null&&(c.callback=n),n=bn(t,c,o),n!==null&&(Hn(n,t,o),yr(n,t,o))}};function sd(t,n,o,c,_,b,D){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,b,D):n.prototype&&n.prototype.isPureReactComponent?!fr(o,c)||!fr(_,b):!0}function od(t,n,o,c){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,c),n.state!==t&&Ju.enqueueReplaceState(n,n.state,null)}function Al(t,n){var o=n;if("ref"in n){o={};for(var c in n)c!=="ref"&&(o[c]=n[c])}if(t=t.defaultProps){o===n&&(o=Ue({},o));for(var _ in t)o[_]===void 0&&(o[_]=t[_])}return o}function af(t){tr(t)}function nf(t){console.error(t)}function rf(t){tr(t)}function Jc(t,n){try{var o=t.onUncaughtError;o(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function co(t,n,o){try{var c=t.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function ld(t,n,o){return o=Qa(o),o.tag=3,o.payload={element:null},o.callback=function(){Jc(t,n)},o}function ud(t){return t=Qa(t),t.tag=3,t}function zl(t,n,o,c){var _=o.type.getDerivedStateFromError;if(typeof _=="function"){var b=c.value;t.payload=function(){return _(b)},t.callback=function(){co(n,o,c)}}var D=o.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(t.callback=function(){co(n,o,c),typeof _!="function"&&(Ps===null?Ps=new Set([this]):Ps.add(this));var N=c.stack;this.componentDidCatch(c.value,{componentStack:N!==null?N:""})})}function Wf(t,n,o,c,_){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=o.alternate,n!==null&&ri(n,o,_,!0),o=Rn.current,o!==null){switch(o.tag){case 31:case 13:return jn===null?hc():o.alternate===null&&Ta===0&&(Ta=3),o.flags&=-257,o.flags|=65536,o.lanes=_,c===He?o.flags|=16384:(n=o.updateQueue,n===null?o.updateQueue=new Set([c]):n.add(c),Za(t,c,_)),!1;case 22:return o.flags|=65536,c===He?o.flags|=16384:(n=o.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=n):(o=n.retryQueue,o===null?n.retryQueue=new Set([c]):o.add(c)),Za(t,c,_)),!1}throw Error(Q(435,o.tag))}return Za(t,c,_),hc(),!1}if(li)return n=Rn.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=_,c!==_l&&(t=Error(Q(422),{cause:c}),os(kn(t,o)))):(c!==_l&&(n=Error(Q(423),{cause:c}),os(kn(n,o))),t=t.current.alternate,t.flags|=65536,_&=-_,t.lanes|=_,c=kn(c,o),_=ld(t.stateNode,c,_),Cs(t,_),Ta!==4&&(Ta=2)),!1;var b=Error(Q(520),{cause:c});if(b=kn(b,o),uc===null?uc=[b]:uc.push(b),Ta!==4&&(Ta=2),n===null)return!0;c=kn(c,o),o=n;do{switch(o.tag){case 3:return o.flags|=65536,t=_&-_,o.lanes|=t,t=ld(o.stateNode,c,t),Cs(o,t),!1;case 1:if(n=o.type,b=o.stateNode,(o.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ps===null||!Ps.has(b))))return o.flags|=65536,_&=-_,o.lanes|=_,_=ud(_),zl(_,t,o,c),Cs(o,_),!1}o=o.return}while(o!==null);return!1}var cd=Error(Q(461)),qa=!1;function ln(t,n,o,c){n.child=t===null?ya(n,null,o,c):Ji(n,t.child,o,c)}function hd(t,n,o,c,_){o=o.render;var b=n.ref;if("ref"in c){var D={};for(var N in c)N!=="ref"&&(D[N]=c[N])}else D=c;return i(n),c=Pc(t,n,o,D,b,_),N=Gu(),t!==null&&!qa?(Fc(t,n,_),Rs(t,n,_)):(li&&N&&Ka(n),n.flags|=1,ln(t,n,c,_),n.child)}function sf(t,n,o,c,_){if(t===null){var b=o.type;return typeof b=="function"&&!Wl(b)&&b.defaultProps===void 0&&o.compare===null?(n.tag=15,n.type=b,of(t,n,b,c,_)):(t=Po(o.type,null,c,n,n.mode,_),t.ref=n.ref,t.return=n,n.child=t)}if(b=t.child,!rh(t,_)){var D=b.memoizedProps;if(o=o.compare,o=o!==null?o:fr,o(D,c)&&t.ref===n.ref)return Rs(t,n,_)}return n.flags|=1,t=rs(b,c),t.ref=n.ref,t.return=n,n.child=t}function of(t,n,o,c,_){if(t!==null){var b=t.memoizedProps;if(fr(b,c)&&t.ref===n.ref)if(qa=!1,n.pendingProps=c=b,rh(t,_))(t.flags&131072)!==0&&(qa=!0);else return n.lanes=t.lanes,Rs(t,n,_)}return ih(t,n,o,c,_)}function lf(t,n,o,c){var _=c.children,b=t!==null?t.memoizedState:null;if(t===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((n.flags&128)!==0){if(b=b!==null?b.baseLanes|o:o,t!==null){for(c=n.child=t.child,_=0;c!==null;)_=_|c.lanes|c.childLanes,c=c.sibling;c=_&~b}else c=0,n.child=null;return Wc(t,n,b,o,c)}if((o&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},t!==null&&_e(n,b!==null?b.cachePool:null),b!==null?ha(n,b):ls(),_r(n);else return c=n.lanes=536870912,Wc(t,n,b!==null?b.baseLanes|o:o,o,c)}else b!==null?(_e(n,b.cachePool),ha(n,b),Bn(),n.memoizedState=null):(t!==null&&_e(n,null),ls(),Bn());return ln(t,n,_,o),n.child}function Wu(t,n){return t!==null&&t.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Wc(t,n,o,c,_){var b=oe();return b=b===null?null:{parent:T._currentValue,pool:b},n.memoizedState={baseLanes:o,cachePool:b},t!==null&&_e(n,null),ls(),_r(n),t!==null&&ri(t,n,c,!0),n.childLanes=_,null}function $o(t,n){return n=nh({mode:n.mode,children:n.children},t.mode),n.ref=t.ref,t.child=n,n.return=t,n}function eh(t,n,o){return Ji(n,t.child,null,o),t=$o(n,n.pendingProps),t.flags|=2,_a(n),n.memoizedState=null,t}function ep(t,n,o){var c=n.pendingProps,_=(n.flags&128)!==0;if(n.flags&=-129,t===null){if(li){if(c.mode==="hidden")return t=$o(n,c),n.lanes=536870912,Wu(null,t);if(bl(n),(t=Ri)?(t=hn(t,wi),t=t!==null&&t.data==="&"?t:null,t!==null&&(n.memoizedState={dehydrated:t,treeContext:Lr!==null?{id:pr,overflow:mr}:null,retryLane:536870912,hydrationErrors:null},o=vn(t),o.return=n,n.child=o,mt=n,Ri=null)):t=null,t===null)throw ka(n);return n.lanes=536870912,null}return $o(n,c)}var b=t.memoizedState;if(b!==null){var D=b.dehydrated;if(bl(n),_)if(n.flags&256)n.flags&=-257,n=eh(t,n,o);else if(n.memoizedState!==null)n.child=t.child,n.flags|=128,n=null;else throw Error(Q(558));else if(qa||ri(t,n,o,!1),_=(o&t.childLanes)!==0,qa||_){if(c=qi,c!==null&&(D=le(c,o),D!==0&&D!==b.retryLane))throw b.retryLane=D,ns(t,D),Hn(c,t,D),cd;hc(),n=eh(t,n,o)}else t=b.treeContext,Ri=sa(D.nextSibling),mt=n,li=!0,Br=null,wi=!1,t!==null&&wt(n,t),n=$o(n,c),n.flags|=4096;return n}return t=rs(t.child,{mode:c.mode,children:c.children}),t.ref=n.ref,n.child=t,t.return=n,t}function th(t,n){var o=n.ref;if(o===null)t!==null&&t.ref!==null&&(n.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(Q(284));(t===null||t.ref!==o)&&(n.flags|=4194816)}}function ih(t,n,o,c,_){return i(n),o=Pc(t,n,o,c,void 0,_),c=Gu(),t!==null&&!qa?(Fc(t,n,_),Rs(t,n,_)):(li&&c&&Ka(n),n.flags|=1,ln(t,n,o,_),n.child)}function uf(t,n,o,c,_,b){return i(n),n.updateQueue=null,o=Nc(n,c,o,_),Ud(t),c=Gu(),t!==null&&!qa?(Fc(t,n,b),Rs(t,n,b)):(li&&c&&Ka(n),n.flags|=1,ln(t,n,o,b),n.child)}function cf(t,n,o,c,_){if(i(n),n.stateNode===null){var b=Es,D=o.contextType;typeof D=="object"&&D!==null&&(b=s(D)),b=new o(c,b),n.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=Ju,n.stateNode=b,b._reactInternals=n,b=n.stateNode,b.props=c,b.state=n.memoizedState,b.refs={},Fi(n),D=o.contextType,b.context=typeof D=="object"&&D!==null?s(D):Es,b.state=n.memoizedState,D=o.getDerivedStateFromProps,typeof D=="function"&&(Qu(n,o,D,c),b.state=n.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(D=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),D!==b.state&&Ju.enqueueReplaceState(b,b.state,null),La(n,c,b,_),ba(),b.state=n.memoizedState),typeof b.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(t===null){b=n.stateNode;var N=n.memoizedProps,te=Al(o,N);b.props=te;var be=b.context,ke=o.contextType;D=Es,typeof ke=="object"&&ke!==null&&(D=s(ke));var Ne=o.getDerivedStateFromProps;ke=typeof Ne=="function"||typeof b.getSnapshotBeforeUpdate=="function",N=n.pendingProps!==N,ke||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(N||be!==D)&&od(n,b,c,D),Da=!1;var we=n.memoizedState;b.state=we,La(n,c,b,_),ba(),be=n.memoizedState,N||we!==be||Da?(typeof Ne=="function"&&(Qu(n,o,Ne,c),be=n.memoizedState),(te=Da||sd(n,o,te,c,we,be,D))?(ke||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(n.flags|=4194308)):(typeof b.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=be),b.props=c,b.state=be,b.context=D,c=te):(typeof b.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{b=n.stateNode,ir(t,n),D=n.memoizedProps,ke=Al(o,D),b.props=ke,Ne=n.pendingProps,we=b.context,be=o.contextType,te=Es,typeof be=="object"&&be!==null&&(te=s(be)),N=o.getDerivedStateFromProps,(be=typeof N=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(D!==Ne||we!==te)&&od(n,b,c,te),Da=!1,we=n.memoizedState,b.state=we,La(n,c,b,_),ba();var Te=n.memoizedState;D!==Ne||we!==Te||Da||t!==null&&t.dependencies!==null&&p(t.dependencies)?(typeof N=="function"&&(Qu(n,o,N,c),Te=n.memoizedState),(ke=Da||sd(n,o,ke,c,we,Te,te)||t!==null&&t.dependencies!==null&&p(t.dependencies))?(be||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(c,Te,te),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(c,Te,te)),typeof b.componentDidUpdate=="function"&&(n.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof b.componentDidUpdate!="function"||D===t.memoizedProps&&we===t.memoizedState||(n.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||D===t.memoizedProps&&we===t.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=Te),b.props=c,b.state=Te,b.context=te,c=ke):(typeof b.componentDidUpdate!="function"||D===t.memoizedProps&&we===t.memoizedState||(n.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||D===t.memoizedProps&&we===t.memoizedState||(n.flags|=1024),c=!1)}return b=c,th(t,n),c=(n.flags&128)!==0,b||c?(b=n.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:b.render(),n.flags|=1,t!==null&&c?(n.child=Ji(n,t.child,null,_),n.child=Ji(n,null,o,_)):ln(t,n,o,_),n.memoizedState=b.state,t=n.child):t=Rs(t,n,_),t}function uu(t,n,o,c){return zi(),n.flags|=256,ln(t,n,o,c),n.child}var ah={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function dd(t){return{baseLanes:t,cachePool:xe()}}function fd(t,n,o){return t=t!==null?t.childLanes&~o:0,n&&(t|=On),t}function hf(t,n,o){var c=n.pendingProps,_=!1,b=(n.flags&128)!==0,D;if((D=b)||(D=t!==null&&t.memoizedState===null?!1:(Si.current&2)!==0),D&&(_=!0,n.flags&=-129),D=(n.flags&32)!==0,n.flags&=-33,t===null){if(li){if(_?Is(n):Bn(),(t=Ri)?(t=hn(t,wi),t=t!==null&&t.data!=="&"?t:null,t!==null&&(n.memoizedState={dehydrated:t,treeContext:Lr!==null?{id:pr,overflow:mr}:null,retryLane:536870912,hydrationErrors:null},o=vn(t),o.return=n,n.child=o,mt=n,Ri=null)):t=null,t===null)throw ka(n);return en(t)?n.lanes=32:n.lanes=536870912,null}var N=c.children;return c=c.fallback,_?(Bn(),_=n.mode,N=nh({mode:"hidden",children:N},_),c=ss(c,_,o,null),N.return=n,c.return=n,N.sibling=c,n.child=N,c=n.child,c.memoizedState=dd(o),c.childLanes=fd(t,D,o),n.memoizedState=ah,Wu(null,c)):(Is(n),pd(n,N))}var te=t.memoizedState;if(te!==null&&(N=te.dehydrated,N!==null)){if(b)n.flags&256?(Is(n),n.flags&=-257,n=md(t,n,o)):n.memoizedState!==null?(Bn(),n.child=t.child,n.flags|=128,n=null):(Bn(),N=c.fallback,_=n.mode,c=nh({mode:"visible",children:c.children},_),N=ss(N,_,o,null),N.flags|=2,c.return=n,N.return=n,c.sibling=N,n.child=c,Ji(n,t.child,null,o),c=n.child,c.memoizedState=dd(o),c.childLanes=fd(t,D,o),n.memoizedState=ah,n=Wu(null,c));else if(Is(n),en(N)){if(D=N.nextSibling&&N.nextSibling.dataset,D)var be=D.dgst;D=be,c=Error(Q(419)),c.stack="",c.digest=D,os({value:c,source:null,stack:null}),n=md(t,n,o)}else if(qa||ri(t,n,o,!1),D=(o&t.childLanes)!==0,qa||D){if(D=qi,D!==null&&(c=le(D,o),c!==0&&c!==te.retryLane))throw te.retryLane=c,ns(t,c),Hn(D,t,c),cd;dn(N)||hc(),n=md(t,n,o)}else dn(N)?(n.flags|=192,n.child=t.child,n=null):(t=te.treeContext,Ri=sa(N.nextSibling),mt=n,li=!0,Br=null,wi=!1,t!==null&&wt(n,t),n=pd(n,c.children),n.flags|=4096);return n}return _?(Bn(),N=c.fallback,_=n.mode,te=t.child,be=te.sibling,c=rs(te,{mode:"hidden",children:c.children}),c.subtreeFlags=te.subtreeFlags&65011712,be!==null?N=rs(be,N):(N=ss(N,_,o,null),N.flags|=2),N.return=n,c.return=n,c.sibling=N,n.child=c,Wu(null,c),c=n.child,N=t.child.memoizedState,N===null?N=dd(o):(_=N.cachePool,_!==null?(te=T._currentValue,_=_.parent!==te?{parent:te,pool:te}:_):_=xe(),N={baseLanes:N.baseLanes|o,cachePool:_}),c.memoizedState=N,c.childLanes=fd(t,D,o),n.memoizedState=ah,Wu(t.child,c)):(Is(n),o=t.child,t=o.sibling,o=rs(o,{mode:"visible",children:c.children}),o.return=n,o.sibling=null,t!==null&&(D=n.deletions,D===null?(n.deletions=[t],n.flags|=16):D.push(t)),n.child=o,n.memoizedState=null,o)}function pd(t,n){return n=nh({mode:"visible",children:n},t.mode),n.return=t,t.child=n}function nh(t,n){return t=In(22,t,null,n),t.lanes=0,t}function md(t,n,o){return Ji(n,t.child,null,o),t=pd(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function gd(t,n,o){t.lanes|=n;var c=t.alternate;c!==null&&(c.lanes|=n),vl(t.return,n,o)}function ec(t,n,o,c,_,b){var D=t.memoizedState;D===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:_,treeForkCount:b}:(D.isBackwards=n,D.rendering=null,D.renderingStartTime=0,D.last=c,D.tail=o,D.tailMode=_,D.treeForkCount=b)}function yd(t,n,o){var c=n.pendingProps,_=c.revealOrder,b=c.tail;c=c.children;var D=Si.current,N=(D&2)!==0;if(N?(D=D&1|2,n.flags|=128):D&=1,Ze(Si,D),ln(t,n,c,o),c=li?Ya:0,!N&&t!==null&&(t.flags&128)!==0)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&gd(t,o,n);else if(t.tag===19)gd(t,o,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(_){case"forwards":for(o=n.child,_=null;o!==null;)t=o.alternate,t!==null&&Vn(t)===null&&(_=o),o=o.sibling;o=_,o===null?(_=n.child,n.child=null):(_=o.sibling,o.sibling=null),ec(n,!1,_,o,b,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,_=n.child,n.child=null;_!==null;){if(t=_.alternate,t!==null&&Vn(t)===null){n.child=_;break}t=_.sibling,_.sibling=o,o=_,_=t}ec(n,!0,o,null,b,c);break;case"together":ec(n,!1,null,null,void 0,c);break;default:n.memoizedState=null}return n.child}function Rs(t,n,o){if(t!==null&&(n.dependencies=t.dependencies),go|=n.lanes,(o&n.childLanes)===0)if(t!==null){if(ri(t,n,o,!1),(o&n.childLanes)===0)return null}else return null;if(t!==null&&n.child!==t.child)throw Error(Q(153));if(n.child!==null){for(t=n.child,o=rs(t,t.pendingProps),n.child=o,o.return=n;t.sibling!==null;)t=t.sibling,o=o.sibling=rs(t,t.pendingProps),o.return=n;o.sibling=null}return n.child}function rh(t,n){return(t.lanes&n)!==0?!0:(t=t.dependencies,!!(t!==null&&p(t)))}function tp(t,n,o){switch(n.tag){case 3:Oi(n,n.stateNode.containerInfo),Or(n,T,t.memoizedState.cache),zi();break;case 27:case 5:Wi(n);break;case 4:Oi(n,n.stateNode.containerInfo);break;case 10:Or(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,bl(n),null;break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(Is(n),n.flags|=128,null):(o&n.child.childLanes)!==0?hf(t,n,o):(Is(n),t=Rs(t,n,o),t!==null?t.sibling:null);Is(n);break;case 19:var _=(t.flags&128)!==0;if(c=(o&n.childLanes)!==0,c||(ri(t,n,o,!1),c=(o&n.childLanes)!==0),_){if(c)return yd(t,n,o);n.flags|=128}if(_=n.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Ze(Si,Si.current),c)break;return null;case 22:return n.lanes=0,lf(t,n,o,n.pendingProps);case 24:Or(n,T,t.memoizedState.cache)}return Rs(t,n,o)}function tc(t,n,o){if(t!==null)if(t.memoizedProps!==n.pendingProps)qa=!0;else{if(!rh(t,o)&&(n.flags&128)===0)return qa=!1,tp(t,n,o);qa=(t.flags&131072)!==0}else qa=!1,li&&(n.flags&1048576)!==0&&Oc(n,Ya,n.index);switch(n.lanes=0,n.tag){case 16:e:{var c=n.pendingProps;if(t=Je(n.elementType),n.type=t,typeof t=="function")Wl(t)?(c=Al(t,c),n.tag=1,n=cf(null,n,t,c,o)):(n.tag=0,n=ih(null,n,t,c,o));else{if(t!=null){var _=t.$$typeof;if(_===St){n.tag=11,n=hd(null,n,t,c,o);break e}else if(_===Pe){n.tag=14,n=sf(null,n,t,c,o);break e}}throw n=Bi(t)||t,Error(Q(306,n,""))}}return n;case 0:return ih(t,n,n.type,n.pendingProps,o);case 1:return c=n.type,_=Al(c,n.pendingProps),cf(t,n,c,_,o);case 3:e:{if(Oi(n,n.stateNode.containerInfo),t===null)throw Error(Q(387));c=n.pendingProps;var b=n.memoizedState;_=b.element,ir(t,n),La(n,c,null,o);var D=n.memoizedState;if(c=D.cache,Or(n,T,c),c!==b.cache&&xl(n,[T],o,!0),ba(),c=D.element,b.isDehydrated)if(b={element:c,isDehydrated:!1,cache:D.cache},n.updateQueue.baseState=b,n.memoizedState=b,n.flags&256){n=uu(t,n,c,o);break e}else if(c!==_){_=kn(Error(Q(424)),n),os(_),n=uu(t,n,c,o);break e}else{switch(t=n.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Ri=sa(t.firstChild),mt=n,li=!0,Br=null,wi=!0,o=ya(n,null,c,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(zi(),c===_){n=Rs(t,n,o);break e}ln(t,n,c,o)}n=n.child}return n;case 26:return th(t,n),t===null?(o=Lf(n.type,null,n.pendingProps,null))?n.memoizedState=o:li||(o=n.type,t=n.pendingProps,c=We(Rt.current).createElement(o),c[st]=n,c[pt]=t,Xe(c,o,t),la(c),n.stateNode=c):n.memoizedState=Lf(n.type,t.memoizedProps,n.pendingProps,t.memoizedState),null;case 27:return Wi(n),t===null&&li&&(c=n.stateNode=tn(n.type,n.pendingProps,Rt.current),mt=n,wi=!0,_=Ri,ra(n.type)?(Ea=_,Ri=sa(c.firstChild)):Ri=_),ln(t,n,n.pendingProps.children,o),th(t,n),t===null&&(n.flags|=4194304),n.child;case 5:return t===null&&li&&((_=c=Ri)&&(c=Pa(c,n.type,n.pendingProps,wi),c!==null?(n.stateNode=c,mt=n,Ri=sa(c.firstChild),wi=!1,_=!0):_=!1),_||ka(n)),Wi(n),_=n.type,b=n.pendingProps,D=t!==null?t.memoizedProps:null,c=b.children,xt(_,b)?c=null:D!==null&&xt(_,D)&&(n.flags|=32),n.memoizedState!==null&&(_=Pc(t,n,Qf,null,null,o),kd._currentValue=_),th(t,n),ln(t,n,c,o),n.child;case 6:return t===null&&li&&((t=o=Ri)&&(o=Na(o,n.pendingProps,wi),o!==null?(n.stateNode=o,mt=n,Ri=null,t=!0):t=!1),t||ka(n)),null;case 13:return hf(t,n,o);case 4:return Oi(n,n.stateNode.containerInfo),c=n.pendingProps,t===null?n.child=Ji(n,null,c,o):ln(t,n,c,o),n.child;case 11:return hd(t,n,n.type,n.pendingProps,o);case 7:return ln(t,n,n.pendingProps,o),n.child;case 8:return ln(t,n,n.pendingProps.children,o),n.child;case 12:return ln(t,n,n.pendingProps.children,o),n.child;case 10:return c=n.pendingProps,Or(n,n.type,c.value),ln(t,n,c.children,o),n.child;case 9:return _=n.type._context,c=n.pendingProps.children,i(n),_=s(_),c=c(_),n.flags|=1,ln(t,n,c,o),n.child;case 14:return sf(t,n,n.type,n.pendingProps,o);case 15:return of(t,n,n.type,n.pendingProps,o);case 19:return yd(t,n,o);case 31:return ep(t,n,o);case 22:return lf(t,n,o,n.pendingProps);case 24:return i(n),c=s(T),t===null?(_=oe(),_===null&&(_=qi,b=A(),_.pooledCache=b,b.refCount++,b!==null&&(_.pooledCacheLanes|=o),_=b),n.memoizedState={parent:c,cache:_},Fi(n),Or(n,T,_)):((t.lanes&o)!==0&&(ir(t,n),La(n,null,null,o),ba()),_=t.memoizedState,b=n.memoizedState,_.parent!==c?(_={parent:c,cache:c},n.memoizedState=_,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=_),Or(n,T,c)):(c=b.cache,Or(n,T,c),c!==_.cache&&xl(n,[T],o,!0))),ln(t,n,n.pendingProps.children,o),n.child;case 29:throw n.pendingProps}throw Error(Q(156,n.tag))}function ho(t){t.flags|=4}function sh(t,n,o,c,_){if((n=(t.mode&32)!==0)&&(n=!1),n){if(t.flags|=16777216,(_&335544128)===_)if(t.stateNode.complete)t.flags|=8192;else if(bf())t.flags|=8192;else throw Tt=He,je}else t.flags&=-16777217}function df(t,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!hr(n))if(bf())t.flags|=8192;else throw Tt=He,je}function oh(t,n){n!==null&&(t.flags|=4),t.flags&16384&&(n=t.tag!==22?F():536870912,t.lanes|=n,Dl|=n)}function ic(t,n){if(!li)switch(t.tailMode){case"hidden":n=t.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function aa(t){var n=t.alternate!==null&&t.alternate.child===t.child,o=0,c=0;if(n)for(var _=t.child;_!==null;)o|=_.lanes|_.childLanes,c|=_.subtreeFlags&65011712,c|=_.flags&65011712,_.return=t,_=_.sibling;else for(_=t.child;_!==null;)o|=_.lanes|_.childLanes,c|=_.subtreeFlags,c|=_.flags,_.return=t,_=_.sibling;return t.subtreeFlags|=c,t.childLanes=o,n}function ip(t,n,o){var c=n.pendingProps;switch(Fo(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return aa(n),null;case 1:return aa(n),null;case 3:return o=n.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),Ln(T),ii(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(Ni(n)?ho(n):t===null||t.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Ms())),aa(n),null;case 26:var _=n.type,b=n.memoizedState;return t===null?(ho(n),b!==null?(aa(n),df(n,b)):(aa(n),sh(n,_,null,c,o))):b?b!==t.memoizedState?(ho(n),aa(n),df(n,b)):(aa(n),n.flags&=-16777217):(t=t.memoizedProps,t!==c&&ho(n),aa(n),sh(n,_,t,c,o)),null;case 27:if(pn(n),o=Rt.current,_=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&ho(n);else{if(!c){if(n.stateNode===null)throw Error(Q(166));return aa(n),null}t=ht.current,Ni(n)?qu(n):(t=tn(_,c,o),n.stateNode=t,ho(n))}return aa(n),null;case 5:if(pn(n),_=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&ho(n);else{if(!c){if(n.stateNode===null)throw Error(Q(166));return aa(n),null}if(b=ht.current,Ni(n))qu(n);else{var D=We(Rt.current);switch(b){case 1:b=D.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:b=D.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":b=D.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":b=D.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":b=D.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof c.is=="string"?D.createElement("select",{is:c.is}):D.createElement("select"),c.multiple?b.multiple=!0:c.size&&(b.size=c.size);break;default:b=typeof c.is=="string"?D.createElement(_,{is:c.is}):D.createElement(_)}}b[st]=n,b[pt]=c;e:for(D=n.child;D!==null;){if(D.tag===5||D.tag===6)b.appendChild(D.stateNode);else if(D.tag!==4&&D.tag!==27&&D.child!==null){D.child.return=D,D=D.child;continue}if(D===n)break e;for(;D.sibling===null;){if(D.return===null||D.return===n)break e;D=D.return}D.sibling.return=D.return,D=D.sibling}n.stateNode=b;e:switch(Xe(b,_,c),_){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ho(n)}}return aa(n),sh(n,n.type,t===null?null:t.memoizedProps,n.pendingProps,o),null;case 6:if(t&&n.stateNode!=null)t.memoizedProps!==c&&ho(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(Q(166));if(t=Rt.current,Ni(n)){if(t=n.stateNode,o=n.memoizedProps,c=null,_=mt,_!==null)switch(_.tag){case 27:case 5:c=_.memoizedProps}t[st]=n,t=!!(t.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||he(t.nodeValue,o)),t||ka(n,!0)}else t=We(t).createTextNode(c),t[st]=n,n.stateNode=t}return aa(n),null;case 31:if(o=n.memoizedState,t===null||t.memoizedState!==null){if(c=Ni(n),o!==null){if(t===null){if(!c)throw Error(Q(318));if(t=n.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(557));t[st]=n}else zi(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;aa(n),t=!1}else o=Ms(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=o),t=!0;if(!t)return n.flags&256?(_a(n),n):(_a(n),null);if((n.flags&128)!==0)throw Error(Q(558))}return aa(n),null;case 13:if(c=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(_=Ni(n),c!==null&&c.dehydrated!==null){if(t===null){if(!_)throw Error(Q(318));if(_=n.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(Q(317));_[st]=n}else zi(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;aa(n),_=!1}else _=Ms(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=_),_=!0;if(!_)return n.flags&256?(_a(n),n):(_a(n),null)}return _a(n),(n.flags&128)!==0?(n.lanes=o,n):(o=c!==null,t=t!==null&&t.memoizedState!==null,o&&(c=n.child,_=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(_=c.alternate.memoizedState.cachePool.pool),b=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(b=c.memoizedState.cachePool.pool),b!==_&&(c.flags|=2048)),o!==t&&o&&(n.child.flags|=8192),oh(n,n.updateQueue),aa(n),null);case 4:return ii(),t===null&&z(n.stateNode.containerInfo),aa(n),null;case 10:return Ln(n.type),aa(n),null;case 19:if(Ie(Si),c=n.memoizedState,c===null)return aa(n),null;if(_=(n.flags&128)!==0,b=c.rendering,b===null)if(_)ic(c,!1);else{if(Ta!==0||t!==null&&(t.flags&128)!==0)for(t=n.child;t!==null;){if(b=Vn(t),b!==null){for(n.flags|=128,ic(c,!1),t=b.updateQueue,n.updateQueue=t,oh(n,t),n.subtreeFlags=0,t=o,o=n.child;o!==null;)eu(o,t),o=o.sibling;return Ze(Si,Si.current&1|2),li&&Rr(n,c.treeForkCount),n.child}t=t.sibling}c.tail!==null&&$t()>_h&&(n.flags|=128,_=!0,ic(c,!1),n.lanes=4194304)}else{if(!_)if(t=Vn(b),t!==null){if(n.flags|=128,_=!0,t=t.updateQueue,n.updateQueue=t,oh(n,t),ic(c,!0),c.tail===null&&c.tailMode==="hidden"&&!b.alternate&&!li)return aa(n),null}else 2*$t()-c.renderingStartTime>_h&&o!==536870912&&(n.flags|=128,_=!0,ic(c,!1),n.lanes=4194304);c.isBackwards?(b.sibling=n.child,n.child=b):(t=c.last,t!==null?t.sibling=b:n.child=b,c.last=b)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=$t(),t.sibling=null,o=Si.current,Ze(Si,_?o&1|2:o&1),li&&Rr(n,c.treeForkCount),t):(aa(n),null);case 22:case 23:return _a(n),Uo(),c=n.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(o&536870912)!==0&&(n.flags&128)===0&&(aa(n),n.subtreeFlags&6&&(n.flags|=8192)):aa(n),o=n.updateQueue,o!==null&&oh(n,o.retryQueue),o=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==o&&(n.flags|=2048),t!==null&&Ie(K),null;case 24:return o=null,t!==null&&(o=t.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),Ln(T),aa(n),null;case 25:return null;case 30:return null}throw Error(Q(156,n.tag))}function ap(t,n){switch(Fo(n),n.tag){case 1:return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Ln(T),ii(),t=n.flags,(t&65536)!==0&&(t&128)===0?(n.flags=t&-65537|128,n):null;case 26:case 27:case 5:return pn(n),null;case 31:if(n.memoizedState!==null){if(_a(n),n.alternate===null)throw Error(Q(340));zi()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 13:if(_a(n),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(Q(340));zi()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return Ie(Si),null;case 4:return ii(),null;case 10:return Ln(n.type),null;case 22:case 23:return _a(n),Uo(),t!==null&&Ie(K),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 24:return Ln(T),null;case 25:return null;default:return null}}function cu(t,n){switch(Fo(n),n.tag){case 3:Ln(T),ii();break;case 26:case 27:case 5:pn(n);break;case 4:ii();break;case 31:n.memoizedState!==null&&_a(n);break;case 13:_a(n);break;case 19:Ie(Si);break;case 10:Ln(n.type);break;case 22:case 23:_a(n),Uo(),t!==null&&Ie(K);break;case 24:Ln(T)}}function fa(t,n){try{var o=n.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var _=c.next;o=_;do{if((o.tag&t)===t){c=void 0;var b=o.create,D=o.inst;c=b(),D.destroy=c}o=o.next}while(o!==_)}}catch(N){Ti(n,n.return,N)}}function fo(t,n,o){try{var c=n.updateQueue,_=c!==null?c.lastEffect:null;if(_!==null){var b=_.next;c=b;do{if((c.tag&t)===t){var D=c.inst,N=D.destroy;if(N!==void 0){D.destroy=void 0,_=n;var te=o,be=N;try{be()}catch(ke){Ti(_,te,ke)}}}c=c.next}while(c!==b)}}catch(ke){Ti(n,n.return,ke)}}function _d(t){var n=t.updateQueue;if(n!==null){var o=t.stateNode;try{ca(n,o)}catch(c){Ti(t,t.return,c)}}}function vd(t,n,o){o.props=Al(t.type,t.memoizedProps),o.state=t.memoizedState;try{o.componentWillUnmount()}catch(c){Ti(t,n,c)}}function vi(t,n){try{var o=t.ref;if(o!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof o=="function"?t.refCleanup=o(c):o.current=c}}catch(_){Ti(t,n,_)}}function Pr(t,n){var o=t.ref,c=t.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(_){Ti(t,n,_)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(_){Ti(t,n,_)}else o.current=null}function xd(t){var n=t.type,o=t.memoizedProps,c=t.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(_){Ti(t,t.return,_)}}function lh(t,n,o){try{var c=t.stateNode;vt(c,t.type,o,n),c[pt]=n}catch(_){Ti(t,t.return,_)}}function Bs(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&ra(t.type)||t.tag===4}function Ho(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Bs(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&ra(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function uh(t,n,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(t,n):(n=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,n.appendChild(t),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=Mr));else if(c!==4&&(c===27&&ra(t.type)&&(o=t.stateNode,n=null),t=t.child,t!==null))for(uh(t,n,o),t=t.sibling;t!==null;)uh(t,n,o),t=t.sibling}function ch(t,n,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?o.insertBefore(t,n):o.appendChild(t);else if(c!==4&&(c===27&&ra(t.type)&&(o=t.stateNode),t=t.child,t!==null))for(ch(t,n,o),t=t.sibling;t!==null;)ch(t,n,o),t=t.sibling}function ff(t){var n=t.stateNode,o=t.memoizedProps;try{for(var c=t.type,_=n.attributes;_.length;)n.removeAttributeNode(_[0]);Xe(n,c,o),n[st]=t,n[pt]=o}catch(b){Ti(t,t.return,b)}}var po=!1,Ga=!1,bd=!1,pf=typeof WeakSet=="function"?WeakSet:Set,un=null;function np(t,n){if(t=t.containerInfo,Ke=Uf,t=ju(t),Xl(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var _=c.anchorOffset,b=c.focusNode;c=c.focusOffset;try{o.nodeType,b.nodeType}catch{o=null;break e}var D=0,N=-1,te=-1,be=0,ke=0,Ne=t,we=null;t:for(;;){for(var Te;Ne!==o||_!==0&&Ne.nodeType!==3||(N=D+_),Ne!==b||c!==0&&Ne.nodeType!==3||(te=D+c),Ne.nodeType===3&&(D+=Ne.nodeValue.length),(Te=Ne.firstChild)!==null;)we=Ne,Ne=Te;for(;;){if(Ne===t)break t;if(we===o&&++be===_&&(N=D),we===b&&++ke===c&&(te=D),(Te=Ne.nextSibling)!==null)break;Ne=we,we=Ne.parentNode}Ne=Te}o=N===-1||te===-1?null:{start:N,end:te}}else o=null}o=o||{start:0,end:0}}else o=null;for(dt={focusedElem:t,selectionRange:o},Uf=!1,un=n;un!==null;)if(n=un,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,un=t;else for(;un!==null;){switch(n=un,b=n.alternate,t=n.flags,n.tag){case 0:if((t&4)!==0&&(t=n.updateQueue,t=t!==null?t.events:null,t!==null))for(o=0;o<t.length;o++)_=t[o],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&b!==null){t=void 0,o=n,_=b.memoizedProps,b=b.memoizedState,c=o.stateNode;try{var Ct=Al(o.type,_);t=c.getSnapshotBeforeUpdate(Ct,b),c.__reactInternalSnapshotBeforeUpdate=t}catch(Zt){Ti(o,o.return,Zt)}}break;case 3:if((t&1024)!==0){if(t=n.stateNode.containerInfo,o=t.nodeType,o===9)cn(t);else if(o===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":cn(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(Q(163))}if(t=n.sibling,t!==null){t.return=n.return,un=t;break}un=n.return}}function mf(t,n,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:xr(t,o),c&4&&fa(5,o);break;case 1:if(xr(t,o),c&4)if(t=o.stateNode,n===null)try{t.componentDidMount()}catch(D){Ti(o,o.return,D)}else{var _=Al(o.type,n.memoizedProps);n=n.memoizedState;try{t.componentDidUpdate(_,n,t.__reactInternalSnapshotBeforeUpdate)}catch(D){Ti(o,o.return,D)}}c&64&&_d(o),c&512&&vi(o,o.return);break;case 3:if(xr(t,o),c&64&&(t=o.updateQueue,t!==null)){if(n=null,o.child!==null)switch(o.child.tag){case 27:case 5:n=o.child.stateNode;break;case 1:n=o.child.stateNode}try{ca(t,n)}catch(D){Ti(o,o.return,D)}}break;case 27:n===null&&c&4&&ff(o);case 26:case 5:xr(t,o),n===null&&c&4&&xd(o),c&512&&vi(o,o.return);break;case 12:xr(t,o);break;case 31:xr(t,o),c&4&&gf(t,o);break;case 13:xr(t,o),c&4&&yf(t,o),c&64&&(t=o.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(o=Mf.bind(null,o),Yn(t,o))));break;case 22:if(c=o.memoizedState!==null||po,!c){n=n!==null&&n.memoizedState!==null||Ga,_=po;var b=Ga;po=c,(Ga=n)&&!b?nr(t,o,(o.subtreeFlags&8772)!==0):xr(t,o),po=_,Ga=b}break;case 30:break;default:xr(t,o)}}function ac(t){var n=t.alternate;n!==null&&(t.alternate=null,ac(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&ki(n)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Vi=null,qn=!1;function cs(t,n,o){for(o=o.child;o!==null;)hh(t,n,o),o=o.sibling}function hh(t,n,o){if(di&&typeof di.onCommitFiberUnmount=="function")try{di.onCommitFiberUnmount(En,o)}catch{}switch(o.tag){case 26:Ga||Pr(o,n),cs(t,n,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Ga||Pr(o,n);var c=Vi,_=qn;ra(o.type)&&(Vi=o.stateNode,qn=!1),cs(t,n,o),ma(o.stateNode),Vi=c,qn=_;break;case 5:Ga||Pr(o,n);case 6:if(c=Vi,_=qn,Vi=null,cs(t,n,o),Vi=c,qn=_,Vi!==null)if(qn)try{(Vi.nodeType===9?Vi.body:Vi.nodeName==="HTML"?Vi.ownerDocument.body:Vi).removeChild(o.stateNode)}catch(b){Ti(o,n,b)}else try{Vi.removeChild(o.stateNode)}catch(b){Ti(o,n,b)}break;case 18:Vi!==null&&(qn?(t=Vi,Wa(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,o.stateNode),Ph(t)):Wa(Vi,o.stateNode));break;case 4:c=Vi,_=qn,Vi=o.stateNode.containerInfo,qn=!0,cs(t,n,o),Vi=c,qn=_;break;case 0:case 11:case 14:case 15:fo(2,o,n),Ga||fo(4,o,n),cs(t,n,o);break;case 1:Ga||(Pr(o,n),c=o.stateNode,typeof c.componentWillUnmount=="function"&&vd(o,n,c)),cs(t,n,o);break;case 21:cs(t,n,o);break;case 22:Ga=(c=Ga)||o.memoizedState!==null,cs(t,n,o),Ga=c;break;default:cs(t,n,o)}}function gf(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Ph(t)}catch(o){Ti(n,n.return,o)}}}function yf(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Ph(t)}catch(o){Ti(n,n.return,o)}}function rp(t){switch(t.tag){case 31:case 13:case 19:var n=t.stateNode;return n===null&&(n=t.stateNode=new pf),n;case 22:return t=t.stateNode,n=t._retryCache,n===null&&(n=t._retryCache=new pf),n;default:throw Error(Q(435,t.tag))}}function nc(t,n){var o=rp(t);n.forEach(function(c){if(!o.has(c)){o.add(c);var _=Cf.bind(null,t,c);c.then(_,_)}})}function Gn(t,n){var o=n.deletions;if(o!==null)for(var c=0;c<o.length;c++){var _=o[c],b=t,D=n,N=D;e:for(;N!==null;){switch(N.tag){case 27:if(ra(N.type)){Vi=N.stateNode,qn=!1;break e}break;case 5:Vi=N.stateNode,qn=!1;break e;case 3:case 4:Vi=N.stateNode.containerInfo,qn=!0;break e}N=N.return}if(Vi===null)throw Error(Q(160));hh(b,D,_),Vi=null,qn=!1,b=_.alternate,b!==null&&(b.return=null),_.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)dh(n,t),n=n.sibling}var pa=null;function dh(t,n){var o=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Gn(n,t),Zn(t),c&4&&(fo(3,t,t.return),fa(3,t),fo(5,t,t.return));break;case 1:Gn(n,t),Zn(t),c&512&&(Ga||o===null||Pr(o,o.return)),c&64&&po&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(o=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var _=pa;if(Gn(n,t),Zn(t),c&512&&(Ga||o===null||Pr(o,o.return)),c&4){var b=o!==null?o.memoizedState:null;if(c=t.memoizedState,o===null)if(c===null)if(t.stateNode===null){e:{c=t.type,o=t.memoizedProps,_=_.ownerDocument||_;t:switch(c){case"title":b=_.getElementsByTagName("title")[0],(!b||b[za]||b[st]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=_.createElement(c),_.head.insertBefore(b,_.querySelector("head > title"))),Xe(b,c,o),b[st]=t,la(b),c=b;break e;case"link":var D=Of("link","href",_).get(c+(o.href||""));if(D){for(var N=0;N<D.length;N++)if(b=D[N],b.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&b.getAttribute("rel")===(o.rel==null?null:o.rel)&&b.getAttribute("title")===(o.title==null?null:o.title)&&b.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){D.splice(N,1);break t}}b=_.createElement(c),Xe(b,c,o),_.head.appendChild(b);break;case"meta":if(D=Of("meta","content",_).get(c+(o.content||""))){for(N=0;N<D.length;N++)if(b=D[N],b.getAttribute("content")===(o.content==null?null:""+o.content)&&b.getAttribute("name")===(o.name==null?null:o.name)&&b.getAttribute("property")===(o.property==null?null:o.property)&&b.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&b.getAttribute("charset")===(o.charSet==null?null:o.charSet)){D.splice(N,1);break t}}b=_.createElement(c),Xe(b,c,o),_.head.appendChild(b);break;default:throw Error(Q(468,c))}b[st]=t,la(b),c=b}t.stateNode=c}else Pf(_,t.type,t.stateNode);else t.stateNode=Bf(_,c,t.memoizedProps);else b!==c?(b===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):b.count--,c===null?Pf(_,t.type,t.stateNode):Bf(_,c,t.memoizedProps)):c===null&&t.stateNode!==null&&lh(t,t.memoizedProps,o.memoizedProps)}break;case 27:Gn(n,t),Zn(t),c&512&&(Ga||o===null||Pr(o,o.return)),o!==null&&c&4&&lh(t,t.memoizedProps,o.memoizedProps);break;case 5:if(Gn(n,t),Zn(t),c&512&&(Ga||o===null||Pr(o,o.return)),t.flags&32){_=t.stateNode;try{ys(_,"")}catch(Ct){Ti(t,t.return,Ct)}}c&4&&t.stateNode!=null&&(_=t.memoizedProps,lh(t,_,o!==null?o.memoizedProps:_)),c&1024&&(bd=!0);break;case 6:if(Gn(n,t),Zn(t),c&4){if(t.stateNode===null)throw Error(Q(162));c=t.memoizedProps,o=t.stateNode;try{o.nodeValue=c}catch(Ct){Ti(t,t.return,Ct)}}break;case 3:if(Oh=null,_=pa,pa=ur(n.containerInfo),Gn(n,t),pa=_,Zn(t),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Ph(n.containerInfo)}catch(Ct){Ti(t,t.return,Ct)}bd&&(bd=!1,mo(t));break;case 4:c=pa,pa=ur(t.stateNode.containerInfo),Gn(n,t),Zn(t),pa=c;break;case 12:Gn(n,t),Zn(t);break;case 31:Gn(n,t),Zn(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,nc(t,c)));break;case 13:Gn(n,t),Zn(t),t.child.flags&8192&&t.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(yh=$t()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,nc(t,c)));break;case 22:_=t.memoizedState!==null;var te=o!==null&&o.memoizedState!==null,be=po,ke=Ga;if(po=be||_,Ga=ke||te,Gn(n,t),Ga=ke,po=be,Zn(t),c&8192)e:for(n=t.stateNode,n._visibility=_?n._visibility&-2:n._visibility|1,_&&(o===null||te||po||Ga||hs(t)),o=null,n=t;;){if(n.tag===5||n.tag===26){if(o===null){te=o=n;try{if(b=te.stateNode,_)D=b.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{N=te.stateNode;var Ne=te.memoizedProps.style,we=Ne!=null&&Ne.hasOwnProperty("display")?Ne.display:null;N.style.display=we==null||typeof we=="boolean"?"":(""+we).trim()}}catch(Ct){Ti(te,te.return,Ct)}}}else if(n.tag===6){if(o===null){te=n;try{te.stateNode.nodeValue=_?"":te.memoizedProps}catch(Ct){Ti(te,te.return,Ct)}}}else if(n.tag===18){if(o===null){te=n;try{var Te=te.stateNode;_?wn(Te,!0):wn(te.stateNode,!1)}catch(Ct){Ti(te,te.return,Ct)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===t)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;n.sibling===null;){if(n.return===null||n.return===t)break e;o===n&&(o=null),n=n.return}o===n&&(o=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=t.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,nc(t,o))));break;case 19:Gn(n,t),Zn(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,nc(t,c)));break;case 30:break;case 21:break;default:Gn(n,t),Zn(t)}}function Zn(t){var n=t.flags;if(n&2){try{for(var o,c=t.return;c!==null;){if(Bs(c)){o=c;break}c=c.return}if(o==null)throw Error(Q(160));switch(o.tag){case 27:var _=o.stateNode,b=Ho(t);ch(t,b,_);break;case 5:var D=o.stateNode;o.flags&32&&(ys(D,""),o.flags&=-33);var N=Ho(t);ch(t,N,D);break;case 3:case 4:var te=o.stateNode.containerInfo,be=Ho(t);uh(t,be,te);break;default:throw Error(Q(161))}}catch(ke){Ti(t,t.return,ke)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function mo(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var n=t;mo(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),t=t.sibling}}function xr(t,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)mf(t,n.alternate,n),n=n.sibling}function hs(t){for(t=t.child;t!==null;){var n=t;switch(n.tag){case 0:case 11:case 14:case 15:fo(4,n,n.return),hs(n);break;case 1:Pr(n,n.return);var o=n.stateNode;typeof o.componentWillUnmount=="function"&&vd(n,n.return,o),hs(n);break;case 27:ma(n.stateNode);case 26:case 5:Pr(n,n.return),hs(n);break;case 22:n.memoizedState===null&&hs(n);break;case 30:hs(n);break;default:hs(n)}t=t.sibling}}function nr(t,n,o){for(o=o&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,_=t,b=n,D=b.flags;switch(b.tag){case 0:case 11:case 15:nr(_,b,o),fa(4,b);break;case 1:if(nr(_,b,o),c=b,_=c.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(be){Ti(c,c.return,be)}if(c=b,_=c.updateQueue,_!==null){var N=c.stateNode;try{var te=_.shared.hiddenCallbacks;if(te!==null)for(_.shared.hiddenCallbacks=null,_=0;_<te.length;_++)Ds(te[_],N)}catch(be){Ti(c,c.return,be)}}o&&D&64&&_d(b),vi(b,b.return);break;case 27:ff(b);case 26:case 5:nr(_,b,o),o&&c===null&&D&4&&xd(b),vi(b,b.return);break;case 12:nr(_,b,o);break;case 31:nr(_,b,o),o&&D&4&&gf(_,b);break;case 13:nr(_,b,o),o&&D&4&&yf(_,b);break;case 22:b.memoizedState===null&&nr(_,b,o),vi(b,b.return);break;case 30:break;default:nr(_,b,o)}n=n.sibling}}function hu(t,n){var o=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),t=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),t!==o&&(t!=null&&t.refCount++,o!=null&&M(o))}function du(t,n){t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&M(t))}function ds(t,n,o,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)wd(t,n,o,c),n=n.sibling}function wd(t,n,o,c){var _=n.flags;switch(n.tag){case 0:case 11:case 15:ds(t,n,o,c),_&2048&&fa(9,n);break;case 1:ds(t,n,o,c);break;case 3:ds(t,n,o,c),_&2048&&(t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&M(t)));break;case 12:if(_&2048){ds(t,n,o,c),t=n.stateNode;try{var b=n.memoizedProps,D=b.id,N=b.onPostCommit;typeof N=="function"&&N(D,n.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(te){Ti(n,n.return,te)}}else ds(t,n,o,c);break;case 31:ds(t,n,o,c);break;case 13:ds(t,n,o,c);break;case 23:break;case 22:b=n.stateNode,D=n.alternate,n.memoizedState!==null?b._visibility&2?ds(t,n,o,c):rc(t,n):b._visibility&2?ds(t,n,o,c):(b._visibility|=2,Ml(t,n,o,c,(n.subtreeFlags&10256)!==0||!1)),_&2048&&hu(D,n);break;case 24:ds(t,n,o,c),_&2048&&du(n.alternate,n);break;default:ds(t,n,o,c)}}function Ml(t,n,o,c,_){for(_=_&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var b=t,D=n,N=o,te=c,be=D.flags;switch(D.tag){case 0:case 11:case 15:Ml(b,D,N,te,_),fa(8,D);break;case 23:break;case 22:var ke=D.stateNode;D.memoizedState!==null?ke._visibility&2?Ml(b,D,N,te,_):rc(b,D):(ke._visibility|=2,Ml(b,D,N,te,_)),_&&be&2048&&hu(D.alternate,D);break;case 24:Ml(b,D,N,te,_),_&&be&2048&&du(D.alternate,D);break;default:Ml(b,D,N,te,_)}n=n.sibling}}function rc(t,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var o=t,c=n,_=c.flags;switch(c.tag){case 22:rc(o,c),_&2048&&hu(c.alternate,c);break;case 24:rc(o,c),_&2048&&du(c.alternate,c);break;default:rc(o,c)}n=n.sibling}}var fu=8192;function Cl(t,n,o){if(t.subtreeFlags&fu)for(t=t.child;t!==null;)fh(t,n,o),t=t.sibling}function fh(t,n,o){switch(t.tag){case 26:Cl(t,n,o),t.flags&fu&&t.memoizedState!==null&&Bl(o,pa,t.memoizedState,t.memoizedProps);break;case 5:Cl(t,n,o);break;case 3:case 4:var c=pa;pa=ur(t.stateNode.containerInfo),Cl(t,n,o),pa=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=fu,fu=16777216,Cl(t,n,o),fu=c):Cl(t,n,o));break;default:Cl(t,n,o)}}function ph(t){var n=t.alternate;if(n!==null&&(t=n.child,t!==null)){n.child=null;do n=t.sibling,t.sibling=null,t=n;while(t!==null)}}function sc(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var o=0;o<n.length;o++){var c=n[o];un=c,pu(c,t)}ph(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)_f(t),t=t.sibling}function _f(t){switch(t.tag){case 0:case 11:case 15:sc(t),t.flags&2048&&fo(9,t,t.return);break;case 3:sc(t);break;case 12:sc(t);break;case 22:var n=t.stateNode;t.memoizedState!==null&&n._visibility&2&&(t.return===null||t.return.tag!==13)?(n._visibility&=-3,oc(t)):sc(t);break;default:sc(t)}}function oc(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var o=0;o<n.length;o++){var c=n[o];un=c,pu(c,t)}ph(t)}for(t=t.child;t!==null;){switch(n=t,n.tag){case 0:case 11:case 15:fo(8,n,n.return),oc(n);break;case 22:o=n.stateNode,o._visibility&2&&(o._visibility&=-3,oc(n));break;default:oc(n)}t=t.sibling}}function pu(t,n){for(;un!==null;){var o=un;switch(o.tag){case 0:case 11:case 15:fo(8,o,n);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:M(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,un=c;else e:for(o=t;un!==null;){c=un;var _=c.sibling,b=c.return;if(ac(c),c===o){un=null;break e}if(_!==null){_.return=b,un=_;break e}un=b}}}var Os={getCacheForType:function(t){var n=s(T),o=n.data.get(t);return o===void 0&&(o=t(),n.data.set(t,o)),o},cacheSignal:function(){return s(T).controller.signal}},Xo=typeof WeakMap=="function"?WeakMap:Map,Ci=0,qi=null,fi=null,gi=0,Di=0,$n=null,Yo=!1,Ko=!1,lc=!1,rr=0,Ta=0,go=0,yo=0,mh=0,On=0,Dl=0,uc=null,sr=null,gh=!1,yh=0,vf=0,_h=1/0,vh=null,Ps=null,na=0,_o=null,Il=null,Ns=0,xh=0,bh=null,Sd=null,kl=0,mu=null;function or(){return(Ci&2)!==0&&gi!==0?gi&-gi:Se.T!==null?xc():Le()}function wh(){if(On===0)if((gi&536870912)===0||li){var t=Nn;Nn<<=1,(Nn&3932160)===0&&(Nn=262144),On=t}else On=536870912;return t=Rn.current,t!==null&&(t.flags|=32),On}function Hn(t,n,o){(t===qi&&(Di===2||Di===9)||t.cancelPendingCommit!==null)&&(Ll(t,0),vo(t,gi,On,!1)),Y(t,o),((Ci&2)===0||t!==qi)&&(t===qi&&((Ci&2)===0&&(yo|=o),Ta===4&&vo(t,gi,On,!1)),Nr(t))}function lr(t,n,o){if((Ci&6)!==0)throw Error(Q(327));var c=!o&&(n&127)===0&&(n&t.expiredLanes)===0||k(t,n),_=c?Sf(t,n):Th(t,n,!0),b=c;do{if(_===0){Ko&&!c&&vo(t,n,0,!1);break}else{if(o=t.current.alternate,b&&!xf(o)){_=Th(t,n,!1),b=!1;continue}if(_===2){if(b=n,t.errorRecoveryDisabledLanes&b)var D=0;else D=t.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){n=D;e:{var N=t;_=uc;var te=N.current.memoizedState.isDehydrated;if(te&&(Ll(N,D).flags|=256),D=Th(N,D,!1),D!==2){if(lc&&!te){N.errorRecoveryDisabledLanes|=b,yo|=b,_=4;break e}b=sr,sr=_,b!==null&&(sr===null?sr=b:sr.push.apply(sr,b))}_=D}if(b=!1,_!==2)continue}}if(_===1){Ll(t,0),vo(t,n,0,!0);break}e:{switch(c=t,b=_,b){case 0:case 1:throw Error(Q(345));case 4:if((n&4194048)!==n)break;case 6:vo(c,n,On,!Yo);break e;case 2:sr=null;break;case 3:case 5:break;default:throw Error(Q(329))}if((n&62914560)===n&&(_=yh+300-$t(),10<_)){if(vo(c,n,On,!Yo),Z(c,0,!0)!==0)break e;Ns=n,c.timeoutHandle=Yi(gu.bind(null,c,o,sr,vh,gh,n,On,yo,Dl,Yo,b,"Throttled",-0,0),_);break e}gu(c,o,sr,vh,gh,n,On,yo,Dl,Yo,b,null,-0,0)}}break}while(!0);Nr(t)}function gu(t,n,o,c,_,b,D,N,te,be,ke,Ne,we,Te){if(t.timeoutHandle=-1,Ne=n.subtreeFlags,Ne&8192||(Ne&16785408)===16785408){Ne={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mr},fh(n,b,Ne);var Ct=(b&62914560)===b?yh-$t():(b&4194048)===b?vf-$t():0;if(Ct=Ol(Ne,Ct),Ct!==null){Ns=b,t.cancelPendingCommit=Ct(zd.bind(null,t,n,b,o,c,_,D,N,te,ke,Ne,null,we,Te)),vo(t,b,D,!be);return}}zd(t,n,b,o,c,_,D,N,te)}function xf(t){for(var n=t;;){var o=n.tag;if((o===0||o===11||o===15)&&n.flags&16384&&(o=n.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var _=o[c],b=_.getSnapshot;_=_.value;try{if(!rn(b(),_))return!1}catch{return!1}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function vo(t,n,o,c){n&=~mh,n&=~yo,t.suspendedLanes|=n,t.pingedLanes&=~n,c&&(t.warmLanes|=n),c=t.expirationTimes;for(var _=n;0<_;){var b=31-xa(_),D=1<<b;c[b]=-1,_&=~D}o!==0&&ae(t,o,n)}function cc(){return(Ci&6)===0?(yu(0),!1):!0}function Sh(){if(fi!==null){if(Di===0)var t=fi.return;else t=fi,gr=Un=null,Uc(t),Ht=null,jt=0,t=fi;for(;t!==null;)cu(t.alternate,t),t=t.return;fi=null}}function Ll(t,n){var o=t.timeoutHandle;o!==-1&&(t.timeoutHandle=-1,Oa(o)),o=t.cancelPendingCommit,o!==null&&(t.cancelPendingCommit=null,o()),Ns=0,Sh(),qi=t,fi=o=rs(t.current,null),gi=n,Di=0,$n=null,Yo=!1,Ko=k(t,n),lc=!1,Dl=On=mh=yo=go=Ta=0,sr=uc=null,gh=!1,(n&8)!==0&&(n|=n&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=n;0<c;){var _=31-xa(c),b=1<<_;n|=t[_],c&=~b}return rr=n,as(),o}function Td(t,n){Nt=null,Se.H=Ku,n===ze||n===Re?(n=_t(),Di=3):n===je?(n=_t(),Di=4):Di=n===cd?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,$n=n,fi===null&&(Ta=1,Jc(t,kn(n,t.current)))}function bf(){var t=Rn.current;return t===null?!0:(gi&4194048)===gi?jn===null:(gi&62914560)===gi||(gi&536870912)!==0?t===jn:!1}function Ed(){var t=Se.H;return Se.H=Ku,t===null?Ku:t}function xo(){var t=Se.A;return Se.A=Os,t}function hc(){Ta=4,Yo||(gi&4194048)!==gi&&Rn.current!==null||(Ko=!0),(go&134217727)===0&&(yo&134217727)===0||qi===null||vo(qi,gi,On,!1)}function Th(t,n,o){var c=Ci;Ci|=2;var _=Ed(),b=xo();(qi!==t||gi!==n)&&(vh=null,Ll(t,n)),n=!1;var D=Ta;e:do try{if(Di!==0&&fi!==null){var N=fi,te=$n;switch(Di){case 8:Sh(),D=6;break e;case 3:case 2:case 9:case 6:Rn.current===null&&(n=!0);var be=Di;if(Di=0,$n=null,fs(t,N,te,be),o&&Ko){D=0;break e}break;default:be=Di,Di=0,$n=null,fs(t,N,te,be)}}wf(),D=Ta;break}catch(ke){Td(t,ke)}while(!0);return n&&t.shellSuspendCounter++,gr=Un=null,Ci=c,Se.H=_,Se.A=b,fi===null&&(qi=null,gi=0,as()),D}function wf(){for(;fi!==null;)Tf(fi)}function Sf(t,n){var o=Ci;Ci|=2;var c=Ed(),_=xo();qi!==t||gi!==n?(vh=null,_h=$t()+500,Ll(t,n)):Ko=k(t,n);e:do try{if(Di!==0&&fi!==null){n=fi;var b=$n;t:switch(Di){case 1:Di=0,$n=null,fs(t,n,b,1);break;case 2:case 9:if(yt(b)){Di=0,$n=null,Ad(n);break}n=function(){Di!==2&&Di!==9||qi!==t||(Di=7),Nr(t)},b.then(n,n);break e;case 3:Di=7;break e;case 4:Di=5;break e;case 7:yt(b)?(Di=0,$n=null,Ad(n)):(Di=0,$n=null,fs(t,n,b,7));break;case 5:var D=null;switch(fi.tag){case 26:D=fi.memoizedState;case 5:case 27:var N=fi;if(D?hr(D):N.stateNode.complete){Di=0,$n=null;var te=N.sibling;if(te!==null)fi=te;else{var be=N.return;be!==null?(fi=be,dc(be)):fi=null}break t}}Di=0,$n=null,fs(t,n,b,5);break;case 6:Di=0,$n=null,fs(t,n,b,6);break;case 8:Sh(),Ta=6;break e;default:throw Error(Q(462))}}sp();break}catch(ke){Td(t,ke)}while(!0);return gr=Un=null,Se.H=c,Se.A=_,Ci=o,fi!==null?0:(qi=null,gi=0,as(),Ta)}function sp(){for(;fi!==null&&!Kn();)Tf(fi)}function Tf(t){var n=tc(t.alternate,t,rr);t.memoizedProps=t.pendingProps,n===null?dc(t):fi=n}function Ad(t){var n=t,o=n.alternate;switch(n.tag){case 15:case 0:n=uf(o,n,n.pendingProps,n.type,void 0,gi);break;case 11:n=uf(o,n,n.pendingProps,n.type.render,n.ref,gi);break;case 5:Uc(n);default:cu(o,n),n=fi=eu(n,rr),n=tc(o,n,rr)}t.memoizedProps=t.pendingProps,n===null?dc(t):fi=n}function fs(t,n,o,c){gr=Un=null,Uc(n),Ht=null,jt=0;var _=n.return;try{if(Wf(t,_,n,o,gi)){Ta=1,Jc(t,kn(o,t.current)),fi=null;return}}catch(b){if(_!==null)throw fi=_,b;Ta=1,Jc(t,kn(o,t.current)),fi=null;return}n.flags&32768?(li||c===1?t=!0:Ko||(gi&536870912)!==0?t=!1:(Yo=t=!0,(c===2||c===9||c===3||c===6)&&(c=Rn.current,c!==null&&c.tag===13&&(c.flags|=16384))),fc(n,t)):dc(n)}function dc(t){var n=t;do{if((n.flags&32768)!==0){fc(n,Yo);return}t=n.return;var o=ip(n.alternate,n,rr);if(o!==null){fi=o;return}if(n=n.sibling,n!==null){fi=n;return}fi=n=t}while(n!==null);Ta===0&&(Ta=5)}function fc(t,n){do{var o=ap(t.alternate,t);if(o!==null){o.flags&=32767,fi=o;return}if(o=t.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!n&&(t=t.sibling,t!==null)){fi=t;return}fi=t=o}while(t!==null);Ta=6,fi=null}function zd(t,n,o,c,_,b,D,N,te){t.cancelPendingCommit=null;do Eh();while(na!==0);if((Ci&6)!==0)throw Error(Q(327));if(n!==null){if(n===t.current)throw Error(Q(177));if(b=n.lanes|n.childLanes,b|=Dr,de(t,o,b,D,N,te),t===qi&&(fi=qi=null,gi=0),Il=n,_o=t,Ns=o,xh=b,bh=_,Sd=c,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,Md(Vs,function(){return Af(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||c){c=Se.T,Se.T=null,_=Ye.p,Ye.p=2,D=Ci,Ci|=4;try{np(t,n,o)}finally{Ci=D,Ye.p=_,Se.T=c}}na=1,pc(),mc(),gc()}}function pc(){if(na===1){na=0;var t=_o,n=Il,o=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||o){o=Se.T,Se.T=null;var c=Ye.p;Ye.p=2;var _=Ci;Ci|=4;try{dh(n,t);var b=dt,D=ju(t.containerInfo),N=b.focusedElem,te=b.selectionRange;if(D!==N&&N&&N.ownerDocument&&Uu(N.ownerDocument.documentElement,N)){if(te!==null&&Xl(N)){var be=te.start,ke=te.end;if(ke===void 0&&(ke=be),"selectionStart"in N)N.selectionStart=be,N.selectionEnd=Math.min(ke,N.value.length);else{var Ne=N.ownerDocument||document,we=Ne&&Ne.defaultView||window;if(we.getSelection){var Te=we.getSelection(),Ct=N.textContent.length,Zt=Math.min(te.start,Ct),oa=te.end===void 0?Zt:Math.min(te.end,Ct);!Te.extend&&Zt>oa&&(D=oa,oa=Zt,Zt=D);var me=no(N,Zt),ue=no(N,oa);if(me&&ue&&(Te.rangeCount!==1||Te.anchorNode!==me.node||Te.anchorOffset!==me.offset||Te.focusNode!==ue.node||Te.focusOffset!==ue.offset)){var ve=Ne.createRange();ve.setStart(me.node,me.offset),Te.removeAllRanges(),Zt>oa?(Te.addRange(ve),Te.extend(ue.node,ue.offset)):(ve.setEnd(ue.node,ue.offset),Te.addRange(ve))}}}}for(Ne=[],Te=N;Te=Te.parentNode;)Te.nodeType===1&&Ne.push({element:Te,left:Te.scrollLeft,top:Te.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<Ne.length;N++){var Be=Ne[N];Be.element.scrollLeft=Be.left,Be.element.scrollTop=Be.top}}Uf=!!Ke,dt=Ke=null}finally{Ci=_,Ye.p=c,Se.T=o}}t.current=n,na=2}}function mc(){if(na===2){na=0;var t=_o,n=Il,o=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||o){o=Se.T,Se.T=null;var c=Ye.p;Ye.p=2;var _=Ci;Ci|=4;try{mf(t,n.alternate,n)}finally{Ci=_,Ye.p=c,Se.T=o}}na=3}}function gc(){if(na===4||na===3){na=0,Pi();var t=_o,n=Il,o=Ns,c=Sd;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?na=5:(na=0,Il=_o=null,Ef(t,t.pendingLanes));var _=t.pendingLanes;if(_===0&&(Ps=null),Ce(o),n=n.stateNode,di&&typeof di.onCommitFiberRoot=="function")try{di.onCommitFiberRoot(En,n,void 0,(n.current.flags&128)===128)}catch{}if(c!==null){n=Se.T,_=Ye.p,Ye.p=2,Se.T=null;try{for(var b=t.onRecoverableError,D=0;D<c.length;D++){var N=c[D];b(N.value,{componentStack:N.stack})}}finally{Se.T=n,Ye.p=_}}(Ns&3)!==0&&Eh(),Nr(t),_=t.pendingLanes,(o&261930)!==0&&(_&42)!==0?t===mu?kl++:(kl=0,mu=t):kl=0,yu(0)}}function Ef(t,n){(t.pooledCacheLanes&=n)===0&&(n=t.pooledCache,n!=null&&(t.pooledCache=null,M(n)))}function Eh(){return pc(),mc(),gc(),Af()}function Af(){if(na!==5)return!1;var t=_o,n=xh;xh=0;var o=Ce(Ns),c=Se.T,_=Ye.p;try{Ye.p=32>o?32:o,Se.T=null,o=bh,bh=null;var b=_o,D=Ns;if(na=0,Il=_o=null,Ns=0,(Ci&6)!==0)throw Error(Q(331));var N=Ci;if(Ci|=4,_f(b.current),wd(b,b.current,D,o),Ci=N,yu(0,!1),di&&typeof di.onPostCommitFiberRoot=="function")try{di.onPostCommitFiberRoot(En,b)}catch{}return!0}finally{Ye.p=_,Se.T=c,Ef(t,n)}}function zf(t,n,o){n=kn(o,n),n=ld(t.stateNode,n,2),t=bn(t,n,2),t!==null&&(Y(t,2),Nr(t))}function Ti(t,n,o){if(t.tag===3)zf(t,t,o);else for(;n!==null;){if(n.tag===3){zf(n,t,o);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ps===null||!Ps.has(c))){t=kn(o,t),o=ud(2),c=bn(n,o,2),c!==null&&(zl(o,c,n,t),Y(c,2),Nr(c));break}}n=n.return}}function Za(t,n,o){var c=t.pingCache;if(c===null){c=t.pingCache=new Xo;var _=new Set;c.set(n,_)}else _=c.get(n),_===void 0&&(_=new Set,c.set(n,_));_.has(o)||(lc=!0,_.add(o),t=Qo.bind(null,t,n,o),n.then(t,t))}function Qo(t,n,o){var c=t.pingCache;c!==null&&c.delete(n),t.pingedLanes|=t.suspendedLanes&o,t.warmLanes&=~o,qi===t&&(gi&o)===o&&(Ta===4||Ta===3&&(gi&62914560)===gi&&300>$t()-yh?(Ci&2)===0&&Ll(t,0):mh|=o,Dl===gi&&(Dl=0)),Nr(t)}function Ah(t,n){n===0&&(n=F()),t=ns(t,n),t!==null&&(Y(t,n),Nr(t))}function Mf(t){var n=t.memoizedState,o=0;n!==null&&(o=n.retryLane),Ah(t,o)}function Cf(t,n){var o=0;switch(t.tag){case 31:case 13:var c=t.stateNode,_=t.memoizedState;_!==null&&(o=_.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(Q(314))}c!==null&&c.delete(n),Ah(t,o)}function Md(t,n){return Ee(t,n)}var zh=null,Rl=null,Mh=!1,Ch=!1,Dh=!1,Fs=0;function Nr(t){t!==Rl&&t.next===null&&(Rl===null?zh=Rl=t:Rl=Rl.next=t),Ch=!0,Mh||(Mh=!0,vc())}function yu(t,n){if(!Dh&&Ch){Dh=!0;do for(var o=!1,c=zh;c!==null;){if(t!==0){var _=c.pendingLanes;if(_===0)var b=0;else{var D=c.suspendedLanes,N=c.pingedLanes;b=(1<<31-xa(42|t)+1)-1,b&=_&~(D&~N),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(o=!0,_c(c,b))}else b=gi,b=Z(c,c===qi?b:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(b&3)===0||k(c,b)||(o=!0,_c(c,b));c=c.next}while(o);Dh=!1}}function yc(){Ih()}function Ih(){Ch=Mh=!1;var t=0;Fs!==0&&Xi()&&(t=Fs);for(var n=$t(),o=null,c=zh;c!==null;){var _=c.next,b=Cd(c,n);b===0?(c.next=null,o===null?zh=_:o.next=_,_===null&&(Rl=o)):(o=c,(t!==0||(b&3)!==0)&&(Ch=!0)),c=_}na!==0&&na!==5||yu(t),Fs!==0&&(Fs=0)}function Cd(t,n){for(var o=t.suspendedLanes,c=t.pingedLanes,_=t.expirationTimes,b=t.pendingLanes&-62914561;0<b;){var D=31-xa(b),N=1<<D,te=_[D];te===-1?((N&o)===0||(N&c)!==0)&&(_[D]=R(N,n)):te<=n&&(t.expiredLanes|=N),b&=~N}if(n=qi,o=gi,o=Z(t,t===n?o:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,o===0||t===n&&(Di===2||Di===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&an(c),t.callbackNode=null,t.callbackPriority=0;if((o&3)===0||k(t,o)){if(n=o&-o,n===t.callbackPriority)return n;switch(c!==null&&an(c),Ce(o)){case 2:case 8:o=Ar;break;case 32:o=Vs;break;case 268435456:o=Gr;break;default:o=Vs}return c=kh.bind(null,t),o=Ee(o,c),t.callbackPriority=n,t.callbackNode=o,n}return c!==null&&c!==null&&an(c),t.callbackPriority=2,t.callbackNode=null,2}function kh(t,n){if(na!==0&&na!==5)return t.callbackNode=null,t.callbackPriority=0,null;var o=t.callbackNode;if(Eh()&&t.callbackNode!==o)return null;var c=gi;return c=Z(t,t===qi?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(lr(t,c,n),Cd(t,$t()),t.callbackNode!=null&&t.callbackNode===o?kh.bind(null,t):null)}function _c(t,n){if(Eh())return null;lr(t,n,!0)}function vc(){Pn(function(){(Ci&6)!==0?Ee(js,yc):Ih()})}function xc(){if(Fs===0){var t=q;t===0&&(t=Fa,Fa<<=1,(Fa&261888)===0&&(Fa=256)),Fs=t}return Fs}function Lh(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Nl(""+t)}function Rh(t,n){var o=n.ownerDocument.createElement("input");return o.name=n.name,o.value=n.value,t.id&&o.setAttribute("form",t.id),n.parentNode.insertBefore(o,n),t=new FormData(t),o.parentNode.removeChild(o),t}function op(t,n,o,c,_){if(n==="submit"&&o&&o.stateNode===_){var b=Lh((_[pt]||null).action),D=c.submitter;D&&(n=(n=D[pt]||null)?Lh(n.formAction):D.getAttribute("formAction"),n!==null&&(b=n,D=null));var N=new Ks("action","action",null,c,_);t.push({event:N,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Fs!==0){var te=D?Rh(_,D):new FormData(_);ru(o,{pending:!0,data:te,method:_.method,action:b},null,te)}}else typeof b=="function"&&(N.preventDefault(),te=D?Rh(_,D):new FormData(_),ru(o,{pending:!0,data:te,method:_.method,action:b},b,te))},currentTarget:_}]})}}for(var a=0;a<Oo.length;a++){var e=Oo[a],r=e.toLowerCase(),l=e[0].toUpperCase()+e.slice(1);sn(r,"on"+l)}sn(Fn,"onAnimationEnd"),sn(Cr,"onAnimationIteration"),sn(pl,"onAnimationStart"),sn("dblclick","onDoubleClick"),sn("focusin","onFocus"),sn("focusout","onBlur"),sn(es,"onTransitionRun"),sn(ts,"onTransitionStart"),sn(Zh,"onTransitionCancel"),sn(Kl,"onTransitionEnd"),gs("onMouseEnter",["mouseout","mouseover"]),gs("onMouseLeave",["mouseout","mouseover"]),gs("onPointerEnter",["pointerout","pointerover"]),gs("onPointerLeave",["pointerout","pointerover"]),hi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),hi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),hi("onBeforeInput",["compositionend","keypress","textInput","paste"]),hi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),hi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),hi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var h="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(h));function y(t,n){n=(n&4)!==0;for(var o=0;o<t.length;o++){var c=t[o],_=c.event;c=c.listeners;e:{var b=void 0;if(n)for(var D=c.length-1;0<=D;D--){var N=c[D],te=N.instance,be=N.currentTarget;if(N=N.listener,te!==b&&_.isPropagationStopped())break e;b=N,_.currentTarget=be;try{b(_)}catch(ke){tr(ke)}_.currentTarget=null,b=te}else for(D=0;D<c.length;D++){if(N=c[D],te=N.instance,be=N.currentTarget,N=N.listener,te!==b&&_.isPropagationStopped())break e;b=N,_.currentTarget=be;try{b(_)}catch(ke){tr(ke)}_.currentTarget=null,b=te}}}}function v(t,n){var o=n[mi];o===void 0&&(o=n[mi]=new Set);var c=t+"__bubble";o.has(c)||(I(n,t,2,!1),o.add(c))}function S(t,n,o){var c=0;n&&(c|=4),I(o,t,c,n)}var E="_reactListening"+Math.random().toString(36).slice(2);function z(t){if(!t[E]){t[E]=!0,Zs.forEach(function(o){o!=="selectionchange"&&(g.has(o)||S(o,!1,t),S(o,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[E]||(n[E]=!0,S("selectionchange",!1,n))}}function I(t,n,o,c){switch(Ip(n)){case 2:var _=cm;break;case 8:_=hm;break;default:_=cp}o=_.bind(null,n,o,t),_=void 0,!Eo||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(_=!0),c?_!==void 0?t.addEventListener(n,o,{capture:!0,passive:_}):t.addEventListener(n,o,!0):_!==void 0?t.addEventListener(n,o,{passive:_}):t.addEventListener(n,o,!1)}function L(t,n,o,c,_){var b=c;if((n&1)===0&&(n&2)===0&&c!==null)e:for(;;){if(c===null)return;var D=c.tag;if(D===3||D===4){var N=c.stateNode.containerInfo;if(N===_)break;if(D===4)for(D=c.return;D!==null;){var te=D.tag;if((te===3||te===4)&&D.stateNode.containerInfo===_)return;D=D.return}for(;N!==null;){if(D=Ki(N),D===null)return;if(te=D.tag,te===5||te===6||te===26||te===27){c=b=D;continue e}N=N.parentNode}}c=c.return}_s(function(){var be=b,ke=To(o),Ne=[];e:{var we=Vu.get(t);if(we!==void 0){var Te=Ks,Ct=t;switch(t){case"keypress":if(Jt(o)===0)break e;case"keydown":case"keyup":Te=Lu;break;case"focusin":Ct="focus",Te=Du;break;case"focusout":Ct="blur",Te=Du;break;case"beforeblur":case"afterblur":Te=Du;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=nl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=Cc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=Io;break;case Fn:case Cr:case pl:Te=Uh;break;case Kl:Te=Bu;break;case"scroll":case"scrollend":Te=Cu;break;case"wheel":Te=ta;break;case"copy":case"cut":case"paste":Te=Vh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=Ru;break;case"toggle":case"beforetoggle":Te=ni}var Zt=(n&4)!==0,oa=!Zt&&(t==="scroll"||t==="scrollend"),me=Zt?we!==null?we+"Capture":null:we;Zt=[];for(var ue=be,ve;ue!==null;){var Be=ue;if(ve=Be.stateNode,Be=Be.tag,Be!==5&&Be!==26&&Be!==27||ve===null||me===null||(Be=vs(ue,me),Be!=null&&Zt.push(O(ue,Be,ve))),oa)break;ue=ue.return}0<Zt.length&&(we=new Te(we,Ct,null,o,ke),Ne.push({event:we,listeners:Zt}))}}if((n&7)===0){e:{if(we=t==="mouseover"||t==="pointerover",Te=t==="mouseout"||t==="pointerout",we&&o!==Fl&&(Ct=o.relatedTarget||o.fromElement)&&(Ki(Ct)||Ct[Bt]))break e;if((Te||we)&&(we=ke.window===ke?ke:(we=ke.ownerDocument)?we.defaultView||we.parentWindow:window,Te?(Ct=o.relatedTarget||o.toElement,Te=be,Ct=Ct?Ki(Ct):null,Ct!==null&&(oa=$e(Ct),Zt=Ct.tag,Ct!==oa||Zt!==5&&Zt!==27&&Zt!==6)&&(Ct=null)):(Te=null,Ct=be),Te!==Ct)){if(Zt=nl,Be="onMouseLeave",me="onMouseEnter",ue="mouse",(t==="pointerout"||t==="pointerover")&&(Zt=Ru,Be="onPointerLeave",me="onPointerEnter",ue="pointer"),oa=Te==null?we:nn(Te),ve=Ct==null?we:nn(Ct),we=new Zt(Be,ue+"leave",Te,o,ke),we.target=oa,we.relatedTarget=ve,Be=null,Ki(ke)===be&&(Zt=new Zt(me,ue+"enter",Ct,o,ke),Zt.target=ve,Zt.relatedTarget=oa,Be=Zt),oa=Be,Te&&Ct)t:{for(Zt=G,me=Te,ue=Ct,ve=0,Be=me;Be;Be=Zt(Be))ve++;Be=0;for(var Ot=ue;Ot;Ot=Zt(Ot))Be++;for(;0<ve-Be;)me=Zt(me),ve--;for(;0<Be-ve;)ue=Zt(ue),Be--;for(;ve--;){if(me===ue||ue!==null&&me===ue.alternate){Zt=me;break t}me=Zt(me),ue=Zt(ue)}Zt=null}else Zt=null;Te!==null&&X(Ne,we,Te,Zt,!1),Ct!==null&&oa!==null&&X(Ne,oa,Ct,Zt,!0)}}e:{if(we=be?nn(be):window,Te=we.nodeName&&we.nodeName.toLowerCase(),Te==="select"||Te==="input"&&we.type==="file")var Ui=$l;else if(ko(we))if(Nu)Ui=Lo;else{Ui=ao;var Lt=ua}else Te=we.nodeName,!Te||Te.toLowerCase()!=="input"||we.type!=="checkbox"&&we.type!=="radio"?be&&tl(be.elementType)&&(Ui=$l):Ui=Dn;if(Ui&&(Ui=Ui(t,be))){kc(Ne,Ui,o,ke);break e}Lt&&Lt(t,we,be),t==="focusout"&&be&&we.type==="number"&&be.memoizedProps.value!=null&&Jo(we,"number",we.value)}switch(Lt=be?nn(be):window,t){case"focusin":(ko(Lt)||Lt.contentEditable==="true")&&(ro=Lt,er=be,Jr=null);break;case"focusout":Jr=er=ro=null;break;case"mousedown":_n=!0;break;case"contextmenu":case"mouseup":case"dragend":_n=!1,Bo(Ne,o,ke);break;case"selectionchange":if(Rc)break;case"keydown":case"keyup":Bo(Ne,o,ke)}var ui;if(Zi)e:{switch(t){case"compositionstart":var Ei="onCompositionStart";break e;case"compositionend":Ei="onCompositionEnd";break e;case"compositionupdate":Ei="onCompositionUpdate";break e}Ei=void 0}else Qr?ol(t,o)&&(Ei="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(Ei="onCompositionStart");Ei&&(Ou&&o.locale!=="ko"&&(Qr||Ei!=="onCompositionStart"?Ei==="onCompositionEnd"&&Qr&&(ui=Yr()):(Wn=ke,Ao="value"in Wn?Wn.value:Wn.textContent,Qr=!0)),Lt=P(be,Ei),0<Lt.length&&(Ei=new jl(Ei,t,null,o,ke),Ne.push({event:Ei,listeners:Lt}),ui?Ei.data=ui:(ui=Zl(o),ui!==null&&(Ei.data=ui)))),(ui=rl?Pu(t,o):ll(t,o))&&(Ei=P(be,"onBeforeInput"),0<Ei.length&&(Lt=new jl("onBeforeInput","beforeinput",null,o,ke),Ne.push({event:Lt,listeners:Ei}),Lt.data=ui)),op(Ne,t,be,o,ke)}y(Ne,n)})}function O(t,n,o){return{instance:t,listener:n,currentTarget:o}}function P(t,n){for(var o=n+"Capture",c=[];t!==null;){var _=t,b=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||b===null||(_=vs(t,o),_!=null&&c.unshift(O(t,_,b)),_=vs(t,n),_!=null&&c.push(O(t,_,b))),t.tag===3)return c;t=t.return}return[]}function G(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function X(t,n,o,c,_){for(var b=n._reactName,D=[];o!==null&&o!==c;){var N=o,te=N.alternate,be=N.stateNode;if(N=N.tag,te!==null&&te===c)break;N!==5&&N!==26&&N!==27||be===null||(te=be,_?(be=vs(o,b),be!=null&&D.unshift(O(o,be,te))):_||(be=vs(o,b),be!=null&&D.push(O(o,be,te)))),o=o.return}D.length!==0&&t.push({event:n,listeners:D})}var J=/\r\n?/g,ce=/\u0000|\uFFFD/g;function ie(t){return(typeof t=="string"?t:""+t).replace(J,`
`).replace(ce,"")}function he(t,n){return n=ie(n),ie(t)===n}function fe(t,n,o,c,_,b){switch(o){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||ys(t,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&ys(t,""+c);break;case"className":Ma(t,"class",c);break;case"tabIndex":Ma(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Ma(t,o,c);break;case"style":Ac(t,c,b);break;case"data":if(n!=="object"){Ma(t,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||o!=="href")){t.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=Nl(""+c),t.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(o==="formAction"?(n!=="input"&&fe(t,n,"name",_.name,_,null),fe(t,n,"formEncType",_.formEncType,_,null),fe(t,n,"formMethod",_.formMethod,_,null),fe(t,n,"formTarget",_.formTarget,_,null)):(fe(t,n,"encType",_.encType,_,null),fe(t,n,"method",_.method,_,null),fe(t,n,"target",_.target,_,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=Nl(""+c),t.setAttribute(o,c);break;case"onClick":c!=null&&(t.onclick=Mr);break;case"onScroll":c!=null&&v("scroll",t);break;case"onScrollEnd":c!=null&&v("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(Q(61));if(o=c.__html,o!=null){if(_.children!=null)throw Error(Q(60));t.innerHTML=o}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}o=Nl(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""+c):t.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""):t.removeAttribute(o);break;case"capture":case"download":c===!0?t.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,c):t.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(o,c):t.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(o):t.setAttribute(o,c);break;case"popover":v("beforetoggle",t),v("toggle",t),yn(t,"popover",c);break;case"xlinkActuate":Qn(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Qn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Qn(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Qn(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Qn(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Qn(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Qn(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Qn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Qn(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":yn(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Mu.get(o)||o,yn(t,o,c))}}function De(t,n,o,c,_,b){switch(o){case"style":Ac(t,c,b);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(Q(61));if(o=c.__html,o!=null){if(_.children!=null)throw Error(Q(60));t.innerHTML=o}}break;case"children":typeof c=="string"?ys(t,c):(typeof c=="number"||typeof c=="bigint")&&ys(t,""+c);break;case"onScroll":c!=null&&v("scroll",t);break;case"onScrollEnd":c!=null&&v("scrollend",t);break;case"onClick":c!=null&&(t.onclick=Mr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ec.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(_=o.endsWith("Capture"),n=o.slice(2,_?o.length-7:void 0),b=t[pt]||null,b=b!=null?b[o]:null,typeof b=="function"&&t.removeEventListener(n,b,_),typeof c=="function")){typeof b!="function"&&b!==null&&(o in t?t[o]=null:t.hasAttribute(o)&&t.removeAttribute(o)),t.addEventListener(n,c,_);break e}o in t?t[o]=c:c===!0?t.setAttribute(o,""):yn(t,o,c)}}}function Xe(t,n,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":v("error",t),v("load",t);var c=!1,_=!1,b;for(b in o)if(o.hasOwnProperty(b)){var D=o[b];if(D!=null)switch(b){case"src":c=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Q(137,n));default:fe(t,n,b,D,o,null)}}_&&fe(t,n,"srcSet",o.srcSet,o,null),c&&fe(t,n,"src",o.src,o,null);return;case"input":v("invalid",t);var N=b=D=_=null,te=null,be=null;for(c in o)if(o.hasOwnProperty(c)){var ke=o[c];if(ke!=null)switch(c){case"name":_=ke;break;case"type":D=ke;break;case"checked":te=ke;break;case"defaultChecked":be=ke;break;case"value":b=ke;break;case"defaultValue":N=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(Q(137,n));break;default:fe(t,n,c,ke,o,null)}}Au(t,b,N,te,be,D,_,!1);return;case"select":v("invalid",t),c=D=b=null;for(_ in o)if(o.hasOwnProperty(_)&&(N=o[_],N!=null))switch(_){case"value":b=N;break;case"defaultValue":D=N;break;case"multiple":c=N;default:fe(t,n,_,N,o,null)}n=b,o=D,t.multiple=!!c,n!=null?$r(t,!!c,n,!1):o!=null&&$r(t,!!c,o,!0);return;case"textarea":v("invalid",t),b=_=c=null;for(D in o)if(o.hasOwnProperty(D)&&(N=o[D],N!=null))switch(D){case"value":c=N;break;case"defaultValue":_=N;break;case"children":b=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(Q(91));break;default:fe(t,n,D,N,o,null)}Hr(t,c,_,b);return;case"option":for(te in o)if(o.hasOwnProperty(te)&&(c=o[te],c!=null))switch(te){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:fe(t,n,te,c,o,null)}return;case"dialog":v("beforetoggle",t),v("toggle",t),v("cancel",t),v("close",t);break;case"iframe":case"object":v("load",t);break;case"video":case"audio":for(c=0;c<h.length;c++)v(h[c],t);break;case"image":v("error",t),v("load",t);break;case"details":v("toggle",t);break;case"embed":case"source":case"link":v("error",t),v("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(be in o)if(o.hasOwnProperty(be)&&(c=o[be],c!=null))switch(be){case"children":case"dangerouslySetInnerHTML":throw Error(Q(137,n));default:fe(t,n,be,c,o,null)}return;default:if(tl(n)){for(ke in o)o.hasOwnProperty(ke)&&(c=o[ke],c!==void 0&&De(t,n,ke,c,o,void 0));return}}for(N in o)o.hasOwnProperty(N)&&(c=o[N],c!=null&&fe(t,n,N,c,o,null))}function vt(t,n,o,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,b=null,D=null,N=null,te=null,be=null,ke=null;for(Te in o){var Ne=o[Te];if(o.hasOwnProperty(Te)&&Ne!=null)switch(Te){case"checked":break;case"value":break;case"defaultValue":te=Ne;default:c.hasOwnProperty(Te)||fe(t,n,Te,null,c,Ne)}}for(var we in c){var Te=c[we];if(Ne=o[we],c.hasOwnProperty(we)&&(Te!=null||Ne!=null))switch(we){case"type":b=Te;break;case"name":_=Te;break;case"checked":be=Te;break;case"defaultChecked":ke=Te;break;case"value":D=Te;break;case"defaultValue":N=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(Q(137,n));break;default:Te!==Ne&&fe(t,n,we,Te,c,Ne)}}zr(t,D,N,te,be,ke,b,_);return;case"select":Te=D=N=we=null;for(b in o)if(te=o[b],o.hasOwnProperty(b)&&te!=null)switch(b){case"value":break;case"multiple":Te=te;default:c.hasOwnProperty(b)||fe(t,n,b,null,c,te)}for(_ in c)if(b=c[_],te=o[_],c.hasOwnProperty(_)&&(b!=null||te!=null))switch(_){case"value":we=b;break;case"defaultValue":N=b;break;case"multiple":D=b;default:b!==te&&fe(t,n,_,b,c,te)}n=N,o=D,c=Te,we!=null?$r(t,!!o,we,!1):!!c!=!!o&&(n!=null?$r(t,!!o,n,!0):$r(t,!!o,o?[]:"",!1));return;case"textarea":Te=we=null;for(N in o)if(_=o[N],o.hasOwnProperty(N)&&_!=null&&!c.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:fe(t,n,N,null,c,_)}for(D in c)if(_=c[D],b=o[D],c.hasOwnProperty(D)&&(_!=null||b!=null))switch(D){case"value":we=_;break;case"defaultValue":Te=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(Q(91));break;default:_!==b&&fe(t,n,D,_,c,b)}Wo(t,we,Te);return;case"option":for(var Ct in o)if(we=o[Ct],o.hasOwnProperty(Ct)&&we!=null&&!c.hasOwnProperty(Ct))switch(Ct){case"selected":t.selected=!1;break;default:fe(t,n,Ct,null,c,we)}for(te in c)if(we=c[te],Te=o[te],c.hasOwnProperty(te)&&we!==Te&&(we!=null||Te!=null))switch(te){case"selected":t.selected=we&&typeof we!="function"&&typeof we!="symbol";break;default:fe(t,n,te,we,c,Te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Zt in o)we=o[Zt],o.hasOwnProperty(Zt)&&we!=null&&!c.hasOwnProperty(Zt)&&fe(t,n,Zt,null,c,we);for(be in c)if(we=c[be],Te=o[be],c.hasOwnProperty(be)&&we!==Te&&(we!=null||Te!=null))switch(be){case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(Q(137,n));break;default:fe(t,n,be,we,c,Te)}return;default:if(tl(n)){for(var oa in o)we=o[oa],o.hasOwnProperty(oa)&&we!==void 0&&!c.hasOwnProperty(oa)&&De(t,n,oa,void 0,c,we);for(ke in c)we=c[ke],Te=o[ke],!c.hasOwnProperty(ke)||we===Te||we===void 0&&Te===void 0||De(t,n,ke,we,c,Te);return}}for(var me in o)we=o[me],o.hasOwnProperty(me)&&we!=null&&!c.hasOwnProperty(me)&&fe(t,n,me,null,c,we);for(Ne in c)we=c[Ne],Te=o[Ne],!c.hasOwnProperty(Ne)||we===Te||we==null&&Te==null||fe(t,n,Ne,we,c,Te)}function lt(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function at(){if(typeof performance.getEntriesByType=="function"){for(var t=0,n=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var _=o[c],b=_.transferSize,D=_.initiatorType,N=_.duration;if(b&&N&&lt(D)){for(D=0,N=_.responseEnd,c+=1;c<o.length;c++){var te=o[c],be=te.startTime;if(be>N)break;var ke=te.transferSize,Ne=te.initiatorType;ke&&lt(Ne)&&(te=te.responseEnd,D+=ke*(te<N?1:(N-be)/(te-be)))}if(--c,n+=8*(b+D)/(_.duration/1e3),t++,10<t)break}}if(0<t)return n/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Ke=null,dt=null;function We(t){return t.nodeType===9?t:t.ownerDocument}function qe(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function zt(t,n){if(t===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&n==="foreignObject"?0:t}function xt(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Yt=null;function Xi(){var t=window.event;return t&&t.type==="popstate"?t===Yt?!1:(Yt=t,!0):(Yt=null,!1)}var Yi=typeof setTimeout=="function"?setTimeout:void 0,Oa=typeof clearTimeout=="function"?clearTimeout:void 0,Xn=typeof Promise=="function"?Promise:void 0,Pn=typeof queueMicrotask=="function"?queueMicrotask:typeof Xn<"u"?function(t){return Xn.resolve(null).then(t).catch(Ia)}:Yi;function Ia(t){setTimeout(function(){throw t})}function ra(t){return t==="head"}function Wa(t,n){var o=n,c=0;do{var _=o.nextSibling;if(t.removeChild(o),_&&_.nodeType===8)if(o=_.data,o==="/$"||o==="/&"){if(c===0){t.removeChild(_),Ph(n);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")ma(t.ownerDocument.documentElement);else if(o==="head"){o=t.ownerDocument.head,ma(o);for(var b=o.firstChild;b;){var D=b.nextSibling,N=b.nodeName;b[za]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&b.rel.toLowerCase()==="stylesheet"||o.removeChild(b),b=D}}else o==="body"&&ma(t.ownerDocument.body);o=_}while(o);Ph(n)}function wn(t,n){var o=t;t=0;do{var c=o.nextSibling;if(o.nodeType===1?n?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(n?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(t===0)break;t--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||t++;o=c}while(o)}function cn(t){var n=t.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var o=n;switch(n=n.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":cn(o),ki(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}t.removeChild(o)}}function Pa(t,n,o,c){for(;t.nodeType===1;){var _=o;if(t.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[za])switch(n){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(b=t.getAttribute("rel"),b==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(b!==_.rel||t.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||t.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||t.getAttribute("title")!==(_.title==null?null:_.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(b=t.getAttribute("src"),(b!==(_.src==null?null:_.src)||t.getAttribute("type")!==(_.type==null?null:_.type)||t.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&b&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(n==="input"&&t.type==="hidden"){var b=_.name==null?null:""+_.name;if(_.type==="hidden"&&t.getAttribute("name")===b)return t}else return t;if(t=sa(t.nextSibling),t===null)break}return null}function Na(t,n,o){if(n==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!o||(t=sa(t.nextSibling),t===null))return null;return t}function hn(t,n){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=sa(t.nextSibling),t===null))return null;return t}function dn(t){return t.data==="$?"||t.data==="$~"}function en(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function Yn(t,n){var o=t.ownerDocument;if(t.data==="$~")t._reactRetry=n;else if(t.data!=="$?"||o.readyState!=="loading")n();else{var c=function(){n(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function sa(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return t}var Ea=null;function ei(t){t=t.nextSibling;for(var n=0;t;){if(t.nodeType===8){var o=t.data;if(o==="/$"||o==="/&"){if(n===0)return sa(t.nextSibling);n--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||n++}t=t.nextSibling}return null}function fn(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(n===0)return t;n--}else o!=="/$"&&o!=="/&"||n++}t=t.previousSibling}return null}function tn(t,n,o){switch(n=We(o),t){case"html":if(t=n.documentElement,!t)throw Error(Q(452));return t;case"head":if(t=n.head,!t)throw Error(Q(453));return t;case"body":if(t=n.body,!t)throw Error(Q(454));return t;default:throw Error(Q(451))}}function ma(t){for(var n=t.attributes;n.length;)t.removeAttributeNode(n[0]);ki(t)}var Aa=new Map,Fr=new Set;function ur(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Sn=Ye.d;Ye.d={f:Ur,r:br,D:bc,C:Df,L:Dd,m:Id,X:If,S:bo,M:kf};function Ur(){var t=Sn.f(),n=cc();return t||n}function br(t){var n=ga(t);n!==null&&n.tag===5&&n.type==="form"?Xu(n):Sn.r(t)}var $a=typeof document>"u"?null:document;function Us(t,n,o){var c=$a;if(c&&typeof n=="string"&&n){var _=Mn(n);_='link[rel="'+t+'"][href="'+_+'"]',typeof o=="string"&&(_+='[crossorigin="'+o+'"]'),Fr.has(_)||(Fr.add(_),t={rel:t,crossOrigin:o,href:n},c.querySelector(_)===null&&(n=c.createElement("link"),Xe(n,"link",t),la(n),c.head.appendChild(n)))}}function bc(t){Sn.D(t),Us("dns-prefetch",t,null)}function Df(t,n){Sn.C(t,n),Us("preconnect",t,n)}function Dd(t,n,o){Sn.L(t,n,o);var c=$a;if(c&&t&&n){var _='link[rel="preload"][as="'+Mn(n)+'"]';n==="image"&&o&&o.imageSrcSet?(_+='[imagesrcset="'+Mn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(_+='[imagesizes="'+Mn(o.imageSizes)+'"]')):_+='[href="'+Mn(t)+'"]';var b=_;switch(n){case"style":b=_u(t);break;case"script":b=vu(t)}Aa.has(b)||(t=Ue({rel:"preload",href:n==="image"&&o&&o.imageSrcSet?void 0:t,as:n},o),Aa.set(b,t),c.querySelector(_)!==null||n==="style"&&c.querySelector(wc(b))||n==="script"&&c.querySelector(Sc(b))||(n=c.createElement("link"),Xe(n,"link",t),la(n),c.head.appendChild(n)))}}function Id(t,n){Sn.m(t,n);var o=$a;if(o&&t){var c=n&&typeof n.as=="string"?n.as:"script",_='link[rel="modulepreload"][as="'+Mn(c)+'"][href="'+Mn(t)+'"]',b=_;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=vu(t)}if(!Aa.has(b)&&(t=Ue({rel:"modulepreload",href:t},n),Aa.set(b,t),o.querySelector(_)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Sc(b)))return}c=o.createElement("link"),Xe(c,"link",t),la(c),o.head.appendChild(c)}}}function bo(t,n,o){Sn.S(t,n,o);var c=$a;if(c&&t){var _=Gs(c).hoistableStyles,b=_u(t);n=n||"default";var D=_.get(b);if(!D){var N={loading:0,preload:null};if(D=c.querySelector(wc(b)))N.loading=5;else{t=Ue({rel:"stylesheet",href:t,"data-precedence":n},o),(o=Aa.get(b))&&xu(t,o);var te=D=c.createElement("link");la(te),Xe(te,"link",t),te._p=new Promise(function(be,ke){te.onload=be,te.onerror=ke}),te.addEventListener("load",function(){N.loading|=1}),te.addEventListener("error",function(){N.loading|=2}),N.loading|=4,cr(D,n,c)}D={type:"stylesheet",instance:D,count:1,state:N},_.set(b,D)}}}function If(t,n){Sn.X(t,n);var o=$a;if(o&&t){var c=Gs(o).hoistableScripts,_=vu(t),b=c.get(_);b||(b=o.querySelector(Sc(_)),b||(t=Ue({src:t,async:!0},n),(n=Aa.get(_))&&Bh(t,n),b=o.createElement("script"),la(b),Xe(b,"link",t),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},c.set(_,b))}}function kf(t,n){Sn.M(t,n);var o=$a;if(o&&t){var c=Gs(o).hoistableScripts,_=vu(t),b=c.get(_);b||(b=o.querySelector(Sc(_)),b||(t=Ue({src:t,async:!0,type:"module"},n),(n=Aa.get(_))&&Bh(t,n),b=o.createElement("script"),la(b),Xe(b,"link",t),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},c.set(_,b))}}function Lf(t,n,o,c){var _=(_=Rt.current)?ur(_):null;if(!_)throw Error(Q(446));switch(t){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(n=_u(o.href),o=Gs(_).hoistableStyles,c=o.get(n),c||(c={type:"style",instance:null,count:0,state:null},o.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){t=_u(o.href);var b=Gs(_).hoistableStyles,D=b.get(t);if(D||(_=_.ownerDocument||_,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(t,D),(b=_.querySelector(wc(t)))&&!b._p&&(D.instance=b,D.state.loading=5),Aa.has(t)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Aa.set(t,o),b||lp(_,t,o,D.state))),n&&c===null)throw Error(Q(528,""));return D}if(n&&c!==null)throw Error(Q(529,""));return null;case"script":return n=o.async,o=o.src,typeof o=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=vu(o),o=Gs(_).hoistableScripts,c=o.get(n),c||(c={type:"script",instance:null,count:0,state:null},o.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(Q(444,t))}}function _u(t){return'href="'+Mn(t)+'"'}function wc(t){return'link[rel="stylesheet"]['+t+"]"}function Rf(t){return Ue({},t,{"data-precedence":t.precedence,precedence:null})}function lp(t,n,o,c){t.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=t.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),Xe(n,"link",o),la(n),t.head.appendChild(n))}function vu(t){return'[src="'+Mn(t)+'"]'}function Sc(t){return"script[async]"+t}function Bf(t,n,o){if(n.count++,n.instance===null)switch(n.type){case"style":var c=t.querySelector('style[data-href~="'+Mn(o.href)+'"]');if(c)return n.instance=c,la(c),c;var _=Ue({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),la(c),Xe(c,"style",_),cr(c,o.precedence,t),n.instance=c;case"stylesheet":_=_u(o.href);var b=t.querySelector(wc(_));if(b)return n.state.loading|=4,n.instance=b,la(b),b;c=Rf(o),(_=Aa.get(_))&&xu(c,_),b=(t.ownerDocument||t).createElement("link"),la(b);var D=b;return D._p=new Promise(function(N,te){D.onload=N,D.onerror=te}),Xe(b,"link",c),n.state.loading|=4,cr(b,o.precedence,t),n.instance=b;case"script":return b=vu(o.src),(_=t.querySelector(Sc(b)))?(n.instance=_,la(_),_):(c=o,(_=Aa.get(b))&&(c=Ue({},o),Bh(c,_)),t=t.ownerDocument||t,_=t.createElement("script"),la(_),Xe(_,"link",c),t.head.appendChild(_),n.instance=_);case"void":return null;default:throw Error(Q(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,cr(c,o.precedence,t));return n.instance}function cr(t,n,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=c.length?c[c.length-1]:null,b=_,D=0;D<c.length;D++){var N=c[D];if(N.dataset.precedence===n)b=N;else if(b!==_)break}b?b.parentNode.insertBefore(t,b.nextSibling):(n=o.nodeType===9?o.head:o,n.insertBefore(t,n.firstChild))}function xu(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.title==null&&(t.title=n.title)}function Bh(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.integrity==null&&(t.integrity=n.integrity)}var Oh=null;function Of(t,n,o){if(Oh===null){var c=new Map,_=Oh=new Map;_.set(o,c)}else _=Oh,c=_.get(o),c||(c=new Map,_.set(o,c));if(c.has(t))return c;for(c.set(t,null),o=o.getElementsByTagName(t),_=0;_<o.length;_++){var b=o[_];if(!(b[za]||b[st]||t==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var D=b.getAttribute(n)||"";D=t+D;var N=c.get(D);N?N.push(b):c.set(D,[b])}}return c}function Pf(t,n,o){t=t.ownerDocument||t,t.head.insertBefore(o,n==="title"?t.querySelector("head > title"):null)}function Tn(t,n,o){if(o===1||n.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return t=n.disabled,typeof n.precedence=="string"&&t==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function hr(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function Bl(t,n,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var _=_u(c.href),b=n.querySelector(wc(_));if(b){n=b._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(t.count++,t=Sr.bind(t),n.then(t,t)),o.state.loading|=4,o.instance=b,la(b);return}b=n.ownerDocument||n,c=Rf(c),(_=Aa.get(_))&&xu(c,_),b=b.createElement("link"),la(b);var D=b;D._p=new Promise(function(N,te){D.onload=N,D.onerror=te}),Xe(b,"link",c),o.instance=b}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(o,n),(n=o.state.preload)&&(o.state.loading&3)===0&&(t.count++,o=Sr.bind(t),n.addEventListener("load",o),n.addEventListener("error",o))}}var wr=0;function Ol(t,n){return t.stylesheets&&t.count===0&&Ff(t,t.stylesheets),0<t.count||0<t.imgCount?function(o){var c=setTimeout(function(){if(t.stylesheets&&Ff(t,t.stylesheets),t.unsuspend){var b=t.unsuspend;t.unsuspend=null,b()}},6e4+n);0<t.imgBytes&&wr===0&&(wr=62500*at());var _=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Ff(t,t.stylesheets),t.unsuspend)){var b=t.unsuspend;t.unsuspend=null,b()}},(t.imgBytes>wr?50:800)+n);return t.unsuspend=o,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(_)}}:null}function Sr(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ff(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Nf=null;function Ff(t,n){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Nf=new Map,n.forEach(lm,t),Nf=null,Sr.call(t))}function lm(t,n){if(!(n.state.loading&4)){var o=Nf.get(t);if(o)var c=o.get(null);else{o=new Map,Nf.set(t,o);for(var _=t.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<_.length;b++){var D=_[b];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(o.set(D.dataset.precedence,D),c=D)}c&&o.set(null,c)}_=n.instance,D=_.getAttribute("data-precedence"),b=o.get(D)||c,b===c&&o.set(null,_),o.set(D,_),this.count++,c=Sr.bind(this),_.addEventListener("load",c),_.addEventListener("error",c),b?b.parentNode.insertBefore(_,b.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(_,t.firstChild)),n.state.loading|=4}}var kd={$$typeof:bt,Provider:null,Consumer:null,_currentValue:gt,_currentValue2:gt,_threadCount:0};function um(t,n,o,c,_,b,D,N,te){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=H(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=H(0),this.hiddenUpdates=H(null),this.identifierPrefix=c,this.onUncaughtError=_,this.onCaughtError=b,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function Ep(t,n,o,c,_,b,D,N,te,be,ke,Ne){return t=new um(t,n,o,D,te,be,ke,Ne,N),n=1,b===!0&&(n|=24),b=In(3,null,null,n),t.current=b,b.stateNode=t,n=A(),n.refCount++,t.pooledCache=n,n.refCount++,b.memoizedState={element:c,isDehydrated:o,cache:n},Fi(b),t}function Ap(t){return t?(t=Es,t):Es}function zp(t,n,o,c,_,b){_=Ap(_),c.context===null?c.context=_:c.pendingContext=_,c=Qa(n),c.payload={element:o},b=b===void 0?null:b,b!==null&&(c.callback=b),o=bn(t,c,n),o!==null&&(Hn(o,t,n),yr(o,t,n))}function Mp(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<n?o:n}}function up(t,n){Mp(t,n),(t=t.alternate)&&Mp(t,n)}function Cp(t){if(t.tag===13||t.tag===31){var n=ns(t,67108864);n!==null&&Hn(n,t,67108864),up(t,67108864)}}function Dp(t){if(t.tag===13||t.tag===31){var n=or();n=Ae(n);var o=ns(t,n);o!==null&&Hn(o,t,n),up(t,n)}}var Uf=!0;function cm(t,n,o,c){var _=Se.T;Se.T=null;var b=Ye.p;try{Ye.p=2,cp(t,n,o,c)}finally{Ye.p=b,Se.T=_}}function hm(t,n,o,c){var _=Se.T;Se.T=null;var b=Ye.p;try{Ye.p=8,cp(t,n,o,c)}finally{Ye.p=b,Se.T=_}}function cp(t,n,o,c){if(Uf){var _=hp(c);if(_===null)L(t,n,c,jf,o),kp(t,c);else if(fm(_,t,n,o,c))c.stopPropagation();else if(kp(t,c),n&4&&-1<dm.indexOf(t)){for(;_!==null;){var b=ga(_);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var D=gn(b.pendingLanes);if(D!==0){var N=b;for(N.pendingLanes|=2,N.entangledLanes|=2;D;){var te=1<<31-xa(D);N.entanglements[1]|=te,D&=~te}Nr(b),(Ci&6)===0&&(_h=$t()+500,yu(0))}}break;case 31:case 13:N=ns(b,2),N!==null&&Hn(N,b,2),cc(),up(b,2)}if(b=hp(c),b===null&&L(t,n,c,jf,o),b===_)break;_=b}_!==null&&c.stopPropagation()}else L(t,n,c,null,o)}}function hp(t){return t=To(t),dp(t)}var jf=null;function dp(t){if(jf=null,t=Ki(t),t!==null){var n=$e(t);if(n===null)t=null;else{var o=n.tag;if(o===13){if(t=Fe(n),t!==null)return t;t=null}else if(o===31){if(t=f(n),t!==null)return t;t=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null)}}return jf=t,null}function Ip(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Er()){case js:return 2;case Ar:return 8;case Vs:case So:return 32;case Gr:return 268435456;default:return 32}default:return 32}}var fp=!1,bu=null,wu=null,Su=null,Ld=new Map,Rd=new Map,Tu=[],dm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function kp(t,n){switch(t){case"focusin":case"focusout":bu=null;break;case"dragenter":case"dragleave":wu=null;break;case"mouseover":case"mouseout":Su=null;break;case"pointerover":case"pointerout":Ld.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rd.delete(n.pointerId)}}function Bd(t,n,o,c,_,b){return t===null||t.nativeEvent!==b?(t={blockedOn:n,domEventName:o,eventSystemFlags:c,nativeEvent:b,targetContainers:[_]},n!==null&&(n=ga(n),n!==null&&Cp(n)),t):(t.eventSystemFlags|=c,n=t.targetContainers,_!==null&&n.indexOf(_)===-1&&n.push(_),t)}function fm(t,n,o,c,_){switch(n){case"focusin":return bu=Bd(bu,t,n,o,c,_),!0;case"dragenter":return wu=Bd(wu,t,n,o,c,_),!0;case"mouseover":return Su=Bd(Su,t,n,o,c,_),!0;case"pointerover":var b=_.pointerId;return Ld.set(b,Bd(Ld.get(b)||null,t,n,o,c,_)),!0;case"gotpointercapture":return b=_.pointerId,Rd.set(b,Bd(Rd.get(b)||null,t,n,o,c,_)),!0}return!1}function Lp(t){var n=Ki(t.target);if(n!==null){var o=$e(n);if(o!==null){if(n=o.tag,n===13){if(n=Fe(o),n!==null){t.blockedOn=n,At(t.priority,function(){Dp(o)});return}}else if(n===31){if(n=f(o),n!==null){t.blockedOn=n,At(t.priority,function(){Dp(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Vf(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var o=hp(t.nativeEvent);if(o===null){o=t.nativeEvent;var c=new o.constructor(o.type,o);Fl=c,o.target.dispatchEvent(c),Fl=null}else return n=ga(o),n!==null&&Cp(n),t.blockedOn=o,!1;n.shift()}return!0}function Rp(t,n,o){Vf(t)&&o.delete(n)}function pm(){fp=!1,bu!==null&&Vf(bu)&&(bu=null),wu!==null&&Vf(wu)&&(wu=null),Su!==null&&Vf(Su)&&(Su=null),Ld.forEach(Rp),Rd.forEach(Rp)}function qf(t,n){t.blockedOn===n&&(t.blockedOn=null,fp||(fp=!0,ne.unstable_scheduleCallback(ne.unstable_NormalPriority,pm)))}var Gf=null;function Bp(t){Gf!==t&&(Gf=t,ne.unstable_scheduleCallback(ne.unstable_NormalPriority,function(){Gf===t&&(Gf=null);for(var n=0;n<t.length;n+=3){var o=t[n],c=t[n+1],_=t[n+2];if(typeof c!="function"){if(dp(c||o)===null)continue;break}var b=ga(o);b!==null&&(t.splice(n,3),n-=3,ru(b,{pending:!0,data:_,method:o.method,action:c},c,_))}}))}function Ph(t){function n(te){return qf(te,t)}bu!==null&&qf(bu,t),wu!==null&&qf(wu,t),Su!==null&&qf(Su,t),Ld.forEach(n),Rd.forEach(n);for(var o=0;o<Tu.length;o++){var c=Tu[o];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Tu.length&&(o=Tu[0],o.blockedOn===null);)Lp(o),o.blockedOn===null&&Tu.shift();if(o=(t.ownerDocument||t).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var _=o[c],b=o[c+1],D=_[pt]||null;if(typeof b=="function")D||Bp(o);else if(D){var N=null;if(b&&b.hasAttribute("formAction")){if(_=b,D=b[pt]||null)N=D.formAction;else if(dp(_)!==null)continue}else N=D.action;typeof N=="function"?o[c+1]=N:(o.splice(c,3),c-=3),Bp(o)}}}function Op(){function t(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(D){return _=D})},focusReset:"manual",scroll:"manual"})}function n(){_!==null&&(_(),_=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,_=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),_!==null&&(_(),_=null)}}}function pp(t){this._internalRoot=t}Zf.prototype.render=pp.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(Q(409));var o=n.current,c=or();zp(o,c,t,n,null,null)},Zf.prototype.unmount=pp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;zp(t.current,2,null,t,null,null),cc(),n[Bt]=null}};function Zf(t){this._internalRoot=t}Zf.prototype.unstable_scheduleHydration=function(t){if(t){var n=Le();t={blockedOn:null,target:t,priority:n};for(var o=0;o<Tu.length&&n!==0&&n<Tu[o].priority;o++);Tu.splice(o,0,t),o===0&&Lp(t)}};var Pp=ye.version;if(Pp!=="19.2.0")throw Error(Q(527,Pp,"19.2.0"));Ye.findDOMNode=function(t){var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(Q(188)):(t=Object.keys(t).join(","),Error(Q(268,t)));return t=U(n),t=t!==null?ut(t):null,t=t===null?null:t.stateNode,t};var mm={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Se,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$f.isDisabled&&$f.supportsFiber)try{En=$f.inject(mm),di=$f}catch{}}return Pd.createRoot=function(t,n){if(!Ve(t))throw Error(Q(299));var o=!1,c="",_=af,b=nf,D=rf;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(_=n.onUncaughtError),n.onCaughtError!==void 0&&(b=n.onCaughtError),n.onRecoverableError!==void 0&&(D=n.onRecoverableError)),n=Ep(t,1,!1,null,null,o,c,null,_,b,D,Op),t[Bt]=n.current,z(t),new pp(n)},Pd.hydrateRoot=function(t,n,o){if(!Ve(t))throw Error(Q(299));var c=!1,_="",b=af,D=nf,N=rf,te=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(_=o.identifierPrefix),o.onUncaughtError!==void 0&&(b=o.onUncaughtError),o.onCaughtError!==void 0&&(D=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.formState!==void 0&&(te=o.formState)),n=Ep(t,1,!0,n,o??null,c,_,te,b,D,N,Op),n.context=Ap(null),o=n.current,c=or(),c=Ae(c),_=Qa(c),_.callback=null,bn(o,_,c),o=c,n.current.lanes=o,Y(n,o),Nr(n),t[Bt]=n.current,z(t),new Zf(n)},Pd.version="19.2.0",Pd}var Hp;function Am(){if(Hp)return yp.exports;Hp=1;function ne(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ne)}catch(ye){console.error(ye)}}return ne(),yp.exports=Em(),yp.exports}var am=Am(),Kf={exports:{}},zm=Kf.exports,Xp;function Mm(){return Xp||(Xp=1,(function(ne,ye){(function(Me,Q){ne.exports=Q()})(zm,(function(){var Me,Q,Ve;function $e(f,Oe){if(!Me)Me=Oe;else if(!Q)Q=Oe;else{var U="var sharedChunk = {}; ("+Me+")(sharedChunk); ("+Q+")(sharedChunk);",ut={};Me(ut),Ve=Oe(ut),typeof window<"u"&&(Ve.workerUrl=window.URL.createObjectURL(new Blob([U],{type:"text/javascript"})))}}$e(["exports"],(function(f){function Oe(a,e,r,l){return new(r||(r=Promise))((function(h,g){function y(E){try{S(l.next(E))}catch(z){g(z)}}function v(E){try{S(l.throw(E))}catch(z){g(z)}}function S(E){var z;E.done?h(E.value):(z=E.value,z instanceof r?z:new r((function(I){I(z)}))).then(y,v)}S((l=l.apply(a,e||[])).next())}))}function U(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}typeof SuppressedError=="function"&&SuppressedError;var ut=Ue;function Ue(a,e){this.x=a,this.y=e}Ue.prototype={clone:function(){return new Ue(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,e){return this.clone()._rotateAround(a,e)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var e=a.x-this.x,r=a.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,e){return Math.atan2(this.x*e-this.y*a,this.x*a+this.y*e)},_matMult:function(a){var e=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=e,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var e=Math.cos(a),r=Math.sin(a),l=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=l,this},_rotateAround:function(a,e){var r=Math.cos(a),l=Math.sin(a),h=e.y+l*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-l*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ue.convert=function(a){return a instanceof Ue?a:Array.isArray(a)?new Ue(a[0],a[1]):a};var pe=U(ut),ft=ct;function ct(a,e,r,l){this.cx=3*a,this.bx=3*(r-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(l-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=e,this.p2x=r,this.p2y=l}ct.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,e){if(e===void 0&&(e=1e-6),a<0)return 0;if(a>1)return 1;for(var r=a,l=0;l<8;l++){var h=this.sampleCurveX(r)-a;if(Math.abs(h)<e)return r;var g=this.sampleCurveDerivativeX(r);if(Math.abs(g)<1e-6)break;r-=h/g}var y=0,v=1;for(r=a,l=0;l<20&&(h=this.sampleCurveX(r),!(Math.abs(h-a)<e));l++)a>h?y=r:v=r,r=.5*(v-y)+y;return r},solve:function(a,e){return this.sampleCurveY(this.solveCurveX(a,e))}};var Qe=U(ft);let nt,Ge;function it(){return nt==null&&(nt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),nt}function bt(){if(Ge==null&&(Ge=!1,it())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let l=0;l<25;l++){const h=4*l;e.fillStyle=`rgb(${h},${h+1},${h+2})`,e.fillRect(l%5,Math.floor(l/5),1,1)}const r=e.getImageData(0,0,5,5).data;for(let l=0;l<100;l++)if(l%4!=3&&r[l]!==l){Ge=!0;break}}}return Ge||!1}function St(a,e,r,l){const h=new Qe(a,e,r,l);return function(g){return h.solve(g)}}const Vt=St(.25,.1,.25,1);function Dt(a,e,r){return Math.min(r,Math.max(e,a))}function Pe(a,e,r){const l=r-e,h=((a-e)%l+l)%l+e;return h===e?r:h}function Et(a,...e){for(const r of e)for(const l in r)a[l]=r[l];return a}let pi=1;function qt(a,e,r){const l={};for(const h in a)l[h]=e.call(r||this,a[h],h,a);return l}function xi(a,e,r){const l={};for(const h in a)e.call(r||this,a[h],h,a)&&(l[h]=a[h]);return l}function bi(a){return Array.isArray(a)?a.map(bi):typeof a=="object"&&a?qt(a,bi):a}const va={};function Bi(a){va[a]||(typeof console<"u"&&console.warn(a),va[a]=!0)}function Kt(a,e,r){return(r.y-a.y)*(e.x-a.x)>(e.y-a.y)*(r.x-a.x)}function Se(a){let e=0;for(let r,l,h=0,g=a.length,y=g-1;h<g;y=h++)r=a[h],l=a[y],e+=(l.x-r.x)*(r.y+l.y);return e}function Ye(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let gt=null;function Gt(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const si="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function se(a,e,r,l,h){return Oe(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const g=new VideoFrame(a,{timestamp:0});try{const y=g?.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const v=y.startsWith("BGR"),S=new Uint8ClampedArray(l*h*4);if(yield g.copyTo(S,(function(E,z,I,L,O){const P=4*Math.max(-z,0),G=(Math.max(0,I)-I)*L*4+P,X=4*L,J=Math.max(0,z),ce=Math.max(0,I);return{rect:{x:J,y:ce,width:Math.min(E.width,z+L)-J,height:Math.min(E.height,I+O)-ce},layout:[{offset:G,stride:X}]}})(a,e,r,l,h)),v)for(let E=0;E<S.length;E+=4){const z=S[E];S[E]=S[E+2],S[E+2]=z}return S}finally{g.close()}}))}let Ie,Ze,ht,kt;const Rt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(a){const e=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(a,e=0){return this.getImageCanvasContext(a).getImageData(-e,-e,a.width+2*e,a.height+2*e)},getImageCanvasContext(a){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=a.width,e.height=a.height,r.drawImage(a,0,0,a.width,a.height),r},resolveURL:a=>(ht||(ht=document.createElement("a")),ht.href=a,ht.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(kt==null&&(kt=matchMedia("(prefers-reduced-motion: reduce)")),kt.matches)}},Pt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Oi extends Error{constructor(e,r,l,h){super(`AJAXError: ${r} (${e}): ${l}`),this.status=e,this.statusText=r,this.url=l,this.body=h}}const ii=Ye()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Wi=a=>Pt.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))];function pn(a,e){const r=new AbortController,l=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:ii(),signal:r.signal});let h=!1,g=!1;return a.type==="json"&&l.headers.set("Accept","application/json"),g||fetch(l).then((y=>y.ok?(v=>{(a.type==="arrayBuffer"||a.type==="image"?v.arrayBuffer():a.type==="json"?v.json():v.text()).then((S=>{g||(h=!0,e(null,S,v.headers.get("Cache-Control"),v.headers.get("Expires")))})).catch((S=>{g||e(new Error(S.message))}))})(y):y.blob().then((v=>e(new Oi(y.status,y.statusText,a.url,v)))))).catch((y=>{y.code!==20&&e(new Error(y.message))})),{cancel:()=>{g=!0,h||r.abort()}}}const Tr=function(a,e){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){if(Ye()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,e);if(!Ye())return(Wi(a.url)||pn)(a,e)}if(!(/^file:/.test(r=a.url)||/^file:/.test(ii())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return pn(a,e);if(Ye()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,e,void 0,!0)}var r;return(function(l,h){const g=new XMLHttpRequest;g.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(g.responseType="arraybuffer");for(const y in l.headers)g.setRequestHeader(y,l.headers[y]);return l.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=l.credentials==="include",g.onerror=()=>{h(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let y=g.response;if(l.type==="json")try{y=JSON.parse(g.response)}catch(v){return h(v)}h(null,y,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else{const y=new Blob([g.response],{type:g.getResponseHeader("Content-Type")});h(new Oi(g.status,g.statusText,l.url,y))}},g.send(l.body),{cancel:()=>g.abort()}})(a,e)},wo=function(a,e){return Tr(Et(a,{type:"arrayBuffer"}),e)};function mn(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const e=new URL(a),r=window.location;return e.protocol===r.protocol&&e.host===r.host}function ps(a,e,r){r[a]&&r[a].indexOf(e)!==-1||(r[a]=r[a]||[],r[a].push(e))}function jr(a,e,r){if(r&&r[a]){const l=r[a].indexOf(e);l!==-1&&r[a].splice(l,1)}}class ms{constructor(e,r={}){Et(this,r),this.type=e}}class Vr extends ms{constructor(e,r={}){super("error",Et({error:e},r))}}class qr{on(e,r){return this._listeners=this._listeners||{},ps(e,r,this._listeners),this}off(e,r){return jr(e,r,this._listeners),jr(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},ps(e,r,this._oneTimeListeners),this):new Promise((l=>this.once(e,l)))}fire(e,r){typeof e=="string"&&(e=new ms(e,r||{}));const l=e.type;if(this.listens(l)){e.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const v of h)v.call(this,e);const g=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const v of g)jr(l,v,this._oneTimeListeners),v.call(this,e);const y=this._eventedParent;y&&(Et(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof Vr&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var Ee={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const an=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Kn(a,e){const r={};for(const l in a)l!=="ref"&&(r[l]=a[l]);return an.forEach((l=>{l in e&&(r[l]=e[l])})),r}function Pi(a,e){if(Array.isArray(a)){if(!Array.isArray(e)||a.length!==e.length)return!1;for(let r=0;r<a.length;r++)if(!Pi(a[r],e[r]))return!1;return!0}if(typeof a=="object"&&a!==null&&e!==null){if(typeof e!="object"||Object.keys(a).length!==Object.keys(e).length)return!1;for(const r in a)if(!Pi(a[r],e[r]))return!1;return!0}return a===e}const $t={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Er(a,e,r){r.push({command:$t.addSource,args:[a,e[a]]})}function js(a,e,r){e.push({command:$t.removeSource,args:[a]}),r[a]=!0}function Ar(a,e,r,l){js(a,r,l),Er(a,e,r)}function Vs(a,e,r){let l;for(l in a[r])if(Object.prototype.hasOwnProperty.call(a[r],l)&&l!=="data"&&!Pi(a[r][l],e[r][l]))return!1;for(l in e[r])if(Object.prototype.hasOwnProperty.call(e[r],l)&&l!=="data"&&!Pi(a[r][l],e[r][l]))return!1;return!0}function So(a,e,r,l,h,g){let y;for(y in e=e||{},a=a||{})Object.prototype.hasOwnProperty.call(a,y)&&(Pi(a[y],e[y])||r.push({command:g,args:[l,y,e[y],h]}));for(y in e)Object.prototype.hasOwnProperty.call(e,y)&&!Object.prototype.hasOwnProperty.call(a,y)&&(Pi(a[y],e[y])||r.push({command:g,args:[l,y,e[y],h]}))}function Gr(a){return a.id}function qs(a,e){return a[e.id]=e,a}class et{constructor(e,r,l,h){this.message=(e?`${e}: `:"")+l,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)}}function En(a,...e){for(const r of e)for(const l in r)a[l]=r[l];return a}class di extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}class An{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[l,h]of r)this.bindings[l]=h}concat(e){return new An(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const xa={kind:"null"},tt={kind:"number"},Xt={kind:"string"},Ft={kind:"boolean"},Fa={kind:"color"},Nn={kind:"object"},Ut={kind:"value"},gn={kind:"collator"},Z={kind:"formatted"},k={kind:"padding"},R={kind:"resolvedImage"},F={kind:"variableAnchorOffsetCollection"};function H(a,e){return{kind:"array",itemType:a,N:e}}function Y(a){if(a.kind==="array"){const e=Y(a.itemType);return typeof a.N=="number"?`array<${e}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${e}>`}return a.kind}const de=[xa,tt,Xt,Ft,Fa,Z,Nn,H(Ut),k,R,F];function ae(a,e){if(e.kind==="error")return null;if(a.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ae(a.itemType,e.itemType))&&(typeof a.N!="number"||a.N===e.N))return null}else{if(a.kind===e.kind)return null;if(a.kind==="value"){for(const r of de)if(!ae(r,e))return null}}return`Expected ${Y(a)} but found ${Y(e)} instead.`}function W(a,e){return e.some((r=>r.kind===a.kind))}function le(a,e){return e.some((r=>r==="null"?a===null:r==="array"?Array.isArray(a):r==="object"?a&&!Array.isArray(a)&&typeof a=="object":r===typeof a))}function Ae(a,e){return a.kind==="array"&&e.kind==="array"?a.itemType.kind===e.itemType.kind&&typeof a.N=="number":a.kind===e.kind}const Ce=.96422,Le=.82521,At=4/29,It=6/29,st=3*It*It,pt=It*It*It,Bt=Math.PI/180,mi=180/Math.PI;function Ii(a){return(a%=360)<0&&(a+=360),a}function ci([a,e,r,l]){let h,g;const y=za((.2225045*(a=ai(a))+.7168786*(e=ai(e))+.0606169*(r=ai(r)))/1);a===e&&e===r?h=g=y:(h=za((.4360747*a+.3850649*e+.1430804*r)/Ce),g=za((.0139322*a+.0971045*e+.7141733*r)/Le));const v=116*y-16;return[v<0?0:v,500*(h-y),200*(y-g),l]}function ai(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function za(a){return a>pt?Math.pow(a,1/3):a/st+At}function ki([a,e,r,l]){let h=(a+16)/116,g=isNaN(e)?h:h+e/500,y=isNaN(r)?h:h-r/200;return h=1*ga(h),g=Ce*ga(g),y=Le*ga(y),[Ki(3.1338561*g-1.6168667*h-.4906146*y),Ki(-.9787684*g+1.9161415*h+.033454*y),Ki(.0719453*g-.2289914*h+1.4052427*y),l]}function Ki(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function ga(a){return a>It?a*a*a:st*(a-At)}function nn(a){return parseInt(a.padEnd(2,a),16)/255}function Gs(a,e){return la(e?a/100:a,0,1)}function la(a,e,r){return Math.min(Math.max(e,a),r)}function Zs(a){return!a.some(Number.isNaN)}const Ec={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class hi{constructor(e,r,l,h=1,g=!0){this.r=e,this.g=r,this.b=l,this.a=h,g||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[e,r,l,h]))}static parse(e){if(e instanceof hi)return e;if(typeof e!="string")return;const r=(function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Ec[l];if(h){const[y,v,S]=h;return[y/255,v/255,S/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const y=l.length<6?1:2;let v=1;return[nn(l.slice(v,v+=y)),nn(l.slice(v,v+=y)),nn(l.slice(v,v+=y)),nn(l.slice(v,v+y)||"ff")]}if(l.startsWith("rgb")){const y=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,S,E,z,I,L,O,P,G,X,J,ce]=y,ie=[z||" ",O||" ",X].join("");if(ie==="  "||ie==="  /"||ie===",,"||ie===",,,"){const he=[E,L,G].join(""),fe=he==="%%%"?100:he===""?255:0;if(fe){const De=[la(+S/fe,0,1),la(+I/fe,0,1),la(+P/fe,0,1),J?Gs(+J,ce):1];if(Zs(De))return De}}return}}const g=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[y,v,S,E,z,I,L,O,P]=g,G=[S||" ",z||" ",L].join("");if(G==="  "||G==="  /"||G===",,"||G===",,,"){const X=[+v,la(+E,0,100),la(+I,0,100),O?Gs(+O,P):1];if(Zs(X))return(function([J,ce,ie,he]){function fe(De){const Xe=(De+J/30)%12,vt=ce*Math.min(ie,1-ie);return ie-vt*Math.max(-1,Math.min(Xe-3,9-Xe,1))}return J=Ii(J),ce/=100,ie/=100,[fe(0),fe(8),fe(4),he]})(X)}}})(e);return r?new hi(...r,!1):void 0}get rgb(){const{r:e,g:r,b:l,a:h}=this,g=h||1/0;return this.overwriteGetter("rgb",[e/g,r/g,l/g,h])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[r,l,h,g]=ci(e),y=Math.sqrt(l*l+h*h);return[Math.round(1e4*y)?Ii(Math.atan2(h,l)*mi):NaN,y,r,g]})(this.rgb))}get lab(){return this.overwriteGetter("lab",ci(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){const[e,r,l,h]=this.rgb;return`rgba(${[e,r,l].map((g=>Math.round(255*g))).join(",")},${h})`}}hi.black=new hi(0,0,0,1),hi.white=new hi(1,1,1,1),hi.transparent=new hi(0,0,0,0),hi.red=new hi(1,0,0,1);class gs{constructor(e,r,l){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Pl{constructor(e,r,l,h,g){this.text=e,this.image=r,this.scale=l,this.fontStack=h,this.textColor=g}}class Ha{constructor(e){this.sections=e}static fromString(e){return new Ha([new Pl(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof Ha?e:Ha.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class zn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof zn)return e;if(typeof e=="number")return new zn([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new zn(e)}}toString(){return JSON.stringify(this.values)}}const Nh=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class yn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof yn)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let r=0;r<e.length;r+=2){const l=e[r],h=e[r+1];if(typeof l!="string"||!Nh.has(l)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new yn(e)}}toString(){return JSON.stringify(this.values)}}class Ma{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ma({name:e,available:!1}):null}}function Qn(a,e,r,l){return typeof a=="number"&&a>=0&&a<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[a,e,r,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[a,e,r,l]:[a,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Xa(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof hi||a instanceof gs||a instanceof Ha||a instanceof zn||a instanceof yn||a instanceof Ma)return!0;if(Array.isArray(a)){for(const e of a)if(!Xa(e))return!1;return!0}if(typeof a=="object"){for(const e in a)if(!Xa(a[e]))return!1;return!0}return!1}function Qi(a){if(a===null)return xa;if(typeof a=="string")return Xt;if(typeof a=="boolean")return Ft;if(typeof a=="number")return tt;if(a instanceof hi)return Fa;if(a instanceof gs)return gn;if(a instanceof Ha)return Z;if(a instanceof zn)return k;if(a instanceof yn)return F;if(a instanceof Ma)return R;if(Array.isArray(a)){const e=a.length;let r;for(const l of a){const h=Qi(l);if(r){if(r===h)continue;r=Ut;break}r=h}return H(r||Ut,e)}return Nn}function yi(a){const e=typeof a;return a===null?"":e==="string"||e==="number"||e==="boolean"?String(a):a instanceof hi||a instanceof Ha||a instanceof zn||a instanceof yn||a instanceof Ma?a.toString():JSON.stringify(a)}class Zr{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Xa(e[1]))return r.error("invalid value");const l=e[1];let h=Qi(l);const g=r.expectedType;return h.kind!=="array"||h.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(h=g),new Zr(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ea{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const $s={string:Xt,number:tt,boolean:Ft,object:Nn};class Jn{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let l,h=1;const g=e[0];if(g==="array"){let v,S;if(e.length>2){const E=e[1];if(typeof E!="string"||!(E in $s)||E==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);v=$s[E],h++}else v=Ut;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);S=e[2],h++}l=H(v,S)}else{if(!$s[g])throw new Error(`Types doesn't contain name = ${g}`);l=$s[g]}const y=[];for(;h<e.length;h++){const v=r.parse(e[h],h,Ut);if(!v)return null;y.push(v)}return new Jn(l,y)}evaluate(e){for(let r=0;r<this.args.length;r++){const l=this.args[r].evaluate(e);if(!ae(this.type,Qi(l)))return l;if(r===this.args.length-1)throw new ea(`Expected value to be of type ${Y(this.type)}, but found ${Y(Qi(l))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Mn={"to-boolean":Ft,"to-color":Fa,"to-number":tt,"to-string":Xt};class zr{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const l=e[0];if(!Mn[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&e.length!==2)return r.error("Expected one argument.");const h=Mn[l],g=[];for(let y=1;y<e.length;y++){const v=r.parse(e[y],y,Ut);if(!v)return null;g.push(v)}return new zr(h,g)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,l;for(const h of this.args){if(r=h.evaluate(e),l=null,r instanceof hi)return r;if(typeof r=="string"){const g=e.parseColor(r);if(g)return g}else if(Array.isArray(r)&&(l=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Qn(r[0],r[1],r[2],r[3]),!l))return new hi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ea(l||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const l of this.args){r=l.evaluate(e);const h=zn.parse(r);if(h)return h}throw new ea(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const l of this.args){r=l.evaluate(e);const h=yn.parse(r);if(h)return h}throw new ea(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const l of this.args){if(r=l.evaluate(e),r===null)return 0;const h=Number(r);if(!isNaN(h))return h}throw new ea(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Ha.fromString(yi(this.args[0].evaluate(e)));case"resolvedImage":return Ma.fromString(yi(this.args[0].evaluate(e)));default:return yi(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Au=["Unknown","Point","LineString","Polygon"];class Jo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Au[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=hi.parse(e)),r}}class $r{constructor(e,r,l=[],h,g=new An,y=[]){this.registry=e,this.path=l,this.key=l.map((v=>`[${v}]`)).join(""),this.scope=g,this.errors=y,this.expectedType=h,this._isConstant=r}parse(e,r,l,h,g={}){return r?this.concat(r,l,h)._parse(e,g):this._parse(e,g)}_parse(e,r){function l(h,g,y){return y==="assert"?new Jn(g,[h]):y==="coerce"?new zr(g,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[h];if(g){let y=g.parse(e,this);if(!y)return null;if(this.expectedType){const v=this.expectedType,S=y.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||S.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(v.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(v,S))return null}else y=l(y,v,r.typeAnnotation||"coerce");else y=l(y,v,r.typeAnnotation||"coerce");else y=l(y,v,r.typeAnnotation||"coerce");else y=l(y,v,r.typeAnnotation||"assert")}if(!(y instanceof Zr)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const v=new Jo;try{y=new Zr(y.type,y.evaluate(v))}catch(S){return this.error(S.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,l){const h=typeof e=="number"?this.path.concat(e):this.path,g=l?this.scope.concat(l):this.scope;return new $r(this.registry,this._isConstant,h,r||null,g,this.errors)}error(e,...r){const l=`${this.key}${r.map((h=>`[${h}]`)).join("")}`;this.errors.push(new di(l,e))}checkSubtype(e,r){const l=ae(e,r);return l&&this.error(l),l}}class Wo{constructor(e,r,l){this.type=gn,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const l=e[1];if(typeof l!="object"||Array.isArray(l))return r.error("Collator options argument must be an object.");const h=r.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Ft);if(!h)return null;const g=r.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Ft);if(!g)return null;let y=null;return l.locale&&(y=r.parse(l.locale,1,Xt),!y)?null:new Wo(h,g,y)}evaluate(e){return new gs(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const Hr=8192;function ys(a,e){a[0]=Math.min(a[0],e[0]),a[1]=Math.min(a[1],e[1]),a[2]=Math.max(a[2],e[0]),a[3]=Math.max(a[3],e[1])}function el(a,e){return!(a[0]<=e[0]||a[2]>=e[2]||a[1]<=e[1]||a[3]>=e[3])}function zu(a,e){const r=(180+a[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(r*h*Hr),Math.round(l*h*Hr)]}function Ac(a,e,r){const l=a[0]-e[0],h=a[1]-e[1],g=a[0]-r[0],y=a[1]-r[1];return l*y-g*h==0&&l*g<=0&&h*y<=0}function tl(a,e){let r=!1;for(let y=0,v=e.length;y<v;y++){const S=e[y];for(let E=0,z=S.length;E<z-1;E++){if(Ac(a,S[E],S[E+1]))return!1;(h=S[E])[1]>(l=a)[1]!=(g=S[E+1])[1]>l[1]&&l[0]<(g[0]-h[0])*(l[1]-h[1])/(g[1]-h[1])+h[0]&&(r=!r)}}var l,h,g;return r}function Mu(a,e){for(let r=0;r<e.length;r++)if(tl(a,e[r]))return!0;return!1}function zc(a,e,r,l){const h=l[0]-r[0],g=l[1]-r[1],y=(a[0]-r[0])*g-h*(a[1]-r[1]),v=(e[0]-r[0])*g-h*(e[1]-r[1]);return y>0&&v<0||y<0&&v>0}function Nl(a,e,r){for(const E of r)for(let z=0;z<E.length-1;++z)if((v=[(y=E[z+1])[0]-(g=E[z])[0],y[1]-g[1]])[0]*(S=[(h=e)[0]-(l=a)[0],h[1]-l[1]])[1]-v[1]*S[0]!=0&&zc(l,h,g,y)&&zc(g,y,l,h))return!0;var l,h,g,y,v,S;return!1}function Mr(a,e){for(let r=0;r<a.length;++r)if(!tl(a[r],e))return!1;for(let r=0;r<a.length-1;++r)if(Nl(a[r],a[r+1],e))return!1;return!0}function Fl(a,e){for(let r=0;r<e.length;r++)if(Mr(a,e[r]))return!0;return!1}function To(a,e,r){const l=[];for(let h=0;h<a.length;h++){const g=[];for(let y=0;y<a[h].length;y++){const v=zu(a[h][y],r);ys(e,v),g.push(v)}l.push(g)}return l}function Hs(a,e,r){const l=[];for(let h=0;h<a.length;h++){const g=To(a[h],e,r);l.push(g)}return l}function Xs(a,e,r,l){if(a[0]<r[0]||a[0]>r[2]){const h=.5*l;let g=a[0]-r[0]>h?-l:r[0]-a[0]>h?l:0;g===0&&(g=a[0]-r[2]>h?-l:r[2]-a[0]>h?l:0),a[0]+=g}ys(e,a)}function Ul(a,e,r,l){const h=Math.pow(2,l.z)*Hr,g=[l.x*Hr,l.y*Hr],y=[];for(const v of a)for(const S of v){const E=[S.x+g[0],S.y+g[1]];Xs(E,e,r,h),y.push(E)}return y}function il(a,e,r,l){const h=Math.pow(2,l.z)*Hr,g=[l.x*Hr,l.y*Hr],y=[];for(const S of a){const E=[];for(const z of S){const I=[z.x+g[0],z.y+g[1]];ys(e,I),E.push(I)}y.push(E)}if(e[2]-e[0]<=h/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const S of y)for(const E of S)Xs(E,e,r,h)}var v;return y}class _s{constructor(e,r){this.type=Ft,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Xa(e[1])){const l=e[1];if(l.type==="FeatureCollection")for(let h=0;h<l.features.length;++h){const g=l.features[h].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new _s(l,l.features[h].geometry)}else if(l.type==="Feature"){const h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new _s(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new _s(l,l)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(r,l){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(l.type==="Polygon"){const v=To(l.coordinates,g,y),S=Ul(r.geometry(),h,g,y);if(!el(h,g))return!1;for(const E of S)if(!tl(E,v))return!1}if(l.type==="MultiPolygon"){const v=Hs(l.coordinates,g,y),S=Ul(r.geometry(),h,g,y);if(!el(h,g))return!1;for(const E of S)if(!Mu(E,v))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(r,l){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(l.type==="Polygon"){const v=To(l.coordinates,g,y),S=il(r.geometry(),h,g,y);if(!el(h,g))return!1;for(const E of S)if(!Mr(E,v))return!1}if(l.type==="MultiPolygon"){const v=Hs(l.coordinates,g,y),S=il(r.geometry(),h,g,y);if(!el(h,g))return!1;for(const E of S)if(!Fl(E,v))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class vs{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const l=e[1];return r.scope.has(l)?new vs(l,r.scope.get(l)):r.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Ca{constructor(e,r,l,h){this.name=e,this.type=r,this._evaluate=l,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){const l=e[0],h=Ca.definitions[l];if(!h)return r.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=y.filter((([E])=>!Array.isArray(E)||E.length===e.length-1));let S=null;for(const[E,z]of v){S=new $r(r.registry,Eo,r.path,null,r.scope);const I=[];let L=!1;for(let O=1;O<e.length;O++){const P=e[O],G=Array.isArray(E)?E[O-1]:E.type,X=S.parse(P,1+I.length,G);if(!X){L=!0;break}I.push(X)}if(!L)if(Array.isArray(E)&&E.length!==I.length)S.error(`Expected ${E.length} arguments, but found ${I.length} instead.`);else{for(let O=0;O<I.length;O++){const P=Array.isArray(E)?E[O]:E.type,G=I[O];S.concat(O+1).checkSubtype(P,G.type)}if(S.errors.length===0)return new Ca(l,g,z,I)}}if(v.length===1)r.errors.push(...S.errors);else{const E=(v.length?v:y).map((([I])=>{return L=I,Array.isArray(L)?`(${L.map(Y).join(", ")})`:`(${Y(L.type)}...)`;var L})).join(" | "),z=[];for(let I=1;I<e.length;I++){const L=r.parse(e[I],1+z.length);if(!L)return null;z.push(Y(L.type))}r.error(`Expected arguments of type ${E}, but found (${z.join(", ")}) instead.`)}return null}static register(e,r){Ca.definitions=r;for(const l in r)e[l]=Ca}}function Eo(a){if(a instanceof vs)return Eo(a.boundExpression);if(a instanceof Ca&&a.name==="error"||a instanceof Wo||a instanceof _s)return!1;const e=a instanceof zr||a instanceof Jn;let r=!0;return a.eachChild((l=>{r=e?r&&Eo(l):r&&l instanceof Zr})),!!r&&xs(a)&&Ao(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function xs(a){if(a instanceof Ca&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof _s)return!1;let e=!0;return a.eachChild((r=>{e&&!xs(r)&&(e=!1)})),e}function Wn(a){if(a instanceof Ca&&a.name==="feature-state")return!1;let e=!0;return a.eachChild((r=>{e&&!Wn(r)&&(e=!1)})),e}function Ao(a,e){if(a instanceof Ca&&e.indexOf(a.name)>=0)return!1;let r=!0;return a.eachChild((l=>{r&&!Ao(l,e)&&(r=!1)})),r}function Xr(a,e){const r=a.length-1;let l,h,g=0,y=r,v=0;for(;g<=y;)if(v=Math.floor((g+y)/2),l=a[v],h=a[v+1],l<=e){if(v===r||e<h)return v;g=v+1}else{if(!(l>e))throw new ea("Input is not a number.");y=v-1}return 0}class Yr{constructor(e,r,l){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[h,g]of l)this.labels.push(h),this.outputs.push(g)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const l=r.parse(e[1],1,tt);if(!l)return null;const h=[];let g=null;r.expectedType&&r.expectedType.kind!=="value"&&(g=r.expectedType);for(let y=1;y<e.length;y+=2){const v=y===1?-1/0:e[y],S=e[y+1],E=y,z=y+1;if(typeof v!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(h.length&&h[h.length-1][0]>=v)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const I=r.parse(S,z,g);if(!I)return null;g=g||I.type,h.push([v,I])}return new Yr(g,l,h)}evaluate(e){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(e);const h=this.input.evaluate(e);if(h<=r[0])return l[0].evaluate(e);const g=r.length;return h>=r[g-1]?l[g-1].evaluate(e):l[Xr(r,h)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Jt(a,e,r){return a+r*(e-a)}function Ys(a,e,r){return a.map(((l,h)=>Jt(l,e[h],r)))}const Cn={number:Jt,color:function(a,e,r,l="rgb"){switch(l){case"rgb":{const[h,g,y,v]=Ys(a.rgb,e.rgb,r);return new hi(h,g,y,v,!1)}case"hcl":{const[h,g,y,v]=a.hcl,[S,E,z,I]=e.hcl;let L,O;if(isNaN(h)||isNaN(S))isNaN(h)?isNaN(S)?L=NaN:(L=S,y!==1&&y!==0||(O=E)):(L=h,z!==1&&z!==0||(O=g));else{let ce=S-h;S>h&&ce>180?ce-=360:S<h&&h-S>180&&(ce+=360),L=h+r*ce}const[P,G,X,J]=(function([ce,ie,he,fe]){return ce=isNaN(ce)?0:ce*Bt,ki([he,Math.cos(ce)*ie,Math.sin(ce)*ie,fe])})([L,O??Jt(g,E,r),Jt(y,z,r),Jt(v,I,r)]);return new hi(P,G,X,J,!1)}case"lab":{const[h,g,y,v]=ki(Ys(a.lab,e.lab,r));return new hi(h,g,y,v,!1)}}},array:Ys,padding:function(a,e,r){return new zn(Ys(a.values,e.values,r))},variableAnchorOffsetCollection:function(a,e,r){const l=a.values,h=e.values;if(l.length!==h.length)throw new ea(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${e.toString()}`);const g=[];for(let y=0;y<l.length;y+=2){if(l[y]!==h[y])throw new ea(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${l[y]}, to[${y}]: ${h[y]}`);g.push(l[y]);const[v,S]=l[y+1],[E,z]=h[y+1];g.push([Jt(v,E,r),Jt(S,z,r)])}return new yn(g)}};class Gi{constructor(e,r,l,h,g){this.type=e,this.operator=r,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[y,v]of g)this.labels.push(y),this.outputs.push(v)}static interpolationFactor(e,r,l,h){let g=0;if(e.name==="exponential")g=Kr(r,e.base,l,h);else if(e.name==="linear")g=Kr(r,1,l,h);else if(e.name==="cubic-bezier"){const y=e.controlPoints;g=new Qe(y[0],y[1],y[2],y[3]).solve(Kr(r,1,l,h))}return g}static parse(e,r){let[l,h,g,...y]=e;if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const E=h[1];if(typeof E!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:E}}else{if(h[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const E=h.slice(1);if(E.length!==4||E.some((z=>typeof z!="number"||z<0||z>1)))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:E}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(g=r.parse(g,2,tt),!g)return null;const v=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=Fa:r.expectedType&&r.expectedType.kind!=="value"&&(S=r.expectedType);for(let E=0;E<y.length;E+=2){const z=y[E],I=y[E+1],L=E+3,O=E+4;if(typeof z!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(v.length&&v[v.length-1][0]>=z)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const P=r.parse(I,O,S);if(!P)return null;S=S||P.type,v.push([z,P])}return Ae(S,tt)||Ae(S,Fa)||Ae(S,k)||Ae(S,F)||Ae(S,H(tt))?new Gi(S,l,h,g,v):r.error(`Type ${Y(S)} is not interpolatable.`)}evaluate(e){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(e);const h=this.input.evaluate(e);if(h<=r[0])return l[0].evaluate(e);const g=r.length;if(h>=r[g-1])return l[g-1].evaluate(e);const y=Xr(r,h),v=Gi.interpolationFactor(this.interpolation,h,r[y],r[y+1]),S=l[y].evaluate(e),E=l[y+1].evaluate(e);switch(this.operator){case"interpolate":return Cn[this.type.kind](S,E,v);case"interpolate-hcl":return Cn.color(S,E,v,"hcl");case"interpolate-lab":return Cn.color(S,E,v,"lab")}}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Kr(a,e,r,l){const h=l-r,g=a-r;return h===0?0:e===1?g/h:(Math.pow(e,g)-1)/(Math.pow(e,h)-1)}class Ks{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let l=null;const h=r.expectedType;h&&h.kind!=="value"&&(l=h);const g=[];for(const v of e.slice(1)){const S=r.parse(v,1+g.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,g.push(S)}if(!l)throw new Error("No output type");const y=h&&g.some((v=>ae(h,v.type)));return new Ks(y?Ut:l,g)}evaluate(e){let r,l=null,h=0;for(const g of this.args)if(h++,l=g.evaluate(e),l&&l instanceof Ma&&!l.available&&(r||(r=l.name),l=null,h===this.args.length&&(l=r)),l!==null)break;return l}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}class bs{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const l=[];for(let g=1;g<e.length-1;g+=2){const y=e[g];if(typeof y!="string")return r.error(`Expected string, but found ${typeof y} instead.`,g);if(/[^a-zA-Z0-9_]/.test(y))return r.error("Variable names must contain only alphanumeric characters or '_'.",g);const v=r.parse(e[g+1],g+1);if(!v)return null;l.push([y,v])}const h=r.parse(e[e.length-1],e.length-1,r.expectedType,l);return h?new bs(l,h):null}outputDefined(){return this.result.outputDefined()}}class Cu{constructor(e,r,l){this.type=e,this.index=r,this.input=l}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=r.parse(e[1],1,tt),h=r.parse(e[2],2,H(r.expectedType||Ut));return l&&h?new Cu(h.type.itemType,l,h):null}evaluate(e){const r=this.index.evaluate(e),l=this.input.evaluate(e);if(r<0)throw new ea(`Array index out of bounds: ${r} < 0.`);if(r>=l.length)throw new ea(`Array index out of bounds: ${r} > ${l.length-1}.`);if(r!==Math.floor(r))throw new ea(`Array index must be an integer, but found ${r} instead.`);return l[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class al{constructor(e,r){this.type=Ft,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=r.parse(e[1],1,Ut),h=r.parse(e[2],2,Ut);return l&&h?W(l.type,[Ft,Xt,tt,xa,Ut])?new al(l,h):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Y(l.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!l)return!1;if(!le(r,["boolean","string","number","null"]))throw new ea(`Expected first argument to be of type boolean, string, number or null, but found ${Y(Qi(r))} instead.`);if(!le(l,["string","array"]))throw new ea(`Expected second argument to be of type array or string, but found ${Y(Qi(l))} instead.`);return l.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class zo{constructor(e,r,l){this.type=tt,this.needle=e,this.haystack=r,this.fromIndex=l}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=r.parse(e[1],1,Ut),h=r.parse(e[2],2,Ut);if(!l||!h)return null;if(!W(l.type,[Ft,Xt,tt,xa,Ut]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Y(l.type)} instead`);if(e.length===4){const g=r.parse(e[3],3,tt);return g?new zo(l,h,g):null}return new zo(l,h)}evaluate(e){const r=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!le(r,["boolean","string","number","null"]))throw new ea(`Expected first argument to be of type boolean, string, number or null, but found ${Y(Qi(r))} instead.`);if(!le(l,["string","array"]))throw new ea(`Expected second argument to be of type array or string, but found ${Y(Qi(l))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return l.indexOf(r,h)}return l.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Qs{constructor(e,r,l,h,g,y){this.inputType=e,this.type=r,this.input=l,this.cases=h,this.outputs=g,this.otherwise=y}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let l,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);const g={},y=[];for(let E=2;E<e.length-1;E+=2){let z=e[E];const I=e[E+1];Array.isArray(z)||(z=[z]);const L=r.concat(E);if(z.length===0)return L.error("Expected at least one branch label.");for(const P of z){if(typeof P!="number"&&typeof P!="string")return L.error("Branch labels must be numbers or strings.");if(typeof P=="number"&&Math.abs(P)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof P=="number"&&Math.floor(P)!==P)return L.error("Numeric branch labels must be integer values.");if(l){if(L.checkSubtype(l,Qi(P)))return null}else l=Qi(P);if(g[String(P)]!==void 0)return L.error("Branch labels must be unique.");g[String(P)]=y.length}const O=r.parse(I,E,h);if(!O)return null;h=h||O.type,y.push(O)}const v=r.parse(e[1],1,Ut);if(!v)return null;const S=r.parse(e[e.length-1],e.length-1,h);return S?v.type.kind!=="value"&&r.concat(1).checkSubtype(l,v.type)?null:new Qs(l,h,v,g,y,S):null}evaluate(e){const r=this.input.evaluate(e);return(Qi(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class Mo{constructor(e,r,l){this.type=e,this.branches=r,this.otherwise=l}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let l;r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const v=r.parse(e[y],y,Ft);if(!v)return null;const S=r.parse(e[y+1],y+1,l);if(!S)return null;h.push([v,S]),l=l||S.type}const g=r.parse(e[e.length-1],e.length-1,l);if(!g)return null;if(!l)throw new Error("Can't infer output type");return new Mo(l,h,g)}evaluate(e){for(const[r,l]of this.branches)if(r.evaluate(e))return l.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,l]of this.branches)e(r),e(l);e(this.otherwise)}outputDefined(){return this.branches.every((([e,r])=>r.outputDefined()))&&this.otherwise.outputDefined()}}class nl{constructor(e,r,l,h){this.type=e,this.input=r,this.beginIndex=l,this.endIndex=h}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=r.parse(e[1],1,Ut),h=r.parse(e[2],2,tt);if(!l||!h)return null;if(!W(l.type,[H(Ut),Xt,Ut]))return r.error(`Expected first argument to be of type array or string, but found ${Y(l.type)} instead`);if(e.length===4){const g=r.parse(e[3],3,tt);return g?new nl(l.type,l,h,g):null}return new nl(l.type,l,h)}evaluate(e){const r=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!le(r,["string","array"]))throw new ea(`Expected first argument to be of type array or string, but found ${Y(Qi(r))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return r.slice(l,h)}return r.slice(l)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Mc(a,e){return a==="=="||a==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Cc(a,e,r,l){return l.compare(e,r)===0}function Co(a,e,r){const l=a!=="=="&&a!=="!=";return class nm{constructor(g,y,v){this.type=Ft,this.lhs=g,this.rhs=y,this.collator=v,this.hasUntypedArgument=g.type.kind==="value"||y.type.kind==="value"}static parse(g,y){if(g.length!==3&&g.length!==4)return y.error("Expected two or three arguments.");const v=g[0];let S=y.parse(g[1],1,Ut);if(!S)return null;if(!Mc(v,S.type))return y.concat(1).error(`"${v}" comparisons are not supported for type '${Y(S.type)}'.`);let E=y.parse(g[2],2,Ut);if(!E)return null;if(!Mc(v,E.type))return y.concat(2).error(`"${v}" comparisons are not supported for type '${Y(E.type)}'.`);if(S.type.kind!==E.type.kind&&S.type.kind!=="value"&&E.type.kind!=="value")return y.error(`Cannot compare types '${Y(S.type)}' and '${Y(E.type)}'.`);l&&(S.type.kind==="value"&&E.type.kind!=="value"?S=new Jn(E.type,[S]):S.type.kind!=="value"&&E.type.kind==="value"&&(E=new Jn(S.type,[E])));let z=null;if(g.length===4){if(S.type.kind!=="string"&&E.type.kind!=="string"&&S.type.kind!=="value"&&E.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(z=y.parse(g[3],3,gn),!z)return null}return new nm(S,E,z)}evaluate(g){const y=this.lhs.evaluate(g),v=this.rhs.evaluate(g);if(l&&this.hasUntypedArgument){const S=Qi(y),E=Qi(v);if(S.kind!==E.kind||S.kind!=="string"&&S.kind!=="number")throw new ea(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${S.kind}, ${E.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=Qi(y),E=Qi(v);if(S.kind!=="string"||E.kind!=="string")return e(g,y,v)}return this.collator?r(g,y,v,this.collator.evaluate(g)):e(g,y,v)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const Du=Co("==",(function(a,e,r){return e===r}),Cc),Fh=Co("!=",(function(a,e,r){return e!==r}),(function(a,e,r,l){return!Cc(0,e,r,l)})),Uh=Co("<",(function(a,e,r){return e<r}),(function(a,e,r,l){return l.compare(e,r)<0})),jh=Co(">",(function(a,e,r){return e>r}),(function(a,e,r,l){return l.compare(e,r)>0})),Vh=Co("<=",(function(a,e,r){return e<=r}),(function(a,e,r,l){return l.compare(e,r)<=0})),qh=Co(">=",(function(a,e,r){return e>=r}),(function(a,e,r,l){return l.compare(e,r)>=0}));class jl{constructor(e,r,l,h,g){this.type=Xt,this.number=e,this.locale=r,this.currency=l,this.minFractionDigits=h,this.maxFractionDigits=g}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const l=r.parse(e[1],1,tt);if(!l)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");let g=null;if(h.locale&&(g=r.parse(h.locale,1,Xt),!g))return null;let y=null;if(h.currency&&(y=r.parse(h.currency,1,Xt),!y))return null;let v=null;if(h["min-fraction-digits"]&&(v=r.parse(h["min-fraction-digits"],1,tt),!v))return null;let S=null;return h["max-fraction-digits"]&&(S=r.parse(h["max-fraction-digits"],1,tt),!S)?null:new jl(l,g,y,v,S)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Vl{constructor(e){this.type=Z,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const l=e[1];if(!Array.isArray(l)&&typeof l=="object")return r.error("First argument must be an image or text section.");const h=[];let g=!1;for(let y=1;y<=e.length-1;++y){const v=e[y];if(g&&typeof v=="object"&&!Array.isArray(v)){g=!1;let S=null;if(v["font-scale"]&&(S=r.parse(v["font-scale"],1,tt),!S))return null;let E=null;if(v["text-font"]&&(E=r.parse(v["text-font"],1,H(Xt)),!E))return null;let z=null;if(v["text-color"]&&(z=r.parse(v["text-color"],1,Fa),!z))return null;const I=h[h.length-1];I.scale=S,I.font=E,I.textColor=z}else{const S=r.parse(e[y],1,Ut);if(!S)return null;const E=S.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,h.push({content:S,scale:null,font:null,textColor:null})}}return new Vl(h)}evaluate(e){return new Ha(this.sections.map((r=>{const l=r.content.evaluate(e);return Qi(l)===R?new Pl("",l,null,null,null):new Pl(yi(l),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)})))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}}class Iu{constructor(e){this.type=R,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const l=r.parse(e[1],1,Xt);return l?new Iu(l):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),l=Ma.fromString(r);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(r)>-1),l}eachChild(e){e(this.input)}outputDefined(){return!1}}class ku{constructor(e){this.type=tt,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const l=r.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${Y(l.type)} instead.`):new ku(l):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new ea(`Expected value to be of type string or array, but found ${Y(Qi(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Do={"==":Du,"!=":Fh,">":jh,"<":Uh,">=":qh,"<=":Vh,array:Jn,at:Cu,boolean:Jn,case:Mo,coalesce:Ks,collator:Wo,format:Vl,image:Iu,in:al,"index-of":zo,interpolate:Gi,"interpolate-hcl":Gi,"interpolate-lab":Gi,length:ku,let:bs,literal:Zr,match:Qs,number:Jn,"number-format":jl,object:Jn,slice:nl,step:Yr,string:Jn,"to-boolean":zr,"to-color":zr,"to-number":zr,"to-string":zr,var:vs,within:_s};function ql(a,[e,r,l,h]){e=e.evaluate(a),r=r.evaluate(a),l=l.evaluate(a);const g=h?h.evaluate(a):1,y=Qn(e,r,l,g);if(y)throw new ea(y);return new hi(e/255,r/255,l/255,g,!1)}function Dc(a,e){return a in e}function Lu(a,e){const r=e[a];return r===void 0?null:r}function Js(a){return{type:a}}function Ru(a){return{result:"success",value:a}}function ws(a){return{result:"error",value:a}}function Io(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Ic(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Bu(a){return!!a.expression&&a.expression.interpolated}function _i(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function ta(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function Gh(a){return a}function ni(a,e){const r=e.type==="color",l=a.stops&&typeof a.stops[0][0]=="object",h=l||!(l||a.property!==void 0),g=a.type||(Bu(e)?"exponential":"interval");if(r||e.type==="padding"){const z=r?hi.parse:zn.parse;(a=En({},a)).stops&&(a.stops=a.stops.map((I=>[I[0],z(I[1])]))),a.default=z(a.default?a.default:e.default)}if(a.colorSpace&&(y=a.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var y;let v,S,E;if(g==="exponential")v=rl;else if(g==="interval")v=Li;else if(g==="categorical"){v=Zi,S=Object.create(null);for(const z of a.stops)S[z[0]]=z[1];E=typeof a.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);v=Ou}if(l){const z={},I=[];for(let P=0;P<a.stops.length;P++){const G=a.stops[P],X=G[0].zoom;z[X]===void 0&&(z[X]={zoom:X,type:a.type,property:a.property,default:a.default,stops:[]},I.push(X)),z[X].stops.push([G[0].value,G[1]])}const L=[];for(const P of I)L.push([z[P].zoom,ni(z[P],e)]);const O={name:"linear"};return{kind:"composite",interpolationType:O,interpolationFactor:Gi.interpolationFactor.bind(void 0,O),zoomStops:L.map((P=>P[0])),evaluate:({zoom:P},G)=>rl({stops:L,base:a.base},e,P).evaluate(P,G)}}if(h){const z=g==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:Gi.interpolationFactor.bind(void 0,z),zoomStops:a.stops.map((I=>I[0])),evaluate:({zoom:I})=>v(a,e,I,S,E)}}return{kind:"source",evaluate(z,I){const L=I&&I.properties?I.properties[a.property]:void 0;return L===void 0?Ws(a.default,e.default):v(a,e,L,S,E)}}}function Ws(a,e,r){return a!==void 0?a:e!==void 0?e:r!==void 0?r:void 0}function Zi(a,e,r,l,h){return Ws(typeof r===h?l[r]:void 0,a.default,e.default)}function Li(a,e,r){if(_i(r)!=="number")return Ws(a.default,e.default);const l=a.stops.length;if(l===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[l-1][0])return a.stops[l-1][1];const h=Xr(a.stops.map((g=>g[0])),r);return a.stops[h][1]}function rl(a,e,r){const l=a.base!==void 0?a.base:1;if(_i(r)!=="number")return Ws(a.default,e.default);const h=a.stops.length;if(h===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[h-1][0])return a.stops[h-1][1];const g=Xr(a.stops.map((z=>z[0])),r),y=(function(z,I,L,O){const P=O-L,G=z-L;return P===0?0:I===1?G/P:(Math.pow(I,G)-1)/(Math.pow(I,P)-1)})(r,l,a.stops[g][0],a.stops[g+1][0]),v=a.stops[g][1],S=a.stops[g+1][1],E=Cn[e.type]||Gh;return typeof v.evaluate=="function"?{evaluate(...z){const I=v.evaluate.apply(void 0,z),L=S.evaluate.apply(void 0,z);if(I!==void 0&&L!==void 0)return E(I,L,y,a.colorSpace)}}:E(v,S,y,a.colorSpace)}function Ou(a,e,r){switch(e.type){case"color":r=hi.parse(r);break;case"formatted":r=Ha.fromString(r.toString());break;case"resolvedImage":r=Ma.fromString(r.toString());break;case"padding":r=zn.parse(r);break;default:_i(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0)}return Ws(r,a.default,e.default)}Ca.register(Do,{error:[{kind:"error"},[Xt],(a,[e])=>{throw new ea(e.evaluate(a))}],typeof:[Xt,[Ut],(a,[e])=>Y(Qi(e.evaluate(a)))],"to-rgba":[H(tt,4),[Fa],(a,[e])=>{const[r,l,h,g]=e.evaluate(a).rgb;return[255*r,255*l,255*h,g]}],rgb:[Fa,[tt,tt,tt],ql],rgba:[Fa,[tt,tt,tt,tt],ql],has:{type:Ft,overloads:[[[Xt],(a,[e])=>Dc(e.evaluate(a),a.properties())],[[Xt,Nn],(a,[e,r])=>Dc(e.evaluate(a),r.evaluate(a))]]},get:{type:Ut,overloads:[[[Xt],(a,[e])=>Lu(e.evaluate(a),a.properties())],[[Xt,Nn],(a,[e,r])=>Lu(e.evaluate(a),r.evaluate(a))]]},"feature-state":[Ut,[Xt],(a,[e])=>Lu(e.evaluate(a),a.featureState||{})],properties:[Nn,[],a=>a.properties()],"geometry-type":[Xt,[],a=>a.geometryType()],id:[Ut,[],a=>a.id()],zoom:[tt,[],a=>a.globals.zoom],"heatmap-density":[tt,[],a=>a.globals.heatmapDensity||0],"line-progress":[tt,[],a=>a.globals.lineProgress||0],accumulated:[Ut,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[tt,Js(tt),(a,e)=>{let r=0;for(const l of e)r+=l.evaluate(a);return r}],"*":[tt,Js(tt),(a,e)=>{let r=1;for(const l of e)r*=l.evaluate(a);return r}],"-":{type:tt,overloads:[[[tt,tt],(a,[e,r])=>e.evaluate(a)-r.evaluate(a)],[[tt],(a,[e])=>-e.evaluate(a)]]},"/":[tt,[tt,tt],(a,[e,r])=>e.evaluate(a)/r.evaluate(a)],"%":[tt,[tt,tt],(a,[e,r])=>e.evaluate(a)%r.evaluate(a)],ln2:[tt,[],()=>Math.LN2],pi:[tt,[],()=>Math.PI],e:[tt,[],()=>Math.E],"^":[tt,[tt,tt],(a,[e,r])=>Math.pow(e.evaluate(a),r.evaluate(a))],sqrt:[tt,[tt],(a,[e])=>Math.sqrt(e.evaluate(a))],log10:[tt,[tt],(a,[e])=>Math.log(e.evaluate(a))/Math.LN10],ln:[tt,[tt],(a,[e])=>Math.log(e.evaluate(a))],log2:[tt,[tt],(a,[e])=>Math.log(e.evaluate(a))/Math.LN2],sin:[tt,[tt],(a,[e])=>Math.sin(e.evaluate(a))],cos:[tt,[tt],(a,[e])=>Math.cos(e.evaluate(a))],tan:[tt,[tt],(a,[e])=>Math.tan(e.evaluate(a))],asin:[tt,[tt],(a,[e])=>Math.asin(e.evaluate(a))],acos:[tt,[tt],(a,[e])=>Math.acos(e.evaluate(a))],atan:[tt,[tt],(a,[e])=>Math.atan(e.evaluate(a))],min:[tt,Js(tt),(a,e)=>Math.min(...e.map((r=>r.evaluate(a))))],max:[tt,Js(tt),(a,e)=>Math.max(...e.map((r=>r.evaluate(a))))],abs:[tt,[tt],(a,[e])=>Math.abs(e.evaluate(a))],round:[tt,[tt],(a,[e])=>{const r=e.evaluate(a);return r<0?-Math.round(-r):Math.round(r)}],floor:[tt,[tt],(a,[e])=>Math.floor(e.evaluate(a))],ceil:[tt,[tt],(a,[e])=>Math.ceil(e.evaluate(a))],"filter-==":[Ft,[Xt,Ut],(a,[e,r])=>a.properties()[e.value]===r.value],"filter-id-==":[Ft,[Ut],(a,[e])=>a.id()===e.value],"filter-type-==":[Ft,[Xt],(a,[e])=>a.geometryType()===e.value],"filter-<":[Ft,[Xt,Ut],(a,[e,r])=>{const l=a.properties()[e.value],h=r.value;return typeof l==typeof h&&l<h}],"filter-id-<":[Ft,[Ut],(a,[e])=>{const r=a.id(),l=e.value;return typeof r==typeof l&&r<l}],"filter->":[Ft,[Xt,Ut],(a,[e,r])=>{const l=a.properties()[e.value],h=r.value;return typeof l==typeof h&&l>h}],"filter-id->":[Ft,[Ut],(a,[e])=>{const r=a.id(),l=e.value;return typeof r==typeof l&&r>l}],"filter-<=":[Ft,[Xt,Ut],(a,[e,r])=>{const l=a.properties()[e.value],h=r.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[Ft,[Ut],(a,[e])=>{const r=a.id(),l=e.value;return typeof r==typeof l&&r<=l}],"filter->=":[Ft,[Xt,Ut],(a,[e,r])=>{const l=a.properties()[e.value],h=r.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[Ft,[Ut],(a,[e])=>{const r=a.id(),l=e.value;return typeof r==typeof l&&r>=l}],"filter-has":[Ft,[Ut],(a,[e])=>e.value in a.properties()],"filter-has-id":[Ft,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Ft,[H(Xt)],(a,[e])=>e.value.indexOf(a.geometryType())>=0],"filter-id-in":[Ft,[H(Ut)],(a,[e])=>e.value.indexOf(a.id())>=0],"filter-in-small":[Ft,[Xt,H(Ut)],(a,[e,r])=>r.value.indexOf(a.properties()[e.value])>=0],"filter-in-large":[Ft,[Xt,H(Ut)],(a,[e,r])=>(function(l,h,g,y){for(;g<=y;){const v=g+y>>1;if(h[v]===l)return!0;h[v]>l?y=v-1:g=v+1}return!1})(a.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Ft,overloads:[[[Ft,Ft],(a,[e,r])=>e.evaluate(a)&&r.evaluate(a)],[Js(Ft),(a,e)=>{for(const r of e)if(!r.evaluate(a))return!1;return!0}]]},any:{type:Ft,overloads:[[[Ft,Ft],(a,[e,r])=>e.evaluate(a)||r.evaluate(a)],[Js(Ft),(a,e)=>{for(const r of e)if(r.evaluate(a))return!0;return!1}]]},"!":[Ft,[Ft],(a,[e])=>!e.evaluate(a)],"is-supported-script":[Ft,[Xt],(a,[e])=>{const r=a.globals&&a.globals.isSupportedScript;return!r||r(e.evaluate(a))}],upcase:[Xt,[Xt],(a,[e])=>e.evaluate(a).toUpperCase()],downcase:[Xt,[Xt],(a,[e])=>e.evaluate(a).toLowerCase()],concat:[Xt,Js(Ut),(a,e)=>e.map((r=>yi(r.evaluate(a)))).join("")],"resolved-locale":[Xt,[gn],(a,[e])=>e.evaluate(a).resolvedLocale()]});class Gl{constructor(e,r){var l;this.expression=e,this._warningHistory={},this._evaluator=new Jo,this._defaultValue=r?(l=r).type==="color"&&ta(l.default)?new hi(0,0,0,0):l.type==="color"?hi.parse(l.default)||null:l.type==="padding"?zn.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?yn.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,l,h,g,y){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=l,this._evaluator.canonical=h,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,r,l,h,g,y){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new ea(`Expected value to be one of ${Object.keys(this._enumValues).map((S=>JSON.stringify(S))).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function sl(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Do}function ol(a,e){const r=new $r(Do,Eo,[],e?(function(h){const g={color:Fa,string:Xt,number:tt,enum:Xt,boolean:Ft,formatted:Z,padding:k,resolvedImage:R,variableAnchorOffsetCollection:F};return h.type==="array"?H(g[h.value]||Ut,h.length):g[h.type]})(e):void 0),l=r.parse(a,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Ru(new Gl(l,e)):ws(r.errors)}class Zl{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!Wn(r.expression)}evaluateWithoutErrorHandling(e,r,l,h,g,y){return this._styleExpression.evaluateWithoutErrorHandling(e,r,l,h,g,y)}evaluate(e,r,l,h,g,y){return this._styleExpression.evaluate(e,r,l,h,g,y)}}class Qr{constructor(e,r,l,h){this.kind=e,this.zoomStops=l,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!Wn(r.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,r,l,h,g,y){return this._styleExpression.evaluateWithoutErrorHandling(e,r,l,h,g,y)}evaluate(e,r,l,h,g,y){return this._styleExpression.evaluate(e,r,l,h,g,y)}interpolationFactor(e,r,l){return this.interpolationType?Gi.interpolationFactor(this.interpolationType,e,r,l):0}}function Pu(a,e){const r=ol(a,e);if(r.result==="error")return r;const l=r.value.expression,h=xs(l);if(!h&&!Io(e))return ws([new di("","data expressions not supported")]);const g=Ao(l,["zoom"]);if(!g&&!Ic(e))return ws([new di("","zoom expressions not supported")]);const y=ul(l);return y||g?y instanceof di?ws([y]):y instanceof Gi&&!Bu(e)?ws([new di("",'"interpolate" expressions cannot be used with this property')]):Ru(y?new Qr(h?"camera":"composite",r.value,y.labels,y instanceof Gi?y.interpolation:void 0):new Zl(h?"constant":"source",r.value)):ws([new di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ll{constructor(e,r){this._parameters=e,this._specification=r,En(this,ni(this._parameters,this._specification))}static deserialize(e){return new ll(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ul(a){let e=null;if(a instanceof bs)e=ul(a.result);else if(a instanceof Ks){for(const r of a.args)if(e=ul(r),e)break}else(a instanceof Yr||a instanceof Gi)&&a.input instanceof Ca&&a.input.name==="zoom"&&(e=a);return e instanceof di||a.eachChild((r=>{const l=ul(r);l instanceof di?e=l:!e&&l?e=new di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&l&&e!==l&&(e=new di("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function ko(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const e of a.slice(1))if(!ko(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const kc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function eo(a){if(a==null)return{filter:()=>!0,needGeometry:!1};ko(a)||(a=to(a));const e=ol(a,kc);if(e.result==="error")throw new Error(e.value.map((r=>`${r.key}: ${r.message}`)).join(", "));return{filter:(r,l,h)=>e.value.evaluate(r,l,{},h),needGeometry:Lc(a)}}function cl(a,e){return a<e?-1:a>e?1:0}function Lc(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let e=1;e<a.length;e++)if(Lc(a[e]))return!0;return!1}function to(a){if(!a)return!0;const e=a[0];return a.length<=1?e!=="any":e==="=="?$l(a[1],a[2],"=="):e==="!="?io($l(a[1],a[2],"==")):e==="<"||e===">"||e==="<="||e===">="?$l(a[1],a[2],e):e==="any"?(r=a.slice(1),["any"].concat(r.map(to))):e==="all"?["all"].concat(a.slice(1).map(to)):e==="none"?["all"].concat(a.slice(1).map(to).map(io)):e==="in"?Nu(a[1],a.slice(2)):e==="!in"?io(Nu(a[1],a.slice(2))):e==="has"?Hl(a[1]):e==="!has"?io(Hl(a[1])):e!=="within"||a;var r}function $l(a,e,r){switch(a){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,a,e]}}function Nu(a,e){if(e.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((r=>typeof r!=typeof e[0]))?["filter-in-large",a,["literal",e.sort(cl)]]:["filter-in-small",a,["literal",e]]}}function Hl(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function io(a){return["!",a]}function hl(a){const e=typeof a;if(e==="number"||e==="boolean"||e==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let h="[";for(const g of a)h+=`${hl(g)},`;return`${h}]`}const r=Object.keys(a).sort();let l="{";for(let h=0;h<r.length;h++)l+=`${JSON.stringify(r[h])}:${hl(a[r[h]])},`;return`${l}}`}function dl(a){let e="";for(const r of an)e+=`/${hl(a[r])}`;return e}function Fu(a){const e=a.value;return e?[new et(a.key,e,"constants have been deprecated as of v8")]:[]}function ua(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function ao(a){if(Array.isArray(a))return a.map(ao);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const e={};for(const r in a)e[r]=ao(a[r]);return e}return ua(a)}function Dn(a){const e=a.key,r=a.value,l=a.valueSpec||{},h=a.objectElementValidators||{},g=a.style,y=a.styleSpec,v=a.validateSpec;let S=[];const E=_i(r);if(E!=="object")return[new et(e,r,`object expected, ${E} found`)];for(const z in r){const I=z.split(".")[0],L=l[I]||l["*"];let O;if(h[I])O=h[I];else if(l[I])O=v;else if(h["*"])O=h["*"];else{if(!l["*"]){S.push(new et(e,r[z],`unknown property "${z}"`));continue}O=v}S=S.concat(O({key:(e&&`${e}.`)+z,value:r[z],valueSpec:L,style:g,styleSpec:y,object:r,objectKey:z,validateSpec:v},r))}for(const z in l)h[z]||l[z].required&&l[z].default===void 0&&r[z]===void 0&&S.push(new et(e,r,`missing required property "${z}"`));return S}function Lo(a){const e=a.value,r=a.valueSpec,l=a.style,h=a.styleSpec,g=a.key,y=a.arrayElementValidator||a.validateSpec;if(_i(e)!=="array")return[new et(g,e,`array expected, ${_i(e)} found`)];if(r.length&&e.length!==r.length)return[new et(g,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new et(g,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let v={type:r.value,values:r.values};h.$version<7&&(v.function=r.function),_i(r.value)==="object"&&(v=r.value);let S=[];for(let E=0;E<e.length;E++)S=S.concat(y({array:e,arrayIndex:E,value:e[E],valueSpec:v,validateSpec:a.validateSpec,style:l,styleSpec:h,key:`${g}[${E}]`}));return S}function fl(a){const e=a.key,r=a.value,l=a.valueSpec;let h=_i(r);return h==="number"&&r!=r&&(h="NaN"),h!=="number"?[new et(e,r,`number expected, ${h} found`)]:"minimum"in l&&r<l.minimum?[new et(e,r,`${r} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&r>l.maximum?[new et(e,r,`${r} is greater than the maximum value ${l.maximum}`)]:[]}function rn(a){const e=a.valueSpec,r=ua(a.value.type);let l,h,g,y={};const v=r!=="categorical"&&a.value.property===void 0,S=!v,E=_i(a.value.stops)==="array"&&_i(a.value.stops[0])==="array"&&_i(a.value.stops[0][0])==="object",z=Dn({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(O){if(r==="identity")return[new et(O.key,O.value,'identity function may not have a "stops" property')];let P=[];const G=O.value;return P=P.concat(Lo({key:O.key,value:G,valueSpec:O.valueSpec,validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec,arrayElementValidator:I})),_i(G)==="array"&&G.length===0&&P.push(new et(O.key,G,"array must have at least one stop")),P},default:function(O){return O.validateSpec({key:O.key,value:O.value,valueSpec:e,validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec})}}});return r==="identity"&&v&&z.push(new et(a.key,a.value,'missing required property "property"')),r==="identity"||a.value.stops||z.push(new et(a.key,a.value,'missing required property "stops"')),r==="exponential"&&a.valueSpec.expression&&!Bu(a.valueSpec)&&z.push(new et(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(S&&!Io(a.valueSpec)?z.push(new et(a.key,a.value,"property functions not supported")):v&&!Ic(a.valueSpec)&&z.push(new et(a.key,a.value,"zoom functions not supported"))),r!=="categorical"&&!E||a.value.property!==void 0||z.push(new et(a.key,a.value,'"property" property is required')),z;function I(O){let P=[];const G=O.value,X=O.key;if(_i(G)!=="array")return[new et(X,G,`array expected, ${_i(G)} found`)];if(G.length!==2)return[new et(X,G,`array length 2 expected, length ${G.length} found`)];if(E){if(_i(G[0])!=="object")return[new et(X,G,`object expected, ${_i(G[0])} found`)];if(G[0].zoom===void 0)return[new et(X,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new et(X,G,"object stop key must have value")];if(g&&g>ua(G[0].zoom))return[new et(X,G[0].zoom,"stop zoom values must appear in ascending order")];ua(G[0].zoom)!==g&&(g=ua(G[0].zoom),h=void 0,y={}),P=P.concat(Dn({key:`${X}[0]`,value:G[0],valueSpec:{zoom:{}},validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec,objectElementValidators:{zoom:fl,value:L}}))}else P=P.concat(L({key:`${X}[0]`,value:G[0],validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec},G));return sl(ao(G[1]))?P.concat([new et(`${X}[1]`,G[1],"expressions are not allowed in function stops.")]):P.concat(O.validateSpec({key:`${X}[1]`,value:G[1],valueSpec:e,validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec}))}function L(O,P){const G=_i(O.value),X=ua(O.value),J=O.value!==null?O.value:P;if(l){if(G!==l)return[new et(O.key,J,`${G} stop domain type must match previous stop domain type ${l}`)]}else l=G;if(G!=="number"&&G!=="string"&&G!=="boolean")return[new et(O.key,J,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&r!=="categorical"){let ce=`number expected, ${G} found`;return Io(e)&&r===void 0&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new et(O.key,J,ce)]}return r!=="categorical"||G!=="number"||isFinite(X)&&Math.floor(X)===X?r!=="categorical"&&G==="number"&&h!==void 0&&X<h?[new et(O.key,J,"stop domain values must appear in ascending order")]:(h=X,r==="categorical"&&X in y?[new et(O.key,J,"stop domain values must be unique")]:(y[X]=!0,[])):[new et(O.key,J,`integer expected, found ${X}`)]}}function fr(a){const e=(a.expressionContext==="property"?Pu:ol)(ao(a.value),a.valueSpec);if(e.result==="error")return e.value.map((l=>new et(`${a.key}${l.key}`,a.value,l.message)));const r=e.value.expression||e.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!r.outputDefined())return[new et(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Wn(r))return[new et(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Wn(r))return[new et(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Ao(r,["zoom","feature-state"]))return[new et(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!xs(r))return[new et(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ro(a){const e=a.key,r=a.value,l=a.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(ua(r))===-1&&h.push(new et(e,r,`expected one of [${l.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(l.values).indexOf(ua(r))===-1&&h.push(new et(e,r,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(r)} found`)),h}function no(a){return ko(ao(a.value))?fr(En({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Uu(a)}function Uu(a){const e=a.value,r=a.key;if(_i(e)!=="array")return[new et(r,e,`array expected, ${_i(e)} found`)];const l=a.styleSpec;let h,g=[];if(e.length<1)return[new et(r,e,"filter array must have at least 1 element")];switch(g=g.concat(Ro({key:`${r}[0]`,value:e[0],valueSpec:l.filter_operator,style:a.style,styleSpec:a.styleSpec})),ua(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ua(e[1])==="$type"&&g.push(new et(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&g.push(new et(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=_i(e[1]),h!=="string"&&g.push(new et(`${r}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=_i(e[y]),ua(e[1])==="$type"?g=g.concat(Ro({key:`${r}[${y}]`,value:e[y],valueSpec:l.geometry_type,style:a.style,styleSpec:a.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&g.push(new et(`${r}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)g=g.concat(Uu({key:`${r}[${y}]`,value:e[y],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":h=_i(e[1]),e.length!==2?g.push(new et(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&g.push(new et(`${r}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=_i(e[1]),e.length!==2?g.push(new et(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&g.push(new et(`${r}[1]`,e[1],`object expected, ${h} found`))}return g}function ju(a,e){const r=a.key,l=a.validateSpec,h=a.style,g=a.styleSpec,y=a.value,v=a.objectKey,S=g[`${e}_${a.layerType}`];if(!S)return[];const E=v.match(/^(.*)-transition$/);if(e==="paint"&&E&&S[E[1]]&&S[E[1]].transition)return l({key:r,value:y,valueSpec:g.transition,style:h,styleSpec:g});const z=a.valueSpec||S[v];if(!z)return[new et(r,y,`unknown property "${v}"`)];let I;if(_i(y)==="string"&&Io(z)&&!z.tokens&&(I=/^{([^}]+)}$/.exec(y)))return[new et(r,y,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(I[1])} }\`.`)];const L=[];return a.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&L.push(new et(r,y,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&ta(ao(y))&&ua(y.type)==="identity"&&L.push(new et(r,y,'"text-font" does not support identity functions'))),L.concat(l({key:a.key,value:y,valueSpec:z,style:h,styleSpec:g,expressionContext:"property",propertyType:e,propertyKey:v}))}function Xl(a){return ju(a,"paint")}function Rc(a){return ju(a,"layout")}function ro(a){let e=[];const r=a.value,l=a.key,h=a.style,g=a.styleSpec;r.type||r.ref||e.push(new et(l,r,'either "type" or "ref" is required'));let y=ua(r.type);const v=ua(r.ref);if(r.id){const S=ua(r.id);for(let E=0;E<a.arrayIndex;E++){const z=h.layers[E];ua(z.id)===S&&e.push(new et(l,r.id,`duplicate layer id "${r.id}", previously used at line ${z.id.__line__}`))}}if("ref"in r){let S;["type","source","source-layer","filter","layout"].forEach((E=>{E in r&&e.push(new et(l,r[E],`"${E}" is prohibited for ref layers`))})),h.layers.forEach((E=>{ua(E.id)===v&&(S=E)})),S?S.ref?e.push(new et(l,r.ref,"ref cannot reference another ref layer")):y=ua(S.type):e.push(new et(l,r.ref,`ref layer "${v}" not found`))}else if(y!=="background")if(r.source){const S=h.sources&&h.sources[r.source],E=S&&ua(S.type);S?E==="vector"&&y==="raster"?e.push(new et(l,r.source,`layer "${r.id}" requires a raster source`)):E!=="raster-dem"&&y==="hillshade"?e.push(new et(l,r.source,`layer "${r.id}" requires a raster-dem source`)):E==="raster"&&y!=="raster"?e.push(new et(l,r.source,`layer "${r.id}" requires a vector source`)):E!=="vector"||r["source-layer"]?E==="raster-dem"&&y!=="hillshade"?e.push(new et(l,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!r.paint||!r.paint["line-gradient"]||E==="geojson"&&S.lineMetrics||e.push(new et(l,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new et(l,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new et(l,r.source,`source "${r.source}" not found`))}else e.push(new et(l,r,'missing required property "source"'));return e=e.concat(Dn({key:l,value:r,valueSpec:g.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${l}.type`,value:r.type,valueSpec:g.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:r,objectKey:"type"}),filter:no,layout:S=>Dn({layer:r,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":E=>Rc(En({layerType:y},E))}}),paint:S=>Dn({layer:r,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":E=>Xl(En({layerType:y},E))}})}})),e}function er(a){const e=a.value,r=a.key,l=_i(e);return l!=="string"?[new et(r,e,`string expected, ${l} found`)]:[]}const Jr={promoteId:function({key:a,value:e}){if(_i(e)==="string")return er({key:a,value:e});{const r=[];for(const l in e)r.push(...er({key:`${a}.${l}`,value:e[l]}));return r}}};function _n(a){const e=a.value,r=a.key,l=a.styleSpec,h=a.style,g=a.validateSpec;if(!e.type)return[new et(r,e,'"type" is required')];const y=ua(e.type);let v;switch(y){case"vector":case"raster":return v=Dn({key:r,value:e,valueSpec:l[`source_${y.replace("-","_")}`],style:a.style,styleSpec:l,objectElementValidators:Jr,validateSpec:g}),v;case"raster-dem":return v=(function(S){var E;const z=(E=S.sourceName)!==null&&E!==void 0?E:"",I=S.value,L=S.styleSpec,O=L.source_raster_dem,P=S.style;let G=[];const X=_i(I);if(I===void 0)return G;if(X!=="object")return G.push(new et("source_raster_dem",I,`object expected, ${X} found`)),G;const J=ua(I.encoding)==="custom",ce=["redFactor","greenFactor","blueFactor","baseShift"],ie=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const he in I)!J&&ce.includes(he)?G.push(new et(he,I[he],`In "${z}": "${he}" is only valid when "encoding" is set to "custom". ${ie} encoding found`)):O[he]?G=G.concat(S.validateSpec({key:he,value:I[he],valueSpec:O[he],validateSpec:S.validateSpec,style:P,styleSpec:L})):G.push(new et(he,I[he],`unknown property "${he}"`));return G})({sourceName:r,value:e,style:a.style,styleSpec:l,validateSpec:g}),v;case"geojson":if(v=Dn({key:r,value:e,valueSpec:l.source_geojson,style:h,styleSpec:l,validateSpec:g,objectElementValidators:Jr}),e.cluster)for(const S in e.clusterProperties){const[E,z]=e.clusterProperties[S],I=typeof E=="string"?[E,["accumulated"],["get",S]]:E;v.push(...fr({key:`${r}.${S}.map`,value:z,expressionContext:"cluster-map"})),v.push(...fr({key:`${r}.${S}.reduce`,value:I,expressionContext:"cluster-reduce"}))}return v;case"video":return Dn({key:r,value:e,valueSpec:l.source_video,style:h,validateSpec:g,styleSpec:l});case"image":return Dn({key:r,value:e,valueSpec:l.source_image,style:h,validateSpec:g,styleSpec:l});case"canvas":return[new et(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ro({key:`${r}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Bo(a){const e=a.value,r=a.styleSpec,l=r.light,h=a.style;let g=[];const y=_i(e);if(e===void 0)return g;if(y!=="object")return g=g.concat([new et("light",e,`object expected, ${y} found`)]),g;for(const v in e){const S=v.match(/^(.*)-transition$/);g=g.concat(S&&l[S[1]]&&l[S[1]].transition?a.validateSpec({key:v,value:e[v],valueSpec:r.transition,validateSpec:a.validateSpec,style:h,styleSpec:r}):l[v]?a.validateSpec({key:v,value:e[v],valueSpec:l[v],validateSpec:a.validateSpec,style:h,styleSpec:r}):[new et(v,e[v],`unknown property "${v}"`)])}return g}function Ss(a){const e=a.value,r=a.styleSpec,l=r.terrain,h=a.style;let g=[];const y=_i(e);if(e===void 0)return g;if(y!=="object")return g=g.concat([new et("terrain",e,`object expected, ${y} found`)]),g;for(const v in e)g=g.concat(l[v]?a.validateSpec({key:v,value:e[v],valueSpec:l[v],validateSpec:a.validateSpec,style:h,styleSpec:r}):[new et(v,e[v],`unknown property "${v}"`)]);return g}function so(a){let e=[];const r=a.value,l=a.key;if(Array.isArray(r)){const h=[],g=[];for(const y in r)r[y].id&&h.includes(r[y].id)&&e.push(new et(l,r,`all the sprites' ids must be unique, but ${r[y].id} is duplicated`)),h.push(r[y].id),r[y].url&&g.includes(r[y].url)&&e.push(new et(l,r,`all the sprites' URLs must be unique, but ${r[y].url} is duplicated`)),g.push(r[y].url),e=e.concat(Dn({key:`${l}[${y}]`,value:r[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return e}return er({key:l,value:r})}const Yl={"*":()=>[],array:Lo,boolean:function(a){const e=a.value,r=a.key,l=_i(e);return l!=="boolean"?[new et(r,e,`boolean expected, ${l} found`)]:[]},number:fl,color:function(a){const e=a.key,r=a.value,l=_i(r);return l!=="string"?[new et(e,r,`color expected, ${l} found`)]:hi.parse(String(r))?[]:[new et(e,r,`color expected, "${r}" found`)]},constants:Fu,enum:Ro,filter:no,function:rn,layer:ro,object:Dn,source:_n,light:Bo,terrain:Ss,string:er,formatted:function(a){return er(a).length===0?[]:fr(a)},resolvedImage:function(a){return er(a).length===0?[]:fr(a)},padding:function(a){const e=a.key,r=a.value;if(_i(r)==="array"){if(r.length<1||r.length>4)return[new et(e,r,`padding requires 1 to 4 values; ${r.length} values found`)];const l={type:"number"};let h=[];for(let g=0;g<r.length;g++)h=h.concat(a.validateSpec({key:`${e}[${g}]`,value:r[g],validateSpec:a.validateSpec,valueSpec:l}));return h}return fl({key:e,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const e=a.key,r=a.value,l=_i(r),h=a.styleSpec;if(l!=="array"||r.length<1||r.length%2!=0)return[new et(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let g=[];for(let y=0;y<r.length;y+=2)g=g.concat(Ro({key:`${e}[${y}]`,value:r[y],valueSpec:h.layout_symbol["text-anchor"]})),g=g.concat(Lo({key:`${e}[${y+1}]`,value:r[y+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:h}));return g},sprite:so};function Wr(a){const e=a.value,r=a.valueSpec,l=a.styleSpec;return a.validateSpec=Wr,r.expression&&ta(ua(e))?rn(a):r.expression&&sl(ao(e))?fr(a):r.type&&Yl[r.type]?Yl[r.type](a):Dn(En({},a,{valueSpec:r.type?l[r.type]:r}))}function Ts(a){const e=a.value,r=a.key,l=er(a);return l.length||(e.indexOf("{fontstack}")===-1&&l.push(new et(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&l.push(new et(r,e,'"glyphs" url must include a "{range}" token'))),l}function Fn(a,e=Ee){let r=[];return r=r.concat(Wr({key:"",value:a,valueSpec:e.$root,styleSpec:e,style:a,validateSpec:Wr,objectElementValidators:{glyphs:Ts,"*":()=>[]}})),a.constants&&(r=r.concat(Fu({key:"constants",value:a.constants}))),pl(r)}function Cr(a){return function(e){return a({...e,validateSpec:Wr})}}function pl(a){return[].concat(a).sort(((e,r)=>e.line-r.line))}function es(a){return function(...e){return pl(a.apply(this,e))}}Fn.source=es(Cr(_n)),Fn.sprite=es(Cr(so)),Fn.glyphs=es(Cr(Ts)),Fn.light=es(Cr(Bo)),Fn.terrain=es(Cr(Ss)),Fn.layer=es(Cr(ro)),Fn.filter=es(Cr(no)),Fn.paintProperty=es(Cr(Xl)),Fn.layoutProperty=es(Cr(Rc));const ts=Fn,Zh=ts.light,Kl=ts.paintProperty,Vu=ts.layoutProperty;function Oo(a,e){let r=!1;if(e&&e.length)for(const l of e)a.fire(new Vr(new Error(l.message))),r=!0;return r}class sn{constructor(e,r,l){const h=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const y=new Int32Array(this.arrayBuffer);e=y[0],this.d=(r=y[1])+2*(l=y[2]);for(let S=0;S<this.d*this.d;S++){const E=y[3+S],z=y[3+S+1];h.push(E===z?null:y.subarray(E,z))}const v=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],v),this.bboxes=y.subarray(v),this.insert=this._insertReadonly}else{this.d=r+2*l;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=l,this.scale=r/e,this.uid=0;const g=l/r*e;this.min=-g,this.max=e+g}insert(e,r,l,h,g){this._forEachCell(r,l,h,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,l,h,g,y){this.cells[g].push(y)}query(e,r,l,h,g){const y=this.min,v=this.max;if(e<=y&&r<=y&&v<=l&&v<=h&&!g)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(e,r,l,h,this._queryCell,S,{},g),S}}_queryCell(e,r,l,h,g,y,v,S){const E=this.cells[g];if(E!==null){const z=this.keys,I=this.bboxes;for(let L=0;L<E.length;L++){const O=E[L];if(v[O]===void 0){const P=4*O;(S?S(I[P+0],I[P+1],I[P+2],I[P+3]):e<=I[P+2]&&r<=I[P+3]&&l>=I[P+0]&&h>=I[P+1])?(v[O]=!0,y.push(z[O])):v[O]=!1}}}}_forEachCell(e,r,l,h,g,y,v,S){const E=this._convertToCellCoord(e),z=this._convertToCellCoord(r),I=this._convertToCellCoord(l),L=this._convertToCellCoord(h);for(let O=E;O<=I;O++)for(let P=z;P<=L;P++){const G=this.d*P+O;if((!S||S(this._convertFromCellCoord(O),this._convertFromCellCoord(P),this._convertFromCellCoord(O+1),this._convertFromCellCoord(P+1)))&&g.call(this,e,r,l,h,G,y,v,S))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,r=3+this.cells.length+1+1;let l=0;for(let y=0;y<this.cells.length;y++)l+=this.cells[y].length;const h=new Int32Array(r+l+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let g=r;for(let y=0;y<e.length;y++){const v=e[y];h[3+y]=g,h.set(v,g),g+=v.length}return h[3+e.length]=g,h.set(this.keys,g),g+=this.keys.length,h[3+e.length+1]=g,h.set(this.bboxes,g),g+=this.bboxes.length,h.buffer}static serialize(e,r){const l=e.toArrayBuffer();return r&&r.push(l),{buffer:l}}static deserialize(e){return new sn(e.buffer)}}const tr={};function rt(a,e,r={}){if(tr[a])throw new Error(`${a} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:a,writeable:!1}),tr[a]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}rt("Object",Object),rt("TransferableGridIndex",sn),rt("Color",hi),rt("Error",Error),rt("AJAXError",Oi),rt("ResolvedImage",Ma),rt("StylePropertyFunction",ll),rt("StyleExpression",Gl,{omit:["_evaluator"]}),rt("ZoomDependentExpression",Qr),rt("ZoomConstantExpression",Zl),rt("CompoundExpression",Ca,{omit:["_evaluate"]});for(const a in Do)Do[a]._classRegistryKey||rt(`Expression_${a}`,Do[a]);function is(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Dr(a,e){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob)return a;if(is(a)||Gt(a))return e&&e.push(a),a;if(ArrayBuffer.isView(a)){const r=a;return e&&e.push(r.buffer),r}if(a instanceof ImageData)return e&&e.push(a.data.buffer),a;if(Array.isArray(a)){const r=[];for(const l of a)r.push(Dr(l,e));return r}if(typeof a=="object"){const r=a.constructor,l=r._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");if(!tr[l])throw new Error(`${l} is not registered.`);const h=r.serialize?r.serialize(a,e):{};if(r.serialize){if(e&&h===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in a){if(!a.hasOwnProperty(g)||tr[l].omit.indexOf(g)>=0)continue;const y=a[g];h[g]=tr[l].shallow.indexOf(g)>=0?y:Dr(y,e)}a instanceof Error&&(h.message=a.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(h.$name=l),h}throw new Error("can't serialize object of type "+typeof a)}function as(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||is(a)||Gt(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(as);if(typeof a=="object"){const e=a.$name||"Object";if(!tr[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:r}=tr[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(a);const l=Object.create(r.prototype);for(const h of Object.keys(a)){if(h==="$name")continue;const g=a[h];l[h]=tr[e].shallow.indexOf(h)>=0?g:as(g)}return l}throw new Error("can't deserialize object of type "+typeof a)}class ml{constructor(){this.first=!0}update(e,r){const l=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=l,!0))}}const ot={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function ns(a){for(const e of a)if(Es(e.charCodeAt(0)))return!0;return!1}function Ql(a){for(const e of a)if(!Jl(e.charCodeAt(0)))return!1;return!0}function Jl(a){return!(ot.Arabic(a)||ot["Arabic Supplement"](a)||ot["Arabic Extended-A"](a)||ot["Arabic Presentation Forms-A"](a)||ot["Arabic Presentation Forms-B"](a))}function Es(a){return!(a!==746&&a!==747&&(a<4352||!(ot["Bopomofo Extended"](a)||ot.Bopomofo(a)||ot["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||ot["CJK Compatibility Ideographs"](a)||ot["CJK Compatibility"](a)||ot["CJK Radicals Supplement"](a)||ot["CJK Strokes"](a)||!(!ot["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||ot["CJK Unified Ideographs Extension A"](a)||ot["CJK Unified Ideographs"](a)||ot["Enclosed CJK Letters and Months"](a)||ot["Hangul Compatibility Jamo"](a)||ot["Hangul Jamo Extended-A"](a)||ot["Hangul Jamo Extended-B"](a)||ot["Hangul Jamo"](a)||ot["Hangul Syllables"](a)||ot.Hiragana(a)||ot["Ideographic Description Characters"](a)||ot.Kanbun(a)||ot["Kangxi Radicals"](a)||ot["Katakana Phonetic Extensions"](a)||ot.Katakana(a)&&a!==12540||!(!ot["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!ot["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||ot["Unified Canadian Aboriginal Syllabics"](a)||ot["Unified Canadian Aboriginal Syllabics Extended"](a)||ot["Vertical Forms"](a)||ot["Yijing Hexagram Symbols"](a)||ot["Yi Syllables"](a)||ot["Yi Radicals"](a))))}function Bc(a){return!(Es(a)||(function(e){return!!(ot["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||ot["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||ot["Letterlike Symbols"](e)||ot["Number Forms"](e)||ot["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||ot["Control Pictures"](e)&&e!==9251||ot["Optical Character Recognition"](e)||ot["Enclosed Alphanumerics"](e)||ot["Geometric Shapes"](e)||ot["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||ot["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ot["CJK Symbols and Punctuation"](e)||ot.Katakana(e)||ot["Private Use Area"](e)||ot["CJK Compatibility Forms"](e)||ot["Small Form Variants"](e)||ot["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)})(a))}function In(a){return a>=1424&&a<=2303||ot["Arabic Presentation Forms-A"](a)||ot["Arabic Presentation Forms-B"](a)}function Wl(a,e){return!(!e&&In(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||ot.Khmer(a))}function rs(a){for(const e of a)if(In(e.charCodeAt(0)))return!0;return!1}const eu="deferred",Po="loading",ss="loaded";let gl=null,vn="unavailable",Ir=null;const No=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(vn="error"),gl&&gl(a)};function kn(){kr.fire(new ms("pluginStateChange",{pluginStatus:vn,pluginURL:Ir}))}const kr=new qr,As=function(){return vn},yl=function(){if(vn!==eu||!Ir)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");vn=Po,kn(),Ir&&wo({url:Ir},(a=>{a?No(a):(vn=ss,kn())}))},Ya={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>vn===ss||Ya.applyArabicShaping!=null,isLoading:()=>vn===Po,setState(a){if(!Ye())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");vn=a.pluginStatus,Ir=a.pluginURL},isParsed(){if(!Ye())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Ya.applyArabicShaping!=null&&Ya.processBidirectionalText!=null&&Ya.processStyledBidirectionalText!=null},getPluginURL(){if(!Ye())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ir}};class oi{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ml,this.transition={})}isSupportedScript(e){return(function(r,l){for(const h of r)if(!Wl(h.charCodeAt(0),l))return!1;return!0})(e,Ya.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,r=e-Math.floor(e),l=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*r}}}class xn{constructor(e,r){this.property=e,this.value=r,this.expression=(function(l,h){if(ta(l))return new ll(l,h);if(sl(l)){const g=Pu(l,h);if(g.result==="error")throw new Error(g.value.map((y=>`${y.key}: ${y.message}`)).join(", "));return g.value}{let g=l;return h.type==="color"&&typeof l=="string"?g=hi.parse(l):h.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(g=yn.parse(l)):g=zn.parse(l),{kind:"constant",evaluate:()=>g}}})(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,l){return this.property.possiblyEvaluate(this,e,r,l)}}class Lr{constructor(e){this.property=e,this.value=new xn(e,void 0)}transitioned(e,r){return new mr(this.property,this.value,r,Et({},e.transition,this.transition),e.now)}untransitioned(){return new mr(this.property,this.value,null,{},0)}}class pr{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return bi(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Lr(this._values[e].property)),this._values[e].value=new xn(this._values[e].property,r===null?void 0:bi(r))}getTransition(e){return bi(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Lr(this._values[e].property)),this._values[e].transition=bi(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(e[r]=l);const h=this.getTransition(r);h!==void 0&&(e[`${r}-transition`]=h)}return e}transitioned(e,r){const l=new Rr(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(e,r._values[h]);return l}untransitioned(){const e=new Rr(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class mr{constructor(e,r,l,h,g){this.property=e,this.value=r,this.begin=g+h.delay||0,this.end=this.begin+h.duration||0,e.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(e,r,l){const h=e.now||0,g=this.value.possiblyEvaluate(e,r,l),y=this.prior;if(y){if(h>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(h<this.begin)return y.possiblyEvaluate(e,r,l);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,r,l),g,(function(S){if(S<=0)return 0;if(S>=1)return 1;const E=S*S,z=E*S;return 4*(S<.5?z:3*(S-E)+z-.75)})(v))}}return g}}class Rr{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,l){const h=new Fo(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(e,r,l);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Oc{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return bi(this._values[e].value)}setValue(e,r){this._values[e]=new xn(this._values[e].property,r===null?void 0:bi(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(e[r]=l)}return e}possiblyEvaluate(e,r,l){const h=new Fo(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(e,r,l);return h}}class Ka{constructor(e,r,l){this.property=e,this.value=r,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,l,h){return this.property.evaluate(this.value,this.parameters,e,r,l,h)}}class Fo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class wt{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,l){const h=Cn[this.specification.type];return h?h(e,r,l):e}}class mt{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,l,h){return new Ka(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},l,h)}:e.expression,r)}interpolate(e,r,l){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new Ka(this,{kind:"constant",value:void 0},e.parameters);const h=Cn[this.specification.type];if(h){const g=h(e.value.value,r.value.value,l);return new Ka(this,{kind:"constant",value:g},e.parameters)}return e}evaluate(e,r,l,h,g,y){return e.kind==="constant"?e.value:e.evaluate(r,l,h,g,y)}}class Ri extends mt{possiblyEvaluate(e,r,l,h){if(e.value===void 0)return new Ka(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){const g=e.expression.evaluate(r,null,{},l,h),y=e.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,v=this._calculate(y,y,y,r);return new Ka(this,{kind:"constant",value:v},r)}if(e.expression.kind==="camera"){const g=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new Ka(this,{kind:"constant",value:g},r)}return new Ka(this,e.expression,r)}evaluate(e,r,l,h,g,y){if(e.kind==="source"){const v=e.evaluate(r,l,h,g,y);return this._calculate(v,v,v,r)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},l,h),e.evaluate({zoom:Math.floor(r.zoom)},l,h),e.evaluate({zoom:Math.floor(r.zoom)+1},l,h),r):e.value}_calculate(e,r,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:l,to:r}}interpolate(e){return e}}class li{constructor(e){this.specification=e}possiblyEvaluate(e,r,l,h){if(e.value!==void 0){if(e.expression.kind==="constant"){const g=e.expression.evaluate(r,null,{},l,h);return this._calculate(g,g,g,r)}return this._calculate(e.expression.evaluate(new oi(Math.floor(r.zoom-1),r)),e.expression.evaluate(new oi(Math.floor(r.zoom),r)),e.expression.evaluate(new oi(Math.floor(r.zoom+1),r)),r)}}_calculate(e,r,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:l,to:r}}interpolate(e){return e}}class Br{constructor(e){this.specification=e}possiblyEvaluate(e,r,l,h){return!!e.expression.evaluate(r,null,{},l,h)}interpolate(){return!1}}class wi{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in e){const l=e[r];l.specification.overridable&&this.overridableProperties.push(r);const h=this.defaultPropertyValues[r]=new xn(l,void 0),g=this.defaultTransitionablePropertyValues[r]=new Lr(l);this.defaultTransitioningPropertyValues[r]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}}}rt("DataDrivenProperty",mt),rt("DataConstantProperty",wt),rt("CrossFadedDataDrivenProperty",Ri),rt("CrossFadedProperty",li),rt("ColorRampProperty",Br);const _l="-transition";class ka extends qr{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new Oc(r.layout)),r.paint)){this._transitionablePaint=new pr(r.paint);for(const l in e.paint)this.setPaintProperty(l,e.paint[l],{validate:!1});for(const l in e.layout)this.setLayoutProperty(l,e.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fo(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,l={}){r!=null&&this._validate(Vu,`layers.${this.id}.layout.${e}`,e,r,l)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return e.endsWith(_l)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,l={}){if(r!=null&&this._validate(Kl,`layers.${this.id}.paint.${e}`,e,r,l))return!1;if(e.endsWith(_l))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const h=this._transitionablePaint._values[e],g=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const S=this._transitionablePaint._values[e].value;return S.isDataDriven()||y||g||this._handleOverridablePaintPropertyUpdate(e,v,S)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,l){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),xi(e,((r,l)=>!(r===void 0||l==="layout"&&!Object.keys(r).length||l==="paint"&&!Object.keys(r).length)))}_validate(e,r,l,h,g={}){return(!g||g.validate!==!1)&&Oo(this,e.call(ts,{key:r,layerType:this.type,objectKey:l,value:h,styleSpec:Ee,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof Ka&&Io(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const qu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class zs{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ni{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function zi(a,e=1){let r=0,l=0;return{members:a.map((h=>{const g=qu[h.type].BYTES_PER_ELEMENT,y=r=Ms(r,Math.max(e,g)),v=h.components||1;return l=Math.max(l,g),r+=g*v,{name:h.name,type:h.type,components:v,offset:y}})),size:Ms(r,Math.max(l,e)),alignment:e}}function Ms(a,e){return Math.ceil(a/e)*e}class os extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const l=this.length;return this.resize(l+1),this.emplace(l,e,r)}emplace(e,r,l){const h=2*e;return this.int16[h+0]=r,this.int16[h+1]=l,e}}os.prototype.bytesPerElement=4,rt("StructArrayLayout2i4",os);class oo extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,l)}emplace(e,r,l,h){const g=3*e;return this.int16[g+0]=r,this.int16[g+1]=l,this.int16[g+2]=h,e}}oo.prototype.bytesPerElement=6,rt("StructArrayLayout3i6",oo);class Un extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,l,h)}emplace(e,r,l,h,g){const y=4*e;return this.int16[y+0]=r,this.int16[y+1]=l,this.int16[y+2]=h,this.int16[y+3]=g,e}}Un.prototype.bytesPerElement=8,rt("StructArrayLayout4i8",Un);class gr extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,h,g,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,l,h,g,y)}emplace(e,r,l,h,g,y,v){const S=6*e;return this.int16[S+0]=r,this.int16[S+1]=l,this.int16[S+2]=h,this.int16[S+3]=g,this.int16[S+4]=y,this.int16[S+5]=v,e}}gr.prototype.bytesPerElement=12,rt("StructArrayLayout2i4i12",gr);class Or extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,h,g,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,l,h,g,y)}emplace(e,r,l,h,g,y,v){const S=4*e,E=8*e;return this.int16[S+0]=r,this.int16[S+1]=l,this.uint8[E+4]=h,this.uint8[E+5]=g,this.uint8[E+6]=y,this.uint8[E+7]=v,e}}Or.prototype.bytesPerElement=8,rt("StructArrayLayout2i4ub8",Or);class Ln extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const l=this.length;return this.resize(l+1),this.emplace(l,e,r)}emplace(e,r,l){const h=2*e;return this.float32[h+0]=r,this.float32[h+1]=l,e}}Ln.prototype.bytesPerElement=8,rt("StructArrayLayout2f8",Ln);class vl extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l,h,g,y,v,S,E,z){const I=this.length;return this.resize(I+1),this.emplace(I,e,r,l,h,g,y,v,S,E,z)}emplace(e,r,l,h,g,y,v,S,E,z,I){const L=10*e;return this.uint16[L+0]=r,this.uint16[L+1]=l,this.uint16[L+2]=h,this.uint16[L+3]=g,this.uint16[L+4]=y,this.uint16[L+5]=v,this.uint16[L+6]=S,this.uint16[L+7]=E,this.uint16[L+8]=z,this.uint16[L+9]=I,e}}vl.prototype.bytesPerElement=20,rt("StructArrayLayout10ui20",vl);class xl extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l,h,g,y,v,S,E,z,I,L){const O=this.length;return this.resize(O+1),this.emplace(O,e,r,l,h,g,y,v,S,E,z,I,L)}emplace(e,r,l,h,g,y,v,S,E,z,I,L,O){const P=12*e;return this.int16[P+0]=r,this.int16[P+1]=l,this.int16[P+2]=h,this.int16[P+3]=g,this.uint16[P+4]=y,this.uint16[P+5]=v,this.uint16[P+6]=S,this.uint16[P+7]=E,this.int16[P+8]=z,this.int16[P+9]=I,this.int16[P+10]=L,this.int16[P+11]=O,e}}xl.prototype.bytesPerElement=24,rt("StructArrayLayout4i4ui4i24",xl);class ri extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,l)}emplace(e,r,l,h){const g=3*e;return this.float32[g+0]=r,this.float32[g+1]=l,this.float32[g+2]=h,e}}ri.prototype.bytesPerElement=12,rt("StructArrayLayout3f12",ri);class p extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}p.prototype.bytesPerElement=4,rt("StructArrayLayout1ul4",p);class i extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l,h,g,y,v,S,E){const z=this.length;return this.resize(z+1),this.emplace(z,e,r,l,h,g,y,v,S,E)}emplace(e,r,l,h,g,y,v,S,E,z){const I=10*e,L=5*e;return this.int16[I+0]=r,this.int16[I+1]=l,this.int16[I+2]=h,this.int16[I+3]=g,this.int16[I+4]=y,this.int16[I+5]=v,this.uint32[L+3]=S,this.uint16[I+8]=E,this.uint16[I+9]=z,e}}i.prototype.bytesPerElement=20,rt("StructArrayLayout6i1ul2ui20",i);class s extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,h,g,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,l,h,g,y)}emplace(e,r,l,h,g,y,v){const S=6*e;return this.int16[S+0]=r,this.int16[S+1]=l,this.int16[S+2]=h,this.int16[S+3]=g,this.int16[S+4]=y,this.int16[S+5]=v,e}}s.prototype.bytesPerElement=12,rt("StructArrayLayout2i2i2i12",s);class u extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,h,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,r,l,h,g)}emplace(e,r,l,h,g,y){const v=4*e,S=8*e;return this.float32[v+0]=r,this.float32[v+1]=l,this.float32[v+2]=h,this.int16[S+6]=g,this.int16[S+7]=y,e}}u.prototype.bytesPerElement=16,rt("StructArrayLayout2f1f2i16",u);class d extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,l,h)}emplace(e,r,l,h,g){const y=12*e,v=3*e;return this.uint8[y+0]=r,this.uint8[y+1]=l,this.float32[v+1]=h,this.float32[v+2]=g,e}}d.prototype.bytesPerElement=12,rt("StructArrayLayout2ub2f12",d);class m extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,l)}emplace(e,r,l,h){const g=3*e;return this.uint16[g+0]=r,this.uint16[g+1]=l,this.uint16[g+2]=h,e}}m.prototype.bytesPerElement=6,rt("StructArrayLayout3ui6",m);class x extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l,h,g,y,v,S,E,z,I,L,O,P,G,X,J){const ce=this.length;return this.resize(ce+1),this.emplace(ce,e,r,l,h,g,y,v,S,E,z,I,L,O,P,G,X,J)}emplace(e,r,l,h,g,y,v,S,E,z,I,L,O,P,G,X,J,ce){const ie=24*e,he=12*e,fe=48*e;return this.int16[ie+0]=r,this.int16[ie+1]=l,this.uint16[ie+2]=h,this.uint16[ie+3]=g,this.uint32[he+2]=y,this.uint32[he+3]=v,this.uint32[he+4]=S,this.uint16[ie+10]=E,this.uint16[ie+11]=z,this.uint16[ie+12]=I,this.float32[he+7]=L,this.float32[he+8]=O,this.uint8[fe+36]=P,this.uint8[fe+37]=G,this.uint8[fe+38]=X,this.uint32[he+10]=J,this.int16[ie+22]=ce,e}}x.prototype.bytesPerElement=48,rt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",x);class w extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l,h,g,y,v,S,E,z,I,L,O,P,G,X,J,ce,ie,he,fe,De,Xe,vt,lt,at,Ke,dt){const We=this.length;return this.resize(We+1),this.emplace(We,e,r,l,h,g,y,v,S,E,z,I,L,O,P,G,X,J,ce,ie,he,fe,De,Xe,vt,lt,at,Ke,dt)}emplace(e,r,l,h,g,y,v,S,E,z,I,L,O,P,G,X,J,ce,ie,he,fe,De,Xe,vt,lt,at,Ke,dt,We){const qe=32*e,zt=16*e;return this.int16[qe+0]=r,this.int16[qe+1]=l,this.int16[qe+2]=h,this.int16[qe+3]=g,this.int16[qe+4]=y,this.int16[qe+5]=v,this.int16[qe+6]=S,this.int16[qe+7]=E,this.uint16[qe+8]=z,this.uint16[qe+9]=I,this.uint16[qe+10]=L,this.uint16[qe+11]=O,this.uint16[qe+12]=P,this.uint16[qe+13]=G,this.uint16[qe+14]=X,this.uint16[qe+15]=J,this.uint16[qe+16]=ce,this.uint16[qe+17]=ie,this.uint16[qe+18]=he,this.uint16[qe+19]=fe,this.uint16[qe+20]=De,this.uint16[qe+21]=Xe,this.uint16[qe+22]=vt,this.uint32[zt+12]=lt,this.float32[zt+13]=at,this.float32[zt+14]=Ke,this.uint16[qe+30]=dt,this.uint16[qe+31]=We,e}}w.prototype.bytesPerElement=64,rt("StructArrayLayout8i15ui1ul2f2ui64",w);class T extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}T.prototype.bytesPerElement=4,rt("StructArrayLayout1f4",T);class A extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,l)}emplace(e,r,l,h){const g=3*e;return this.uint16[6*e+0]=r,this.float32[g+1]=l,this.float32[g+2]=h,e}}A.prototype.bytesPerElement=12,rt("StructArrayLayout1ui2f12",A);class M extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,l)}emplace(e,r,l,h){const g=4*e;return this.uint32[2*e+0]=r,this.uint16[g+2]=l,this.uint16[g+3]=h,e}}M.prototype.bytesPerElement=8,rt("StructArrayLayout1ul2ui8",M);class C extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const l=this.length;return this.resize(l+1),this.emplace(l,e,r)}emplace(e,r,l){const h=2*e;return this.uint16[h+0]=r,this.uint16[h+1]=l,e}}C.prototype.bytesPerElement=4,rt("StructArrayLayout2ui4",C);class B extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}B.prototype.bytesPerElement=2,rt("StructArrayLayout1ui2",B);class q extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,l,h)}emplace(e,r,l,h,g){const y=4*e;return this.float32[y+0]=r,this.float32[y+1]=l,this.float32[y+2]=h,this.float32[y+3]=g,e}}q.prototype.bytesPerElement=16,rt("StructArrayLayout4f16",q);class V extends zs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new pe(this.anchorPointX,this.anchorPointY)}}V.prototype.size=20;class $ extends i{get(e){return new V(this,e)}}rt("CollisionBoxArray",$);class j extends zs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}j.prototype.size=48;class re extends x{get(e){return new j(this,e)}}rt("PlacedSymbolArray",re);class ge extends zs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ge.prototype.size=64;class K extends w{get(e){return new ge(this,e)}}rt("SymbolInstanceArray",K);class oe extends T{getoffsetX(e){return this.float32[1*e+0]}}rt("GlyphOffsetArray",oe);class _e extends oo{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}rt("SymbolLineVertexArray",_e);class xe extends zs{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}xe.prototype.size=12;class ze extends A{get(e){return new xe(this,e)}}rt("TextAnchorOffsetArray",ze);class je extends zs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}je.prototype.size=8;class Re extends M{get(e){return new je(this,e)}}rt("FeatureIndexArray",Re);class He extends os{}class yt extends os{}class Wt extends os{}class Je extends gr{}class Tt extends Or{}class _t extends Ln{}class Ai extends vl{}class Ht extends xl{}class jt extends ri{}class Qt extends p{}class $i extends s{}class Mi extends d{}class Ua extends m{}class Ji extends C{}const ya=zi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Da}=ya;class Fi{constructor(e=[]){this.segments=e}prepareSegment(e,r,l,h){let g=this.segments[this.segments.length-1];return e>Fi.MAX_VERTEX_ARRAY_LENGTH&&Bi(`Max vertices per segment is ${Fi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!g||g.vertexLength+e>Fi.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==h)&&(g={vertexOffset:r.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},h!==void 0&&(g.sortKey=h),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,l,h){return new Fi([{vertexOffset:e,primitiveOffset:r,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}function ir(a,e){return 256*(a=Dt(Math.floor(a),0,255))+Dt(Math.floor(e),0,255)}Fi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,rt("SegmentVector",Fi);const Qa=zi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var bn={exports:{}},yr={exports:{}};yr.exports=function(a,e){var r,l,h,g,y,v,S,E;for(l=a.length-(r=3&a.length),h=e,y=3432918353,v=461845907,E=0;E<l;)S=255&a.charCodeAt(E)|(255&a.charCodeAt(++E))<<8|(255&a.charCodeAt(++E))<<16|(255&a.charCodeAt(++E))<<24,++E,h=27492+(65535&(g=5*(65535&(h=(h^=S=(65535&(S=(S=(65535&S)*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*v+(((S>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(S=0,r){case 3:S^=(255&a.charCodeAt(E+2))<<16;case 2:S^=(255&a.charCodeAt(E+1))<<8;case 1:h^=S=(65535&(S=(S=(65535&(S^=255&a.charCodeAt(E)))*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*v+(((S>>>16)*v&65535)<<16)&4294967295}return h^=a.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var Cs=yr.exports,ja={exports:{}};ja.exports=function(a,e){for(var r,l=a.length,h=e^l,g=0;l>=4;)r=1540483477*(65535&(r=255&a.charCodeAt(g)|(255&a.charCodeAt(++g))<<8|(255&a.charCodeAt(++g))<<16|(255&a.charCodeAt(++g))<<24))+((1540483477*(r>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),l-=4,++g;switch(l){case 3:h^=(255&a.charCodeAt(g+2))<<16;case 2:h^=(255&a.charCodeAt(g+1))<<8;case 1:h=1540483477*(65535&(h^=255&a.charCodeAt(g)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var ba=Cs,La=ja.exports;bn.exports=ba,bn.exports.murmur3=ba,bn.exports.murmur2=La;var Ds=U(bn.exports);class ca{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,l,h){this.ids.push(ia(e)),this.positions.push(r,l,h)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=ia(e);let l=0,h=this.ids.length-1;for(;l<h;){const y=l+h>>1;this.ids[y]>=r?h=y:l=y+1}const g=[];for(;this.ids[l]===r;)g.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return g}static serialize(e,r){const l=new Float64Array(e.ids),h=new Uint32Array(e.positions);return Ja(l,h,0,l.length-1),r&&r.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(e){const r=new ca;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function ia(a){const e=+a;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Ds(String(a))}function Ja(a,e,r,l){for(;r<l;){const h=a[r+l>>1];let g=r-1,y=l+1;for(;;){do g++;while(a[g]<h);do y--;while(a[y]>h);if(g>=y)break;ha(a,g,y),ha(e,3*g,3*y),ha(e,3*g+1,3*y+1),ha(e,3*g+2,3*y+2)}y-r<l-y?(Ja(a,e,r,y),r=y+1):(Ja(a,e,y+1,l),l=y)}}function ha(a,e,r){const l=a[e];a[e]=a[r],a[r]=l}rt("FeaturePositionMap",ca);class ls{constructor(e,r){this.gl=e.gl,this.location=r}}class Uo extends ls{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Rn extends ls{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class jn extends ls{constructor(e,r){super(e,r),this.current=hi.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Is=new Float32Array(16);function bl(a){return[ir(255*a.r,255*a.g),ir(255*a.b,255*a.a)]}class _r{constructor(e,r,l){this.value=e,this.uniformNames=r.map((h=>`u_${h}`)),this.type=l}setUniform(e,r,l){e.set(l.constantOr(this.value))}getBinding(e,r,l){return this.type==="color"?new jn(e,r):new Uo(e,r)}}class Bn{constructor(e,r){this.uniformNames=r.map((l=>`u_${l}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,l,h){const g=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&e.set(g)}getBinding(e,r,l){return l.substr(0,9)==="u_pattern"?new Rn(e,r):new Uo(e,r)}}class _a{constructor(e,r,l,h){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=r.map((g=>({name:`a_${g}`,type:"Float32",components:l==="color"?2:1,offset:0}))),this.paintVertexArray=new h}populatePaintArray(e,r,l,h,g){const y=this.paintVertexArray.length,v=this.expression.evaluate(new oi(0),r,{},h,[],g);this.paintVertexArray.resize(e),this._setPaintValue(y,e,v)}updatePaintArray(e,r,l,h){const g=this.expression.evaluate({zoom:0},l,h);this._setPaintValue(e,r,g)}_setPaintValue(e,r,l){if(this.type==="color"){const h=bl(l);for(let g=e;g<r;g++)this.paintVertexArray.emplace(g,h[0],h[1])}else{for(let h=e;h<r;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Si{constructor(e,r,l,h,g,y){this.expression=e,this.uniformNames=r.map((v=>`u_${v}_t`)),this.type=l,this.useIntegerZoom=h,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=r.map((v=>({name:`a_${v}`,type:"Float32",components:l==="color"?4:2,offset:0}))),this.paintVertexArray=new y}populatePaintArray(e,r,l,h,g){const y=this.expression.evaluate(new oi(this.zoom),r,{},h,[],g),v=this.expression.evaluate(new oi(this.zoom+1),r,{},h,[],g),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,y,v)}updatePaintArray(e,r,l,h){const g=this.expression.evaluate({zoom:this.zoom},l,h),y=this.expression.evaluate({zoom:this.zoom+1},l,h);this._setPaintValue(e,r,g,y)}_setPaintValue(e,r,l,h){if(this.type==="color"){const g=bl(l),y=bl(h);for(let v=e;v<r;v++)this.paintVertexArray.emplace(v,g[0],g[1],y[0],y[1])}else{for(let g=e;g<r;g++)this.paintVertexArray.emplace(g,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){const l=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,h=Dt(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,r,l){return new Uo(e,r)}}class Vn{constructor(e,r,l,h,g,y){this.expression=e,this.type=r,this.useIntegerZoom=l,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(e,r,l){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,r.patterns&&r.patterns[this.layerId],l)}updatePaintArray(e,r,l,h,g){this._setPaintValues(e,r,l.patterns&&l.patterns[this.layerId],g)}_setPaintValues(e,r,l,h){if(!h||!l)return;const{min:g,mid:y,max:v}=l,S=h[g],E=h[y],z=h[v];if(S&&E&&z)for(let I=e;I<r;I++)this.zoomInPaintVertexArray.emplace(I,E.tl[0],E.tl[1],E.br[0],E.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],E.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(I,E.tl[0],E.tl[1],E.br[0],E.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],E.pixelRatio,z.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Qa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Qa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class vr{constructor(e,r,l){this.binders={},this._buffers=[];const h=[];for(const g in e.paint._values){if(!l(g))continue;const y=e.paint.get(g);if(!(y instanceof Ka&&Io(y.property.specification)))continue;const v=Hi(g,e.type),S=y.value,E=y.property.specification.type,z=y.property.useIntegerZoom,I=y.property.specification["property-type"],L=I==="cross-faded"||I==="cross-faded-data-driven";if(S.kind==="constant")this.binders[g]=L?new Bn(S.value,v):new _r(S.value,v,E),h.push(`/u_${g}`);else if(S.kind==="source"||L){const O=Ra(g,E,"source");this.binders[g]=L?new Vn(S,E,z,r,O,e.id):new _a(S,v,E,O),h.push(`/a_${g}`)}else{const O=Ra(g,E,"composite");this.binders[g]=new Si(S,v,E,z,r,O),h.push(`/z_${g}`)}}this.cacheKey=h.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof _a||r instanceof Si?r.maxValue:0}populatePaintArrays(e,r,l,h,g){for(const y in this.binders){const v=this.binders[y];(v instanceof _a||v instanceof Si||v instanceof Vn)&&v.populatePaintArray(e,r,l,h,g)}}setConstantPatternPositions(e,r){for(const l in this.binders){const h=this.binders[l];h instanceof Bn&&h.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,l,h,g){let y=!1;for(const v in e){const S=r.getPositions(v);for(const E of S){const z=l.feature(E.index);for(const I in this.binders){const L=this.binders[I];if((L instanceof _a||L instanceof Si||L instanceof Vn)&&L.expression.isStateDependent===!0){const O=h.paint.get(I);L.expression=O.value,L.updatePaintArray(E.start,E.end,z,e[v],g),y=!0}}}}return y}defines(){const e=[];for(const r in this.binders){const l=this.binders[r];(l instanceof _r||l instanceof Bn)&&e.push(...l.uniformNames.map((h=>`#define HAS_UNIFORM_${h}`)))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof _a||l instanceof Si)for(let h=0;h<l.paintVertexAttributes.length;h++)e.push(l.paintVertexAttributes[h].name);else if(l instanceof Vn)for(let h=0;h<Qa.members.length;h++)e.push(Qa.members[h].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof _r||l instanceof Bn||l instanceof Si)for(const h of l.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){const l=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof _r||g instanceof Bn||g instanceof Si){for(const y of g.uniformNames)if(r[y]){const v=g.getBinding(e,r[y],y);l.push({name:y,property:h,binding:v})}}}return l}setUniforms(e,r,l,h){for(const{name:g,property:y,binding:v}of r)this.binders[y].setUniform(v,h,l.get(y),g)}updatePaintBuffers(e){this._buffers=[];for(const r in this.binders){const l=this.binders[r];if(e&&l instanceof Vn){const h=e.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(l instanceof _a||l instanceof Si)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(e){for(const r in this.binders){const l=this.binders[r];(l instanceof _a||l instanceof Si||l instanceof Vn)&&l.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof _a||r instanceof Si||r instanceof Vn)&&r.destroy()}}}class Nt{constructor(e,r,l=(()=>!0)){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new vr(h,r,l);this.needsUpload=!1,this._featureMap=new ca,this._bufferOffset=0}populatePaintArrays(e,r,l,h,g,y){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(e,r,h,g,y);r.id!==void 0&&this._featureMap.add(r.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,l,h){for(const g of l)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,r,g,h)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Hi(a,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${e}-`,"").replace(/-/g,"_")]}function Ra(a,e,r){const l={color:{source:Ln,composite:q},number:{source:T,composite:Ln}},h=(function(g){return{"line-pattern":{source:Ai,composite:Ai},"fill-pattern":{source:Ai,composite:Ai},"fill-extrusion-pattern":{source:Ai,composite:Ai}}[g]})(a);return h&&h[r]||l[e][r]}rt("ConstantBinder",_r),rt("CrossFadedConstantBinder",Bn),rt("SourceExpressionBinder",_a),rt("CrossFadedCompositeBinder",Vn),rt("CompositeExpressionBinder",Si),rt("ProgramConfiguration",vr,{omit:["_buffers"]}),rt("ProgramConfigurationSet",Nt);const da=8192,jo=Math.pow(2,14)-1,Vo=-jo-1;function ks(a){const e=da/a.extent,r=a.loadGeometry();for(let l=0;l<r.length;l++){const h=r[l];for(let g=0;g<h.length;g++){const y=h[g],v=Math.round(y.x*e),S=Math.round(y.y*e);y.x=Dt(v,Vo,jo),y.y=Dt(S,Vo,jo),(v<y.x||v>y.x+1||S<y.y||S>y.y+1)&&Bi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function us(a,e){return{type:a.type,id:a.id,properties:a.properties,geometry:e?ks(a):[]}}function lo(a,e,r,l,h){a.emplaceBack(2*e+(l+1)/2,2*r+(h+1)/2)}class $h{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new yt,this.indexArray=new Ua,this.segments=new Fi,this.programConfigurations=new Nt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(e,r,l){const h=this.layers[0],g=[];let y=null,v=!1;h.type==="circle"&&(y=h.layout.get("circle-sort-key"),v=!y.isConstant());for(const{feature:S,id:E,index:z,sourceLayerIndex:I}of e){const L=this.layers[0]._featureFilter.needGeometry,O=us(S,L);if(!this.layers[0]._featureFilter.filter(new oi(this.zoom),O,l))continue;const P=v?y.evaluate(O,{},l):void 0,G={id:E,properties:S.properties,type:S.type,sourceLayerIndex:I,index:z,geometry:L?O.geometry:ks(S),patterns:{},sortKey:P};g.push(G)}v&&g.sort(((S,E)=>S.sortKey-E.sortKey));for(const S of g){const{geometry:E,index:z,sourceLayerIndex:I}=S,L=e[z].feature;this.addFeature(S,E,z,l),r.featureIndex.insert(L,E,z,I,this.index)}}update(e,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Da),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,l,h){for(const g of r)for(const y of g){const v=y.x,S=y.y;if(v<0||v>=da||S<0||S>=da)continue;const E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),z=E.vertexLength;lo(this.layoutVertexArray,v,S,-1,-1),lo(this.layoutVertexArray,v,S,1,-1),lo(this.layoutVertexArray,v,S,1,1),lo(this.layoutVertexArray,v,S,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+3,z+2),E.vertexLength+=4,E.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},h)}}function wa(a,e){for(let r=0;r<a.length;r++)if(Va(e,a[r]))return!0;for(let r=0;r<e.length;r++)if(Va(a,e[r]))return!0;return!!Nc(a,e)}function Hh(a,e,r){return!!Va(a,e)||!!Gu(e,a,r)}function Pc(a,e){if(a.length===1)return Uc(e,a[0]);for(let r=0;r<e.length;r++){const l=e[r];for(let h=0;h<l.length;h++)if(Va(a,l[h]))return!0}for(let r=0;r<a.length;r++)if(Uc(e,a[r]))return!0;for(let r=0;r<e.length;r++)if(Nc(a,e[r]))return!0;return!1}function Ud(a,e,r){if(a.length>1){if(Nc(a,e))return!0;for(let l=0;l<e.length;l++)if(Gu(e[l],a,r))return!0}for(let l=0;l<a.length;l++)if(Gu(a[l],e,r))return!0;return!1}function Nc(a,e){if(a.length===0||e.length===0)return!1;for(let r=0;r<a.length-1;r++){const l=a[r],h=a[r+1];for(let g=0;g<e.length-1;g++)if(Qf(l,h,e[g],e[g+1]))return!0}return!1}function Qf(a,e,r,l){return Kt(a,r,l)!==Kt(e,r,l)&&Kt(a,e,r)!==Kt(a,e,l)}function Gu(a,e,r){const l=r*r;if(e.length===1)return a.distSqr(e[0])<l;for(let h=1;h<e.length;h++)if(Fc(a,e[h-1],e[h])<l)return!0;return!1}function Fc(a,e,r){const l=e.distSqr(r);if(l===0)return a.distSqr(e);const h=((a.x-e.x)*(r.x-e.x)+(a.y-e.y)*(r.y-e.y))/l;return a.distSqr(h<0?e:h>1?r:r.sub(e)._mult(h)._add(e))}function Uc(a,e){let r,l,h,g=!1;for(let y=0;y<a.length;y++){r=a[y];for(let v=0,S=r.length-1;v<r.length;S=v++)l=r[v],h=r[S],l.y>e.y!=h.y>e.y&&e.x<(h.x-l.x)*(e.y-l.y)/(h.y-l.y)+l.x&&(g=!g)}return g}function Va(a,e){let r=!1;for(let l=0,h=a.length-1;l<a.length;h=l++){const g=a[l],y=a[h];g.y>e.y!=y.y>e.y&&e.x<(y.x-g.x)*(e.y-g.y)/(y.y-g.y)+g.x&&(r=!r)}return r}function Ba(a,e,r){const l=r[0],h=r[2];if(a.x<l.x&&e.x<l.x||a.x>h.x&&e.x>h.x||a.y<l.y&&e.y<l.y||a.y>h.y&&e.y>h.y)return!1;const g=Kt(a,e,r[0]);return g!==Kt(a,e,r[1])||g!==Kt(a,e,r[2])||g!==Kt(a,e,r[3])}function qo(a,e,r){const l=e.paint.get(a).value;return l.kind==="constant"?l.value:r.programConfigurations.get(e.id).getMaxValue(a)}function Go(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function wl(a,e,r,l,h){if(!e[0]&&!e[1])return a;const g=pe.convert(e)._mult(h);r==="viewport"&&g._rotate(-l);const y=[];for(let v=0;v<a.length;v++)y.push(a[v].sub(g));return y}let jc,Ls;rt("CircleBucket",$h,{omit:["layers"]});var Vc={get paint(){return Ls=Ls||new wi({"circle-radius":new mt(Ee.paint_circle["circle-radius"]),"circle-color":new mt(Ee.paint_circle["circle-color"]),"circle-blur":new mt(Ee.paint_circle["circle-blur"]),"circle-opacity":new mt(Ee.paint_circle["circle-opacity"]),"circle-translate":new wt(Ee.paint_circle["circle-translate"]),"circle-translate-anchor":new wt(Ee.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wt(Ee.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wt(Ee.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new mt(Ee.paint_circle["circle-stroke-width"]),"circle-stroke-color":new mt(Ee.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new mt(Ee.paint_circle["circle-stroke-opacity"])})},get layout(){return jc=jc||new wi({"circle-sort-key":new mt(Ee.layout_circle["circle-sort-key"])})}},on=1e-6,Zo=typeof Float32Array<"u"?Float32Array:Array;function qc(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Xh(a,e,r){var l=e[0],h=e[1],g=e[2],y=e[3],v=e[4],S=e[5],E=e[6],z=e[7],I=e[8],L=e[9],O=e[10],P=e[11],G=e[12],X=e[13],J=e[14],ce=e[15],ie=r[0],he=r[1],fe=r[2],De=r[3];return a[0]=ie*l+he*v+fe*I+De*G,a[1]=ie*h+he*S+fe*L+De*X,a[2]=ie*g+he*E+fe*O+De*J,a[3]=ie*y+he*z+fe*P+De*ce,a[4]=(ie=r[4])*l+(he=r[5])*v+(fe=r[6])*I+(De=r[7])*G,a[5]=ie*h+he*S+fe*L+De*X,a[6]=ie*g+he*E+fe*O+De*J,a[7]=ie*y+he*z+fe*P+De*ce,a[8]=(ie=r[8])*l+(he=r[9])*v+(fe=r[10])*I+(De=r[11])*G,a[9]=ie*h+he*S+fe*L+De*X,a[10]=ie*g+he*E+fe*O+De*J,a[11]=ie*y+he*z+fe*P+De*ce,a[12]=(ie=r[12])*l+(he=r[13])*v+(fe=r[14])*I+(De=r[15])*G,a[13]=ie*h+he*S+fe*L+De*X,a[14]=ie*g+he*E+fe*O+De*J,a[15]=ie*y+he*z+fe*P+De*ce,a}Math.hypot||(Math.hypot=function(){for(var a=0,e=arguments.length;e--;)a+=arguments[e]*arguments[e];return Math.sqrt(a)});var tu,jd=Xh;function Zu(a,e,r){var l=e[0],h=e[1],g=e[2],y=e[3];return a[0]=r[0]*l+r[4]*h+r[8]*g+r[12]*y,a[1]=r[1]*l+r[5]*h+r[9]*g+r[13]*y,a[2]=r[2]*l+r[6]*h+r[10]*g+r[14]*y,a[3]=r[3]*l+r[7]*h+r[11]*g+r[15]*y,a}tu=new Zo(4),Zo!=Float32Array&&(tu[0]=0,tu[1]=0,tu[2]=0,tu[3]=0);class Vd extends ka{constructor(e){super(e,Vc)}createBucket(e){return new $h(e)}queryRadius(e){const r=e;return qo("circle-radius",this,r)+qo("circle-stroke-width",this,r)+Go(this.paint.get("circle-translate"))}queryIntersectsFeature(e,r,l,h,g,y,v,S){const E=wl(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,v),z=this.paint.get("circle-radius").evaluate(r,l)+this.paint.get("circle-stroke-width").evaluate(r,l),I=this.paint.get("circle-pitch-alignment")==="map",L=I?E:(function(P,G){return P.map((X=>Gc(X,G)))})(E,S),O=I?z*v:z;for(const P of h)for(const G of P){const X=I?G:Gc(G,S);let J=O;const ce=Zu([],[G.x,G.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?J*=ce[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(J*=y.cameraToCenterDistance/ce[3]),Hh(L,X,J))return!0}return!1}}function Gc(a,e){const r=Zu([],[a.x,a.y,0,1],e);return new pe(r[0]/r[3],r[1]/r[3])}class Yh extends $h{}let qd;rt("HeatmapBucket",Yh,{omit:["layers"]});var Gd={get paint(){return qd=qd||new wi({"heatmap-radius":new mt(Ee.paint_heatmap["heatmap-radius"]),"heatmap-weight":new mt(Ee.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wt(Ee.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Br(Ee.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wt(Ee.paint_heatmap["heatmap-opacity"])})}};function Zc(a,{width:e,height:r},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*r*l)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${e*r*l}`)}else h=new Uint8Array(e*r*l);return a.width=e,a.height=r,a.data=h,a}function Kh(a,{width:e,height:r},l){if(e===a.width&&r===a.height)return;const h=Zc({},{width:e,height:r},l);$u(a,h,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,e),height:Math.min(a.height,r)},l),a.width=e,a.height=r,a.data=h.data}function $u(a,e,r,l,h,g){if(h.width===0||h.height===0)return e;if(h.width>a.width||h.height>a.height||r.x>a.width-h.width||r.y>a.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||l.x>e.width-h.width||l.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=a.data,v=e.data;if(y===v)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<h.height;S++){const E=((r.y+S)*a.width+r.x)*g,z=((l.y+S)*e.width+l.x)*g;for(let I=0;I<h.width*g;I++)v[z+I]=y[E+I]}return e}class iu{constructor(e,r){Zc(this,e,1,r)}resize(e){Kh(this,e,1)}clone(){return new iu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,l,h,g){$u(e,r,l,h,g,1)}}class ar{constructor(e,r){Zc(this,e,4,r)}resize(e){Kh(this,e,4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new ar({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,l,h,g){$u(e,r,l,h,g,4)}}function Qh(a){const e={},r=a.resolution||256,l=a.clips?a.clips.length:1,h=a.image||new ar({width:r,height:l});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const g=(y,v,S)=>{e[a.evaluationKey]=S;const E=a.expression.evaluate(e);h.data[y+v+0]=Math.floor(255*E.r/E.a),h.data[y+v+1]=Math.floor(255*E.g/E.a),h.data[y+v+2]=Math.floor(255*E.b/E.a),h.data[y+v+3]=Math.floor(255*E.a)};if(a.clips)for(let y=0,v=0;y<l;++y,v+=4*r)for(let S=0,E=0;S<r;S++,E+=4){const z=S/(r-1),{start:I,end:L}=a.clips[y];g(v,E,I*(1-z)+L*z)}else for(let y=0,v=0;y<r;y++,v+=4)g(0,v,y/(r-1));return h}rt("AlphaImage",iu),rt("RGBAImage",ar);class Zd extends ka{createBucket(e){return new Yh(e)}constructor(e){super(e,Gd),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Qh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Jh;var Jf={get paint(){return Jh=Jh||new wi({"hillshade-illumination-direction":new wt(Ee.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wt(Ee.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wt(Ee.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wt(Ee.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wt(Ee.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wt(Ee.paint_hillshade["hillshade-accent-color"])})}};class $d extends ka{constructor(e){super(e,Jf)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const au=zi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Hd}=au;var nu={exports:{}};function Sl(a,e,r){r=r||2;var l,h,g,y,v,S,E,z=e&&e.length,I=z?e[0]*r:a.length,L=Wh(a,0,I,r,!0),O=[];if(!L||L.next===L.prev)return O;if(z&&(L=(function(G,X,J,ce){var ie,he,fe,De=[];for(ie=0,he=X.length;ie<he;ie++)(fe=Wh(G,X[ie]*ce,ie<he-1?X[ie+1]*ce:G.length,ce,!1))===fe.next&&(fe.steiner=!0),De.push(td(fe));for(De.sort(Jd),ie=0;ie<De.length;ie++)J=ed(De[ie],J);return J})(a,e,L,r)),a.length>80*r){l=g=a[0],h=y=a[1];for(var P=r;P<I;P+=r)(v=a[P])<l&&(l=v),(S=a[P+1])<h&&(h=S),v>g&&(g=v),S>y&&(y=S);E=(E=Math.max(g-l,y-h))!==0?32767/E:0}return Hu(L,O,r,l,h,E,0),O}function Wh(a,e,r,l,h){var g,y;if(h===El(a,e,r,l)>0)for(g=e;g<r;g+=l)y=tf(g,a[g],a[g+1],y);else for(g=r-l;g>=e;g-=l)y=tf(g,a[g],a[g+1],y);return y&&ru(y,y.next)&&(Yu(y),y=y.next),y}function uo(a,e){if(!a)return a;e||(e=a);var r,l=a;do if(r=!1,l.steiner||!ru(l,l.next)&&Sa(l.prev,l,l.next)!==0)l=l.next;else{if(Yu(l),(l=e=l.prev)===l.next)break;r=!0}while(r||l!==e);return e}function Hu(a,e,r,l,h,g,y){if(a){!y&&g&&(function(z,I,L,O){var P=z;do P.z===0&&(P.z=$c(P.x,P.y,I,L,O)),P.prevZ=P.prev,P.nextZ=P.next,P=P.next;while(P!==z);P.prevZ.nextZ=null,P.prevZ=null,(function(G){var X,J,ce,ie,he,fe,De,Xe,vt=1;do{for(J=G,G=null,he=null,fe=0;J;){for(fe++,ce=J,De=0,X=0;X<vt&&(De++,ce=ce.nextZ);X++);for(Xe=vt;De>0||Xe>0&&ce;)De!==0&&(Xe===0||!ce||J.z<=ce.z)?(ie=J,J=J.nextZ,De--):(ie=ce,ce=ce.nextZ,Xe--),he?he.nextZ=ie:G=ie,ie.prevZ=he,he=ie;J=ce}he.nextZ=null,vt*=2}while(fe>1)})(P)})(a,l,h,g);for(var v,S,E=a;a.prev!==a.next;)if(v=a.prev,S=a.next,g?Yd(a,l,h,g):Xd(a))e.push(v.i/r|0),e.push(a.i/r|0),e.push(S.i/r|0),Yu(a),a=S.next,E=S.next;else if((a=S)===E){y?y===1?Hu(a=Kd(uo(a),e,r),e,r,l,h,g,2):y===2&&Qd(a,e,r,l,h,g):Hu(uo(a),e,r,l,h,g,1);break}}}function Xd(a){var e=a.prev,r=a,l=a.next;if(Sa(e,r,l)>=0)return!1;for(var h=e.x,g=r.x,y=l.x,v=e.y,S=r.y,E=l.y,z=h<g?h<y?h:y:g<y?g:y,I=v<S?v<E?v:E:S<E?S:E,L=h>g?h>y?h:y:g>y?g:y,O=v>S?v>E?v:E:S>E?S:E,P=l.next;P!==e;){if(P.x>=z&&P.x<=L&&P.y>=I&&P.y<=O&&Tl(h,v,g,S,y,E,P.x,P.y)&&Sa(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function Yd(a,e,r,l){var h=a.prev,g=a,y=a.next;if(Sa(h,g,y)>=0)return!1;for(var v=h.x,S=g.x,E=y.x,z=h.y,I=g.y,L=y.y,O=v<S?v<E?v:E:S<E?S:E,P=z<I?z<L?z:L:I<L?I:L,G=v>S?v>E?v:E:S>E?S:E,X=z>I?z>L?z:L:I>L?I:L,J=$c(O,P,e,r,l),ce=$c(G,X,e,r,l),ie=a.prevZ,he=a.nextZ;ie&&ie.z>=J&&he&&he.z<=ce;){if(ie.x>=O&&ie.x<=G&&ie.y>=P&&ie.y<=X&&ie!==h&&ie!==y&&Tl(v,z,S,I,E,L,ie.x,ie.y)&&Sa(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,he.x>=O&&he.x<=G&&he.y>=P&&he.y<=X&&he!==h&&he!==y&&Tl(v,z,S,I,E,L,he.x,he.y)&&Sa(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;ie&&ie.z>=J;){if(ie.x>=O&&ie.x<=G&&ie.y>=P&&ie.y<=X&&ie!==h&&ie!==y&&Tl(v,z,S,I,E,L,ie.x,ie.y)&&Sa(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;he&&he.z<=ce;){if(he.x>=O&&he.x<=G&&he.y>=P&&he.y<=X&&he!==h&&he!==y&&Tl(v,z,S,I,E,L,he.x,he.y)&&Sa(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function Kd(a,e,r){var l=a;do{var h=l.prev,g=l.next.next;!ru(h,g)&&id(h,l,l.next,g)&&ou(h,g)&&ou(g,h)&&(e.push(h.i/r|0),e.push(l.i/r|0),e.push(g.i/r|0),Yu(l),Yu(l.next),l=a=g),l=l.next}while(l!==a);return uo(l)}function Qd(a,e,r,l,h,g){var y=a;do{for(var v=y.next.next;v!==y.prev;){if(y.i!==v.i&&ef(y,v)){var S=ad(y,v);return y=uo(y,y.next),S=uo(S,S.next),Hu(y,e,r,l,h,g,0),void Hu(S,e,r,l,h,g,0)}v=v.next}y=y.next}while(y!==a)}function Jd(a,e){return a.x-e.x}function ed(a,e){var r=(function(h,g){var y,v=g,S=h.x,E=h.y,z=-1/0;do{if(E<=v.y&&E>=v.next.y&&v.next.y!==v.y){var I=v.x+(E-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(I<=S&&I>z&&(z=I,y=v.x<v.next.x?v:v.next,I===S))return y}v=v.next}while(v!==g);if(!y)return null;var L,O=y,P=y.x,G=y.y,X=1/0;v=y;do S>=v.x&&v.x>=P&&S!==v.x&&Tl(E<G?S:z,E,P,G,E<G?z:S,E,v.x,v.y)&&(L=Math.abs(E-v.y)/(S-v.x),ou(v,h)&&(L<X||L===X&&(v.x>y.x||v.x===y.x&&Wd(y,v)))&&(y=v,X=L)),v=v.next;while(v!==O);return y})(a,e);if(!r)return e;var l=ad(r,a);return uo(l,l.next),uo(r,r.next)}function Wd(a,e){return Sa(a.prev,a,e.prev)<0&&Sa(e.next,a,a.next)<0}function $c(a,e,r,l,h){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-r)*h|0)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-l)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function td(a){var e=a,r=a;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==a);return r}function Tl(a,e,r,l,h,g,y,v){return(h-y)*(e-v)>=(a-y)*(g-v)&&(a-y)*(l-v)>=(r-y)*(e-v)&&(r-y)*(g-v)>=(h-y)*(l-v)}function ef(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!(function(r,l){var h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==l.i&&h.next.i!==l.i&&id(h,h.next,r,l))return!0;h=h.next}while(h!==r);return!1})(a,e)&&(ou(a,e)&&ou(e,a)&&(function(r,l){var h=r,g=!1,y=(r.x+l.x)/2,v=(r.y+l.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&y<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(g=!g),h=h.next;while(h!==r);return g})(a,e)&&(Sa(a.prev,a,e.prev)||Sa(a,e.prev,e))||ru(a,e)&&Sa(a.prev,a,a.next)>0&&Sa(e.prev,e,e.next)>0)}function Sa(a,e,r){return(e.y-a.y)*(r.x-e.x)-(e.x-a.x)*(r.y-e.y)}function ru(a,e){return a.x===e.x&&a.y===e.y}function id(a,e,r,l){var h=su(Sa(a,e,r)),g=su(Sa(a,e,l)),y=su(Sa(r,l,a)),v=su(Sa(r,l,e));return h!==g&&y!==v||!(h!==0||!Xu(a,r,e))||!(g!==0||!Xu(a,l,e))||!(y!==0||!Xu(r,a,l))||!(v!==0||!Xu(r,e,l))}function Xu(a,e,r){return e.x<=Math.max(a.x,r.x)&&e.x>=Math.min(a.x,r.x)&&e.y<=Math.max(a.y,r.y)&&e.y>=Math.min(a.y,r.y)}function su(a){return a>0?1:a<0?-1:0}function ou(a,e){return Sa(a.prev,a,a.next)<0?Sa(a,e,a.next)>=0&&Sa(a,a.prev,e)>=0:Sa(a,e,a.prev)<0||Sa(a,a.next,e)<0}function ad(a,e){var r=new Hc(a.i,a.x,a.y),l=new Hc(e.i,e.x,e.y),h=a.next,g=e.prev;return a.next=e,e.prev=a,r.next=h,h.prev=r,l.next=r,r.prev=l,g.next=l,l.prev=g,l}function tf(a,e,r,l){var h=new Hc(a,e,r);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Yu(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Hc(a,e,r){this.i=a,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function El(a,e,r,l){for(var h=0,g=e,y=r-l;g<r;g+=l)h+=(a[y]-a[g])*(a[g+1]+a[y+1]),y=g;return h}nu.exports=Sl,nu.exports.default=Sl,Sl.deviation=function(a,e,r,l){var h=e&&e.length,g=Math.abs(El(a,0,h?e[0]*r:a.length,r));if(h)for(var y=0,v=e.length;y<v;y++)g-=Math.abs(El(a,e[y]*r,y<v-1?e[y+1]*r:a.length,r));var S=0;for(y=0;y<l.length;y+=3){var E=l[y]*r,z=l[y+1]*r,I=l[y+2]*r;S+=Math.abs((a[E]-a[I])*(a[z+1]-a[E+1])-(a[E]-a[z])*(a[I+1]-a[E+1]))}return g===0&&S===0?0:Math.abs((S-g)/g)},Sl.flatten=function(a){for(var e=a[0][0].length,r={vertices:[],holes:[],dimensions:e},l=0,h=0;h<a.length;h++){for(var g=0;g<a[h].length;g++)for(var y=0;y<e;y++)r.vertices.push(a[h][g][y]);h>0&&r.holes.push(l+=a[h-1].length)}return r};var Xc=U(nu.exports);function Yc(a,e,r,l,h){nd(a,e,r,l||a.length-1,h||Ku)}function nd(a,e,r,l,h){for(;l>r;){if(l-r>600){var g=l-r+1,y=e-r+1,v=Math.log(g),S=.5*Math.exp(2*v/3),E=.5*Math.sqrt(v*S*(g-S)/g)*(y-g/2<0?-1:1);nd(a,e,Math.max(r,Math.floor(e-y*S/g+E)),Math.min(l,Math.floor(e+(g-y)*S/g+E)),h)}var z=a[e],I=r,L=l;for(lu(a,r,e),h(a[l],z)>0&&lu(a,r,l);I<L;){for(lu(a,I,L),I++,L--;h(a[I],z)<0;)I++;for(;h(a[L],z)>0;)L--}h(a[r],z)===0?lu(a,r,L):lu(a,++L,l),L<=e&&(r=L+1),e<=L&&(l=L-1)}}function lu(a,e,r){var l=a[e];a[e]=a[r],a[r]=l}function Ku(a,e){return a<e?-1:a>e?1:0}function Kc(a,e){const r=a.length;if(r<=1)return[a];const l=[];let h,g;for(let y=0;y<r;y++){const v=Se(a[y]);v!==0&&(a[y].area=Math.abs(v),g===void 0&&(g=v<0),g===v<0?(h&&l.push(h),h=[a[y]]):h.push(a[y]))}if(h&&l.push(h),e>1)for(let y=0;y<l.length;y++)l[y].length<=e||(Yc(l[y],e,1,l[y].length-1,rd),l[y]=l[y].slice(0,e));return l}function rd(a,e){return e.area-a.area}function Qc(a,e,r){const l=r.patternDependencies;let h=!1;for(const g of e){const y=g.paint.get(`${a}-pattern`);y.isConstant()||(h=!0);const v=y.constantOr(null);v&&(h=!0,l[v.to]=!0,l[v.from]=!0)}return h}function Qu(a,e,r,l,h){const g=h.patternDependencies;for(const y of e){const v=y.paint.get(`${a}-pattern`).value;if(v.kind!=="constant"){let S=v.evaluate({zoom:l-1},r,{},h.availableImages),E=v.evaluate({zoom:l},r,{},h.availableImages),z=v.evaluate({zoom:l+1},r,{},h.availableImages);S=S&&S.name?S.name:S,E=E&&E.name?E.name:E,z=z&&z.name?z.name:z,g[S]=!0,g[E]=!0,g[z]=!0,r.patterns[y.id]={min:S,mid:E,max:z}}}return r}class Ju{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Wt,this.indexArray=new Ua,this.indexArray2=new Ji,this.programConfigurations=new Nt(e.layers,e.zoom),this.segments=new Fi,this.segments2=new Fi,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(e,r,l){this.hasPattern=Qc("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),g=!h.isConstant(),y=[];for(const{feature:v,id:S,index:E,sourceLayerIndex:z}of e){const I=this.layers[0]._featureFilter.needGeometry,L=us(v,I);if(!this.layers[0]._featureFilter.filter(new oi(this.zoom),L,l))continue;const O=g?h.evaluate(L,{},l,r.availableImages):void 0,P={id:S,properties:v.properties,type:v.type,sourceLayerIndex:z,index:E,geometry:I?L.geometry:ks(v),patterns:{},sortKey:O};y.push(P)}g&&y.sort(((v,S)=>v.sortKey-S.sortKey));for(const v of y){const{geometry:S,index:E,sourceLayerIndex:z}=v;if(this.hasPattern){const I=Qu("fill",this.layers,v,this.zoom,r);this.patternFeatures.push(I)}else this.addFeature(v,S,E,l,{});r.featureIndex.insert(e[E].feature,S,E,z,this.index)}}update(e,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,l)}addFeatures(e,r,l){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Hd),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,l,h,g){for(const y of Kc(r,500)){let v=0;for(const O of y)v+=O.length;const S=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),E=S.vertexLength,z=[],I=[];for(const O of y){if(O.length===0)continue;O!==y[0]&&I.push(z.length/2);const P=this.segments2.prepareSegment(O.length,this.layoutVertexArray,this.indexArray2),G=P.vertexLength;this.layoutVertexArray.emplaceBack(O[0].x,O[0].y),this.indexArray2.emplaceBack(G+O.length-1,G),z.push(O[0].x),z.push(O[0].y);for(let X=1;X<O.length;X++)this.layoutVertexArray.emplaceBack(O[X].x,O[X].y),this.indexArray2.emplaceBack(G+X-1,G+X),z.push(O[X].x),z.push(O[X].y);P.vertexLength+=O.length,P.primitiveLength+=O.length}const L=Xc(z,I);for(let O=0;O<L.length;O+=3)this.indexArray.emplaceBack(E+L[O],E+L[O+1],E+L[O+2]);S.vertexLength+=v,S.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,g,h)}}let sd,od;rt("FillBucket",Ju,{omit:["layers","patternFeatures"]});var Al={get paint(){return od=od||new wi({"fill-antialias":new wt(Ee.paint_fill["fill-antialias"]),"fill-opacity":new mt(Ee.paint_fill["fill-opacity"]),"fill-color":new mt(Ee.paint_fill["fill-color"]),"fill-outline-color":new mt(Ee.paint_fill["fill-outline-color"]),"fill-translate":new wt(Ee.paint_fill["fill-translate"]),"fill-translate-anchor":new wt(Ee.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ri(Ee.paint_fill["fill-pattern"])})},get layout(){return sd=sd||new wi({"fill-sort-key":new mt(Ee.layout_fill["fill-sort-key"])})}};class af extends ka{constructor(e){super(e,Al)}recalculate(e,r){super.recalculate(e,r);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Ju(e)}queryRadius(){return Go(this.paint.get("fill-translate"))}queryIntersectsFeature(e,r,l,h,g,y,v){return Pc(wl(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,v),h)}isTileClipped(){return!0}}const nf=zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),rf=zi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Jc}=nf;var co={},ld=ut,ud=zl;function zl(a,e,r,l,h){this.properties={},this.extent=r,this.type=0,this._pbf=a,this._geometry=-1,this._keys=l,this._values=h,a.readFields(Wf,this,e)}function Wf(a,e,r){a==1?e.id=r.readVarint():a==2?(function(l,h){for(var g=l.readVarint()+l.pos;l.pos<g;){var y=h._keys[l.readVarint()],v=h._values[l.readVarint()];h.properties[y]=v}})(r,e):a==3?e.type=r.readVarint():a==4&&(e._geometry=r.pos)}function cd(a){for(var e,r,l=0,h=0,g=a.length,y=g-1;h<g;y=h++)l+=((r=a[y]).x-(e=a[h]).x)*(e.y+r.y);return l}zl.types=["Unknown","Point","LineString","Polygon"],zl.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var e,r=a.readVarint()+a.pos,l=1,h=0,g=0,y=0,v=[];a.pos<r;){if(h<=0){var S=a.readVarint();l=7&S,h=S>>3}if(h--,l===1||l===2)g+=a.readSVarint(),y+=a.readSVarint(),l===1&&(e&&v.push(e),e=[]),e.push(new ld(g,y));else{if(l!==7)throw new Error("unknown command "+l);e&&e.push(e[0].clone())}}return e&&v.push(e),v},zl.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var e=a.readVarint()+a.pos,r=1,l=0,h=0,g=0,y=1/0,v=-1/0,S=1/0,E=-1/0;a.pos<e;){if(l<=0){var z=a.readVarint();r=7&z,l=z>>3}if(l--,r===1||r===2)(h+=a.readSVarint())<y&&(y=h),h>v&&(v=h),(g+=a.readSVarint())<S&&(S=g),g>E&&(E=g);else if(r!==7)throw new Error("unknown command "+r)}return[y,S,v,E]},zl.prototype.toGeoJSON=function(a,e,r){var l,h,g=this.extent*Math.pow(2,r),y=this.extent*a,v=this.extent*e,S=this.loadGeometry(),E=zl.types[this.type];function z(O){for(var P=0;P<O.length;P++){var G=O[P];O[P]=[360*(G.x+y)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+v)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var I=[];for(l=0;l<S.length;l++)I[l]=S[l][0];z(S=I);break;case 2:for(l=0;l<S.length;l++)z(S[l]);break;case 3:for(S=(function(O){var P=O.length;if(P<=1)return[O];for(var G,X,J=[],ce=0;ce<P;ce++){var ie=cd(O[ce]);ie!==0&&(X===void 0&&(X=ie<0),X===ie<0?(G&&J.push(G),G=[O[ce]]):G.push(O[ce]))}return G&&J.push(G),J})(S),l=0;l<S.length;l++)for(h=0;h<S[l].length;h++)z(S[l][h])}S.length===1?S=S[0]:E="Multi"+E;var L={type:"Feature",geometry:{type:E,coordinates:S},properties:this.properties};return"id"in this&&(L.id=this.id),L};var qa=ud,ln=hd;function hd(a,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(sf,this,e),this.length=this._features.length}function sf(a,e,r){a===15?e.version=r.readVarint():a===1?e.name=r.readString():a===5?e.extent=r.readVarint():a===2?e._features.push(r.pos):a===3?e._keys.push(r.readString()):a===4&&e._values.push((function(l){for(var h=null,g=l.readVarint()+l.pos;l.pos<g;){var y=l.readVarint()>>3;h=y===1?l.readString():y===2?l.readFloat():y===3?l.readDouble():y===4?l.readVarint64():y===5?l.readVarint():y===6?l.readSVarint():y===7?l.readBoolean():null}return h})(r))}hd.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var e=this._pbf.readVarint()+this._pbf.pos;return new qa(this._pbf,e,this.extent,this._keys,this._values)};var of=ln;function lf(a,e,r){if(a===3){var l=new of(r,r.readVarint()+r.pos);l.length&&(e[l.name]=l)}}co.VectorTile=function(a,e){this.layers=a.readFields(lf,{},e)},co.VectorTileFeature=ud,co.VectorTileLayer=ln;const Wu=co.VectorTileFeature.types,Wc=Math.pow(2,13);function $o(a,e,r,l,h,g,y,v){a.emplaceBack(e,r,2*Math.floor(l*Wc)+y,h*Wc*2,g*Wc*2,Math.round(v))}class eh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Je,this.centroidVertexArray=new He,this.indexArray=new Ua,this.programConfigurations=new Nt(e.layers,e.zoom),this.segments=new Fi,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(e,r,l){this.features=[],this.hasPattern=Qc("fill-extrusion",this.layers,r);for(const{feature:h,id:g,index:y,sourceLayerIndex:v}of e){const S=this.layers[0]._featureFilter.needGeometry,E=us(h,S);if(!this.layers[0]._featureFilter.filter(new oi(this.zoom),E,l))continue;const z={id:g,sourceLayerIndex:v,index:y,geometry:S?E.geometry:ks(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(Qu("fill-extrusion",this.layers,z,this.zoom,r)):this.addFeature(z,z.geometry,y,l,{}),r.featureIndex.insert(h,z.geometry,y,v,this.index,!0)}}addFeatures(e,r,l){for(const h of this.features){const{geometry:g}=h;this.addFeature(h,g,h.index,r,l)}}update(e,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jc),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,rf.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,l,h,g){const y={x:0,y:0,vertexCount:0};for(const v of Kc(r,500)){let S=0;for(const P of v)S+=P.length;let E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const P of v){if(P.length===0||th(P))continue;let G=0;for(let X=0;X<P.length;X++){const J=P[X];if(X>=1){const ce=P[X-1];if(!ep(J,ce)){E.vertexLength+4>Fi.MAX_VERTEX_ARRAY_LENGTH&&(E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ie=J.sub(ce)._perp()._unit(),he=ce.dist(J);G+he>32768&&(G=0),$o(this.layoutVertexArray,J.x,J.y,ie.x,ie.y,0,0,G),$o(this.layoutVertexArray,J.x,J.y,ie.x,ie.y,0,1,G),y.x+=2*J.x,y.y+=2*J.y,y.vertexCount+=2,G+=he,$o(this.layoutVertexArray,ce.x,ce.y,ie.x,ie.y,0,0,G),$o(this.layoutVertexArray,ce.x,ce.y,ie.x,ie.y,0,1,G),y.x+=2*ce.x,y.y+=2*ce.y,y.vertexCount+=2;const fe=E.vertexLength;this.indexArray.emplaceBack(fe,fe+2,fe+1),this.indexArray.emplaceBack(fe+1,fe+2,fe+3),E.vertexLength+=4,E.primitiveLength+=2}}}}if(E.vertexLength+S>Fi.MAX_VERTEX_ARRAY_LENGTH&&(E=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),Wu[e.type]!=="Polygon")continue;const z=[],I=[],L=E.vertexLength;for(const P of v)if(P.length!==0){P!==v[0]&&I.push(z.length/2);for(let G=0;G<P.length;G++){const X=P[G];$o(this.layoutVertexArray,X.x,X.y,0,0,1,1,0),y.x+=X.x,y.y+=X.y,y.vertexCount+=1,z.push(X.x),z.push(X.y)}}const O=Xc(z,I);for(let P=0;P<O.length;P+=3)this.indexArray.emplaceBack(L+O[P],L+O[P+2],L+O[P+1]);E.primitiveLength+=O.length/3,E.vertexLength+=S}for(let v=0;v<y.vertexCount;v++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,g,h)}}function ep(a,e){return a.x===e.x&&(a.x<0||a.x>da)||a.y===e.y&&(a.y<0||a.y>da)}function th(a){return a.every((e=>e.x<0))||a.every((e=>e.x>da))||a.every((e=>e.y<0))||a.every((e=>e.y>da))}let ih;rt("FillExtrusionBucket",eh,{omit:["layers","features"]});var uf={get paint(){return ih=ih||new wi({"fill-extrusion-opacity":new wt(Ee["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new mt(Ee["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wt(Ee["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wt(Ee["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ri(Ee["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new mt(Ee["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new mt(Ee["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wt(Ee["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class cf extends ka{constructor(e){super(e,uf)}createBucket(e){return new eh(e)}queryRadius(){return Go(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,r,l,h,g,y,v,S){const E=wl(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,v),z=this.paint.get("fill-extrusion-height").evaluate(r,l),I=this.paint.get("fill-extrusion-base").evaluate(r,l),L=(function(P,G,X,J){const ce=[];for(const ie of P){const he=[ie.x,ie.y,0,1];Zu(he,he,G),ce.push(new pe(he[0]/he[3],he[1]/he[3]))}return ce})(E,S),O=(function(P,G,X,J){const ce=[],ie=[],he=J[8]*G,fe=J[9]*G,De=J[10]*G,Xe=J[11]*G,vt=J[8]*X,lt=J[9]*X,at=J[10]*X,Ke=J[11]*X;for(const dt of P){const We=[],qe=[];for(const zt of dt){const xt=zt.x,Yt=zt.y,Xi=J[0]*xt+J[4]*Yt+J[12],Yi=J[1]*xt+J[5]*Yt+J[13],Oa=J[2]*xt+J[6]*Yt+J[14],Xn=J[3]*xt+J[7]*Yt+J[15],Pn=Oa+De,Ia=Xn+Xe,ra=Xi+vt,Wa=Yi+lt,wn=Oa+at,cn=Xn+Ke,Pa=new pe((Xi+he)/Ia,(Yi+fe)/Ia);Pa.z=Pn/Ia,We.push(Pa);const Na=new pe(ra/cn,Wa/cn);Na.z=wn/cn,qe.push(Na)}ce.push(We),ie.push(qe)}return[ce,ie]})(h,I,z,S);return(function(P,G,X){let J=1/0;Pc(X,G)&&(J=ah(X,G[0]));for(let ce=0;ce<G.length;ce++){const ie=G[ce],he=P[ce];for(let fe=0;fe<ie.length-1;fe++){const De=ie[fe],Xe=[De,ie[fe+1],he[fe+1],he[fe],De];wa(X,Xe)&&(J=Math.min(J,ah(X,Xe)))}}return J!==1/0&&J})(O[0],O[1],L)}}function uu(a,e){return a.x*e.x+a.y*e.y}function ah(a,e){if(a.length===1){let r=0;const l=e[r++];let h;for(;!h||l.equals(h);)if(h=e[r++],!h)return 1/0;for(;r<e.length;r++){const g=e[r],y=a[0],v=h.sub(l),S=g.sub(l),E=y.sub(l),z=uu(v,v),I=uu(v,S),L=uu(S,S),O=uu(E,v),P=uu(E,S),G=z*L-I*I,X=(L*O-I*P)/G,J=(z*P-I*O)/G,ce=l.z*(1-X-J)+h.z*X+g.z*J;if(isFinite(ce))return ce}return 1/0}{let r=1/0;for(const l of e)r=Math.min(r,l.z);return r}}const dd=zi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:fd}=dd,hf=zi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:pd}=hf,nh=co.VectorTileFeature.types,md=Math.cos(Math.PI/180*37.5),gd=Math.pow(2,14)/.5;class ec{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((r=>{this.gradients[r.id]={}})),this.layoutVertexArray=new Tt,this.layoutVertexArray2=new _t,this.indexArray=new Ua,this.programConfigurations=new Nt(e.layers,e.zoom),this.segments=new Fi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(e,r,l){this.hasPattern=Qc("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),g=!h.isConstant(),y=[];for(const{feature:v,id:S,index:E,sourceLayerIndex:z}of e){const I=this.layers[0]._featureFilter.needGeometry,L=us(v,I);if(!this.layers[0]._featureFilter.filter(new oi(this.zoom),L,l))continue;const O=g?h.evaluate(L,{},l):void 0,P={id:S,properties:v.properties,type:v.type,sourceLayerIndex:z,index:E,geometry:I?L.geometry:ks(v),patterns:{},sortKey:O};y.push(P)}g&&y.sort(((v,S)=>v.sortKey-S.sortKey));for(const v of y){const{geometry:S,index:E,sourceLayerIndex:z}=v;if(this.hasPattern){const I=Qu("line",this.layers,v,this.zoom,r);this.patternFeatures.push(I)}else this.addFeature(v,S,E,l,{});r.featureIndex.insert(e[E].feature,S,E,z,this.index)}}update(e,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,l)}addFeatures(e,r,l){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,pd)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fd),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,l,h,g){const y=this.layers[0].layout,v=y.get("line-join").evaluate(e,{}),S=y.get("line-cap"),E=y.get("line-miter-limit"),z=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const I of r)this.addLine(I,e,v,S,E,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,g,h)}addLine(e,r,l,h,g,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let J=0;J<e.length-1;J++)this.totalDistance+=e[J].dist(e[J+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=nh[r.type]==="Polygon";let S=e.length;for(;S>=2&&e[S-1].equals(e[S-2]);)S--;let E=0;for(;E<S-1&&e[E].equals(e[E+1]);)E++;if(S<(v?3:2))return;l==="bevel"&&(g=1.05);const z=this.overscaling<=16?15*da/(512*this.overscaling):0,I=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let L,O,P,G,X;this.e1=this.e2=-1,v&&(L=e[S-2],X=e[E].sub(L)._unit()._perp());for(let J=E;J<S;J++){if(P=J===S-1?v?e[E+1]:void 0:e[J+1],P&&e[J].equals(P))continue;X&&(G=X),L&&(O=L),L=e[J],X=P?P.sub(L)._unit()._perp():G,G=G||X;let ce=G.add(X);ce.x===0&&ce.y===0||ce._unit();const ie=G.x*X.x+G.y*X.y,he=ce.x*X.x+ce.y*X.y,fe=he!==0?1/he:1/0,De=2*Math.sqrt(2-2*he),Xe=he<md&&O&&P,vt=G.x*X.y-G.y*X.x>0;if(Xe&&J>E){const Ke=L.dist(O);if(Ke>2*z){const dt=L.sub(L.sub(O)._mult(z/Ke)._round());this.updateDistance(O,dt),this.addCurrentVertex(dt,G,0,0,I),O=dt}}const lt=O&&P;let at=lt?l:v?"butt":h;if(lt&&at==="round"&&(fe<y?at="miter":fe<=2&&(at="fakeround")),at==="miter"&&fe>g&&(at="bevel"),at==="bevel"&&(fe>2&&(at="flipbevel"),fe<g&&(at="miter")),O&&this.updateDistance(O,L),at==="miter")ce._mult(fe),this.addCurrentVertex(L,ce,0,0,I);else if(at==="flipbevel"){if(fe>100)ce=X.mult(-1);else{const Ke=fe*G.add(X).mag()/G.sub(X).mag();ce._perp()._mult(Ke*(vt?-1:1))}this.addCurrentVertex(L,ce,0,0,I),this.addCurrentVertex(L,ce.mult(-1),0,0,I)}else if(at==="bevel"||at==="fakeround"){const Ke=-Math.sqrt(fe*fe-1),dt=vt?Ke:0,We=vt?0:Ke;if(O&&this.addCurrentVertex(L,G,dt,We,I),at==="fakeround"){const qe=Math.round(180*De/Math.PI/20);for(let zt=1;zt<qe;zt++){let xt=zt/qe;if(xt!==.5){const Xi=xt-.5;xt+=xt*Xi*(xt-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*Xi*Xi+(.848013+ie*(.215638*ie-1.06021)))}const Yt=X.sub(G)._mult(xt)._add(G)._unit()._mult(vt?-1:1);this.addHalfVertex(L,Yt.x,Yt.y,!1,vt,0,I)}}P&&this.addCurrentVertex(L,X,-dt,-We,I)}else if(at==="butt")this.addCurrentVertex(L,ce,0,0,I);else if(at==="square"){const Ke=O?1:-1;this.addCurrentVertex(L,ce,Ke,Ke,I)}else at==="round"&&(O&&(this.addCurrentVertex(L,G,0,0,I),this.addCurrentVertex(L,G,1,1,I,!0)),P&&(this.addCurrentVertex(L,X,-1,-1,I,!0),this.addCurrentVertex(L,X,0,0,I)));if(Xe&&J<S-1){const Ke=L.dist(P);if(Ke>2*z){const dt=L.add(P.sub(L)._mult(z/Ke)._round());this.updateDistance(L,dt),this.addCurrentVertex(dt,X,0,0,I),L=dt}}}}addCurrentVertex(e,r,l,h,g,y=!1){const v=r.y*h-r.x,S=-r.y-r.x*h;this.addHalfVertex(e,r.x+r.y*l,r.y-r.x*l,y,!1,l,g),this.addHalfVertex(e,v,S,y,!0,-h,g),this.distance>gd/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,l,h,g,y))}addHalfVertex({x:e,y:r},l,h,g,y,v,S){const E=.5*(this.lineClips?this.scaledDistance*(gd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(g?1:0),(r<<1)+(y?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&E)<<2,E>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),S.primitiveLength++),y?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}let yd,Rs;rt("LineBucket",ec,{omit:["layers","patternFeatures"]});var rh={get paint(){return Rs=Rs||new wi({"line-opacity":new mt(Ee.paint_line["line-opacity"]),"line-color":new mt(Ee.paint_line["line-color"]),"line-translate":new wt(Ee.paint_line["line-translate"]),"line-translate-anchor":new wt(Ee.paint_line["line-translate-anchor"]),"line-width":new mt(Ee.paint_line["line-width"]),"line-gap-width":new mt(Ee.paint_line["line-gap-width"]),"line-offset":new mt(Ee.paint_line["line-offset"]),"line-blur":new mt(Ee.paint_line["line-blur"]),"line-dasharray":new li(Ee.paint_line["line-dasharray"]),"line-pattern":new Ri(Ee.paint_line["line-pattern"]),"line-gradient":new Br(Ee.paint_line["line-gradient"])})},get layout(){return yd=yd||new wi({"line-cap":new wt(Ee.layout_line["line-cap"]),"line-join":new mt(Ee.layout_line["line-join"]),"line-miter-limit":new wt(Ee.layout_line["line-miter-limit"]),"line-round-limit":new wt(Ee.layout_line["line-round-limit"]),"line-sort-key":new mt(Ee.layout_line["line-sort-key"])})}};class tp extends mt{possiblyEvaluate(e,r){return r=new oi(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,l,h){return r=Et({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,l,h)}}let tc;class ho extends ka{constructor(e){super(e,rh),this.gradientVersion=0,tc||(tc=new tp(rh.paint.properties["line-width"].specification),tc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!(function(l){return l._styleExpression!==void 0})(r)&&r._styleExpression.expression instanceof Yr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=tc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new ec(e)}queryRadius(e){const r=e,l=sh(qo("line-width",this,r),qo("line-gap-width",this,r)),h=qo("line-offset",this,r);return l/2+Math.abs(h)+Go(this.paint.get("line-translate"))}queryIntersectsFeature(e,r,l,h,g,y,v){const S=wl(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,v),E=v/2*sh(this.paint.get("line-width").evaluate(r,l),this.paint.get("line-gap-width").evaluate(r,l)),z=this.paint.get("line-offset").evaluate(r,l);return z&&(h=(function(I,L){const O=[];for(let P=0;P<I.length;P++){const G=I[P],X=[];for(let J=0;J<G.length;J++){const ce=G[J-1],ie=G[J],he=G[J+1],fe=J===0?new pe(0,0):ie.sub(ce)._unit()._perp(),De=J===G.length-1?new pe(0,0):he.sub(ie)._unit()._perp(),Xe=fe._add(De)._unit(),vt=Xe.x*De.x+Xe.y*De.y;vt!==0&&Xe._mult(1/vt),X.push(Xe._mult(L)._add(ie))}O.push(X)}return O})(h,z*v)),(function(I,L,O){for(let P=0;P<L.length;P++){const G=L[P];if(I.length>=3){for(let X=0;X<G.length;X++)if(Va(I,G[X]))return!0}if(Ud(I,G,O))return!0}return!1})(S,h,E)}isTileClipped(){return!0}}function sh(a,e){return e>0?e+2*a:a}const df=zi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),oh=zi([{name:"a_projected_pos",components:3,type:"Float32"}],4);zi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ic=zi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);zi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const aa=zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ip=zi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ap(a,e,r){return a.sections.forEach((l=>{l.text=(function(h,g,y){const v=g.layout.get("text-transform").evaluate(y,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),Ya.applyArabicShaping&&(h=Ya.applyArabicShaping(h)),h})(l.text,e,r)})),a}zi([{name:"triangle",components:3,type:"Uint16"}]),zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),zi([{type:"Float32",name:"offsetX"}]),zi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),zi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const cu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var fa=24,fo=vi,_d=function(a,e,r,l,h){var g,y,v=8*h-l-1,S=(1<<v)-1,E=S>>1,z=-7,I=h-1,L=-1,O=a[e+I];for(I+=L,g=O&(1<<-z)-1,O>>=-z,z+=v;z>0;g=256*g+a[e+I],I+=L,z-=8);for(y=g&(1<<-z)-1,g>>=-z,z+=l;z>0;y=256*y+a[e+I],I+=L,z-=8);if(g===0)g=1-E;else{if(g===S)return y?NaN:1/0*(O?-1:1);y+=Math.pow(2,l),g-=E}return(O?-1:1)*y*Math.pow(2,g-l)},vd=function(a,e,r,l,h,g){var y,v,S,E=8*g-h-1,z=(1<<E)-1,I=z>>1,L=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=0,P=1,G=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,y=z):(y=Math.floor(Math.log(e)/Math.LN2),e*(S=Math.pow(2,-y))<1&&(y--,S*=2),(e+=y+I>=1?L/S:L*Math.pow(2,1-I))*S>=2&&(y++,S/=2),y+I>=z?(v=0,y=z):y+I>=1?(v=(e*S-1)*Math.pow(2,h),y+=I):(v=e*Math.pow(2,I-1)*Math.pow(2,h),y=0));h>=8;a[r+O]=255&v,O+=P,v/=256,h-=8);for(y=y<<h|v,E+=h;E>0;a[r+O]=255&y,O+=P,y/=256,E-=8);a[r+O-P]|=128*G};function vi(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}vi.Varint=0,vi.Fixed64=1,vi.Bytes=2,vi.Fixed32=5;var Pr=4294967296,xd=1/Pr,lh=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Bs(a){return a.type===vi.Bytes?a.readVarint()+a.pos:a.pos+1}function Ho(a,e,r){return r?4294967296*e+(a>>>0):4294967296*(e>>>0)+(a>>>0)}function uh(a,e,r){var l=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(l);for(var h=r.pos-1;h>=a;h--)r.buf[h+l]=r.buf[h]}function ch(a,e){for(var r=0;r<a.length;r++)e.writeVarint(a[r])}function ff(a,e){for(var r=0;r<a.length;r++)e.writeSVarint(a[r])}function po(a,e){for(var r=0;r<a.length;r++)e.writeFloat(a[r])}function Ga(a,e){for(var r=0;r<a.length;r++)e.writeDouble(a[r])}function bd(a,e){for(var r=0;r<a.length;r++)e.writeBoolean(a[r])}function pf(a,e){for(var r=0;r<a.length;r++)e.writeFixed32(a[r])}function un(a,e){for(var r=0;r<a.length;r++)e.writeSFixed32(a[r])}function np(a,e){for(var r=0;r<a.length;r++)e.writeFixed64(a[r])}function mf(a,e){for(var r=0;r<a.length;r++)e.writeSFixed64(a[r])}function ac(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+16777216*a[e+3]}function Vi(a,e,r){a[r]=e,a[r+1]=e>>>8,a[r+2]=e>>>16,a[r+3]=e>>>24}function qn(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+(a[e+3]<<24)}vi.prototype={destroy:function(){this.buf=null},readFields:function(a,e,r){for(r=r||this.length;this.pos<r;){var l=this.readVarint(),h=l>>3,g=this.pos;this.type=7&l,a(h,e,this),this.pos===g&&this.skip(l)}return e},readMessage:function(a,e){return this.readFields(a,e,this.readVarint()+this.pos)},readFixed32:function(){var a=ac(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=qn(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=ac(this.buf,this.pos)+ac(this.buf,this.pos+4)*Pr;return this.pos+=8,a},readSFixed64:function(){var a=ac(this.buf,this.pos)+qn(this.buf,this.pos+4)*Pr;return this.pos+=8,a},readFloat:function(){var a=_d(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=_d(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var e,r,l=this.buf;return e=127&(r=l[this.pos++]),r<128?e:(e|=(127&(r=l[this.pos++]))<<7,r<128?e:(e|=(127&(r=l[this.pos++]))<<14,r<128?e:(e|=(127&(r=l[this.pos++]))<<21,r<128?e:(function(h,g,y){var v,S,E=y.buf;if(v=(112&(S=E[y.pos++]))>>4,S<128||(v|=(127&(S=E[y.pos++]))<<3,S<128)||(v|=(127&(S=E[y.pos++]))<<10,S<128)||(v|=(127&(S=E[y.pos++]))<<17,S<128)||(v|=(127&(S=E[y.pos++]))<<24,S<128)||(v|=(1&(S=E[y.pos++]))<<31,S<128))return Ho(h,v,g);throw new Error("Expected varint not more than 10 bytes")})(e|=(15&(r=l[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,e=this.pos;return this.pos=a,a-e>=12&&lh?(function(r,l,h){return lh.decode(r.subarray(l,h))})(this.buf,e,a):(function(r,l,h){for(var g="",y=l;y<h;){var v,S,E,z=r[y],I=null,L=z>239?4:z>223?3:z>191?2:1;if(y+L>h)break;L===1?z<128&&(I=z):L===2?(192&(v=r[y+1]))==128&&(I=(31&z)<<6|63&v)<=127&&(I=null):L===3?(S=r[y+2],(192&(v=r[y+1]))==128&&(192&S)==128&&((I=(15&z)<<12|(63&v)<<6|63&S)<=2047||I>=55296&&I<=57343)&&(I=null)):L===4&&(S=r[y+2],E=r[y+3],(192&(v=r[y+1]))==128&&(192&S)==128&&(192&E)==128&&((I=(15&z)<<18|(63&v)<<12|(63&S)<<6|63&E)<=65535||I>=1114112)&&(I=null)),I===null?(I=65533,L=1):I>65535&&(I-=65536,g+=String.fromCharCode(I>>>10&1023|55296),I=56320|1023&I),g+=String.fromCharCode(I),y+=L}return g})(this.buf,e,a)},readBytes:function(){var a=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,a);return this.pos=a,e},readPackedVarint:function(a,e){if(this.type!==vi.Bytes)return a.push(this.readVarint(e));var r=Bs(this);for(a=a||[];this.pos<r;)a.push(this.readVarint(e));return a},readPackedSVarint:function(a){if(this.type!==vi.Bytes)return a.push(this.readSVarint());var e=Bs(this);for(a=a||[];this.pos<e;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==vi.Bytes)return a.push(this.readBoolean());var e=Bs(this);for(a=a||[];this.pos<e;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==vi.Bytes)return a.push(this.readFloat());var e=Bs(this);for(a=a||[];this.pos<e;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==vi.Bytes)return a.push(this.readDouble());var e=Bs(this);for(a=a||[];this.pos<e;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==vi.Bytes)return a.push(this.readFixed32());var e=Bs(this);for(a=a||[];this.pos<e;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==vi.Bytes)return a.push(this.readSFixed32());var e=Bs(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==vi.Bytes)return a.push(this.readFixed64());var e=Bs(this);for(a=a||[];this.pos<e;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==vi.Bytes)return a.push(this.readSFixed64());var e=Bs(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed64());return a},skip:function(a){var e=7&a;if(e===vi.Varint)for(;this.buf[this.pos++]>127;);else if(e===vi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===vi.Fixed32)this.pos+=4;else{if(e!==vi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(a,e){this.writeVarint(a<<3|e)},realloc:function(a){for(var e=this.length||16;e<this.pos+a;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Vi(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Vi(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Vi(this.buf,-1&a,this.pos),Vi(this.buf,Math.floor(a*xd),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Vi(this.buf,-1&a,this.pos),Vi(this.buf,Math.floor(a*xd),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?(function(e,r){var l,h;if(e>=0?(l=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(l=~(-e%4294967296))?l=l+1|0:(l=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),(function(g,y,v){v.buf[v.pos++]=127&g|128,g>>>=7,v.buf[v.pos++]=127&g|128,g>>>=7,v.buf[v.pos++]=127&g|128,g>>>=7,v.buf[v.pos++]=127&g|128,v.buf[v.pos]=127&(g>>>=7)})(l,0,r),(function(g,y){var v=(7&g)<<4;y.buf[y.pos++]|=v|((g>>>=3)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g)))))})(h,r)})(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var e=this.pos;this.pos=(function(l,h,g){for(var y,v,S=0;S<h.length;S++){if((y=h.charCodeAt(S))>55295&&y<57344){if(!v){y>56319||S+1===h.length?(l[g++]=239,l[g++]=191,l[g++]=189):v=y;continue}if(y<56320){l[g++]=239,l[g++]=191,l[g++]=189,v=y;continue}y=v-55296<<10|y-56320|65536,v=null}else v&&(l[g++]=239,l[g++]=191,l[g++]=189,v=null);y<128?l[g++]=y:(y<2048?l[g++]=y>>6|192:(y<65536?l[g++]=y>>12|224:(l[g++]=y>>18|240,l[g++]=y>>12&63|128),l[g++]=y>>6&63|128),l[g++]=63&y|128)}return g})(this.buf,a,this.pos);var r=this.pos-e;r>=128&&uh(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(a){this.realloc(4),vd(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),vd(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var e=a.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=a[r]},writeRawMessage:function(a,e){this.pos++;var r=this.pos;a(e,this);var l=this.pos-r;l>=128&&uh(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeMessage:function(a,e,r){this.writeTag(a,vi.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(a,e){e.length&&this.writeMessage(a,ch,e)},writePackedSVarint:function(a,e){e.length&&this.writeMessage(a,ff,e)},writePackedBoolean:function(a,e){e.length&&this.writeMessage(a,bd,e)},writePackedFloat:function(a,e){e.length&&this.writeMessage(a,po,e)},writePackedDouble:function(a,e){e.length&&this.writeMessage(a,Ga,e)},writePackedFixed32:function(a,e){e.length&&this.writeMessage(a,pf,e)},writePackedSFixed32:function(a,e){e.length&&this.writeMessage(a,un,e)},writePackedFixed64:function(a,e){e.length&&this.writeMessage(a,np,e)},writePackedSFixed64:function(a,e){e.length&&this.writeMessage(a,mf,e)},writeBytesField:function(a,e){this.writeTag(a,vi.Bytes),this.writeBytes(e)},writeFixed32Field:function(a,e){this.writeTag(a,vi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(a,e){this.writeTag(a,vi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(a,e){this.writeTag(a,vi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(a,e){this.writeTag(a,vi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(a,e){this.writeTag(a,vi.Varint),this.writeVarint(e)},writeSVarintField:function(a,e){this.writeTag(a,vi.Varint),this.writeSVarint(e)},writeStringField:function(a,e){this.writeTag(a,vi.Bytes),this.writeString(e)},writeFloatField:function(a,e){this.writeTag(a,vi.Fixed32),this.writeFloat(e)},writeDoubleField:function(a,e){this.writeTag(a,vi.Fixed64),this.writeDouble(e)},writeBooleanField:function(a,e){this.writeVarintField(a,!!e)}};var cs=U(fo);const hh=3;function gf(a,e,r){a===1&&r.readMessage(yf,e)}function yf(a,e,r){if(a===3){const{id:l,bitmap:h,width:g,height:y,left:v,top:S,advance:E}=r.readMessage(rp,{});e.push({id:l,bitmap:new iu({width:g+2*hh,height:y+2*hh},h),metrics:{width:g,height:y,left:v,top:S,advance:E}})}}function rp(a,e,r){a===1?e.id=r.readVarint():a===2?e.bitmap=r.readBytes():a===3?e.width=r.readVarint():a===4?e.height=r.readVarint():a===5?e.left=r.readSVarint():a===6?e.top=r.readSVarint():a===7&&(e.advance=r.readVarint())}const nc=hh;function Gn(a){let e=0,r=0;for(const y of a)e+=y.w*y.h,r=Math.max(r,y.w);a.sort(((y,v)=>v.h-y.h));const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let h=0,g=0;for(const y of a)for(let v=l.length-1;v>=0;v--){const S=l[v];if(!(y.w>S.w||y.h>S.h)){if(y.x=S.x,y.y=S.y,g=Math.max(g,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===S.w&&y.h===S.h){const E=l.pop();v<l.length&&(l[v]=E)}else y.h===S.h?(S.x+=y.w,S.w-=y.w):y.w===S.w?(S.y+=y.h,S.h-=y.h):(l.push({x:S.x+y.w,y:S.y,w:S.w-y.w,h:y.h}),S.y+=y.h,S.h-=y.h);break}}return{w:h,h:g,fill:e/(h*g)||0}}const pa=1;class dh{constructor(e,{pixelRatio:r,version:l,stretchX:h,stretchY:g,content:y}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=h,this.stretchY=g,this.content=y,this.version=l}get tl(){return[this.paddedRect.x+pa,this.paddedRect.y+pa]}get br(){return[this.paddedRect.x+this.paddedRect.w-pa,this.paddedRect.y+this.paddedRect.h-pa]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*pa)/this.pixelRatio,(this.paddedRect.h-2*pa)/this.pixelRatio]}}class Zn{constructor(e,r){const l={},h={};this.haveRenderCallbacks=[];const g=[];this.addImages(e,l,g),this.addImages(r,h,g);const{w:y,h:v}=Gn(g),S=new ar({width:y||1,height:v||1});for(const E in e){const z=e[E],I=l[E].paddedRect;ar.copy(z.data,S,{x:0,y:0},{x:I.x+pa,y:I.y+pa},z.data)}for(const E in r){const z=r[E],I=h[E].paddedRect,L=I.x+pa,O=I.y+pa,P=z.data.width,G=z.data.height;ar.copy(z.data,S,{x:0,y:0},{x:L,y:O},z.data),ar.copy(z.data,S,{x:0,y:G-1},{x:L,y:O-1},{width:P,height:1}),ar.copy(z.data,S,{x:0,y:0},{x:L,y:O+G},{width:P,height:1}),ar.copy(z.data,S,{x:P-1,y:0},{x:L-1,y:O},{width:1,height:G}),ar.copy(z.data,S,{x:0,y:0},{x:L+P,y:O},{width:1,height:G})}this.image=S,this.iconPositions=l,this.patternPositions=h}addImages(e,r,l){for(const h in e){const g=e[h],y={x:0,y:0,w:g.data.width+2*pa,h:g.data.height+2*pa};l.push(y),r[h]=new dh(y,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),r),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),r)}patchUpdatedImage(e,r,l){if(!e||!r||e.version===r.version)return;e.version=r.version;const[h,g]=e.tl;l.update(r.data,void 0,{x:h,y:g})}}var mo;rt("ImagePosition",dh),rt("ImageAtlas",Zn),f.ai=void 0,(mo=f.ai||(f.ai={}))[mo.none=0]="none",mo[mo.horizontal=1]="horizontal",mo[mo.vertical=2]="vertical",mo[mo.horizontalOnly=3]="horizontalOnly";const xr=-17;class hs{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const l=new hs;return l.scale=e||1,l.fontStack=r,l}static forImage(e){const r=new hs;return r.imageName=e,r}}class nr{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const l=new nr;for(let h=0;h<e.sections.length;h++){const g=e.sections[h];g.image?l.addImageSection(g):l.addTextSection(g,r)}return l}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=(function(e){let r="";for(let l=0;l<e.length;l++){const h=e.charCodeAt(l+1)||null,g=e.charCodeAt(l-1)||null;r+=h&&Bc(h)&&!cu[e[l+1]]||g&&Bc(g)&&!cu[e[l-1]]||!cu[e[l]]?e[l]:cu[e[l]]}return r})(this.text)}trim(){let e=0;for(let l=0;l<this.text.length&&du[this.text.charCodeAt(l)];l++)e++;let r=this.text.length;for(let l=this.text.length-1;l>=0&&l>=e&&du[this.text.charCodeAt(l)];l--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const l=new nr;return l.text=this.text.substring(e,r),l.sectionIndex=this.sectionIndex.slice(e,r),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,r)=>Math.max(e,this.sections[r].scale)),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(hs.forText(e.scale,e.fontStack||r));const l=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(l)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void Bi("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(hs.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Bi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function hu(a,e,r,l,h,g,y,v,S,E,z,I,L,O,P,G){const X=nr.fromFeature(a,h);let J;I===f.ai.vertical&&X.verticalizePunctuation();const{processBidirectionalText:ce,processStyledBidirectionalText:ie}=Ya;if(ce&&X.sections.length===1){J=[];const De=ce(X.toString(),fh(X,E,g,e,l,O,P));for(const Xe of De){const vt=new nr;vt.text=Xe,vt.sections=X.sections;for(let lt=0;lt<Xe.length;lt++)vt.sectionIndex.push(0);J.push(vt)}}else if(ie){J=[];const De=ie(X.text,X.sectionIndex,fh(X,E,g,e,l,O,P));for(const Xe of De){const vt=new nr;vt.text=Xe[0],vt.sectionIndex=Xe[1],vt.sections=X.sections,J.push(vt)}}else J=(function(De,Xe){const vt=[],lt=De.text;let at=0;for(const Ke of Xe)vt.push(De.substring(at,Ke)),at=Ke;return at<lt.length&&vt.push(De.substring(at,lt.length)),vt})(X,fh(X,E,g,e,l,O,P));const he=[],fe={positionedLines:he,text:X.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:I,iconsInText:!1,verticalizable:!1};return(function(De,Xe,vt,lt,at,Ke,dt,We,qe,zt,xt,Yt){let Xi=0,Yi=xr,Oa=0,Xn=0;const Pn=We==="right"?1:We==="left"?0:.5;let Ia=0;for(const Pa of at){Pa.trim();const Na=Pa.getMaxScale(),hn=(Na-1)*fa,dn={positionedGlyphs:[],lineOffset:0};De.positionedLines[Ia]=dn;const en=dn.positionedGlyphs;let Yn=0;if(!Pa.length()){Yi+=Ke,++Ia;continue}for(let Ea=0;Ea<Pa.length();Ea++){const ei=Pa.getSection(Ea),fn=Pa.getSectionIndex(Ea),tn=Pa.getCharCode(Ea);let ma=0,Aa=null,Fr=null,ur=null,Sn=fa;const Ur=!(qe===f.ai.horizontal||!xt&&!Es(tn)||xt&&(du[tn]||(ra=tn,ot.Arabic(ra)||ot["Arabic Supplement"](ra)||ot["Arabic Extended-A"](ra)||ot["Arabic Presentation Forms-A"](ra)||ot["Arabic Presentation Forms-B"](ra))));if(ei.imageName){const br=lt[ei.imageName];if(!br)continue;ur=ei.imageName,De.iconsInText=De.iconsInText||!0,Fr=br.paddedRect;const $a=br.displaySize;ei.scale=ei.scale*fa/Yt,Aa={width:$a[0],height:$a[1],left:pa,top:-nc,advance:Ur?$a[1]:$a[0]},ma=hn+(fa-$a[1]*ei.scale),Sn=Aa.advance;const Us=Ur?$a[0]*ei.scale-fa*Na:$a[1]*ei.scale-fa*Na;Us>0&&Us>Yn&&(Yn=Us)}else{const br=vt[ei.fontStack],$a=br&&br[tn];if($a&&$a.rect)Fr=$a.rect,Aa=$a.metrics;else{const Us=Xe[ei.fontStack],bc=Us&&Us[tn];if(!bc)continue;Aa=bc.metrics}ma=(Na-ei.scale)*fa}Ur?(De.verticalizable=!0,en.push({glyph:tn,imageName:ur,x:Xi,y:Yi+ma,vertical:Ur,scale:ei.scale,fontStack:ei.fontStack,sectionIndex:fn,metrics:Aa,rect:Fr}),Xi+=Sn*ei.scale+zt):(en.push({glyph:tn,imageName:ur,x:Xi,y:Yi+ma,vertical:Ur,scale:ei.scale,fontStack:ei.fontStack,sectionIndex:fn,metrics:Aa,rect:Fr}),Xi+=Aa.advance*ei.scale+zt)}en.length!==0&&(Oa=Math.max(Xi-zt,Oa),sc(en,0,en.length-1,Pn,Yn)),Xi=0;const sa=Ke*Na+Yn;dn.lineOffset=Math.max(Yn,hn),Yi+=sa,Xn=Math.max(sa,Xn),++Ia}var ra;const Wa=Yi-xr,{horizontalAlign:wn,verticalAlign:cn}=ph(dt);(function(Pa,Na,hn,dn,en,Yn,sa,Ea,ei){const fn=(Na-hn)*en;let tn=0;tn=Yn!==sa?-Ea*dn-xr:(-dn*ei+.5)*sa;for(const ma of Pa)for(const Aa of ma.positionedGlyphs)Aa.x+=fn,Aa.y+=tn})(De.positionedLines,Pn,wn,cn,Oa,Xn,Ke,Wa,at.length),De.top+=-cn*Wa,De.bottom=De.top+Wa,De.left+=-wn*Oa,De.right=De.left+Oa})(fe,e,r,l,J,y,v,S,I,E,L,G),!(function(De){for(const Xe of De)if(Xe.positionedGlyphs.length!==0)return!1;return!0})(he)&&fe}const du={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ds={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function wd(a,e,r,l,h,g){if(e.imageName){const y=l[e.imageName];return y?y.displaySize[0]*e.scale*fa/g+h:0}{const y=r[e.fontStack],v=y&&y[a];return v?v.metrics.advance*e.scale+h:0}}function Ml(a,e,r,l){const h=Math.pow(a-e,2);return l?a<e?h/2:2*h:h+Math.abs(r)*r}function rc(a,e,r){let l=0;return a===10&&(l-=1e4),r&&(l+=150),a!==40&&a!==65288||(l+=50),e!==41&&e!==65289||(l+=50),l}function fu(a,e,r,l,h,g){let y=null,v=Ml(e,r,h,g);for(const S of l){const E=Ml(e-S.x,r,h,g)+S.badness;E<=v&&(y=S,v=E)}return{index:a,x:e,priorBreak:y,badness:v}}function Cl(a){return a?Cl(a.priorBreak).concat(a.index):[]}function fh(a,e,r,l,h,g,y){if(g!=="point")return[];if(!a)return[];const v=[],S=(function(L,O,P,G,X,J){let ce=0;for(let ie=0;ie<L.length();ie++){const he=L.getSection(ie);ce+=wd(L.getCharCode(ie),he,G,X,O,J)}return ce/Math.max(1,Math.ceil(ce/P))})(a,e,r,l,h,y),E=a.text.indexOf("​")>=0;let z=0;for(let L=0;L<a.length();L++){const O=a.getSection(L),P=a.getCharCode(L);if(du[P]||(z+=wd(P,O,l,h,e,y)),L<a.length()-1){const G=!((I=P)<11904||!(ot["Bopomofo Extended"](I)||ot.Bopomofo(I)||ot["CJK Compatibility Forms"](I)||ot["CJK Compatibility Ideographs"](I)||ot["CJK Compatibility"](I)||ot["CJK Radicals Supplement"](I)||ot["CJK Strokes"](I)||ot["CJK Symbols and Punctuation"](I)||ot["CJK Unified Ideographs Extension A"](I)||ot["CJK Unified Ideographs"](I)||ot["Enclosed CJK Letters and Months"](I)||ot["Halfwidth and Fullwidth Forms"](I)||ot.Hiragana(I)||ot["Ideographic Description Characters"](I)||ot["Kangxi Radicals"](I)||ot["Katakana Phonetic Extensions"](I)||ot.Katakana(I)||ot["Vertical Forms"](I)||ot["Yi Radicals"](I)||ot["Yi Syllables"](I)));(ds[P]||G||O.imageName)&&v.push(fu(L+1,z,S,v,rc(P,a.getCharCode(L+1),G&&E),!1))}}var I;return Cl(fu(a.length(),z,S,v,0,!0))}function ph(a){let e=.5,r=.5;switch(a){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function sc(a,e,r,l,h){if(!l&&!h)return;const g=a[r],y=(a[r].x+g.metrics.advance*g.scale)*l;for(let v=e;v<=r;v++)a[v].x-=y,a[v].y+=h}function _f(a,e,r){const{horizontalAlign:l,verticalAlign:h}=ph(r),g=e[0]-a.displaySize[0]*l,y=e[1]-a.displaySize[1]*h;return{image:a,top:y,bottom:y+a.displaySize[1],left:g,right:g+a.displaySize[0]}}function oc(a,e,r,l,h,g){const y=a.image;let v;if(y.content){const X=y.content,J=y.pixelRatio||1;v=[X[0]/J,X[1]/J,y.displaySize[0]-X[2]/J,y.displaySize[1]-X[3]/J]}const S=e.left*g,E=e.right*g;let z,I,L,O;r==="width"||r==="both"?(O=h[0]+S-l[3],I=h[0]+E+l[1]):(O=h[0]+(S+E-y.displaySize[0])/2,I=O+y.displaySize[0]);const P=e.top*g,G=e.bottom*g;return r==="height"||r==="both"?(z=h[1]+P-l[0],L=h[1]+G+l[2]):(z=h[1]+(P+G-y.displaySize[1])/2,L=z+y.displaySize[1]),{image:y,top:z,right:I,bottom:L,left:O,collisionPadding:v}}const pu=255,Os=128,Xo=pu*Os;function Ci(a,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new oi(a+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:h}=r;let g=0;for(;g<l.length&&l[g]<=a;)g++;g=Math.max(0,g-1);let y=g;for(;y<l.length&&l[y]<a+1;)y++;y=Math.min(l.length-1,y);const v=l[g],S=l[y];return r.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:S,minSize:r.evaluate(new oi(v)),maxSize:r.evaluate(new oi(S)),interpolationType:h}}}function qi(a,e,r){let l="never";const h=a.get(e);return h?l=h:a.get(r)&&(l="always"),l}const fi=co.VectorTileFeature.types,gi=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Di(a,e,r,l,h,g,y,v,S,E,z,I,L){const O=v?Math.min(Xo,Math.round(v[0])):0,P=v?Math.min(Xo,Math.round(v[1])):0;a.emplaceBack(e,r,Math.round(32*l),Math.round(32*h),g,y,(O<<1)+(S?1:0),P,16*E,16*z,256*I,256*L)}function $n(a,e,r){a.emplaceBack(e.x,e.y,r),a.emplaceBack(e.x,e.y,r),a.emplaceBack(e.x,e.y,r),a.emplaceBack(e.x,e.y,r)}function Yo(a){for(const e of a.sections)if(rs(e.text))return!0;return!1}class Ko{constructor(e){this.layoutVertexArray=new Ht,this.indexArray=new Ua,this.programConfigurations=e,this.segments=new Fi,this.dynamicLayoutVertexArray=new jt,this.opacityVertexArray=new Qt,this.hasVisibleVertices=!1,this.placedSymbolArray=new re}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,df.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,oh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,gi,!0),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}rt("SymbolBuffers",Ko);class lc{constructor(e,r,l){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new l,this.segments=new Fi,this.collisionVertexArray=new Mi}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,ic.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}rt("CollisionBuffers",lc);class rr{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((y=>y.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qc([]),this.placementViewportMatrix=qc([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ci(this.zoom,r["text-size"]),this.iconSizeData=Ci(this.zoom,r["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),g=l.get("symbol-z-order");this.canOverlap=qi(l,"text-overlap","text-allow-overlap")!=="never"||qi(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map((y=>f.ai[y]))),this.stateDependentLayerIds=this.layers.filter((y=>y.isStateDependent())).map((y=>y.id)),this.sourceID=e.sourceID}createArrays(){this.text=new Ko(new Nt(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new Ko(new Nt(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new oe,this.lineVertexArray=new _e,this.symbolInstances=new K,this.textAnchorOffsets=new ze}calculateGlyphDependencies(e,r,l,h,g){for(let y=0;y<e.length;y++)if(r[e.charCodeAt(y)]=!0,(l||h)&&g){const v=cu[e.charAt(y)];v&&(r[v.charCodeAt(0)]=!0)}}populate(e,r,l){const h=this.layers[0],g=h.layout,y=g.get("text-font"),v=g.get("text-field"),S=g.get("icon-image"),E=(v.value.kind!=="constant"||v.value.value instanceof Ha&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),z=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,I=g.get("symbol-sort-key");if(this.features=[],!E&&!z)return;const L=r.iconDependencies,O=r.glyphDependencies,P=r.availableImages,G=new oi(this.zoom);for(const{feature:X,id:J,index:ce,sourceLayerIndex:ie}of e){const he=h._featureFilter.needGeometry,fe=us(X,he);if(!h._featureFilter.filter(G,fe,l))continue;let De,Xe;if(he||(fe.geometry=ks(X)),E){const lt=h.getValueAndResolveTokens("text-field",fe,l,P),at=Ha.factory(lt);Yo(at)&&(this.hasRTLText=!0),(!this.hasRTLText||As()==="unavailable"||this.hasRTLText&&Ya.isParsed())&&(De=ap(at,h,fe))}if(z){const lt=h.getValueAndResolveTokens("icon-image",fe,l,P);Xe=lt instanceof Ma?lt:Ma.fromString(lt)}if(!De&&!Xe)continue;const vt=this.sortFeaturesByKey?I.evaluate(fe,{},l):void 0;if(this.features.push({id:J,text:De,icon:Xe,index:ce,sourceLayerIndex:ie,geometry:fe.geometry,properties:X.properties,type:fi[X.type],sortKey:vt}),Xe&&(L[Xe.name]=!0),De){const lt=y.evaluate(fe,{},l).join(","),at=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(f.ai.vertical)>=0;for(const Ke of De.sections)if(Ke.image)L[Ke.image.name]=!0;else{const dt=ns(De.toString()),We=Ke.fontStack||lt,qe=O[We]=O[We]||{};this.calculateGlyphDependencies(Ke.text,qe,at,this.allowVerticalPlacement,dt)}}}g.get("symbol-placement")==="line"&&(this.features=(function(X){const J={},ce={},ie=[];let he=0;function fe(lt){ie.push(X[lt]),he++}function De(lt,at,Ke){const dt=ce[lt];return delete ce[lt],ce[at]=dt,ie[dt].geometry[0].pop(),ie[dt].geometry[0]=ie[dt].geometry[0].concat(Ke[0]),dt}function Xe(lt,at,Ke){const dt=J[at];return delete J[at],J[lt]=dt,ie[dt].geometry[0].shift(),ie[dt].geometry[0]=Ke[0].concat(ie[dt].geometry[0]),dt}function vt(lt,at,Ke){const dt=Ke?at[0][at[0].length-1]:at[0][0];return`${lt}:${dt.x}:${dt.y}`}for(let lt=0;lt<X.length;lt++){const at=X[lt],Ke=at.geometry,dt=at.text?at.text.toString():null;if(!dt){fe(lt);continue}const We=vt(dt,Ke),qe=vt(dt,Ke,!0);if(We in ce&&qe in J&&ce[We]!==J[qe]){const zt=Xe(We,qe,Ke),xt=De(We,qe,ie[zt].geometry);delete J[We],delete ce[qe],ce[vt(dt,ie[xt].geometry,!0)]=xt,ie[zt].geometry=null}else We in ce?De(We,qe,Ke):qe in J?Xe(We,qe,Ke):(fe(lt),J[We]=he-1,ce[qe]=he-1)}return ie.filter((lt=>lt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((X,J)=>X.sortKey-J.sortKey))}update(e,r,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,l),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const l=this.lineVertexArray.length;if(e.segment!==void 0){let h=e.dist(r[e.segment+1]),g=e.dist(r[e.segment]);const y={};for(let v=e.segment+1;v<r.length;v++)y[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:h},v<r.length-1&&(h+=r[v+1].dist(r[v]));for(let v=e.segment||0;v>=0;v--)y[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:g},v>0&&(g+=r[v-1].dist(r[v]));for(let v=0;v<r.length;v++){const S=y[v];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(e,r,l,h,g,y,v,S,E,z,I,L){const O=e.indexArray,P=e.layoutVertexArray,G=e.segments.prepareSegment(4*r.length,P,O,this.canOverlap?y.sortKey:void 0),X=this.glyphOffsetArray.length,J=G.vertexLength,ce=this.allowVerticalPlacement&&v===f.ai.vertical?Math.PI/2:0,ie=y.text&&y.text.sections;for(let he=0;he<r.length;he++){const{tl:fe,tr:De,bl:Xe,br:vt,tex:lt,pixelOffsetTL:at,pixelOffsetBR:Ke,minFontScaleX:dt,minFontScaleY:We,glyphOffset:qe,isSDF:zt,sectionIndex:xt}=r[he],Yt=G.vertexLength,Xi=qe[1];Di(P,S.x,S.y,fe.x,Xi+fe.y,lt.x,lt.y,l,zt,at.x,at.y,dt,We),Di(P,S.x,S.y,De.x,Xi+De.y,lt.x+lt.w,lt.y,l,zt,Ke.x,at.y,dt,We),Di(P,S.x,S.y,Xe.x,Xi+Xe.y,lt.x,lt.y+lt.h,l,zt,at.x,Ke.y,dt,We),Di(P,S.x,S.y,vt.x,Xi+vt.y,lt.x+lt.w,lt.y+lt.h,l,zt,Ke.x,Ke.y,dt,We),$n(e.dynamicLayoutVertexArray,S,ce),O.emplaceBack(Yt,Yt+1,Yt+2),O.emplaceBack(Yt+1,Yt+2,Yt+3),G.vertexLength+=4,G.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qe[0]),he!==r.length-1&&xt===r[he+1].sectionIndex||e.programConfigurations.populatePaintArrays(P.length,y,y.index,{},L,ie&&ie[xt])}e.placedSymbolArray.emplaceBack(S.x,S.y,X,this.glyphOffsetArray.length-X,J,E,z,S.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],v,0,!1,0,I)}_addCollisionDebugVertex(e,r,l,h,g,y){return r.emplaceBack(0,0),e.emplaceBack(l.x,l.y,h,g,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(e,r,l,h,g,y,v){const S=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),E=S.vertexLength,z=g.layoutVertexArray,I=g.collisionVertexArray,L=v.anchorX,O=v.anchorY;this._addCollisionDebugVertex(z,I,y,L,O,new pe(e,r)),this._addCollisionDebugVertex(z,I,y,L,O,new pe(l,r)),this._addCollisionDebugVertex(z,I,y,L,O,new pe(l,h)),this._addCollisionDebugVertex(z,I,y,L,O,new pe(e,h)),S.vertexLength+=4;const P=g.indexArray;P.emplaceBack(E,E+1),P.emplaceBack(E+1,E+2),P.emplaceBack(E+2,E+3),P.emplaceBack(E+3,E),S.primitiveLength+=4}addDebugCollisionBoxes(e,r,l,h){for(let g=e;g<r;g++){const y=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new lc($i,aa.members,Ji),this.iconCollisionBox=new lc($i,aa.members,Ji);for(let e=0;e<this.symbolInstances.length;e++){const r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,l,h,g,y,v,S,E){const z={};for(let I=r;I<l;I++){const L=e.get(I);z.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.textFeatureIndex=L.featureIndex;break}for(let I=h;I<g;I++){const L=e.get(I);z.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.verticalTextFeatureIndex=L.featureIndex;break}for(let I=y;I<v;I++){const L=e.get(I);z.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.iconFeatureIndex=L.featureIndex;break}for(let I=S;I<E;I++){const L=e.get(I);z.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.verticalIconFeatureIndex=L.featureIndex;break}return z}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const l=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const l=e.placedSymbolArray.get(r),h=l.vertexStartIndex+4*l.numGlyphs;for(let g=l.vertexStartIndex;g<h;g+=4)e.indexArray.emplaceBack(g,g+1,g+2),e.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),l=Math.cos(e),h=[],g=[],y=[];for(let v=0;v<this.symbolInstances.length;++v){y.push(v);const S=this.symbolInstances.get(v);h.push(0|Math.round(r*S.anchorX+l*S.anchorY)),g.push(S.featureIndex)}return y.sort(((v,S)=>h[v]-h[S]||g[S]-g[v])),y}addToSortKeyRanges(e,r){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===r?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const l=this.symbolInstances.get(r);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach(((h,g,y)=>{h>=0&&y.indexOf(h)===g&&this.addIndicesForPlacedSymbol(this.text,h)})),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Ta,go;rt("SymbolBucket",rr,{omit:["layers","collisionBoxArray","features","compareText"]}),rr.MAX_GLYPHS=65535,rr.addDynamicAttributes=$n;var yo={get paint(){return go=go||new wi({"icon-opacity":new mt(Ee.paint_symbol["icon-opacity"]),"icon-color":new mt(Ee.paint_symbol["icon-color"]),"icon-halo-color":new mt(Ee.paint_symbol["icon-halo-color"]),"icon-halo-width":new mt(Ee.paint_symbol["icon-halo-width"]),"icon-halo-blur":new mt(Ee.paint_symbol["icon-halo-blur"]),"icon-translate":new wt(Ee.paint_symbol["icon-translate"]),"icon-translate-anchor":new wt(Ee.paint_symbol["icon-translate-anchor"]),"text-opacity":new mt(Ee.paint_symbol["text-opacity"]),"text-color":new mt(Ee.paint_symbol["text-color"],{runtimeType:Fa,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new mt(Ee.paint_symbol["text-halo-color"]),"text-halo-width":new mt(Ee.paint_symbol["text-halo-width"]),"text-halo-blur":new mt(Ee.paint_symbol["text-halo-blur"]),"text-translate":new wt(Ee.paint_symbol["text-translate"]),"text-translate-anchor":new wt(Ee.paint_symbol["text-translate-anchor"])})},get layout(){return Ta=Ta||new wi({"symbol-placement":new wt(Ee.layout_symbol["symbol-placement"]),"symbol-spacing":new wt(Ee.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wt(Ee.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new mt(Ee.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wt(Ee.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wt(Ee.layout_symbol["icon-allow-overlap"]),"icon-overlap":new wt(Ee.layout_symbol["icon-overlap"]),"icon-ignore-placement":new wt(Ee.layout_symbol["icon-ignore-placement"]),"icon-optional":new wt(Ee.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wt(Ee.layout_symbol["icon-rotation-alignment"]),"icon-size":new mt(Ee.layout_symbol["icon-size"]),"icon-text-fit":new wt(Ee.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wt(Ee.layout_symbol["icon-text-fit-padding"]),"icon-image":new mt(Ee.layout_symbol["icon-image"]),"icon-rotate":new mt(Ee.layout_symbol["icon-rotate"]),"icon-padding":new mt(Ee.layout_symbol["icon-padding"]),"icon-keep-upright":new wt(Ee.layout_symbol["icon-keep-upright"]),"icon-offset":new mt(Ee.layout_symbol["icon-offset"]),"icon-anchor":new mt(Ee.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wt(Ee.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wt(Ee.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wt(Ee.layout_symbol["text-rotation-alignment"]),"text-field":new mt(Ee.layout_symbol["text-field"]),"text-font":new mt(Ee.layout_symbol["text-font"]),"text-size":new mt(Ee.layout_symbol["text-size"]),"text-max-width":new mt(Ee.layout_symbol["text-max-width"]),"text-line-height":new wt(Ee.layout_symbol["text-line-height"]),"text-letter-spacing":new mt(Ee.layout_symbol["text-letter-spacing"]),"text-justify":new mt(Ee.layout_symbol["text-justify"]),"text-radial-offset":new mt(Ee.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wt(Ee.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new mt(Ee.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new mt(Ee.layout_symbol["text-anchor"]),"text-max-angle":new wt(Ee.layout_symbol["text-max-angle"]),"text-writing-mode":new wt(Ee.layout_symbol["text-writing-mode"]),"text-rotate":new mt(Ee.layout_symbol["text-rotate"]),"text-padding":new wt(Ee.layout_symbol["text-padding"]),"text-keep-upright":new wt(Ee.layout_symbol["text-keep-upright"]),"text-transform":new mt(Ee.layout_symbol["text-transform"]),"text-offset":new mt(Ee.layout_symbol["text-offset"]),"text-allow-overlap":new wt(Ee.layout_symbol["text-allow-overlap"]),"text-overlap":new wt(Ee.layout_symbol["text-overlap"]),"text-ignore-placement":new wt(Ee.layout_symbol["text-ignore-placement"]),"text-optional":new wt(Ee.layout_symbol["text-optional"])})}};class mh{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:xa,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}rt("FormatSectionOverride",mh,{omit:["defaultValue"]});class On extends ka{constructor(e){super(e,yo)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const g of l)h.indexOf(g)<0&&h.push(g);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,l,h){const g=this.layout.get(e).evaluate(r,{},l,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||sl(y.value)||!g?g:(function(v,S){return S.replace(/{([^{}]+)}/g,((E,z)=>v&&z in v?String(v[z]):""))})(r.properties,g)}createBucket(e){return new rr(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of yo.paint.overridableProperties){if(!On.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),l=new mh(r),h=new Gl(l,r.property.specification);let g=null;g=r.value.kind==="constant"||r.value.kind==="source"?new Zl("source",h):new Qr("composite",h,r.value.zoomStops),this.paint._values[e]=new Ka(r.property,g,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,l){return!(!this.layout||r.isDataDriven()||l.isDataDriven())&&On.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const l=e.get("text-field"),h=yo.paint.properties[r];let g=!1;const y=v=>{for(const S of v)if(h.overrides&&h.overrides.hasOverride(S))return void(g=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Ha)y(l.value.value.sections);else if(l.value.kind==="source"){const v=E=>{g||(E instanceof Zr&&Qi(E.value)===Z?y(E.value.sections):E instanceof Vl?y(E.sections):E.eachChild(v))},S=l.value;S._styleExpression&&v(S._styleExpression.expression)}return g}}let Dl;var uc={get paint(){return Dl=Dl||new wi({"background-color":new wt(Ee.paint_background["background-color"]),"background-pattern":new li(Ee.paint_background["background-pattern"]),"background-opacity":new wt(Ee.paint_background["background-opacity"])})}};class sr extends ka{constructor(e){super(e,uc)}}let gh;var yh={get paint(){return gh=gh||new wi({"raster-opacity":new wt(Ee.paint_raster["raster-opacity"]),"raster-hue-rotate":new wt(Ee.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wt(Ee.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wt(Ee.paint_raster["raster-brightness-max"]),"raster-saturation":new wt(Ee.paint_raster["raster-saturation"]),"raster-contrast":new wt(Ee.paint_raster["raster-contrast"]),"raster-resampling":new wt(Ee.paint_raster["raster-resampling"]),"raster-fade-duration":new wt(Ee.paint_raster["raster-fade-duration"])})}};class vf extends ka{constructor(e){super(e,yh)}}class _h extends ka{constructor(e){super(e,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class vh{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){delete this._channel,this._callback=()=>{}}}const Ps=63710088e-1;class na{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new na(Pe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,l=this.lat*r,h=e.lat*r,g=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((e.lng-this.lng)*r);return Ps*Math.acos(Math.min(g,1))}static convert(e){if(e instanceof na)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new na(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new na(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const _o=2*Math.PI*Ps;function Il(a){return _o*Math.cos(a*Math.PI/180)}function Ns(a){return(180+a)/360}function xh(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function bh(a,e){return a/Il(e)}function Sd(a){return 360*a-180}function kl(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class mu{constructor(e,r,l=0){this.x=+e,this.y=+r,this.z=+l}static fromLngLat(e,r=0){const l=na.convert(e);return new mu(Ns(l.lng),xh(l.lat),bh(r,l.lat))}toLngLat(){return new na(Sd(this.x),kl(this.y))}toAltitude(){return this.z*Il(kl(this.y))}meterInMercatorCoordinateUnits(){return 1/_o*(e=kl(this.y),1/Math.cos(e*Math.PI/180));var e}}function or(a,e,r){var l=2*Math.PI*6378137/256/Math.pow(2,r);return[a*l-2*Math.PI*6378137/2,e*l-2*Math.PI*6378137/2]}class wh{constructor(e,r,l){if(e<0||e>25||l<0||l>=Math.pow(2,e)||r<0||r>=Math.pow(2,e))throw new Error(`x=${r}, y=${l}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=r,this.y=l,this.key=gu(0,e,e,r,l)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,l){const h=(y=this.y,v=this.z,S=or(256*(g=this.x),256*(y=Math.pow(2,v)-y-1),v),E=or(256*(g+1),256*(y+1),v),S[0]+","+S[1]+","+E[0]+","+E[1]);var g,y,v,S,E;const z=(function(I,L,O){let P,G="";for(let X=I;X>0;X--)P=1<<X-1,G+=(L&P?1:0)+(O&P?2:0);return G})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,z).replace(/{bbox-epsg-3857}/g,h)}isChildOf(e){const r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){const r=Math.pow(2,this.z);return new pe((e.x*r-this.x)*da,(e.y*r-this.y)*da)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Hn{constructor(e,r){this.wrap=e,this.canonical=r,this.key=gu(e,r.z,r.z,r.x,r.y)}}class lr{constructor(e,r,l,h,g){if(e<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${l}`);this.overscaledZ=e,this.wrap=r,this.canonical=new wh(l,+h,+g),this.key=gu(r,e,l,h,g)}clone(){return new lr(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?new lr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new lr(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-e;return e>this.canonical.z?gu(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):gu(this.wrap*+r,e,e,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new lr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new lr(r,this.wrap,r,l,h),new lr(r,this.wrap,r,l+1,h),new lr(r,this.wrap,r,l,h+1),new lr(r,this.wrap,r,l+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new lr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new lr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Hn(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new mu(e.x-this.wrap,e.y))}}function gu(a,e,r,l,h){(a*=2)<0&&(a=-1*a-1);const g=1<<r;return(g*g*a+g*h+l).toString(36)+r.toString(36)+e.toString(36)}rt("CanonicalTileID",wh),rt("OverscaledTileID",lr,{omit:["posMatrix"]});class xf{constructor(e,r,l,h=1,g=1,y=1,v=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Bi(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const S=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=g,this.blueFactor=y,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let E=0;E<S;E++)this.data[this._idx(-1,E)]=this.data[this._idx(0,E)],this.data[this._idx(S,E)]=this.data[this._idx(S-1,E)],this.data[this._idx(E,-1)]=this.data[this._idx(E,0)],this.data[this._idx(E,S)]=this.data[this._idx(E,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let E=0;E<S;E++)for(let z=0;z<S;z++){const I=this.get(E,z);I>this.max&&(this.max=I),I<this.min&&(this.min=I)}}get(e,r){const l=new Uint8Array(this.data.buffer),h=4*this._idx(e,r);return this.unpack(l[h],l[h+1],l[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,l){return e*this.redFactor+r*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new ar({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=r*this.dim,g=r*this.dim+this.dim,y=l*this.dim,v=l*this.dim+this.dim;switch(r){case-1:h=g-1;break;case 1:g=h+1}switch(l){case-1:y=v-1;break;case 1:v=y+1}const S=-r*this.dim,E=-l*this.dim;for(let z=y;z<v;z++)for(let I=h;I<g;I++)this.data[this._idx(I,z)]=e.data[this._idx(I+S,z+E)]}}rt("DEMData",xf);class vo{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const l=e[r];this._stringToNumber[l]=r,this._numberToString[r]=l}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class cc{constructor(e,r,l,h,g){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=l,e._y=h,this.properties=e.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(e[r]=this[r]);return e}}class Sh{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new sn(da,16,0),this.grid3D=new sn(da,16,0),this.featureIndexArray=new Re,this.promoteId=r}insert(e,r,l,h,g,y){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,g);const S=y?this.grid3D:this.grid;for(let E=0;E<r.length;E++){const z=r[E],I=[1/0,1/0,-1/0,-1/0];for(let L=0;L<z.length;L++){const O=z[L];I[0]=Math.min(I[0],O.x),I[1]=Math.min(I[1],O.y),I[2]=Math.max(I[2],O.x),I[3]=Math.max(I[3],O.y)}I[0]<da&&I[1]<da&&I[2]>=0&&I[3]>=0&&S.insert(v,I[0],I[1],I[2],I[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new co.VectorTile(new cs(this.rawTileData)).layers,this.sourceLayerCoder=new vo(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,l,h){this.loadVTLayers();const g=e.params||{},y=da/e.tileSize/e.scale,v=eo(g.filter),S=e.queryGeometry,E=e.queryPadding*y,z=Td(S),I=this.grid.query(z.minX-E,z.minY-E,z.maxX+E,z.maxY+E),L=Td(e.cameraQueryGeometry),O=this.grid3D.query(L.minX-E,L.minY-E,L.maxX+E,L.maxY+E,((X,J,ce,ie)=>(function(he,fe,De,Xe,vt){for(const at of he)if(fe<=at.x&&De<=at.y&&Xe>=at.x&&vt>=at.y)return!0;const lt=[new pe(fe,De),new pe(fe,vt),new pe(Xe,vt),new pe(Xe,De)];if(he.length>2){for(const at of lt)if(Va(he,at))return!0}for(let at=0;at<he.length-1;at++)if(Ba(he[at],he[at+1],lt))return!0;return!1})(e.cameraQueryGeometry,X-E,J-E,ce+E,ie+E)));for(const X of O)I.push(X);I.sort(bf);const P={};let G;for(let X=0;X<I.length;X++){const J=I[X];if(J===G)continue;G=J;const ce=this.featureIndexArray.get(J);let ie=null;this.loadMatchingFeature(P,ce.bucketIndex,ce.sourceLayerIndex,ce.featureIndex,v,g.layers,g.availableImages,r,l,h,((he,fe,De)=>(ie||(ie=ks(he)),fe.queryIntersectsFeature(S,he,De,ie,this.z,e.transform,y,e.pixelPosMatrix))))}return P}loadMatchingFeature(e,r,l,h,g,y,v,S,E,z,I){const L=this.bucketLayerIDs[r];if(y&&!(function(X,J){for(let ce=0;ce<X.length;ce++)if(J.indexOf(X[ce])>=0)return!0;return!1})(y,L))return;const O=this.sourceLayerCoder.decode(l),P=this.vtLayers[O].feature(h);if(g.needGeometry){const X=us(P,!0);if(!g.filter(new oi(this.tileID.overscaledZ),X,this.tileID.canonical))return}else if(!g.filter(new oi(this.tileID.overscaledZ),P))return;const G=this.getId(P,O);for(let X=0;X<L.length;X++){const J=L[X];if(y&&y.indexOf(J)<0)continue;const ce=S[J];if(!ce)continue;let ie={};G&&z&&(ie=z.getState(ce.sourceLayer||"_geojsonTileLayer",G));const he=Et({},E[J]);he.paint=Ll(he.paint,ce.paint,P,ie,v),he.layout=Ll(he.layout,ce.layout,P,ie,v);const fe=!I||I(P,ce,ie);if(!fe)continue;const De=new cc(P,this.z,this.x,this.y,G);De.layer=he;let Xe=e[J];Xe===void 0&&(Xe=e[J]=[]),Xe.push({featureIndex:h,feature:De,intersectionZ:fe})}}lookupSymbolFeatures(e,r,l,h,g,y,v,S){const E={};this.loadVTLayers();const z=eo(g);for(const I of e)this.loadMatchingFeature(E,l,h,I,z,y,v,S,r);return E}hasLayer(e){for(const r of this.bucketLayerIDs)for(const l of r)if(e===l)return!0;return!1}getId(e,r){let l=e.id;return this.promoteId&&(l=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof l=="boolean"&&(l=Number(l))),l}}function Ll(a,e,r,l,h){return qt(a,((g,y)=>{const v=e instanceof Fo?e.get(y):null;return v&&v.evaluate?v.evaluate(r,l,h):v}))}function Td(a){let e=1/0,r=1/0,l=-1/0,h=-1/0;for(const g of a)e=Math.min(e,g.x),r=Math.min(r,g.y),l=Math.max(l,g.x),h=Math.max(h,g.y);return{minX:e,minY:r,maxX:l,maxY:h}}function bf(a,e){return e-a}function Ed(a,e,r,l,h){const g=[];for(let y=0;y<a.length;y++){const v=a[y];let S;for(let E=0;E<v.length-1;E++){let z=v[E],I=v[E+1];z.x<e&&I.x<e||(z.x<e?z=new pe(e,z.y+(e-z.x)/(I.x-z.x)*(I.y-z.y))._round():I.x<e&&(I=new pe(e,z.y+(e-z.x)/(I.x-z.x)*(I.y-z.y))._round()),z.y<r&&I.y<r||(z.y<r?z=new pe(z.x+(r-z.y)/(I.y-z.y)*(I.x-z.x),r)._round():I.y<r&&(I=new pe(z.x+(r-z.y)/(I.y-z.y)*(I.x-z.x),r)._round()),z.x>=l&&I.x>=l||(z.x>=l?z=new pe(l,z.y+(l-z.x)/(I.x-z.x)*(I.y-z.y))._round():I.x>=l&&(I=new pe(l,z.y+(l-z.x)/(I.x-z.x)*(I.y-z.y))._round()),z.y>=h&&I.y>=h||(z.y>=h?z=new pe(z.x+(h-z.y)/(I.y-z.y)*(I.x-z.x),h)._round():I.y>=h&&(I=new pe(z.x+(h-z.y)/(I.y-z.y)*(I.x-z.x),h)._round()),S&&z.equals(S[S.length-1])||(S=[z],g.push(S)),S.push(I)))))}}return g}rt("FeatureIndex",Sh,{omit:["rawTileData","sourceLayerCoder"]});class xo extends pe{constructor(e,r,l,h){super(e,r),this.angle=l,h!==void 0&&(this.segment=h)}clone(){return new xo(this.x,this.y,this.angle,this.segment)}}function hc(a,e,r,l,h){if(e.segment===void 0||r===0)return!0;let g=e,y=e.segment+1,v=0;for(;v>-r/2;){if(y--,y<0)return!1;v-=a[y].dist(g),g=a[y]}v+=a[y].dist(a[y+1]),y++;const S=[];let E=0;for(;v<r/2;){const z=a[y],I=a[y+1];if(!I)return!1;let L=a[y-1].angleTo(z)-z.angleTo(I);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:v,angleDelta:L}),E+=L;v-S[0].distance>l;)E-=S.shift().angleDelta;if(E>h)return!1;y++,v+=z.dist(I)}return!0}function Th(a){let e=0;for(let r=0;r<a.length-1;r++)e+=a[r].dist(a[r+1]);return e}function wf(a,e,r){return a?.6*e*r:0}function Sf(a,e){return Math.max(a?a.right-a.left:0,e?e.right-e.left:0)}function sp(a,e,r,l,h,g){const y=wf(r,h,g),v=Sf(r,l)*g;let S=0;const E=Th(a)/2;for(let z=0;z<a.length-1;z++){const I=a[z],L=a[z+1],O=I.dist(L);if(S+O>E){const P=(E-S)/O,G=Cn.number(I.x,L.x,P),X=Cn.number(I.y,L.y,P),J=new xo(G,X,L.angleTo(I),z);return J._round(),!y||hc(a,J,v,y,e)?J:void 0}S+=O}}function Tf(a,e,r,l,h,g,y,v,S){const E=wf(l,g,y),z=Sf(l,h),I=z*y,L=a[0].x===0||a[0].x===S||a[0].y===0||a[0].y===S;return e-I<e/4&&(e=I+e/4),Ad(a,L?e/2*v%e:(z/2+2*g)*y*v%e,e,E,r,I,L,!1,S)}function Ad(a,e,r,l,h,g,y,v,S){const E=g/2,z=Th(a);let I=0,L=e-r,O=[];for(let P=0;P<a.length-1;P++){const G=a[P],X=a[P+1],J=G.dist(X),ce=X.angleTo(G);for(;L+r<I+J;){L+=r;const ie=(L-I)/J,he=Cn.number(G.x,X.x,ie),fe=Cn.number(G.y,X.y,ie);if(he>=0&&he<S&&fe>=0&&fe<S&&L-E>=0&&L+E<=z){const De=new xo(he,fe,ce,P);De._round(),l&&!hc(a,De,g,l,h)||O.push(De)}}I+=J}return v||O.length||y||(O=Ad(a,I/2,r,l,h,g,y,!0,S)),O}rt("Anchor",xo);const fs=pa;function dc(a,e,r,l){const h=[],g=a.image,y=g.pixelRatio,v=g.paddedRect.w-2*fs,S=g.paddedRect.h-2*fs,E=a.right-a.left,z=a.bottom-a.top,I=g.stretchX||[[0,v]],L=g.stretchY||[[0,S]],O=(Ke,dt)=>Ke+dt[1]-dt[0],P=I.reduce(O,0),G=L.reduce(O,0),X=v-P,J=S-G;let ce=0,ie=P,he=0,fe=G,De=0,Xe=X,vt=0,lt=J;if(g.content&&l){const Ke=g.content;ce=fc(I,0,Ke[0]),he=fc(L,0,Ke[1]),ie=fc(I,Ke[0],Ke[2]),fe=fc(L,Ke[1],Ke[3]),De=Ke[0]-ce,vt=Ke[1]-he,Xe=Ke[2]-Ke[0]-ie,lt=Ke[3]-Ke[1]-fe}const at=(Ke,dt,We,qe)=>{const zt=pc(Ke.stretch-ce,ie,E,a.left),xt=mc(Ke.fixed-De,Xe,Ke.stretch,P),Yt=pc(dt.stretch-he,fe,z,a.top),Xi=mc(dt.fixed-vt,lt,dt.stretch,G),Yi=pc(We.stretch-ce,ie,E,a.left),Oa=mc(We.fixed-De,Xe,We.stretch,P),Xn=pc(qe.stretch-he,fe,z,a.top),Pn=mc(qe.fixed-vt,lt,qe.stretch,G),Ia=new pe(zt,Yt),ra=new pe(Yi,Yt),Wa=new pe(Yi,Xn),wn=new pe(zt,Xn),cn=new pe(xt/y,Xi/y),Pa=new pe(Oa/y,Pn/y),Na=e*Math.PI/180;if(Na){const en=Math.sin(Na),Yn=Math.cos(Na),sa=[Yn,-en,en,Yn];Ia._matMult(sa),ra._matMult(sa),wn._matMult(sa),Wa._matMult(sa)}const hn=Ke.stretch+Ke.fixed,dn=dt.stretch+dt.fixed;return{tl:Ia,tr:ra,bl:wn,br:Wa,tex:{x:g.paddedRect.x+fs+hn,y:g.paddedRect.y+fs+dn,w:We.stretch+We.fixed-hn,h:qe.stretch+qe.fixed-dn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:cn,pixelOffsetBR:Pa,minFontScaleX:Xe/y/E,minFontScaleY:lt/y/z,isSDF:r}};if(l&&(g.stretchX||g.stretchY)){const Ke=zd(I,X,P),dt=zd(L,J,G);for(let We=0;We<Ke.length-1;We++){const qe=Ke[We],zt=Ke[We+1];for(let xt=0;xt<dt.length-1;xt++)h.push(at(qe,dt[xt],zt,dt[xt+1]))}}else h.push(at({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:S+1}));return h}function fc(a,e,r){let l=0;for(const h of a)l+=Math.max(e,Math.min(r,h[1]))-Math.max(e,Math.min(r,h[0]));return l}function zd(a,e,r){const l=[{fixed:-fs,stretch:0}];for(const[h,g]of a){const y=l[l.length-1];l.push({fixed:h-y.stretch,stretch:y.stretch}),l.push({fixed:h-y.stretch,stretch:y.stretch+(g-h)})}return l.push({fixed:e+fs,stretch:r}),l}function pc(a,e,r,l){return a/e*r+l}function mc(a,e,r,l){return a-e*r/l}class gc{constructor(e,r,l,h,g,y,v,S,E,z){if(this.boxStartIndex=e.length,E){let I=y.top,L=y.bottom;const O=y.collisionPadding;O&&(I-=O[1],L+=O[3]);let P=L-I;P>0&&(P=Math.max(10,P),this.circleDiameter=P)}else{let I=y.top*v-S[0],L=y.bottom*v+S[2],O=y.left*v-S[3],P=y.right*v+S[1];const G=y.collisionPadding;if(G&&(O-=G[0]*v,I-=G[1]*v,P+=G[2]*v,L+=G[3]*v),z){const X=new pe(O,I),J=new pe(P,I),ce=new pe(O,L),ie=new pe(P,L),he=z*Math.PI/180;X._rotate(he),J._rotate(he),ce._rotate(he),ie._rotate(he),O=Math.min(X.x,J.x,ce.x,ie.x),P=Math.max(X.x,J.x,ce.x,ie.x),I=Math.min(X.y,J.y,ce.y,ie.y),L=Math.max(X.y,J.y,ce.y,ie.y)}e.emplaceBack(r.x,r.y,O,I,P,L,l,h,g)}this.boxEndIndex=e.length}}class Ef{constructor(e=[],r=Eh){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:l}=this,h=r[e];for(;e>0;){const g=e-1>>1,y=r[g];if(l(h,y)>=0)break;r[e]=y,e=g}r[e]=h}_down(e){const{data:r,compare:l}=this,h=this.length>>1,g=r[e];for(;e<h;){let y=1+(e<<1),v=r[y];const S=y+1;if(S<this.length&&l(r[S],v)<0&&(y=S,v=r[S]),l(v,g)>=0)break;r[e]=v,e=y}r[e]=g}}function Eh(a,e){return a<e?-1:a>e?1:0}function Af(a,e=1,r=!1){let l=1/0,h=1/0,g=-1/0,y=-1/0;const v=a[0];for(let O=0;O<v.length;O++){const P=v[O];(!O||P.x<l)&&(l=P.x),(!O||P.y<h)&&(h=P.y),(!O||P.x>g)&&(g=P.x),(!O||P.y>y)&&(y=P.y)}const S=Math.min(g-l,y-h);let E=S/2;const z=new Ef([],zf);if(S===0)return new pe(l,h);for(let O=l;O<g;O+=S)for(let P=h;P<y;P+=S)z.push(new Ti(O+E,P+E,E,a));let I=(function(O){let P=0,G=0,X=0;const J=O[0];for(let ce=0,ie=J.length,he=ie-1;ce<ie;he=ce++){const fe=J[ce],De=J[he],Xe=fe.x*De.y-De.x*fe.y;G+=(fe.x+De.x)*Xe,X+=(fe.y+De.y)*Xe,P+=3*Xe}return new Ti(G/P,X/P,0,O)})(a),L=z.length;for(;z.length;){const O=z.pop();(O.d>I.d||!I.d)&&(I=O,r&&console.log("found best %d after %d probes",Math.round(1e4*O.d)/1e4,L)),O.max-I.d<=e||(E=O.h/2,z.push(new Ti(O.p.x-E,O.p.y-E,E,a)),z.push(new Ti(O.p.x+E,O.p.y-E,E,a)),z.push(new Ti(O.p.x-E,O.p.y+E,E,a)),z.push(new Ti(O.p.x+E,O.p.y+E,E,a)),L+=4)}return r&&(console.log(`num probes: ${L}`),console.log(`best distance: ${I.d}`)),I.p}function zf(a,e){return e.max-a.max}function Ti(a,e,r,l){this.p=new pe(a,e),this.h=r,this.d=(function(h,g){let y=!1,v=1/0;for(let S=0;S<g.length;S++){const E=g[S];for(let z=0,I=E.length,L=I-1;z<I;L=z++){const O=E[z],P=E[L];O.y>h.y!=P.y>h.y&&h.x<(P.x-O.x)*(h.y-O.y)/(P.y-O.y)+O.x&&(y=!y),v=Math.min(v,Fc(h,O,P))}}return(y?1:-1)*Math.sqrt(v)})(this.p,l),this.max=this.d+this.h*Math.SQRT2}var Za;f.aq=void 0,(Za=f.aq||(f.aq={}))[Za.center=1]="center",Za[Za.left=2]="left",Za[Za.right=3]="right",Za[Za.top=4]="top",Za[Za.bottom=5]="bottom",Za[Za["top-left"]=6]="top-left",Za[Za["top-right"]=7]="top-right",Za[Za["bottom-left"]=8]="bottom-left",Za[Za["bottom-right"]=9]="bottom-right";const Qo=7,Ah=Number.POSITIVE_INFINITY;function Mf(a,e){return e[1]!==Ah?(function(r,l,h){let g=0,y=0;switch(l=Math.abs(l),h=Math.abs(h),r){case"top-right":case"top-left":case"top":y=h-Qo;break;case"bottom-right":case"bottom-left":case"bottom":y=-h+Qo}switch(r){case"top-right":case"bottom-right":case"right":g=-l;break;case"top-left":case"bottom-left":case"left":g=l}return[g,y]})(a,e[0],e[1]):(function(r,l){let h=0,g=0;l<0&&(l=0);const y=l/Math.SQRT2;switch(r){case"top-right":case"top-left":g=y-Qo;break;case"bottom-right":case"bottom-left":g=-y+Qo;break;case"bottom":g=-l+Qo;break;case"top":g=l-Qo}switch(r){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=l;break;case"right":h=-l}return[h,g]})(a,e[0])}function Cf(a,e,r){var l;const h=a.layout,g=(l=h.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(e,{},r);if(g){const v=g.values,S=[];for(let E=0;E<v.length;E+=2){const z=S[E]=v[E],I=v[E+1].map((L=>L*fa));z.startsWith("top")?I[1]-=Qo:z.startsWith("bottom")&&(I[1]+=Qo),S[E+1]=I}return new yn(S)}const y=h.get("text-variable-anchor");if(y){let v;v=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(e,{},r)*fa,Ah]:h.get("text-offset").evaluate(e,{},r).map((E=>E*fa));const S=[];for(const E of y)S.push(E,Mf(E,v));return new yn(S)}return null}function Md(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function zh(a,e,r,l,h,g,y,v,S,E,z){let I=g.textMaxSize.evaluate(e,{});I===void 0&&(I=y);const L=a.layers[0].layout,O=L.get("icon-offset").evaluate(e,{},z),P=Mh(r.horizontal),G=y/24,X=a.tilePixelRatio*G,J=a.tilePixelRatio*I/24,ce=a.tilePixelRatio*v,ie=a.tilePixelRatio*L.get("symbol-spacing"),he=L.get("text-padding")*a.tilePixelRatio,fe=(function(qe,zt,xt,Yt=1){const Xi=qe.get("icon-padding").evaluate(zt,{},xt),Yi=Xi&&Xi.values;return[Yi[0]*Yt,Yi[1]*Yt,Yi[2]*Yt,Yi[3]*Yt]})(L,e,z,a.tilePixelRatio),De=L.get("text-max-angle")/180*Math.PI,Xe=L.get("text-rotation-alignment")!=="viewport"&&L.get("symbol-placement")!=="point",vt=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",lt=L.get("symbol-placement"),at=ie/2,Ke=L.get("icon-text-fit");let dt;l&&Ke!=="none"&&(a.allowVerticalPlacement&&r.vertical&&(dt=oc(l,r.vertical,Ke,L.get("icon-text-fit-padding"),O,G)),P&&(l=oc(l,P,Ke,L.get("icon-text-fit-padding"),O,G)));const We=(qe,zt)=>{zt.x<0||zt.x>=da||zt.y<0||zt.y>=da||(function(xt,Yt,Xi,Yi,Oa,Xn,Pn,Ia,ra,Wa,wn,cn,Pa,Na,hn,dn,en,Yn,sa,Ea,ei,fn,tn,ma,Aa){const Fr=xt.addToLineVertexArray(Yt,Xi);let ur,Sn,Ur,br,$a=0,Us=0,bc=0,Df=0,Dd=-1,Id=-1;const bo={};let If=Ds("");if(xt.allowVerticalPlacement&&Yi.vertical){const Tn=Ia.layout.get("text-rotate").evaluate(ei,{},ma)+90;Ur=new gc(ra,Yt,Wa,wn,cn,Yi.vertical,Pa,Na,hn,Tn),Pn&&(br=new gc(ra,Yt,Wa,wn,cn,Pn,en,Yn,hn,Tn))}if(Oa){const Tn=Ia.layout.get("icon-rotate").evaluate(ei,{}),hr=Ia.layout.get("icon-text-fit")!=="none",Bl=dc(Oa,Tn,tn,hr),wr=Pn?dc(Pn,Tn,tn,hr):void 0;Sn=new gc(ra,Yt,Wa,wn,cn,Oa,en,Yn,!1,Tn),$a=4*Bl.length;const Ol=xt.iconSizeData;let Sr=null;Ol.kind==="source"?(Sr=[Os*Ia.layout.get("icon-size").evaluate(ei,{})],Sr[0]>Xo&&Bi(`${xt.layerIds[0]}: Value for "icon-size" is >= ${pu}. Reduce your "icon-size".`)):Ol.kind==="composite"&&(Sr=[Os*fn.compositeIconSizes[0].evaluate(ei,{},ma),Os*fn.compositeIconSizes[1].evaluate(ei,{},ma)],(Sr[0]>Xo||Sr[1]>Xo)&&Bi(`${xt.layerIds[0]}: Value for "icon-size" is >= ${pu}. Reduce your "icon-size".`)),xt.addSymbols(xt.icon,Bl,Sr,Ea,sa,ei,f.ai.none,Yt,Fr.lineStartIndex,Fr.lineLength,-1,ma),Dd=xt.icon.placedSymbolArray.length-1,wr&&(Us=4*wr.length,xt.addSymbols(xt.icon,wr,Sr,Ea,sa,ei,f.ai.vertical,Yt,Fr.lineStartIndex,Fr.lineLength,-1,ma),Id=xt.icon.placedSymbolArray.length-1)}const kf=Object.keys(Yi.horizontal);for(const Tn of kf){const hr=Yi.horizontal[Tn];if(!ur){If=Ds(hr.text);const wr=Ia.layout.get("text-rotate").evaluate(ei,{},ma);ur=new gc(ra,Yt,Wa,wn,cn,hr,Pa,Na,hn,wr)}const Bl=hr.positionedLines.length===1;if(bc+=Rl(xt,Yt,hr,Xn,Ia,hn,ei,dn,Fr,Yi.vertical?f.ai.horizontal:f.ai.horizontalOnly,Bl?kf:[Tn],bo,Dd,fn,ma),Bl)break}Yi.vertical&&(Df+=Rl(xt,Yt,Yi.vertical,Xn,Ia,hn,ei,dn,Fr,f.ai.vertical,["vertical"],bo,Id,fn,ma));const Lf=ur?ur.boxStartIndex:xt.collisionBoxArray.length,_u=ur?ur.boxEndIndex:xt.collisionBoxArray.length,wc=Ur?Ur.boxStartIndex:xt.collisionBoxArray.length,Rf=Ur?Ur.boxEndIndex:xt.collisionBoxArray.length,lp=Sn?Sn.boxStartIndex:xt.collisionBoxArray.length,vu=Sn?Sn.boxEndIndex:xt.collisionBoxArray.length,Sc=br?br.boxStartIndex:xt.collisionBoxArray.length,Bf=br?br.boxEndIndex:xt.collisionBoxArray.length;let cr=-1;const xu=(Tn,hr)=>Tn&&Tn.circleDiameter?Math.max(Tn.circleDiameter,hr):hr;cr=xu(ur,cr),cr=xu(Ur,cr),cr=xu(Sn,cr),cr=xu(br,cr);const Bh=cr>-1?1:0;Bh&&(cr*=Aa/fa),xt.glyphOffsetArray.length>=rr.MAX_GLYPHS&&Bi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ei.sortKey!==void 0&&xt.addToSortKeyRanges(xt.symbolInstances.length,ei.sortKey);const Oh=Cf(Ia,ei,ma),[Of,Pf]=(function(Tn,hr){const Bl=Tn.length,wr=hr?.values;if(wr?.length>0)for(let Ol=0;Ol<wr.length;Ol+=2){const Sr=wr[Ol+1];Tn.emplaceBack(f.aq[wr[Ol]],Sr[0],Sr[1])}return[Bl,Tn.length]})(xt.textAnchorOffsets,Oh);xt.symbolInstances.emplaceBack(Yt.x,Yt.y,bo.right>=0?bo.right:-1,bo.center>=0?bo.center:-1,bo.left>=0?bo.left:-1,bo.vertical||-1,Dd,Id,If,Lf,_u,wc,Rf,lp,vu,Sc,Bf,Wa,bc,Df,$a,Us,Bh,0,Pa,cr,Of,Pf)})(a,zt,qe,r,l,h,dt,a.layers[0],a.collisionBoxArray,e.index,e.sourceLayerIndex,a.index,X,[he,he,he,he],Xe,S,ce,fe,vt,O,e,g,E,z,y)};if(lt==="line")for(const qe of Ed(e.geometry,0,0,da,da)){const zt=Tf(qe,ie,De,r.vertical||P,l,24,J,a.overscaling,da);for(const xt of zt)P&&Ch(a,P.text,at,xt)||We(qe,xt)}else if(lt==="line-center"){for(const qe of e.geometry)if(qe.length>1){const zt=sp(qe,De,r.vertical||P,l,24,J);zt&&We(qe,zt)}}else if(e.type==="Polygon")for(const qe of Kc(e.geometry,0)){const zt=Af(qe,16);We(qe[0],new xo(zt.x,zt.y,0))}else if(e.type==="LineString")for(const qe of e.geometry)We(qe,new xo(qe[0].x,qe[0].y,0));else if(e.type==="Point")for(const qe of e.geometry)for(const zt of qe)We([zt],new xo(zt.x,zt.y,0))}function Rl(a,e,r,l,h,g,y,v,S,E,z,I,L,O,P){const G=(function(ce,ie,he,fe,De,Xe,vt,lt){const at=fe.layout.get("text-rotate").evaluate(Xe,{})*Math.PI/180,Ke=[];for(const dt of ie.positionedLines)for(const We of dt.positionedGlyphs){if(!We.rect)continue;const qe=We.rect||{};let zt=nc+1,xt=!0,Yt=1,Xi=0;const Yi=(De||lt)&&We.vertical,Oa=We.metrics.advance*We.scale/2;if(lt&&ie.verticalizable&&(Xi=dt.lineOffset/2-(We.imageName?-(fa-We.metrics.width*We.scale)/2:(We.scale-1)*fa)),We.imageName){const Ea=vt[We.imageName];xt=Ea.sdf,Yt=Ea.pixelRatio,zt=pa/Yt}const Xn=De?[We.x+Oa,We.y]:[0,0];let Pn=De?[0,0]:[We.x+Oa+he[0],We.y+he[1]-Xi],Ia=[0,0];Yi&&(Ia=Pn,Pn=[0,0]);const ra=We.metrics.isDoubleResolution?2:1,Wa=(We.metrics.left-zt)*We.scale-Oa+Pn[0],wn=(-We.metrics.top-zt)*We.scale+Pn[1],cn=Wa+qe.w/ra*We.scale/Yt,Pa=wn+qe.h/ra*We.scale/Yt,Na=new pe(Wa,wn),hn=new pe(cn,wn),dn=new pe(Wa,Pa),en=new pe(cn,Pa);if(Yi){const Ea=new pe(-Oa,Oa-xr),ei=-Math.PI/2,fn=fa/2-Oa,tn=new pe(5-xr-fn,-(We.imageName?fn:0)),ma=new pe(...Ia);Na._rotateAround(ei,Ea)._add(tn)._add(ma),hn._rotateAround(ei,Ea)._add(tn)._add(ma),dn._rotateAround(ei,Ea)._add(tn)._add(ma),en._rotateAround(ei,Ea)._add(tn)._add(ma)}if(at){const Ea=Math.sin(at),ei=Math.cos(at),fn=[ei,-Ea,Ea,ei];Na._matMult(fn),hn._matMult(fn),dn._matMult(fn),en._matMult(fn)}const Yn=new pe(0,0),sa=new pe(0,0);Ke.push({tl:Na,tr:hn,bl:dn,br:en,tex:qe,writingMode:ie.writingMode,glyphOffset:Xn,sectionIndex:We.sectionIndex,isSDF:xt,pixelOffsetTL:Yn,pixelOffsetBR:sa,minFontScaleX:0,minFontScaleY:0})}return Ke})(0,r,v,h,g,y,l,a.allowVerticalPlacement),X=a.textSizeData;let J=null;X.kind==="source"?(J=[Os*h.layout.get("text-size").evaluate(y,{})],J[0]>Xo&&Bi(`${a.layerIds[0]}: Value for "text-size" is >= ${pu}. Reduce your "text-size".`)):X.kind==="composite"&&(J=[Os*O.compositeTextSizes[0].evaluate(y,{},P),Os*O.compositeTextSizes[1].evaluate(y,{},P)],(J[0]>Xo||J[1]>Xo)&&Bi(`${a.layerIds[0]}: Value for "text-size" is >= ${pu}. Reduce your "text-size".`)),a.addSymbols(a.text,G,J,v,g,y,E,e,S.lineStartIndex,S.lineLength,L,P);for(const ce of z)I[ce]=a.text.placedSymbolArray.length-1;return 4*G.length}function Mh(a){for(const e in a)return a[e];return null}function Ch(a,e,r,l){const h=a.compareText;if(e in h){const g=h[e];for(let y=g.length-1;y>=0;y--)if(l.dist(g[y])<r)return!0}else h[e]=[];return h[e].push(l),!1}const Dh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Fs{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,l]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=l>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const g=Dh[15&l];if(!g)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new Fs(v,y,g,e)}constructor(e,r=64,l=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=l,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const g=Dh.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-v%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${l}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+S,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+v+S),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+S,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=e,this.coords[this._pos++]=r,l}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Nr(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:y,nodeSize:v}=this,S=[0,g.length-1,0],E=[];for(;S.length;){const z=S.pop()||0,I=S.pop()||0,L=S.pop()||0;if(I-L<=v){for(let X=L;X<=I;X++){const J=y[2*X],ce=y[2*X+1];J>=e&&J<=l&&ce>=r&&ce<=h&&E.push(g[X])}continue}const O=L+I>>1,P=y[2*O],G=y[2*O+1];P>=e&&P<=l&&G>=r&&G<=h&&E.push(g[O]),(z===0?e<=P:r<=G)&&(S.push(L),S.push(O-1),S.push(1-z)),(z===0?l>=P:h>=G)&&(S.push(O+1),S.push(I),S.push(1-z))}return E}within(e,r,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:g,nodeSize:y}=this,v=[0,h.length-1,0],S=[],E=l*l;for(;v.length;){const z=v.pop()||0,I=v.pop()||0,L=v.pop()||0;if(I-L<=y){for(let X=L;X<=I;X++)Cd(g[2*X],g[2*X+1],e,r)<=E&&S.push(h[X]);continue}const O=L+I>>1,P=g[2*O],G=g[2*O+1];Cd(P,G,e,r)<=E&&S.push(h[O]),(z===0?e-l<=P:r-l<=G)&&(v.push(L),v.push(O-1),v.push(1-z)),(z===0?e+l>=P:r+l>=G)&&(v.push(O+1),v.push(I),v.push(1-z))}return S}}function Nr(a,e,r,l,h,g){if(h-l<=r)return;const y=l+h>>1;yu(a,e,y,l,h,g),Nr(a,e,r,l,y-1,1-g),Nr(a,e,r,y+1,h,1-g)}function yu(a,e,r,l,h,g){for(;h>l;){if(h-l>600){const E=h-l+1,z=r-l+1,I=Math.log(E),L=.5*Math.exp(2*I/3),O=.5*Math.sqrt(I*L*(E-L)/E)*(z-E/2<0?-1:1);yu(a,e,r,Math.max(l,Math.floor(r-z*L/E+O)),Math.min(h,Math.floor(r+(E-z)*L/E+O)),g)}const y=e[2*r+g];let v=l,S=h;for(yc(a,e,l,r),e[2*h+g]>y&&yc(a,e,l,h);v<S;){for(yc(a,e,v,S),v++,S--;e[2*v+g]<y;)v++;for(;e[2*S+g]>y;)S--}e[2*l+g]===y?yc(a,e,l,S):(S++,yc(a,e,S,h)),S<=r&&(l=S+1),r<=S&&(h=S-1)}}function yc(a,e,r,l){Ih(a,r,l),Ih(e,2*r,2*l),Ih(e,2*r+1,2*l+1)}function Ih(a,e,r){const l=a[e];a[e]=a[r],a[r]=l}function Cd(a,e,r,l){const h=a-r,g=e-l;return h*h+g*g}var kh;f.bh=void 0,(kh=f.bh||(f.bh={})).create="create",kh.load="load",kh.fullLoad="fullLoad";let _c=null,vc=[];const xc=1e3/60,Lh="loadTime",Rh="fullLoadTime",op={mark(a){performance.mark(a)},frame(a){const e=a;_c!=null&&vc.push(e-_c),_c=e},clearMetrics(){_c=null,vc=[],performance.clearMeasures(Lh),performance.clearMeasures(Rh);for(const a in f.bh)performance.clearMarks(f.bh[a])},getPerformanceMetrics(){performance.measure(Lh,f.bh.create,f.bh.load),performance.measure(Rh,f.bh.create,f.bh.fullLoad);const a=performance.getEntriesByName(Lh)[0].duration,e=performance.getEntriesByName(Rh)[0].duration,r=vc.length,l=1/(vc.reduce(((g,y)=>g+y),0)/r/1e3),h=vc.filter((g=>g>xc)).reduce(((g,y)=>g+(y-xc)/xc),0);return{loadTime:a,fullLoadTime:e,fps:l,percentDroppedFrames:h/(r+h)*100,totalFrames:r}}};f.$=function(a,e,r){var l,h,g,y,v,S,E,z,I,L,O,P,G=r[0],X=r[1],J=r[2];return e===a?(a[12]=e[0]*G+e[4]*X+e[8]*J+e[12],a[13]=e[1]*G+e[5]*X+e[9]*J+e[13],a[14]=e[2]*G+e[6]*X+e[10]*J+e[14],a[15]=e[3]*G+e[7]*X+e[11]*J+e[15]):(h=e[1],g=e[2],y=e[3],v=e[4],S=e[5],E=e[6],z=e[7],I=e[8],L=e[9],O=e[10],P=e[11],a[0]=l=e[0],a[1]=h,a[2]=g,a[3]=y,a[4]=v,a[5]=S,a[6]=E,a[7]=z,a[8]=I,a[9]=L,a[10]=O,a[11]=P,a[12]=l*G+v*X+I*J+e[12],a[13]=h*G+S*X+L*J+e[13],a[14]=g*G+E*X+O*J+e[14],a[15]=y*G+z*X+P*J+e[15]),a},f.A=Zo,f.B=Cn,f.C=class{constructor(a,e,r){this.receive=l=>{const h=l.data,g=h.id;if(g&&(!h.targetMapId||this.mapId===h.targetMapId))if(h.type==="<cancel>"){delete this.tasks[g];const y=this.cancelCallbacks[g];delete this.cancelCallbacks[g],y&&y()}else Ye()||h.mustQueue?(this.tasks[g]=h,this.taskQueue.push(g),this.invoker.trigger()):this.processTask(g,h)},this.process=()=>{if(!this.taskQueue.length)return;const l=this.taskQueue.shift(),h=this.tasks[l];delete this.tasks[l],this.taskQueue.length&&this.invoker.trigger(),h&&this.processTask(l,h)},this.target=a,this.parent=e,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new vh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ye()?a:window}send(a,e,r,l,h=!1){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[g]=r);const y=[],v={id:g,type:a,hasCallback:!!r,targetMapId:l,mustQueue:h,sourceMapId:this.mapId,data:Dr(e,y)};return this.target.postMessage(v,{transfer:y}),{cancel:()=>{r&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}processTask(a,e){if(e.type==="<response>"){const r=this.callbacks[a];delete this.callbacks[a],r&&(e.error?r(as(e.error)):r(null,as(e.data)))}else{let r=!1;const l=[],h=e.hasCallback?(v,S)=>{r=!0,delete this.cancelCallbacks[a];const E={id:a,type:"<response>",sourceMapId:this.mapId,error:v?Dr(v):null,data:Dr(S,l)};this.target.postMessage(E,{transfer:l})}:v=>{r=!0};let g=null;const y=as(e.data);if(this.parent[e.type])g=this.parent[e.type](e.sourceMapId,y,h);else if("getWorkerSource"in this.parent){const v=e.type.split(".");g=this.parent.getWorkerSource(e.sourceMapId,v[0],y.source)[v[1]](y,h)}else h(new Error(`Could not find function ${e.type}`));!r&&g&&g.cancel&&(this.cancelCallbacks[a]=g.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},f.D=wt,f.E=qr,f.F=function(a,e){const r={};for(let l=0;l<e.length;l++){const h=e[l];h in a&&(r[h]=a[h])}return r},f.G=Ns,f.H=xh,f.I=dh,f.J=it,f.K=bt,f.L=na,f.M=se,f.N=da,f.O=lr,f.P=pe,f.Q=zi,f.R=ar,f.S=Fi,f.T=pr,f.U=mu,f.V=class extends Un{},f.W=wh,f.X=function(a,e){const r=window.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let l=0;l<a.length;l++){const h=window.document.createElement("source");mn(a[l])||(r.crossOrigin="Anonymous"),h.src=a[l],r.appendChild(h)}return{cancel:()=>{}}},f.Y=et,f.Z=function(){var a=new Zo(16);return Zo!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},f._=Oe,f.a=Gt,f.a$=class extends B{},f.a0=function(a,e,r){var l=r[0],h=r[1],g=r[2];return a[0]=e[0]*l,a[1]=e[1]*l,a[2]=e[2]*l,a[3]=e[3]*l,a[4]=e[4]*h,a[5]=e[5]*h,a[6]=e[6]*h,a[7]=e[7]*h,a[8]=e[8]*g,a[9]=e[9]*g,a[10]=e[10]*g,a[11]=e[11]*g,a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},f.a1=Xh,f.a2=function(){return pi++},f.a3=$,f.a4=rr,f.a5=function(){Ya.isLoading()||Ya.isLoaded()||As()!=="deferred"||yl()},f.a6=eo,f.a7=us,f.a8=oi,f.a9=cc,f.aA=No,f.aB=function(a){a=a.slice();const e=Object.create(null);for(let r=0;r<a.length;r++)e[a[r].id]=a[r];for(let r=0;r<a.length;r++)"ref"in a[r]&&(a[r]=Kn(a[r],e[a[r].ref]));return a},f.aC=function(a){if(a.type==="custom")return new _h(a);switch(a.type){case"background":return new sr(a);case"circle":return new Vd(a);case"fill":return new af(a);case"fill-extrusion":return new cf(a);case"heatmap":return new Zd(a);case"hillshade":return new $d(a);case"line":return new ho(a);case"raster":return new vf(a);case"symbol":return new On(a)}},f.aD=bi,f.aE=function(a,e){if(!a)return[{command:$t.setStyle,args:[e]}];let r=[];try{if(!Pi(a.version,e.version))return[{command:$t.setStyle,args:[e]}];Pi(a.center,e.center)||r.push({command:$t.setCenter,args:[e.center]}),Pi(a.zoom,e.zoom)||r.push({command:$t.setZoom,args:[e.zoom]}),Pi(a.bearing,e.bearing)||r.push({command:$t.setBearing,args:[e.bearing]}),Pi(a.pitch,e.pitch)||r.push({command:$t.setPitch,args:[e.pitch]}),Pi(a.sprite,e.sprite)||r.push({command:$t.setSprite,args:[e.sprite]}),Pi(a.glyphs,e.glyphs)||r.push({command:$t.setGlyphs,args:[e.glyphs]}),Pi(a.transition,e.transition)||r.push({command:$t.setTransition,args:[e.transition]}),Pi(a.light,e.light)||r.push({command:$t.setLight,args:[e.light]});const l={},h=[];(function(y,v,S,E){let z;for(z in v=v||{},y=y||{})Object.prototype.hasOwnProperty.call(y,z)&&(Object.prototype.hasOwnProperty.call(v,z)||js(z,S,E));for(z in v)Object.prototype.hasOwnProperty.call(v,z)&&(Object.prototype.hasOwnProperty.call(y,z)?Pi(y[z],v[z])||(y[z].type==="geojson"&&v[z].type==="geojson"&&Vs(y,v,z)?S.push({command:$t.setGeoJSONSourceData,args:[z,v[z].data]}):Ar(z,v,S,E)):Er(z,v,S))})(a.sources,e.sources,h,l);const g=[];a.layers&&a.layers.forEach((y=>{l[y.source]?r.push({command:$t.removeLayer,args:[y.id]}):g.push(y)})),r=r.concat(h),(function(y,v,S){v=v||[];const E=(y=y||[]).map(Gr),z=v.map(Gr),I=y.reduce(qs,{}),L=v.reduce(qs,{}),O=E.slice(),P=Object.create(null);let G,X,J,ce,ie,he,fe;for(G=0,X=0;G<E.length;G++)J=E[G],Object.prototype.hasOwnProperty.call(L,J)?X++:(S.push({command:$t.removeLayer,args:[J]}),O.splice(O.indexOf(J,X),1));for(G=0,X=0;G<z.length;G++)J=z[z.length-1-G],O[O.length-1-G]!==J&&(Object.prototype.hasOwnProperty.call(I,J)?(S.push({command:$t.removeLayer,args:[J]}),O.splice(O.lastIndexOf(J,O.length-X),1)):X++,he=O[O.length-G],S.push({command:$t.addLayer,args:[L[J],he]}),O.splice(O.length-G,0,J),P[J]=!0);for(G=0;G<z.length;G++)if(J=z[G],ce=I[J],ie=L[J],!P[J]&&!Pi(ce,ie))if(Pi(ce.source,ie.source)&&Pi(ce["source-layer"],ie["source-layer"])&&Pi(ce.type,ie.type)){for(fe in So(ce.layout,ie.layout,S,J,null,$t.setLayoutProperty),So(ce.paint,ie.paint,S,J,null,$t.setPaintProperty),Pi(ce.filter,ie.filter)||S.push({command:$t.setFilter,args:[J,ie.filter]}),Pi(ce.minzoom,ie.minzoom)&&Pi(ce.maxzoom,ie.maxzoom)||S.push({command:$t.setLayerZoomRange,args:[J,ie.minzoom,ie.maxzoom]}),ce)Object.prototype.hasOwnProperty.call(ce,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?So(ce[fe],ie[fe],S,J,fe.slice(6),$t.setPaintProperty):Pi(ce[fe],ie[fe])||S.push({command:$t.setLayerProperty,args:[J,fe,ie[fe]]}));for(fe in ie)Object.prototype.hasOwnProperty.call(ie,fe)&&!Object.prototype.hasOwnProperty.call(ce,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?So(ce[fe],ie[fe],S,J,fe.slice(6),$t.setPaintProperty):Pi(ce[fe],ie[fe])||S.push({command:$t.setLayerProperty,args:[J,fe,ie[fe]]}))}else S.push({command:$t.removeLayer,args:[J]}),he=O[O.lastIndexOf(J)+1],S.push({command:$t.addLayer,args:[ie,he]})})(g,e.layers,r)}catch(l){console.warn("Unable to compute style diff:",l),r=[{command:$t.setStyle,args:[e]}]}return r},f.aF=function(a){const e=[],r=a.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),a.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},f.aG=function a(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(let l=0;l<e.length;l++)if(!a(e[l],r[l]))return!1;return!0}if(typeof e=="object"&&e!==null&&r!==null){if(typeof r!="object"||Object.keys(e).length!==Object.keys(r).length)return!1;for(const l in e)if(!a(e[l],r[l]))return!1;return!0}return e===r},f.aH=qt,f.aI=xi,f.aJ=kr,f.aK=function(a){return a({pluginStatus:vn,pluginURL:Ir}),kr.on("pluginStateChange",a),a},f.aL=class extends ls{constructor(a,e){super(a,e),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},f.aM=Uo,f.aN=class extends ls{constructor(a,e){super(a,e),this.current=Is}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let e=1;e<16;e++)if(a[e]!==this.current[e]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},f.aO=Rn,f.aP=class extends ls{constructor(a,e){super(a,e),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},f.aQ=class extends ls{constructor(a,e){super(a,e),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},f.aR=jn,f.aS=function(a,e,r,l,h,g,y){var v=1/(e-r),S=1/(l-h),E=1/(g-y);return a[0]=-2*v,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*S,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*E,a[11]=0,a[12]=(e+r)*v,a[13]=(h+l)*S,a[14]=(y+g)*E,a[15]=1,a},f.aT=hi,f.aU=jd,f.aV=class extends u{},f.aW=ip,f.aX=class extends m{},f.aY=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},f.aZ=Qh,f.a_=He,f.aa=function(a){const e={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((r,l,h,g)=>{const y=h||g;return e[l]=!y||y.toLowerCase(),""})),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e},f.ab=function(a,e){const r=[];for(const l in a)l in e||r.push(l);return r},f.ac=function(a){if(gt==null){const e=a.navigator?a.navigator.userAgent:null;gt=!!a.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return gt},f.ad=Dt,f.ae=function(a,e,r){var l=Math.sin(r),h=Math.cos(r),g=e[0],y=e[1],v=e[2],S=e[3],E=e[4],z=e[5],I=e[6],L=e[7];return e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=g*h+E*l,a[1]=y*h+z*l,a[2]=v*h+I*l,a[3]=S*h+L*l,a[4]=E*h-g*l,a[5]=z*h-y*l,a[6]=I*h-v*l,a[7]=L*h-S*l,a},f.af=function(a){var e=new Zo(16);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[4]=a[4],e[5]=a[5],e[6]=a[6],e[7]=a[7],e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15],e},f.ag=Zu,f.ah=function(a,e){let r=0,l=0;if(a.kind==="constant")l=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:h,minZoom:g,maxZoom:y}=a,v=h?Dt(Gi.interpolationFactor(h,e,g,y),0,1):0;a.kind==="camera"?l=Cn.number(a.minSize,a.maxSize,v):r=v}return{uSizeT:r,uSize:l}},f.aj=function(a,{uSize:e,uSizeT:r},{lowerSize:l,upperSize:h}){return a.kind==="source"?l/Os:a.kind==="composite"?Cn.number(l/Os,h/Os,r):e},f.ak=$n,f.al=function(a,e,r,l){const h=e.y-a.y,g=e.x-a.x,y=l.y-r.y,v=l.x-r.x,S=y*g-v*h;if(S===0)return null;const E=(v*(a.y-r.y)-y*(a.x-r.x))/S;return new pe(a.x+E*g,a.y+E*h)},f.am=Ed,f.an=wa,f.ao=qc,f.ap=fa,f.ar=qi,f.as=function(a,e){var r=e[0],l=e[1],h=e[2],g=e[3],y=e[4],v=e[5],S=e[6],E=e[7],z=e[8],I=e[9],L=e[10],O=e[11],P=e[12],G=e[13],X=e[14],J=e[15],ce=r*v-l*y,ie=r*S-h*y,he=r*E-g*y,fe=l*S-h*v,De=l*E-g*v,Xe=h*E-g*S,vt=z*G-I*P,lt=z*X-L*P,at=z*J-O*P,Ke=I*X-L*G,dt=I*J-O*G,We=L*J-O*X,qe=ce*We-ie*dt+he*Ke+fe*at-De*lt+Xe*vt;return qe?(a[0]=(v*We-S*dt+E*Ke)*(qe=1/qe),a[1]=(h*dt-l*We-g*Ke)*qe,a[2]=(G*Xe-X*De+J*fe)*qe,a[3]=(L*De-I*Xe-O*fe)*qe,a[4]=(S*at-y*We-E*lt)*qe,a[5]=(r*We-h*at+g*lt)*qe,a[6]=(X*he-P*Xe-J*ie)*qe,a[7]=(z*Xe-L*he+O*ie)*qe,a[8]=(y*dt-v*at+E*vt)*qe,a[9]=(l*at-r*dt-g*vt)*qe,a[10]=(P*De-G*he+J*ce)*qe,a[11]=(I*he-z*De-O*ce)*qe,a[12]=(v*lt-y*Ke-S*vt)*qe,a[13]=(r*Ke-l*lt+h*vt)*qe,a[14]=(G*ie-P*fe-X*ce)*qe,a[15]=(z*fe-I*ie+L*ce)*qe,a):null},f.at=Md,f.au=ph,f.av=Fs,f.aw=function(){const a={},e=Ee.$version;for(const r in Ee.$root){const l=Ee.$root[r];if(l.required){let h=null;h=r==="version"?e:l.type==="array"?[]:{},h!=null&&(a[r]=h)}}return a},f.ax=$t,f.ay=ml,f.az=ii,f.b=function(a,e){const r=new Blob([new Uint8Array(a)],{type:"image/png"});createImageBitmap(r).then((l=>{e(null,l)})).catch((l=>{e(new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))},f.b0=Ua,f.b1=function(a,e){var r=a[0],l=a[1],h=a[2],g=a[3],y=a[4],v=a[5],S=a[6],E=a[7],z=a[8],I=a[9],L=a[10],O=a[11],P=a[12],G=a[13],X=a[14],J=a[15],ce=e[0],ie=e[1],he=e[2],fe=e[3],De=e[4],Xe=e[5],vt=e[6],lt=e[7],at=e[8],Ke=e[9],dt=e[10],We=e[11],qe=e[12],zt=e[13],xt=e[14],Yt=e[15];return Math.abs(r-ce)<=on*Math.max(1,Math.abs(r),Math.abs(ce))&&Math.abs(l-ie)<=on*Math.max(1,Math.abs(l),Math.abs(ie))&&Math.abs(h-he)<=on*Math.max(1,Math.abs(h),Math.abs(he))&&Math.abs(g-fe)<=on*Math.max(1,Math.abs(g),Math.abs(fe))&&Math.abs(y-De)<=on*Math.max(1,Math.abs(y),Math.abs(De))&&Math.abs(v-Xe)<=on*Math.max(1,Math.abs(v),Math.abs(Xe))&&Math.abs(S-vt)<=on*Math.max(1,Math.abs(S),Math.abs(vt))&&Math.abs(E-lt)<=on*Math.max(1,Math.abs(E),Math.abs(lt))&&Math.abs(z-at)<=on*Math.max(1,Math.abs(z),Math.abs(at))&&Math.abs(I-Ke)<=on*Math.max(1,Math.abs(I),Math.abs(Ke))&&Math.abs(L-dt)<=on*Math.max(1,Math.abs(L),Math.abs(dt))&&Math.abs(O-We)<=on*Math.max(1,Math.abs(O),Math.abs(We))&&Math.abs(P-qe)<=on*Math.max(1,Math.abs(P),Math.abs(qe))&&Math.abs(G-zt)<=on*Math.max(1,Math.abs(G),Math.abs(zt))&&Math.abs(X-xt)<=on*Math.max(1,Math.abs(X),Math.abs(xt))&&Math.abs(J-Yt)<=on*Math.max(1,Math.abs(J),Math.abs(Yt))},f.b2=function(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},f.b3=function(a,e,r){return a[0]=e[0]*r[0],a[1]=e[1]*r[1],a[2]=e[2]*r[2],a[3]=e[3]*r[3],a},f.b4=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]*e[3]},f.b5=Pe,f.b6=Hn,f.b7=bh,f.b8=function(a,e,r,l,h){var g,y=1/Math.tan(e/2);return a[0]=y/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=y,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,h!=null&&h!==1/0?(a[10]=(h+l)*(g=1/(l-h)),a[14]=2*h*l*g):(a[10]=-1,a[14]=-2*l),a},f.b9=function(a,e,r){var l=Math.sin(r),h=Math.cos(r),g=e[4],y=e[5],v=e[6],S=e[7],E=e[8],z=e[9],I=e[10],L=e[11];return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[4]=g*h+E*l,a[5]=y*h+z*l,a[6]=v*h+I*l,a[7]=S*h+L*l,a[8]=E*h-g*l,a[9]=z*h-y*l,a[10]=I*h-v*l,a[11]=L*h-S*l,a},f.bA=ut,f.bB=fo,f.bC=ol,f.bD=Ya,f.ba=St,f.bb=Vt,f.bc=function(a,e){return a[0]=e[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=e[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},f.bd=class extends oo{},f.be=Ps,f.bf=Sd,f.bg=op,f.bi=Oi,f.bj=function(a,e,r=!1){if(vn===eu||vn===Po||vn===ss)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ir=Rt.resolveURL(a),vn=eu,gl=e,kn(),r||yl()},f.bk=As,f.bl=function(a,e){const r={};for(let h=0;h<a.length;h++){const g=e&&e[a[h].id]||dl(a[h]);e&&(e[a[h].id]=g);let y=r[g];y||(y=r[g]=[]),y.push(a[h])}const l=[];for(const h in r)l.push(r[h]);return l},f.bm=rt,f.bn=vo,f.bo=Sh,f.bp=Zn,f.bq=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=da/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const e=a.bucket.layers[0],r=e.layout,l=e._unevaluatedLayout._values,h={layoutIconSize:l["icon-size"].possiblyEvaluate(new oi(a.bucket.zoom+1),a.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new oi(a.bucket.zoom+1),a.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new oi(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:E,maxZoom:z}=a.bucket.textSizeData;h.compositeTextSizes=[l["text-size"].possiblyEvaluate(new oi(E),a.canonical),l["text-size"].possiblyEvaluate(new oi(z),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:E,maxZoom:z}=a.bucket.iconSizeData;h.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new oi(E),a.canonical),l["icon-size"].possiblyEvaluate(new oi(z),a.canonical)]}const g=r.get("text-line-height")*fa,y=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",v=r.get("text-keep-upright"),S=r.get("text-size");for(const E of a.bucket.features){const z=r.get("text-font").evaluate(E,{},a.canonical).join(","),I=S.evaluate(E,{},a.canonical),L=h.layoutTextSize.evaluate(E,{},a.canonical),O=h.layoutIconSize.evaluate(E,{},a.canonical),P={horizontal:{},vertical:void 0},G=E.text;let X,J=[0,0];if(G){const he=G.toString(),fe=r.get("text-letter-spacing").evaluate(E,{},a.canonical)*fa,De=Ql(he)?fe:0,Xe=r.get("text-anchor").evaluate(E,{},a.canonical),vt=Cf(e,E,a.canonical);if(!vt){const We=r.get("text-radial-offset").evaluate(E,{},a.canonical);J=We?Mf(Xe,[We*fa,Ah]):r.get("text-offset").evaluate(E,{},a.canonical).map((qe=>qe*fa))}let lt=y?"center":r.get("text-justify").evaluate(E,{},a.canonical);const at=r.get("symbol-placement"),Ke=at==="point"?r.get("text-max-width").evaluate(E,{},a.canonical)*fa:0,dt=()=>{a.bucket.allowVerticalPlacement&&ns(he)&&(P.vertical=hu(G,a.glyphMap,a.glyphPositions,a.imagePositions,z,Ke,g,Xe,"left",De,J,f.ai.vertical,!0,at,L,I))};if(!y&&vt){const We=new Set;if(lt==="auto")for(let zt=0;zt<vt.values.length;zt+=2)We.add(Md(vt.values[zt]));else We.add(lt);let qe=!1;for(const zt of We)if(!P.horizontal[zt])if(qe)P.horizontal[zt]=P.horizontal[0];else{const xt=hu(G,a.glyphMap,a.glyphPositions,a.imagePositions,z,Ke,g,"center",zt,De,J,f.ai.horizontal,!1,at,L,I);xt&&(P.horizontal[zt]=xt,qe=xt.positionedLines.length===1)}dt()}else{lt==="auto"&&(lt=Md(Xe));const We=hu(G,a.glyphMap,a.glyphPositions,a.imagePositions,z,Ke,g,Xe,lt,De,J,f.ai.horizontal,!1,at,L,I);We&&(P.horizontal[lt]=We),dt(),ns(he)&&y&&v&&(P.vertical=hu(G,a.glyphMap,a.glyphPositions,a.imagePositions,z,Ke,g,Xe,lt,De,J,f.ai.vertical,!1,at,L,I))}}let ce=!1;if(E.icon&&E.icon.name){const he=a.imageMap[E.icon.name];he&&(X=_f(a.imagePositions[E.icon.name],r.get("icon-offset").evaluate(E,{},a.canonical),r.get("icon-anchor").evaluate(E,{},a.canonical)),ce=!!he.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=ce:a.bucket.sdfIcons!==ce&&Bi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(he.pixelRatio!==a.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const ie=Mh(P.horizontal)||P.vertical;a.bucket.iconsInText=!!ie&&ie.iconsInText,(ie||X)&&zh(a.bucket,E,P,X,a.imageMap,h,L,O,J,ce,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},f.br=ec,f.bs=Ju,f.bt=eh,f.bu=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},f.bv=cs,f.bw=co,f.bx=function(a,e,r,l,h){return Oe(this,void 0,void 0,(function*(){if(bt())try{return yield se(a,e,r,l,h)}catch{}return(function(g,y,v,S,E){const z=g.width,I=g.height;Ie&&Ze||(Ie=new OffscreenCanvas(z,I),Ze=Ie.getContext("2d",{willReadFrequently:!0})),Ie.width=z,Ie.height=I,Ze.drawImage(g,0,0,z,I);const L=Ze.getImageData(y,v,S,E);return Ze.clearRect(0,0,z,I),L.data})(a,e,r,l,h)}))},f.by=xf,f.bz=U,f.c=Pt,f.d=function(a,e){const r=new Image;r.onload=()=>{e(null,r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame((()=>{r.src=si}))},r.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const l=new Blob([new Uint8Array(a)],{type:"image/png"});r.src=a.byteLength?URL.createObjectURL(l):si},f.e=Et,f.f=function(a,e){return Tr(Et(a,{type:"json"}),e)},f.g=Wi,f.h=Rt,f.i=Ye,f.j=Vr,f.k=ms,f.l=wo,f.m=Tr,f.n=function(a){return new cs(a).readFields(gf,[])},f.o=function(a,e,r){if(!a.length)return r(null,[]);let l=a.length;const h=new Array(a.length);let g=null;a.forEach(((y,v)=>{e(y,((S,E)=>{S&&(g=S),h[v]=E,--l==0&&r(g,h)}))}))},f.p=Gn,f.q=iu,f.r=wi,f.s=mn,f.t=Zh,f.u=ot,f.v=Ee,f.w=Bi,f.x=Oo,f.y=ts,f.z=function([a,e,r]){return e+=90,e*=Math.PI/180,r*=Math.PI/180,{x:a*Math.cos(e)*Math.sin(r),y:a*Math.sin(e)*Math.sin(r),z:a*Math.cos(r)}}})),$e(["./shared"],(function(f){class Oe{constructor(k){this.keyCache={},k&&this.replace(k)}replace(k){this._layerConfigs={},this._layers={},this.update(k,[])}update(k,R){for(const H of k){this._layerConfigs[H.id]=H;const Y=this._layers[H.id]=f.aC(H);Y._featureFilter=f.a6(Y.filter),this.keyCache[H.id]&&delete this.keyCache[H.id]}for(const H of R)delete this.keyCache[H],delete this._layerConfigs[H],delete this._layers[H];this.familiesBySource={};const F=f.bl(Object.values(this._layerConfigs),this.keyCache);for(const H of F){const Y=H.map((Ce=>this._layers[Ce.id])),de=Y[0];if(de.visibility==="none")continue;const ae=de.source||"";let W=this.familiesBySource[ae];W||(W=this.familiesBySource[ae]={});const le=de.sourceLayer||"_geojsonTileLayer";let Ae=W[le];Ae||(Ae=W[le]=[]),Ae.push(Y)}}}class U{constructor(k){const R={},F=[];for(const ae in k){const W=k[ae],le=R[ae]={};for(const Ae in W){const Ce=W[+Ae];if(!Ce||Ce.bitmap.width===0||Ce.bitmap.height===0)continue;const Le={x:0,y:0,w:Ce.bitmap.width+2,h:Ce.bitmap.height+2};F.push(Le),le[Ae]={rect:Le,metrics:Ce.metrics}}}const{w:H,h:Y}=f.p(F),de=new f.q({width:H||1,height:Y||1});for(const ae in k){const W=k[ae];for(const le in W){const Ae=W[+le];if(!Ae||Ae.bitmap.width===0||Ae.bitmap.height===0)continue;const Ce=R[ae][le].rect;f.q.copy(Ae.bitmap,de,{x:0,y:0},{x:Ce.x+1,y:Ce.y+1},Ae.bitmap)}}this.image=de,this.positions=R}}f.bm("GlyphAtlas",U);class ut{constructor(k){this.tileID=new f.O(k.tileID.overscaledZ,k.tileID.wrap,k.tileID.canonical.z,k.tileID.canonical.x,k.tileID.canonical.y),this.uid=k.uid,this.zoom=k.zoom,this.pixelRatio=k.pixelRatio,this.tileSize=k.tileSize,this.source=k.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=k.showCollisionBoxes,this.collectResourceTiming=!!k.collectResourceTiming,this.returnDependencies=!!k.returnDependencies,this.promoteId=k.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(k,R,F,H,Y){this.status="parsing",this.data=k,this.collisionBoxArray=new f.a3;const de=new f.bn(Object.keys(k.layers).sort()),ae=new f.bo(this.tileID,this.promoteId);ae.bucketLayerIDs=[];const W={},le={featureIndex:ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:F},Ae=R.familiesBySource[this.source];for(const ci in Ae){const ai=k.layers[ci];if(!ai)continue;ai.version===1&&f.w(`Vector tile source "${this.source}" layer "${ci}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const za=de.encode(ci),ki=[];for(let Ki=0;Ki<ai.length;Ki++){const ga=ai.feature(Ki),nn=ae.getId(ga,ci);ki.push({feature:ga,id:nn,index:Ki,sourceLayerIndex:za})}for(const Ki of Ae[ci]){const ga=Ki[0];ga.source!==this.source&&f.w(`layer.source = ${ga.source} does not equal this.source = ${this.source}`),ga.minzoom&&this.zoom<Math.floor(ga.minzoom)||ga.maxzoom&&this.zoom>=ga.maxzoom||ga.visibility!=="none"&&(Ue(Ki,this.zoom,F),(W[ga.id]=ga.createBucket({index:ae.bucketLayerIDs.length,layers:Ki,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:za,sourceID:this.source})).populate(ki,le,this.tileID.canonical),ae.bucketLayerIDs.push(Ki.map((nn=>nn.id))))}}let Ce,Le,At,It;const st=f.aH(le.glyphDependencies,(ci=>Object.keys(ci).map(Number)));this.inFlightDependencies.forEach((ci=>ci?.cancel())),this.inFlightDependencies=[];const pt=++this.dependencySentinel;Object.keys(st).length?this.inFlightDependencies.push(H.send("getGlyphs",{uid:this.uid,stacks:st,source:this.source,tileID:this.tileID,type:"glyphs"},((ci,ai)=>{pt===this.dependencySentinel&&(Ce||(Ce=ci,Le=ai,Ii.call(this)))}))):Le={};const Bt=Object.keys(le.iconDependencies);Bt.length?this.inFlightDependencies.push(H.send("getImages",{icons:Bt,source:this.source,tileID:this.tileID,type:"icons"},((ci,ai)=>{pt===this.dependencySentinel&&(Ce||(Ce=ci,At=ai,Ii.call(this)))}))):At={};const mi=Object.keys(le.patternDependencies);function Ii(){if(Ce)return Y(Ce);if(Le&&At&&It){const ci=new U(Le),ai=new f.bp(At,It);for(const za in W){const ki=W[za];ki instanceof f.a4?(Ue(ki.layers,this.zoom,F),f.bq({bucket:ki,glyphMap:Le,glyphPositions:ci.positions,imageMap:At,imagePositions:ai.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):ki.hasPattern&&(ki instanceof f.br||ki instanceof f.bs||ki instanceof f.bt)&&(Ue(ki.layers,this.zoom,F),ki.addFeatures(le,this.tileID.canonical,ai.patternPositions))}this.status="done",Y(null,{buckets:Object.values(W).filter((za=>!za.isEmpty())),featureIndex:ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ci.image,imageAtlas:ai,glyphMap:this.returnDependencies?Le:null,iconMap:this.returnDependencies?At:null,glyphPositions:this.returnDependencies?ci.positions:null})}}mi.length?this.inFlightDependencies.push(H.send("getImages",{icons:mi,source:this.source,tileID:this.tileID,type:"patterns"},((ci,ai)=>{pt===this.dependencySentinel&&(Ce||(Ce=ci,It=ai,Ii.call(this)))}))):It={},Ii.call(this)}}function Ue(Z,k,R){const F=new f.a8(k);for(const H of Z)H.recalculate(F,R)}function pe(Z,k){const R=f.l(Z.request,((F,H,Y,de)=>{if(F)k(F);else if(H)try{const ae=new f.bw.VectorTile(new f.bv(H));k(null,{vectorTile:ae,rawData:H,cacheControl:Y,expires:de})}catch(ae){const W=new Uint8Array(H);let le=`Unable to parse the tile at ${Z.request.url}, `;le+=W[0]===31&&W[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ae.messge}`,k(new Error(le))}}));return()=>{R.cancel(),k()}}class ft{constructor(k,R,F,H){this.actor=k,this.layerIndex=R,this.availableImages=F,this.loadVectorData=H||pe,this.fetching={},this.loading={},this.loaded={}}loadTile(k,R){const F=k.uid;this.loading||(this.loading={});const H=!!(k&&k.request&&k.request.collectResourceTiming)&&new f.bu(k.request),Y=this.loading[F]=new ut(k);Y.abort=this.loadVectorData(k,((de,ae)=>{if(delete this.loading[F],de||!ae)return Y.status="done",this.loaded[F]=Y,R(de);const W=ae.rawData,le={};ae.expires&&(le.expires=ae.expires),ae.cacheControl&&(le.cacheControl=ae.cacheControl);const Ae={};if(H){const Ce=H.finish();Ce&&(Ae.resourceTiming=JSON.parse(JSON.stringify(Ce)))}Y.vectorTile=ae.vectorTile,Y.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,((Ce,Le)=>{if(delete this.fetching[F],Ce||!Le)return R(Ce);R(null,f.e({rawTileData:W.slice(0)},Le,le,Ae))})),this.loaded=this.loaded||{},this.loaded[F]=Y,this.fetching[F]={rawTileData:W,cacheControl:le,resourceTiming:Ae}}))}reloadTile(k,R){const F=this.loaded,H=k.uid;if(F&&F[H]){const Y=F[H];Y.showCollisionBoxes=k.showCollisionBoxes,Y.status==="parsing"?Y.parse(Y.vectorTile,this.layerIndex,this.availableImages,this.actor,((de,ae)=>{if(de||!ae)return R(de,ae);let W;if(this.fetching[H]){const{rawTileData:le,cacheControl:Ae,resourceTiming:Ce}=this.fetching[H];delete this.fetching[H],W=f.e({rawTileData:le.slice(0)},ae,Ae,Ce)}else W=ae;R(null,W)})):Y.status==="done"&&(Y.vectorTile?Y.parse(Y.vectorTile,this.layerIndex,this.availableImages,this.actor,R):R())}}abortTile(k,R){const F=this.loading,H=k.uid;F&&F[H]&&F[H].abort&&(F[H].abort(),delete F[H]),R()}removeTile(k,R){const F=this.loaded,H=k.uid;F&&F[H]&&delete F[H],R()}}class ct{constructor(){this.loaded={}}loadTile(k,R){return f._(this,void 0,void 0,(function*(){const{uid:F,encoding:H,rawImageData:Y,redFactor:de,greenFactor:ae,blueFactor:W,baseShift:le}=k,Ae=Y.width+2,Ce=Y.height+2,Le=f.a(Y)?new f.R({width:Ae,height:Ce},yield f.bx(Y,-1,-1,Ae,Ce)):Y,At=new f.by(F,Le,H,de,ae,W,le);this.loaded=this.loaded||{},this.loaded[F]=At,R(null,At)}))}removeTile(k){const R=this.loaded,F=k.uid;R&&R[F]&&delete R[F]}}function Qe(Z,k){if(Z.length!==0){nt(Z[0],k);for(var R=1;R<Z.length;R++)nt(Z[R],!k)}}function nt(Z,k){for(var R=0,F=0,H=0,Y=Z.length,de=Y-1;H<Y;de=H++){var ae=(Z[H][0]-Z[de][0])*(Z[de][1]+Z[H][1]),W=R+ae;F+=Math.abs(R)>=Math.abs(ae)?R-W+ae:ae-W+R,R=W}R+F>=0!=!!k&&Z.reverse()}var Ge=f.bz((function Z(k,R){var F,H=k&&k.type;if(H==="FeatureCollection")for(F=0;F<k.features.length;F++)Z(k.features[F],R);else if(H==="GeometryCollection")for(F=0;F<k.geometries.length;F++)Z(k.geometries[F],R);else if(H==="Feature")Z(k.geometry,R);else if(H==="Polygon")Qe(k.coordinates,R);else if(H==="MultiPolygon")for(F=0;F<k.coordinates.length;F++)Qe(k.coordinates[F],R);return k}));const it=f.bw.VectorTileFeature.prototype.toGeoJSON;var bt={exports:{}},St=f.bA,Vt=f.bw.VectorTileFeature,Dt=Pe;function Pe(Z,k){this.options=k||{},this.features=Z,this.length=Z.length}function Et(Z,k){this.id=typeof Z.id=="number"?Z.id:void 0,this.type=Z.type,this.rawGeometry=Z.type===1?[Z.geometry]:Z.geometry,this.properties=Z.tags,this.extent=k||4096}Pe.prototype.feature=function(Z){return new Et(this.features[Z],this.options.extent)},Et.prototype.loadGeometry=function(){var Z=this.rawGeometry;this.geometry=[];for(var k=0;k<Z.length;k++){for(var R=Z[k],F=[],H=0;H<R.length;H++)F.push(new St(R[H][0],R[H][1]));this.geometry.push(F)}return this.geometry},Et.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Z=this.geometry,k=1/0,R=-1/0,F=1/0,H=-1/0,Y=0;Y<Z.length;Y++)for(var de=Z[Y],ae=0;ae<de.length;ae++){var W=de[ae];k=Math.min(k,W.x),R=Math.max(R,W.x),F=Math.min(F,W.y),H=Math.max(H,W.y)}return[k,F,R,H]},Et.prototype.toGeoJSON=Vt.prototype.toGeoJSON;var pi=f.bB,qt=Dt;function xi(Z){var k=new pi;return(function(R,F){for(var H in R.layers)F.writeMessage(3,bi,R.layers[H])})(Z,k),k.finish()}function bi(Z,k){var R;k.writeVarintField(15,Z.version||1),k.writeStringField(1,Z.name||""),k.writeVarintField(5,Z.extent||4096);var F={keys:[],values:[],keycache:{},valuecache:{}};for(R=0;R<Z.length;R++)F.feature=Z.feature(R),k.writeMessage(2,va,F);var H=F.keys;for(R=0;R<H.length;R++)k.writeStringField(3,H[R]);var Y=F.values;for(R=0;R<Y.length;R++)k.writeMessage(4,gt,Y[R])}function va(Z,k){var R=Z.feature;R.id!==void 0&&k.writeVarintField(1,R.id),k.writeMessage(2,Bi,Z),k.writeVarintField(3,R.type),k.writeMessage(4,Ye,R)}function Bi(Z,k){var R=Z.feature,F=Z.keys,H=Z.values,Y=Z.keycache,de=Z.valuecache;for(var ae in R.properties){var W=R.properties[ae],le=Y[ae];if(W!==null){le===void 0&&(F.push(ae),Y[ae]=le=F.length-1),k.writeVarint(le);var Ae=typeof W;Ae!=="string"&&Ae!=="boolean"&&Ae!=="number"&&(W=JSON.stringify(W));var Ce=Ae+":"+W,Le=de[Ce];Le===void 0&&(H.push(W),de[Ce]=Le=H.length-1),k.writeVarint(Le)}}}function Kt(Z,k){return(k<<3)+(7&Z)}function Se(Z){return Z<<1^Z>>31}function Ye(Z,k){for(var R=Z.loadGeometry(),F=Z.type,H=0,Y=0,de=R.length,ae=0;ae<de;ae++){var W=R[ae],le=1;F===1&&(le=W.length),k.writeVarint(Kt(1,le));for(var Ae=F===3?W.length-1:W.length,Ce=0;Ce<Ae;Ce++){Ce===1&&F!==1&&k.writeVarint(Kt(2,Ae-1));var Le=W[Ce].x-H,At=W[Ce].y-Y;k.writeVarint(Se(Le)),k.writeVarint(Se(At)),H+=Le,Y+=At}F===3&&k.writeVarint(Kt(7,1))}}function gt(Z,k){var R=typeof Z;R==="string"?k.writeStringField(1,Z):R==="boolean"?k.writeBooleanField(7,Z):R==="number"&&(Z%1!=0?k.writeDoubleField(3,Z):Z<0?k.writeSVarintField(6,Z):k.writeVarintField(5,Z))}bt.exports=xi,bt.exports.fromVectorTileJs=xi,bt.exports.fromGeojsonVt=function(Z,k){k=k||{};var R={};for(var F in Z)R[F]=new qt(Z[F].features,k),R[F].name=F,R[F].version=k.version,R[F].extent=k.extent;return xi({layers:R})},bt.exports.GeoJSONWrapper=qt;var Gt=f.bz(bt.exports);const si={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Z=>Z},se=Math.fround||(Ie=new Float32Array(1),Z=>(Ie[0]=+Z,Ie[0]));var Ie;const Ze=3,ht=5,kt=6;class Rt{constructor(k){this.options=Object.assign(Object.create(si),k),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(k){const{log:R,minZoom:F,maxZoom:H}=this.options;R&&console.time("total time");const Y=`prepare ${k.length} points`;R&&console.time(Y),this.points=k;const de=[];for(let W=0;W<k.length;W++){const le=k[W];if(!le.geometry)continue;const[Ae,Ce]=le.geometry.coordinates,Le=se(ii(Ae)),At=se(Wi(Ce));de.push(Le,At,1/0,W,-1,1),this.options.reduce&&de.push(0)}let ae=this.trees[H+1]=this._createTree(de);R&&console.timeEnd(Y);for(let W=H;W>=F;W--){const le=+Date.now();ae=this.trees[W]=this._createTree(this._cluster(ae,W)),R&&console.log("z%d: %d clusters in %dms",W,ae.numItems,+Date.now()-le)}return R&&console.timeEnd("total time"),this}getClusters(k,R){let F=((k[0]+180)%360+360)%360-180;const H=Math.max(-90,Math.min(90,k[1]));let Y=k[2]===180?180:((k[2]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,k[3]));if(k[2]-k[0]>=360)F=-180,Y=180;else if(F>Y){const Ce=this.getClusters([F,H,180,de],R),Le=this.getClusters([-180,H,Y,de],R);return Ce.concat(Le)}const ae=this.trees[this._limitZoom(R)],W=ae.range(ii(F),Wi(de),ii(Y),Wi(H)),le=ae.data,Ae=[];for(const Ce of W){const Le=this.stride*Ce;Ae.push(le[Le+ht]>1?Pt(le,Le,this.clusterProps):this.points[le[Le+Ze]])}return Ae}getChildren(k){const R=this._getOriginId(k),F=this._getOriginZoom(k),H="No cluster with the specified id.",Y=this.trees[F];if(!Y)throw new Error(H);const de=Y.data;if(R*this.stride>=de.length)throw new Error(H);const ae=this.options.radius/(this.options.extent*Math.pow(2,F-1)),W=Y.within(de[R*this.stride],de[R*this.stride+1],ae),le=[];for(const Ae of W){const Ce=Ae*this.stride;de[Ce+4]===k&&le.push(de[Ce+ht]>1?Pt(de,Ce,this.clusterProps):this.points[de[Ce+Ze]])}if(le.length===0)throw new Error(H);return le}getLeaves(k,R,F){const H=[];return this._appendLeaves(H,k,R=R||10,F=F||0,0),H}getTile(k,R,F){const H=this.trees[this._limitZoom(k)],Y=Math.pow(2,k),{extent:de,radius:ae}=this.options,W=ae/de,le=(F-W)/Y,Ae=(F+1+W)/Y,Ce={features:[]};return this._addTileFeatures(H.range((R-W)/Y,le,(R+1+W)/Y,Ae),H.data,R,F,Y,Ce),R===0&&this._addTileFeatures(H.range(1-W/Y,le,1,Ae),H.data,Y,F,Y,Ce),R===Y-1&&this._addTileFeatures(H.range(0,le,W/Y,Ae),H.data,-1,F,Y,Ce),Ce.features.length?Ce:null}getClusterExpansionZoom(k){let R=this._getOriginZoom(k)-1;for(;R<=this.options.maxZoom;){const F=this.getChildren(k);if(R++,F.length!==1)break;k=F[0].properties.cluster_id}return R}_appendLeaves(k,R,F,H,Y){const de=this.getChildren(R);for(const ae of de){const W=ae.properties;if(W&&W.cluster?Y+W.point_count<=H?Y+=W.point_count:Y=this._appendLeaves(k,W.cluster_id,F,H,Y):Y<H?Y++:k.push(ae),k.length===F)break}return Y}_createTree(k){const R=new f.av(k.length/this.stride|0,this.options.nodeSize,Float32Array);for(let F=0;F<k.length;F+=this.stride)R.add(k[F],k[F+1]);return R.finish(),R.data=k,R}_addTileFeatures(k,R,F,H,Y,de){for(const ae of k){const W=ae*this.stride,le=R[W+ht]>1;let Ae,Ce,Le;if(le)Ae=Oi(R,W,this.clusterProps),Ce=R[W],Le=R[W+1];else{const st=this.points[R[W+Ze]];Ae=st.properties;const[pt,Bt]=st.geometry.coordinates;Ce=ii(pt),Le=Wi(Bt)}const At={type:1,geometry:[[Math.round(this.options.extent*(Ce*Y-F)),Math.round(this.options.extent*(Le*Y-H))]],tags:Ae};let It;It=le||this.options.generateId?R[W+Ze]:this.points[R[W+Ze]].id,It!==void 0&&(At.id=It),de.features.push(At)}}_limitZoom(k){return Math.max(this.options.minZoom,Math.min(Math.floor(+k),this.options.maxZoom+1))}_cluster(k,R){const{radius:F,extent:H,reduce:Y,minPoints:de}=this.options,ae=F/(H*Math.pow(2,R)),W=k.data,le=[],Ae=this.stride;for(let Ce=0;Ce<W.length;Ce+=Ae){if(W[Ce+2]<=R)continue;W[Ce+2]=R;const Le=W[Ce],At=W[Ce+1],It=k.within(W[Ce],W[Ce+1],ae),st=W[Ce+ht];let pt=st;for(const Bt of It){const mi=Bt*Ae;W[mi+2]>R&&(pt+=W[mi+ht])}if(pt>st&&pt>=de){let Bt,mi=Le*st,Ii=At*st,ci=-1;const ai=((Ce/Ae|0)<<5)+(R+1)+this.points.length;for(const za of It){const ki=za*Ae;if(W[ki+2]<=R)continue;W[ki+2]=R;const Ki=W[ki+ht];mi+=W[ki]*Ki,Ii+=W[ki+1]*Ki,W[ki+4]=ai,Y&&(Bt||(Bt=this._map(W,Ce,!0),ci=this.clusterProps.length,this.clusterProps.push(Bt)),Y(Bt,this._map(W,ki)))}W[Ce+4]=ai,le.push(mi/pt,Ii/pt,1/0,ai,-1,pt),Y&&le.push(ci)}else{for(let Bt=0;Bt<Ae;Bt++)le.push(W[Ce+Bt]);if(pt>1)for(const Bt of It){const mi=Bt*Ae;if(!(W[mi+2]<=R)){W[mi+2]=R;for(let Ii=0;Ii<Ae;Ii++)le.push(W[mi+Ii])}}}}return le}_getOriginId(k){return k-this.points.length>>5}_getOriginZoom(k){return(k-this.points.length)%32}_map(k,R,F){if(k[R+ht]>1){const de=this.clusterProps[k[R+kt]];return F?Object.assign({},de):de}const H=this.points[k[R+Ze]].properties,Y=this.options.map(H);return F&&Y===H?Object.assign({},Y):Y}}function Pt(Z,k,R){return{type:"Feature",id:Z[k+Ze],properties:Oi(Z,k,R),geometry:{type:"Point",coordinates:[(F=Z[k],360*(F-.5)),pn(Z[k+1])]}};var F}function Oi(Z,k,R){const F=Z[k+ht],H=F>=1e4?`${Math.round(F/1e3)}k`:F>=1e3?Math.round(F/100)/10+"k":F,Y=Z[k+kt],de=Y===-1?{}:Object.assign({},R[Y]);return Object.assign(de,{cluster:!0,cluster_id:Z[k+Ze],point_count:F,point_count_abbreviated:H})}function ii(Z){return Z/360+.5}function Wi(Z){const k=Math.sin(Z*Math.PI/180),R=.5-.25*Math.log((1+k)/(1-k))/Math.PI;return R<0?0:R>1?1:R}function pn(Z){const k=(180-360*Z)*Math.PI/180;return 360*Math.atan(Math.exp(k))/Math.PI-90}function Tr(Z,k,R,F){for(var H,Y=F,de=R-k>>1,ae=R-k,W=Z[k],le=Z[k+1],Ae=Z[R],Ce=Z[R+1],Le=k+3;Le<R;Le+=3){var At=wo(Z[Le],Z[Le+1],W,le,Ae,Ce);if(At>Y)H=Le,Y=At;else if(At===Y){var It=Math.abs(Le-de);It<ae&&(H=Le,ae=It)}}Y>F&&(H-k>3&&Tr(Z,k,H,F),Z[H+2]=Y,R-H>3&&Tr(Z,H,R,F))}function wo(Z,k,R,F,H,Y){var de=H-R,ae=Y-F;if(de!==0||ae!==0){var W=((Z-R)*de+(k-F)*ae)/(de*de+ae*ae);W>1?(R=H,F=Y):W>0&&(R+=de*W,F+=ae*W)}return(de=Z-R)*de+(ae=k-F)*ae}function mn(Z,k,R,F){var H={id:Z===void 0?null:Z,type:k,geometry:R,tags:F,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return(function(Y){var de=Y.geometry,ae=Y.type;if(ae==="Point"||ae==="MultiPoint"||ae==="LineString")ps(Y,de);else if(ae==="Polygon"||ae==="MultiLineString")for(var W=0;W<de.length;W++)ps(Y,de[W]);else if(ae==="MultiPolygon")for(W=0;W<de.length;W++)for(var le=0;le<de[W].length;le++)ps(Y,de[W][le])})(H),H}function ps(Z,k){for(var R=0;R<k.length;R+=3)Z.minX=Math.min(Z.minX,k[R]),Z.minY=Math.min(Z.minY,k[R+1]),Z.maxX=Math.max(Z.maxX,k[R]),Z.maxY=Math.max(Z.maxY,k[R+1])}function jr(Z,k,R,F){if(k.geometry){var H=k.geometry.coordinates,Y=k.geometry.type,de=Math.pow(R.tolerance/((1<<R.maxZoom)*R.extent),2),ae=[],W=k.id;if(R.promoteId?W=k.properties[R.promoteId]:R.generateId&&(W=F||0),Y==="Point")ms(H,ae);else if(Y==="MultiPoint")for(var le=0;le<H.length;le++)ms(H[le],ae);else if(Y==="LineString")Vr(H,ae,de,!1);else if(Y==="MultiLineString"){if(R.lineMetrics){for(le=0;le<H.length;le++)Vr(H[le],ae=[],de,!1),Z.push(mn(W,"LineString",ae,k.properties));return}qr(H,ae,de,!1)}else if(Y==="Polygon")qr(H,ae,de,!0);else{if(Y!=="MultiPolygon"){if(Y==="GeometryCollection"){for(le=0;le<k.geometry.geometries.length;le++)jr(Z,{id:W,geometry:k.geometry.geometries[le],properties:k.properties},R,F);return}throw new Error("Input data is not a valid GeoJSON object.")}for(le=0;le<H.length;le++){var Ae=[];qr(H[le],Ae,de,!0),ae.push(Ae)}}Z.push(mn(W,Y,ae,k.properties))}}function ms(Z,k){k.push(Ee(Z[0])),k.push(an(Z[1])),k.push(0)}function Vr(Z,k,R,F){for(var H,Y,de=0,ae=0;ae<Z.length;ae++){var W=Ee(Z[ae][0]),le=an(Z[ae][1]);k.push(W),k.push(le),k.push(0),ae>0&&(de+=F?(H*le-W*Y)/2:Math.sqrt(Math.pow(W-H,2)+Math.pow(le-Y,2))),H=W,Y=le}var Ae=k.length-3;k[2]=1,Tr(k,0,Ae,R),k[Ae+2]=1,k.size=Math.abs(de),k.start=0,k.end=k.size}function qr(Z,k,R,F){for(var H=0;H<Z.length;H++){var Y=[];Vr(Z[H],Y,R,F),k.push(Y)}}function Ee(Z){return Z/360+.5}function an(Z){var k=Math.sin(Z*Math.PI/180),R=.5-.25*Math.log((1+k)/(1-k))/Math.PI;return R<0?0:R>1?1:R}function Kn(Z,k,R,F,H,Y,de,ae){if(F/=k,Y>=(R/=k)&&de<F)return Z;if(de<R||Y>=F)return null;for(var W=[],le=0;le<Z.length;le++){var Ae=Z[le],Ce=Ae.geometry,Le=Ae.type,At=H===0?Ae.minX:Ae.minY,It=H===0?Ae.maxX:Ae.maxY;if(At>=R&&It<F)W.push(Ae);else if(!(It<R||At>=F)){var st=[];if(Le==="Point"||Le==="MultiPoint")Pi(Ce,st,R,F,H);else if(Le==="LineString")$t(Ce,st,R,F,H,!1,ae.lineMetrics);else if(Le==="MultiLineString")js(Ce,st,R,F,H,!1);else if(Le==="Polygon")js(Ce,st,R,F,H,!0);else if(Le==="MultiPolygon")for(var pt=0;pt<Ce.length;pt++){var Bt=[];js(Ce[pt],Bt,R,F,H,!0),Bt.length&&st.push(Bt)}if(st.length){if(ae.lineMetrics&&Le==="LineString"){for(pt=0;pt<st.length;pt++)W.push(mn(Ae.id,Le,st[pt],Ae.tags));continue}Le!=="LineString"&&Le!=="MultiLineString"||(st.length===1?(Le="LineString",st=st[0]):Le="MultiLineString"),Le!=="Point"&&Le!=="MultiPoint"||(Le=st.length===3?"Point":"MultiPoint"),W.push(mn(Ae.id,Le,st,Ae.tags))}}}return W.length?W:null}function Pi(Z,k,R,F,H){for(var Y=0;Y<Z.length;Y+=3){var de=Z[Y+H];de>=R&&de<=F&&(k.push(Z[Y]),k.push(Z[Y+1]),k.push(Z[Y+2]))}}function $t(Z,k,R,F,H,Y,de){for(var ae,W,le=Er(Z),Ae=H===0?Vs:So,Ce=Z.start,Le=0;Le<Z.length-3;Le+=3){var At=Z[Le],It=Z[Le+1],st=Z[Le+2],pt=Z[Le+3],Bt=Z[Le+4],mi=H===0?At:It,Ii=H===0?pt:Bt,ci=!1;de&&(ae=Math.sqrt(Math.pow(At-pt,2)+Math.pow(It-Bt,2))),mi<R?Ii>R&&(W=Ae(le,At,It,pt,Bt,R),de&&(le.start=Ce+ae*W)):mi>F?Ii<F&&(W=Ae(le,At,It,pt,Bt,F),de&&(le.start=Ce+ae*W)):Ar(le,At,It,st),Ii<R&&mi>=R&&(W=Ae(le,At,It,pt,Bt,R),ci=!0),Ii>F&&mi<=F&&(W=Ae(le,At,It,pt,Bt,F),ci=!0),!Y&&ci&&(de&&(le.end=Ce+ae*W),k.push(le),le=Er(Z)),de&&(Ce+=ae)}var ai=Z.length-3;At=Z[ai],It=Z[ai+1],st=Z[ai+2],(mi=H===0?At:It)>=R&&mi<=F&&Ar(le,At,It,st),ai=le.length-3,Y&&ai>=3&&(le[ai]!==le[0]||le[ai+1]!==le[1])&&Ar(le,le[0],le[1],le[2]),le.length&&k.push(le)}function Er(Z){var k=[];return k.size=Z.size,k.start=Z.start,k.end=Z.end,k}function js(Z,k,R,F,H,Y){for(var de=0;de<Z.length;de++)$t(Z[de],k,R,F,H,Y,!1)}function Ar(Z,k,R,F){Z.push(k),Z.push(R),Z.push(F)}function Vs(Z,k,R,F,H,Y){var de=(Y-k)/(F-k);return Z.push(Y),Z.push(R+(H-R)*de),Z.push(1),de}function So(Z,k,R,F,H,Y){var de=(Y-R)/(H-R);return Z.push(k+(F-k)*de),Z.push(Y),Z.push(1),de}function Gr(Z,k){for(var R=[],F=0;F<Z.length;F++){var H,Y=Z[F],de=Y.type;if(de==="Point"||de==="MultiPoint"||de==="LineString")H=qs(Y.geometry,k);else if(de==="MultiLineString"||de==="Polygon"){H=[];for(var ae=0;ae<Y.geometry.length;ae++)H.push(qs(Y.geometry[ae],k))}else if(de==="MultiPolygon")for(H=[],ae=0;ae<Y.geometry.length;ae++){for(var W=[],le=0;le<Y.geometry[ae].length;le++)W.push(qs(Y.geometry[ae][le],k));H.push(W)}R.push(mn(Y.id,de,H,Y.tags))}return R}function qs(Z,k){var R=[];R.size=Z.size,Z.start!==void 0&&(R.start=Z.start,R.end=Z.end);for(var F=0;F<Z.length;F+=3)R.push(Z[F]+k,Z[F+1],Z[F+2]);return R}function et(Z,k){if(Z.transformed)return Z;var R,F,H,Y=1<<Z.z,de=Z.x,ae=Z.y;for(R=0;R<Z.features.length;R++){var W=Z.features[R],le=W.geometry,Ae=W.type;if(W.geometry=[],Ae===1)for(F=0;F<le.length;F+=2)W.geometry.push(En(le[F],le[F+1],k,Y,de,ae));else for(F=0;F<le.length;F++){var Ce=[];for(H=0;H<le[F].length;H+=2)Ce.push(En(le[F][H],le[F][H+1],k,Y,de,ae));W.geometry.push(Ce)}}return Z.transformed=!0,Z}function En(Z,k,R,F,H,Y){return[Math.round(R*(Z*F-H)),Math.round(R*(k*F-Y))]}function di(Z,k,R,F,H){for(var Y=k===H.maxZoom?0:H.tolerance/((1<<k)*H.extent),de={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:R,y:F,z:k,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ae=0;ae<Z.length;ae++){de.numFeatures++,An(de,Z[ae],Y,H);var W=Z[ae].minX,le=Z[ae].minY,Ae=Z[ae].maxX,Ce=Z[ae].maxY;W<de.minX&&(de.minX=W),le<de.minY&&(de.minY=le),Ae>de.maxX&&(de.maxX=Ae),Ce>de.maxY&&(de.maxY=Ce)}return de}function An(Z,k,R,F){var H=k.geometry,Y=k.type,de=[];if(Y==="Point"||Y==="MultiPoint")for(var ae=0;ae<H.length;ae+=3)de.push(H[ae]),de.push(H[ae+1]),Z.numPoints++,Z.numSimplified++;else if(Y==="LineString")xa(de,H,Z,R,!1,!1);else if(Y==="MultiLineString"||Y==="Polygon")for(ae=0;ae<H.length;ae++)xa(de,H[ae],Z,R,Y==="Polygon",ae===0);else if(Y==="MultiPolygon")for(var W=0;W<H.length;W++){var le=H[W];for(ae=0;ae<le.length;ae++)xa(de,le[ae],Z,R,!0,ae===0)}if(de.length){var Ae=k.tags||null;if(Y==="LineString"&&F.lineMetrics){for(var Ce in Ae={},k.tags)Ae[Ce]=k.tags[Ce];Ae.mapbox_clip_start=H.start/H.size,Ae.mapbox_clip_end=H.end/H.size}var Le={geometry:de,type:Y==="Polygon"||Y==="MultiPolygon"?3:Y==="LineString"||Y==="MultiLineString"?2:1,tags:Ae};k.id!==null&&(Le.id=k.id),Z.features.push(Le)}}function xa(Z,k,R,F,H,Y){var de=F*F;if(F>0&&k.size<(H?de:F))R.numPoints+=k.length/3;else{for(var ae=[],W=0;W<k.length;W+=3)(F===0||k[W+2]>de)&&(R.numSimplified++,ae.push(k[W]),ae.push(k[W+1])),R.numPoints++;H&&(function(le,Ae){for(var Ce=0,Le=0,At=le.length,It=At-2;Le<At;It=Le,Le+=2)Ce+=(le[Le]-le[It])*(le[Le+1]+le[It+1]);if(Ce>0===Ae)for(Le=0,At=le.length;Le<At/2;Le+=2){var st=le[Le],pt=le[Le+1];le[Le]=le[At-2-Le],le[Le+1]=le[At-1-Le],le[At-2-Le]=st,le[At-1-Le]=pt}})(ae,Y),Z.push(ae)}}function tt(Z,k){var R=(k=this.options=(function(H,Y){for(var de in Y)H[de]=Y[de];return H})(Object.create(this.options),k)).debug;if(R&&console.time("preprocess data"),k.maxZoom<0||k.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(k.promoteId&&k.generateId)throw new Error("promoteId and generateId cannot be used together.");var F=(function(H,Y){var de=[];if(H.type==="FeatureCollection")for(var ae=0;ae<H.features.length;ae++)jr(de,H.features[ae],Y,ae);else jr(de,H.type==="Feature"?H:{geometry:H},Y);return de})(Z,k);this.tiles={},this.tileCoords=[],R&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",k.indexMaxZoom,k.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),F=(function(H,Y){var de=Y.buffer/Y.extent,ae=H,W=Kn(H,1,-1-de,de,0,-1,2,Y),le=Kn(H,1,1-de,2+de,0,-1,2,Y);return(W||le)&&(ae=Kn(H,1,-de,1+de,0,-1,2,Y)||[],W&&(ae=Gr(W,1).concat(ae)),le&&(ae=ae.concat(Gr(le,-1)))),ae})(F,k),F.length&&this.splitTile(F,0,0,0),R&&(F.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Xt(Z,k,R){return 32*((1<<Z)*R+k)+Z}function Ft(Z,k){return k?Z.properties[k]:Z.id}function Fa(Z,k){if(Z==null)return!0;if(Z.type==="Feature")return Ft(Z,k)!=null;if(Z.type==="FeatureCollection"){const R=new Set;for(const F of Z.features){const H=Ft(F,k);if(H==null||R.has(H))return!1;R.add(H)}return!0}return!1}function Nn(Z,k){const R=new Map;if(Z!=null)if(Z.type==="Feature")R.set(Ft(Z,k),Z);else for(const F of Z.features)R.set(Ft(F,k),F);return R}tt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},tt.prototype.splitTile=function(Z,k,R,F,H,Y,de){for(var ae=[Z,k,R,F],W=this.options,le=W.debug;ae.length;){F=ae.pop(),R=ae.pop(),k=ae.pop(),Z=ae.pop();var Ae=1<<k,Ce=Xt(k,R,F),Le=this.tiles[Ce];if(!Le&&(le>1&&console.time("creation"),Le=this.tiles[Ce]=di(Z,k,R,F,W),this.tileCoords.push({z:k,x:R,y:F}),le)){le>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",k,R,F,Le.numFeatures,Le.numPoints,Le.numSimplified),console.timeEnd("creation"));var At="z"+k;this.stats[At]=(this.stats[At]||0)+1,this.total++}if(Le.source=Z,H){if(k===W.maxZoom||k===H)continue;var It=1<<H-k;if(R!==Math.floor(Y/It)||F!==Math.floor(de/It))continue}else if(k===W.indexMaxZoom||Le.numPoints<=W.indexMaxPoints)continue;if(Le.source=null,Z.length!==0){le>1&&console.time("clipping");var st,pt,Bt,mi,Ii,ci,ai=.5*W.buffer/W.extent,za=.5-ai,ki=.5+ai,Ki=1+ai;st=pt=Bt=mi=null,Ii=Kn(Z,Ae,R-ai,R+ki,0,Le.minX,Le.maxX,W),ci=Kn(Z,Ae,R+za,R+Ki,0,Le.minX,Le.maxX,W),Z=null,Ii&&(st=Kn(Ii,Ae,F-ai,F+ki,1,Le.minY,Le.maxY,W),pt=Kn(Ii,Ae,F+za,F+Ki,1,Le.minY,Le.maxY,W),Ii=null),ci&&(Bt=Kn(ci,Ae,F-ai,F+ki,1,Le.minY,Le.maxY,W),mi=Kn(ci,Ae,F+za,F+Ki,1,Le.minY,Le.maxY,W),ci=null),le>1&&console.timeEnd("clipping"),ae.push(st||[],k+1,2*R,2*F),ae.push(pt||[],k+1,2*R,2*F+1),ae.push(Bt||[],k+1,2*R+1,2*F),ae.push(mi||[],k+1,2*R+1,2*F+1)}}},tt.prototype.getTile=function(Z,k,R){var F=this.options,H=F.extent,Y=F.debug;if(Z<0||Z>24)return null;var de=1<<Z,ae=Xt(Z,k=(k%de+de)%de,R);if(this.tiles[ae])return et(this.tiles[ae],H);Y>1&&console.log("drilling down to z%d-%d-%d",Z,k,R);for(var W,le=Z,Ae=k,Ce=R;!W&&le>0;)le--,Ae=Math.floor(Ae/2),Ce=Math.floor(Ce/2),W=this.tiles[Xt(le,Ae,Ce)];return W&&W.source?(Y>1&&console.log("found parent tile z%d-%d-%d",le,Ae,Ce),Y>1&&console.time("drilling down"),this.splitTile(W.source,le,Ae,Ce,Z,k,R),Y>1&&console.timeEnd("drilling down"),this.tiles[ae]?et(this.tiles[ae],H):null):null};class Ut extends ft{constructor(k,R,F,H){super(k,R,F),this._dataUpdateable=new Map,this.loadGeoJSON=(Y,de)=>{const{promoteId:ae}=Y;if(Y.request)return f.f(Y.request,((W,le,Ae,Ce)=>{this._dataUpdateable=Fa(le,ae)?Nn(le,ae):void 0,de(W,le,Ae,Ce)}));if(typeof Y.data=="string")try{const W=JSON.parse(Y.data);this._dataUpdateable=Fa(W,ae)?Nn(W,ae):void 0,de(null,W)}catch{de(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}else Y.dataDiff?this._dataUpdateable?((function(W,le,Ae){var Ce,Le,At,It;if(le.removeAll&&W.clear(),le.remove)for(const st of le.remove)W.delete(st);if(le.add)for(const st of le.add){const pt=Ft(st,Ae);pt!=null&&W.set(pt,st)}if(le.update)for(const st of le.update){let pt=W.get(st.id);if(pt==null)continue;const Bt=!st.removeAllProperties&&(((Ce=st.removeProperties)===null||Ce===void 0?void 0:Ce.length)>0||((Le=st.addOrUpdateProperties)===null||Le===void 0?void 0:Le.length)>0);if((st.newGeometry||st.removeAllProperties||Bt)&&(pt=Object.assign({},pt),W.set(st.id,pt),Bt&&(pt.properties=Object.assign({},pt.properties))),st.newGeometry&&(pt.geometry=st.newGeometry),st.removeAllProperties)pt.properties={};else if(((At=st.removeProperties)===null||At===void 0?void 0:At.length)>0)for(const mi of st.removeProperties)Object.prototype.hasOwnProperty.call(pt.properties,mi)&&delete pt.properties[mi];if(((It=st.addOrUpdateProperties)===null||It===void 0?void 0:It.length)>0)for(const{key:mi,value:Ii}of st.addOrUpdateProperties)pt.properties[mi]=Ii}})(this._dataUpdateable,Y.dataDiff,ae),de(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):de(new Error(`Cannot update existing geojson data in ${Y.source}`)):de(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,H&&(this.loadGeoJSON=H)}loadGeoJSONTile(k,R){const F=k.tileID.canonical;if(!this._geoJSONIndex)return R(null,null);const H=this._geoJSONIndex.getTile(F.z,F.x,F.y);if(!H)return R(null,null);const Y=new class{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.N,this.length=ae.length,this._features=ae}feature(ae){return new class{constructor(W){this._feature=W,this.extent=f.N,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))}loadGeometry(){if(this._feature.type===1){const W=[];for(const le of this._feature.geometry)W.push([new f.P(le[0],le[1])]);return W}{const W=[];for(const le of this._feature.geometry){const Ae=[];for(const Ce of le)Ae.push(new f.P(Ce[0],Ce[1]));W.push(Ae)}return W}}toGeoJSON(W,le,Ae){return it.call(this,W,le,Ae)}}(this._features[ae])}}(H.features);let de=Gt(Y);de.byteOffset===0&&de.byteLength===de.buffer.byteLength||(de=new Uint8Array(de)),R(null,{vectorTile:Y,rawData:de.buffer})}loadData(k,R){var F;(F=this._pendingRequest)===null||F===void 0||F.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const H=!!(k&&k.request&&k.request.collectResourceTiming)&&new f.bu(k.request);this._pendingCallback=R,this._pendingRequest=this.loadGeoJSON(k,((Y,de)=>{if(delete this._pendingCallback,delete this._pendingRequest,Y||!de)return R(Y);if(typeof de!="object")return R(new Error(`Input data given to '${k.source}' is not a valid GeoJSON object.`));{Ge(de,!0);try{if(k.filter){const W=f.bC(k.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(W.result==="error")throw new Error(W.value.map((Ae=>`${Ae.key}: ${Ae.message}`)).join(", "));de={type:"FeatureCollection",features:de.features.filter((Ae=>W.value.evaluate({zoom:0},Ae)))}}this._geoJSONIndex=k.cluster?new Rt((function({superclusterOptions:W,clusterProperties:le}){if(!le||!W)return W;const Ae={},Ce={},Le={accumulated:null,zoom:0},At={properties:null},It=Object.keys(le);for(const st of It){const[pt,Bt]=le[st],mi=f.bC(Bt),Ii=f.bC(typeof pt=="string"?[pt,["accumulated"],["get",st]]:pt);Ae[st]=mi.value,Ce[st]=Ii.value}return W.map=st=>{At.properties=st;const pt={};for(const Bt of It)pt[Bt]=Ae[Bt].evaluate(Le,At);return pt},W.reduce=(st,pt)=>{At.properties=pt;for(const Bt of It)Le.accumulated=st[Bt],st[Bt]=Ce[Bt].evaluate(Le,At)},W})(k)).load(de.features):(function(W,le){return new tt(W,le)})(de,k.geojsonVtOptions)}catch(W){return R(W)}this.loaded={};const ae={};if(H){const W=H.finish();W&&(ae.resourceTiming={},ae.resourceTiming[k.source]=JSON.parse(JSON.stringify(W)))}R(null,ae)}}))}reloadTile(k,R){const F=this.loaded;return F&&F[k.uid]?super.reloadTile(k,R):this.loadTile(k,R)}removeSource(k,R){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),R()}getClusterExpansionZoom(k,R){try{R(null,this._geoJSONIndex.getClusterExpansionZoom(k.clusterId))}catch(F){R(F)}}getClusterChildren(k,R){try{R(null,this._geoJSONIndex.getChildren(k.clusterId))}catch(F){R(F)}}getClusterLeaves(k,R){try{R(null,this._geoJSONIndex.getLeaves(k.clusterId,k.limit,k.offset))}catch(F){R(F)}}}class gn{constructor(k){this.self=k,this.actor=new f.C(k,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ft,geojson:Ut},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(R,F)=>{if(this.workerSourceTypes[R])throw new Error(`Worker source with name "${R}" already registered.`);this.workerSourceTypes[R]=F},this.self.registerRTLTextPlugin=R=>{if(f.bD.isParsed())throw new Error("RTL text plugin already registered.");f.bD.applyArabicShaping=R.applyArabicShaping,f.bD.processBidirectionalText=R.processBidirectionalText,f.bD.processStyledBidirectionalText=R.processStyledBidirectionalText}}setReferrer(k,R){this.referrer=R}setImages(k,R,F){this.availableImages[k]=R;for(const H in this.workerSources[k]){const Y=this.workerSources[k][H];for(const de in Y)Y[de].availableImages=R}F()}setLayers(k,R,F){this.getLayerIndex(k).replace(R),F()}updateLayers(k,R,F){this.getLayerIndex(k).update(R.layers,R.removedIds),F()}loadTile(k,R,F){this.getWorkerSource(k,R.type,R.source).loadTile(R,F)}loadDEMTile(k,R,F){this.getDEMWorkerSource(k,R.source).loadTile(R,F)}reloadTile(k,R,F){this.getWorkerSource(k,R.type,R.source).reloadTile(R,F)}abortTile(k,R,F){this.getWorkerSource(k,R.type,R.source).abortTile(R,F)}removeTile(k,R,F){this.getWorkerSource(k,R.type,R.source).removeTile(R,F)}removeDEMTile(k,R){this.getDEMWorkerSource(k,R.source).removeTile(R)}removeSource(k,R,F){if(!this.workerSources[k]||!this.workerSources[k][R.type]||!this.workerSources[k][R.type][R.source])return;const H=this.workerSources[k][R.type][R.source];delete this.workerSources[k][R.type][R.source],H.removeSource!==void 0?H.removeSource(R,F):F()}loadWorkerSource(k,R,F){try{this.self.importScripts(R.url),F()}catch(H){F(H.toString())}}syncRTLPluginState(k,R,F){try{f.bD.setState(R);const H=f.bD.getPluginURL();if(f.bD.isLoaded()&&!f.bD.isParsed()&&H!=null){this.self.importScripts(H);const Y=f.bD.isParsed();F(Y?void 0:new Error(`RTL Text Plugin failed to import scripts from ${H}`),Y)}}catch(H){F(H.toString())}}getAvailableImages(k){let R=this.availableImages[k];return R||(R=[]),R}getLayerIndex(k){let R=this.layerIndexes[k];return R||(R=this.layerIndexes[k]=new Oe),R}getWorkerSource(k,R,F){return this.workerSources[k]||(this.workerSources[k]={}),this.workerSources[k][R]||(this.workerSources[k][R]={}),this.workerSources[k][R][F]||(this.workerSources[k][R][F]=new this.workerSourceTypes[R]({send:(H,Y,de)=>{this.actor.send(H,Y,de,k)}},this.getLayerIndex(k),this.getAvailableImages(k))),this.workerSources[k][R][F]}getDEMWorkerSource(k,R){return this.demWorkerSources[k]||(this.demWorkerSources[k]={}),this.demWorkerSources[k][R]||(this.demWorkerSources[k][R]=new ct),this.demWorkerSources[k][R]}}return f.i()&&(self.worker=new gn(self)),gn})),$e(["./shared"],(function(f){var Oe="3.6.2";class U{static testProp(i){if(!U.docStyle)return i[0];for(let s=0;s<i.length;s++)if(i[s]in U.docStyle)return i[s];return i[0]}static create(i,s,u){const d=window.document.createElement(i);return s!==void 0&&(d.className=s),u&&u.appendChild(d),d}static createNS(i,s){return window.document.createElementNS(i,s)}static disableDrag(){U.docStyle&&U.selectProp&&(U.userSelect=U.docStyle[U.selectProp],U.docStyle[U.selectProp]="none")}static enableDrag(){U.docStyle&&U.selectProp&&(U.docStyle[U.selectProp]=U.userSelect)}static setTransform(i,s){i.style[U.transformProp]=s}static addEventListener(i,s,u,d={}){i.addEventListener(s,u,"passive"in d?d:d.capture)}static removeEventListener(i,s,u,d={}){i.removeEventListener(s,u,"passive"in d?d:d.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",U.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",U.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",U.suppressClickInternal,!0)}),0)}static mousePos(i,s){const u=i.getBoundingClientRect();return new f.P(s.clientX-u.left-i.clientLeft,s.clientY-u.top-i.clientTop)}static touchPos(i,s){const u=i.getBoundingClientRect(),d=[];for(let m=0;m<s.length;m++)d.push(new f.P(s[m].clientX-u.left-i.clientLeft,s[m].clientY-u.top-i.clientTop));return d}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}U.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,U.selectProp=U.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),U.transformProp=U.testProp(["transform","WebkitTransform"]);const ut={supported:!1,testSupport:function(p){!ft&&pe&&(ct?Qe(p):Ue=p)}};let Ue,pe,ft=!1,ct=!1;function Qe(p){const i=p.createTexture();p.bindTexture(p.TEXTURE_2D,i);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,pe),p.isContextLost())return;ut.supported=!0}catch{}p.deleteTexture(i),ft=!0}var nt,Ge;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=function(){Ue&&Qe(Ue),Ue=null,ct=!0},pe.onerror=function(){ft=!0,Ue=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(p){let i,s,u,d;p.resetRequestQueue=()=>{i=[],s=0,u=0,d={}},p.addThrottleControl=A=>{const M=u++;return d[M]=A,M},p.removeThrottleControl=A=>{delete d[A],w()},p.getImage=(A,M,C=!0)=>{ut.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*");const B={requestParameters:A,supportImageRefresh:C,callback:M,cancelled:!1,completed:!1,cancel:()=>{B.completed||B.cancelled||(B.cancelled=!0,B.innerRequest&&(B.innerRequest.cancel(),s--),w())}};return i.push(B),w(),B};const m=A=>{const{requestParameters:M,supportImageRefresh:C,callback:B}=A;return f.e(M,{type:"image"}),(C!==!1||f.i()||f.g(M.url)||M.headers&&!Object.keys(M.headers).reduce(((q,V)=>q&&V==="accept"),!0)?f.m:T)(M,((q,V,$,j)=>{x(A,B,q,V,$,j)}))},x=(A,M,C,B,q,V)=>{C?M(C):B instanceof HTMLImageElement||f.a(B)?M(null,B):B&&(($,j)=>{typeof createImageBitmap=="function"?f.b($,j):f.d($,j)})(B,(($,j)=>{$!=null?M($):j!=null&&M(null,j,{cacheControl:q,expires:V})})),A.cancelled||(A.completed=!0,s--,w())},w=()=>{const A=(()=>{const M=Object.keys(d);let C=!1;if(M.length>0){for(const B of M)if(C=d[B](),C)break}return C})()?f.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:f.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let M=s;M<A&&i.length>0;M++){const C=i.shift();if(C.cancelled){M--;continue}const B=m(C);s++,C.innerRequest=B}},T=(A,M)=>{const C=new Image,B=A.url;let q=!1;const V=A.credentials;return V&&V==="include"?C.crossOrigin="use-credentials":(V&&V==="same-origin"||!f.s(B))&&(C.crossOrigin="anonymous"),C.fetchPriority="high",C.onload=()=>{M(null,C),C.onerror=C.onload=null},C.onerror=()=>{q||M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),C.onerror=C.onload=null},C.src=B,{cancel:()=>{q=!0,C.src=""}}}})(nt||(nt={})),nt.resetRequestQueue(),(function(p){p.Glyphs="Glyphs",p.Image="Image",p.Source="Source",p.SpriteImage="SpriteImage",p.SpriteJSON="SpriteJSON",p.Style="Style",p.Tile="Tile",p.Unknown="Unknown"})(Ge||(Ge={}));class it{constructor(i){this._transformRequestFn=i}transformRequest(i,s){return this._transformRequestFn&&this._transformRequestFn(i,s)||{url:i}}normalizeSpriteURL(i,s,u){const d=(function(m){const x=m.match(bt);if(!x)throw new Error(`Unable to parse URL "${m}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}})(i);return d.path+=`${s}${u}`,(function(m){const x=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${x}`})(d)}setTransformRequest(i){this._transformRequestFn=i}}const bt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function St(p){var i=new f.A(3);return i[0]=p[0],i[1]=p[1],i[2]=p[2],i}var Vt,Dt=function(p,i,s){return p[0]=i[0]-s[0],p[1]=i[1]-s[1],p[2]=i[2]-s[2],p};Vt=new f.A(3),f.A!=Float32Array&&(Vt[0]=0,Vt[1]=0,Vt[2]=0);var Pe=function(p){var i=p[0],s=p[1];return i*i+s*s};function Et(p){const i=[];if(typeof p=="string")i.push({id:"default",url:p});else if(p&&p.length>0){const s=[];for(const{id:u,url:d}of p){const m=`${u}${d}`;s.indexOf(m)===-1&&(s.push(m),i.push({id:u,url:d}))}}return i}function pi(p,i,s,u,d){if(u)return void p(u);if(d!==Object.values(i).length||d!==Object.values(s).length)return;const m={};for(const x in i){m[x]={};const w=f.h.getImageCanvasContext(s[x]),T=i[x];for(const A in T){const{width:M,height:C,x:B,y:q,sdf:V,pixelRatio:$,stretchX:j,stretchY:re,content:ge}=T[A];m[x][A]={data:null,pixelRatio:$,sdf:V,stretchX:j,stretchY:re,content:ge,spriteData:{width:M,height:C,x:B,y:q,context:w}}}}p(null,m)}(function(){var p=new f.A(2);f.A!=Float32Array&&(p[0]=0,p[1]=0)})();class qt{constructor(i,s,u,d){this.context=i,this.format=u,this.texture=i.gl.createTexture(),this.update(s,d)}update(i,s,u){const{width:d,height:m}=i,x=!(this.size&&this.size[0]===d&&this.size[1]===m||u),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(s&&s.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!s||s.premultiply!==!1)),x)this.size=[d,m],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||f.a(i)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,i):T.texImage2D(T.TEXTURE_2D,0,this.format,d,m,0,this.format,T.UNSIGNED_BYTE,i.data);else{const{x:A,y:M}=u||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||f.a(i)?T.texSubImage2D(T.TEXTURE_2D,0,A,M,T.RGBA,T.UNSIGNED_BYTE,i):T.texSubImage2D(T.TEXTURE_2D,0,A,M,d,m,T.RGBA,T.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(i,s,u){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),u!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=m.LINEAR),i!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,i),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,u||i),this.filter=i),s!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function xi(p){const{userImage:i}=p;return!!(i&&i.render&&i.render())&&(p.data.replace(new Uint8Array(i.data.buffer)),!0)}class bi extends f.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new f.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:s,callback:u}of this.requestors)this._notify(s,u);this.requestors=[]}}getImage(i){const s=this.images[i];if(s&&!s.data&&s.spriteData){const u=s.spriteData;s.data=new f.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),s.spriteData=null}return s}addImage(i,s){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,s)&&(this.images[i]=s)}_validate(i,s){let u=!0;const d=s.data||s.spriteData;return this._validateStretch(s.stretchX,d&&d.width)||(this.fire(new f.j(new Error(`Image "${i}" has invalid "stretchX" value`))),u=!1),this._validateStretch(s.stretchY,d&&d.height)||(this.fire(new f.j(new Error(`Image "${i}" has invalid "stretchY" value`))),u=!1),this._validateContent(s.content,s)||(this.fire(new f.j(new Error(`Image "${i}" has invalid "content" value`))),u=!1),u}_validateStretch(i,s){if(!i)return!0;let u=0;for(const d of i){if(d[0]<u||d[1]<d[0]||s<d[1])return!1;u=d[1]}return!0}_validateContent(i,s){if(!i)return!0;if(i.length!==4)return!1;const u=s.spriteData,d=u&&u.width||s.data.width,m=u&&u.height||s.data.height;return!(i[0]<0||d<i[0]||i[1]<0||m<i[1]||i[2]<0||d<i[2]||i[3]<0||m<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,s,u=!0){const d=this.getImage(i);if(u&&(d.data.width!==s.data.width||d.data.height!==s.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=d.version+1,this.images[i]=s,this.updatedImages[i]=!0}removeImage(i){const s=this.images[i];delete this.images[i],delete this.patterns[i],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,s){let u=!0;if(!this.isLoaded())for(const d of i)this.images[d]||(u=!1);this.isLoaded()||u?this._notify(i,s):this.requestors.push({ids:i,callback:s})}_notify(i,s){const u={};for(const d of i){let m=this.getImage(d);m||(this.fire(new f.k("styleimagemissing",{id:d})),m=this.getImage(d)),m?u[d]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,hasRenderCallback:!!(m.userImage&&m.userImage.render)}:f.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,u)}getPixelSize(){const{width:i,height:s}=this.atlasImage;return{width:i,height:s}}getPattern(i){const s=this.patterns[i],u=this.getImage(i);if(!u)return null;if(s&&s.position.version===u.version)return s.position;if(s)s.position.version=u.version;else{const d={w:u.data.width+2,h:u.data.height+2,x:0,y:0},m=new f.I(d,u);this.patterns[i]={bin:d,position:m}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const s=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new qt(i,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const m in this.patterns)i.push(this.patterns[m].bin);const{w:s,h:u}=f.p(i),d=this.atlasImage;d.resize({width:s||1,height:u||1});for(const m in this.patterns){const{bin:x}=this.patterns[m],w=x.x+1,T=x.y+1,A=this.getImage(m).data,M=A.width,C=A.height;f.R.copy(A,d,{x:0,y:0},{x:w,y:T},{width:M,height:C}),f.R.copy(A,d,{x:0,y:C-1},{x:w,y:T-1},{width:M,height:1}),f.R.copy(A,d,{x:0,y:0},{x:w,y:T+C},{width:M,height:1}),f.R.copy(A,d,{x:M-1,y:0},{x:w-1,y:T},{width:1,height:C}),f.R.copy(A,d,{x:0,y:0},{x:w+M,y:T},{width:1,height:C})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const s of i){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const u=this.getImage(s);u||f.w(`Image with ID: "${s}" was not found`),xi(u)&&this.updateImage(s,u)}}}const va=1e20;function Bi(p,i,s,u,d,m,x,w,T){for(let A=i;A<i+u;A++)Kt(p,s*m+A,m,d,x,w,T);for(let A=s;A<s+d;A++)Kt(p,A*m+i,1,u,x,w,T)}function Kt(p,i,s,u,d,m,x){m[0]=0,x[0]=-va,x[1]=va,d[0]=p[i];for(let w=1,T=0,A=0;w<u;w++){d[w]=p[i+w*s];const M=w*w;do{const C=m[T];A=(d[w]-d[C]+M-C*C)/(w-C)/2}while(A<=x[T]&&--T>-1);T++,m[T]=w,x[T]=A,x[T+1]=va}for(let w=0,T=0;w<u;w++){for(;x[T+1]<w;)T++;const A=m[T],M=w-A;p[i+w*s]=d[A]+M*M}}class Se{constructor(i,s){this.requestManager=i,this.localIdeographFontFamily=s,this.entries={}}setURL(i){this.url=i}getGlyphs(i,s){const u=[];for(const d in i)for(const m of i[d])u.push({stack:d,id:m});f.o(u,(({stack:d,id:m},x)=>{let w=this.entries[d];w||(w=this.entries[d]={glyphs:{},requests:{},ranges:{}});let T=w.glyphs[m];if(T!==void 0)return void x(null,{stack:d,id:m,glyph:T});if(T=this._tinySDF(w,d,m),T)return w.glyphs[m]=T,void x(null,{stack:d,id:m,glyph:T});const A=Math.floor(m/256);if(256*A>65535)return void x(new Error("glyphs > 65535 not supported"));if(w.ranges[A])return void x(null,{stack:d,id:m,glyph:T});if(!this.url)return void x(new Error("glyphsUrl is not set"));let M=w.requests[A];M||(M=w.requests[A]=[],Se.loadGlyphRange(d,A,this.url,this.requestManager,((C,B)=>{if(B){for(const q in B)this._doesCharSupportLocalGlyph(+q)||(w.glyphs[+q]=B[+q]);w.ranges[A]=!0}for(const q of M)q(C,B);delete w.requests[A]}))),M.push(((C,B)=>{C?x(C):B&&x(null,{stack:d,id:m,glyph:B[m]||null})}))}),((d,m)=>{if(d)s(d);else if(m){const x={};for(const{stack:w,id:T,glyph:A}of m)(x[w]||(x[w]={}))[T]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics};s(null,x)}}))}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(f.u["CJK Unified Ideographs"](i)||f.u["Hangul Syllables"](i)||f.u.Hiragana(i)||f.u.Katakana(i))}_tinySDF(i,s,u){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(u))return;let m=i.tinySDF;if(!m){let w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),m=i.tinySDF=new Se.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:w})}const x=m.draw(String.fromCharCode(u));return{id:u,bitmap:new f.q({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}Se.loadGlyphRange=function(p,i,s,u,d){const m=256*i,x=m+255,w=u.transformRequest(s.replace("{fontstack}",p).replace("{range}",`${m}-${x}`),Ge.Glyphs);f.l(w,((T,A)=>{if(T)d(T);else if(A){const M={};for(const C of f.n(A))M[C.id]=C;d(null,M)}}))},Se.TinySDF=class{constructor({fontSize:p=24,buffer:i=3,radius:s=8,cutoff:u=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:x="normal"}={}){this.buffer=i,this.cutoff=u,this.radius=s;const w=this.size=p+4*i,T=this._createCanvas(w),A=this.ctx=T.getContext("2d",{willReadFrequently:!0});A.font=`${x} ${m} ${p}px ${d}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(p){const i=document.createElement("canvas");return i.width=i.height=p,i}draw(p){const{width:i,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(p),x=Math.ceil(s),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),T=Math.min(this.size-this.buffer,x+Math.ceil(u)),A=w+2*this.buffer,M=T+2*this.buffer,C=Math.max(A*M,0),B=new Uint8ClampedArray(C),q={data:B,width:A,height:M,glyphWidth:w,glyphHeight:T,glyphTop:x,glyphLeft:0,glyphAdvance:i};if(w===0||T===0)return q;const{ctx:V,buffer:$,gridInner:j,gridOuter:re}=this;V.clearRect($,$,w,T),V.fillText(p,$,$+x);const ge=V.getImageData($,$,w,T);re.fill(va,0,C),j.fill(0,0,C);for(let K=0;K<T;K++)for(let oe=0;oe<w;oe++){const _e=ge.data[4*(K*w+oe)+3]/255;if(_e===0)continue;const xe=(K+$)*A+oe+$;if(_e===1)re[xe]=0,j[xe]=va;else{const ze=.5-_e;re[xe]=ze>0?ze*ze:0,j[xe]=ze<0?ze*ze:0}}Bi(re,0,0,A,M,A,this.f,this.v,this.z),Bi(j,$,$,w,T,A,this.f,this.v,this.z);for(let K=0;K<C;K++){const oe=Math.sqrt(re[K])-Math.sqrt(j[K]);B[K]=Math.round(255-255*(oe/this.radius+this.cutoff))}return q}};class Ye{constructor(){this.specification=f.v.light.position}possiblyEvaluate(i,s){return f.z(i.expression.evaluate(s))}interpolate(i,s,u){return{x:f.B.number(i.x,s.x,u),y:f.B.number(i.y,s.y,u),z:f.B.number(i.z,s.z,u)}}}let gt;class Gt extends f.E{constructor(i){super(),gt=gt||new f.r({anchor:new f.D(f.v.light.anchor),position:new Ye,color:new f.D(f.v.light.color),intensity:new f.D(f.v.light.intensity)}),this._transitionable=new f.T(gt),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,s={}){if(!this._validate(f.t,i,s))for(const u in i){const d=i[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),d):this._transitionable.setValue(u,d)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,s,u){return(!u||u.validate!==!1)&&f.x(this,i.call(f.y,f.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:f.v})))}}class si{constructor(i,s){this.width=i,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,s){const u=i.join(",")+String(s);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(i,s)),this.dashEntry[u]}getDashRanges(i,s,u){const d=[];let m=i.length%2==1?-i[i.length-1]*u:0,x=i[0]*u,w=!0;d.push({left:m,right:x,isDash:w,zeroLength:i[0]===0});let T=i[0];for(let A=1;A<i.length;A++){w=!w;const M=i[A];m=T*u,T+=M,x=T*u,d.push({left:m,right:x,isDash:w,zeroLength:M===0})}return d}addRoundDash(i,s,u){const d=s/2;for(let m=-u;m<=u;m++){const x=this.width*(this.nextRow+u+m);let w=0,T=i[w];for(let A=0;A<this.width;A++){A/T.right>1&&(T=i[++w]);const M=Math.abs(A-T.left),C=Math.abs(A-T.right),B=Math.min(M,C);let q;const V=m/u*(d+1);if(T.isDash){const $=d-Math.abs(V);q=Math.sqrt(B*B+$*$)}else q=d-Math.sqrt(B*B+V*V);this.data[x+A]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(i){for(let w=i.length-1;w>=0;--w){const T=i[w],A=i[w+1];T.zeroLength?i.splice(w,1):A&&A.isDash===T.isDash&&(A.left=T.left,i.splice(w,1))}const s=i[0],u=i[i.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const d=this.width*this.nextRow;let m=0,x=i[m];for(let w=0;w<this.width;w++){w/x.right>1&&(x=i[++m]);const T=Math.abs(w-x.left),A=Math.abs(w-x.right),M=Math.min(T,A);this.data[d+w]=Math.max(0,Math.min(255,(x.isDash?M:-M)+128))}}addDash(i,s){const u=s?7:0,d=2*u+1;if(this.nextRow+d>this.height)return f.w("LineAtlas out of space"),null;let m=0;for(let w=0;w<i.length;w++)m+=i[w];if(m!==0){const w=this.width/m,T=this.getDashRanges(i,this.width,w);s?this.addRoundDash(T,w,u):this.addRegularDash(T)}const x={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:m};return this.nextRow+=d,this.dirty=!0,x}bind(i){const s=i.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}class se{constructor(i,s,u){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=u;const d=this.workerPool.acquire(u);for(let m=0;m<d.length;m++){const x=new f.C(d[m],s,u);x.name=`Worker ${m}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,s,u){f.o(this.actors,((d,m)=>{d.send(i,s,m)}),u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach((s=>{s.remove()})),this.actors=[],i&&this.workerPool.release(this.id)}}function Ie(p,i,s){const u=function(d,m){if(d)return s(d);if(m){const x=f.F(f.e(m,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);m.vector_layers&&(x.vectorLayers=m.vector_layers,x.vectorLayerIds=x.vectorLayers.map((w=>w.id))),s(null,x)}};return p.url?f.f(i.transformRequest(p.url,Ge.Source),u):f.h.frame((()=>u(null,p)))}class Ze{constructor(i,s){i&&(s?this.setSouthWest(i).setNorthEast(s):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof f.L?new f.L(i.lng,i.lat):f.L.convert(i),this}setSouthWest(i){return this._sw=i instanceof f.L?new f.L(i.lng,i.lat):f.L.convert(i),this}extend(i){const s=this._sw,u=this._ne;let d,m;if(i instanceof f.L)d=i,m=i;else{if(!(i instanceof Ze))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Ze.convert(i)):this.extend(f.L.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(f.L.convert(i)):this;if(d=i._sw,m=i._ne,!d||!m)return this}return s||u?(s.lng=Math.min(d.lng,s.lng),s.lat=Math.min(d.lat,s.lat),u.lng=Math.max(m.lng,u.lng),u.lat=Math.max(m.lat,u.lat)):(this._sw=new f.L(d.lng,d.lat),this._ne=new f.L(m.lng,m.lat)),this}getCenter(){return new f.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new f.L(this.getWest(),this.getNorth())}getSouthEast(){return new f.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:s,lat:u}=f.L.convert(i);let d=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&d}static convert(i){return i instanceof Ze?i:i&&new Ze(i)}static fromLngLat(i,s=0){const u=360*s/40075017,d=u/Math.cos(Math.PI/180*i.lat);return new Ze(new f.L(i.lng-d,i.lat-u),new f.L(i.lng+d,i.lat+u))}}class ht{constructor(i,s,u){this.bounds=Ze.convert(this.validateBounds(i)),this.minzoom=s||0,this.maxzoom=u||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const s=Math.pow(2,i.z),u=Math.floor(f.G(this.bounds.getWest())*s),d=Math.floor(f.H(this.bounds.getNorth())*s),m=Math.ceil(f.G(this.bounds.getEast())*s),x=Math.ceil(f.H(this.bounds.getSouth())*s);return i.x>=u&&i.x<m&&i.y>=d&&i.y<x}}class kt extends f.E{constructor(i,s,u,d){if(super(),this.load=()=>{this._loaded=!1,this.fire(new f.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ie(this._options,this.map._requestManager,((m,x)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),m?this.fire(new f.j(m)):x&&(f.e(this,x),x.bounds&&(this.tileBounds=new ht(x.bounds,this.minzoom,this.maxzoom)),this.fire(new f.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.k("data",{dataType:"source",sourceDataType:"content"})))}))},this.serialize=()=>f.e({},this._options),this.id=i,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,f.e(this,f.F(s,["url","scheme","tileSize","promoteId"])),this._options=f.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.load()}setTiles(i){return this.setSourceProperty((()=>{this._options.tiles=i})),this}setUrl(i){return this.setSourceProperty((()=>{this.url=i,this._options.url=i})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(i,s){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(u,Ge.Tile),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function m(x,w){return delete i.request,i.aborted?s(null):x&&x.status!==404?s(x):(w&&w.resourceTiming&&(i.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&i.setExpiryData(w),i.loadVectorData(w,this.map.painter),s(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}d.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired"?i.state==="loading"?i.reloadCallback=s:i.request=i.actor.send("reloadTile",d,m.bind(this)):(i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",d,m.bind(this)))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id},void 0)}unloadTile(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Rt extends f.E{constructor(i,s,u,d){super(),this.id=i,this.dispatcher=u,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=f.e({type:"raster"},s),f.e(this,f.F(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new f.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ie(this._options,this.map._requestManager,((i,s)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new f.j(i)):s&&(f.e(this,s),s.bounds&&(this.tileBounds=new ht(s.bounds,this.minzoom,this.maxzoom)),this.fire(new f.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.k("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.load()}setTiles(i){return this.setSourceProperty((()=>{this._options.tiles=i})),this}serialize(){return f.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,s){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.request=nt.getImage(this.map._requestManager.transformRequest(u,Ge.Tile),((d,m,x)=>{if(delete i.request,i.aborted)i.state="unloaded",s(null);else if(d)i.state="errored",s(d);else if(m){this.map._refreshExpiredTiles&&x&&i.setExpiryData(x);const w=this.map.painter.context,T=w.gl;i.texture=this.map.painter.getTileTexture(m.width),i.texture?i.texture.update(m,{useMipmap:!0}):(i.texture=new qt(w,m,T.RGBA,{useMipmap:!0}),i.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),w.extTextureFilterAnisotropic&&T.texParameterf(T.TEXTURE_2D,w.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,w.extTextureFilterAnisotropicMax)),i.state="loaded",s(null)}}),this.map._refreshExpiredTiles)}abortTile(i,s){i.request&&(i.request.cancel(),delete i.request),s()}unloadTile(i,s){i.texture&&this.map.painter.saveTileTexture(i.texture),s()}hasTransition(){return!1}}class Pt extends Rt{constructor(i,s,u,d){super(i,s,u,d),this.type="raster-dem",this.maxzoom=22,this._options=f.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(i,s){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(u,Ge.Tile);function m(x,w){x&&(i.state="errored",s(x)),w&&(i.dem=w,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded",s(null))}i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.request=nt.getImage(d,((x,w,T)=>f._(this,void 0,void 0,(function*(){if(delete i.request,i.aborted)i.state="unloaded",s(null);else if(x)i.state="errored",s(x);else if(w){this.map._refreshExpiredTiles&&i.setExpiryData(T);const A=f.a(w)&&f.J()?w:yield(function(C){return f._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&f.K()){const B=C.width+2,q=C.height+2;try{return new f.R({width:B,height:q},yield f.M(C,-1,-1,B,q))}catch{}}return f.h.getImageData(C,1)}))})(w),M={uid:i.uid,coord:i.tileID,source:this.id,rawImageData:A,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",M,m))}}))),this.map._refreshExpiredTiles)}_getNeighboringTiles(i){const s=i.canonical,u=Math.pow(2,s.z),d=(s.x-1+u)%u,m=s.x===0?i.wrap-1:i.wrap,x=(s.x+1+u)%u,w=s.x+1===u?i.wrap+1:i.wrap,T={};return T[new f.O(i.overscaledZ,m,s.z,d,s.y).key]={backfilled:!1},T[new f.O(i.overscaledZ,w,s.z,x,s.y).key]={backfilled:!1},s.y>0&&(T[new f.O(i.overscaledZ,m,s.z,d,s.y-1).key]={backfilled:!1},T[new f.O(i.overscaledZ,i.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},T[new f.O(i.overscaledZ,w,s.z,x,s.y-1).key]={backfilled:!1}),s.y+1<u&&(T[new f.O(i.overscaledZ,m,s.z,d,s.y+1).key]={backfilled:!1},T[new f.O(i.overscaledZ,i.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},T[new f.O(i.overscaledZ,w,s.z,x,s.y+1).key]={backfilled:!1}),T}unloadTile(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&i.actor.send("removeDEMTile",{uid:i.uid,source:this.id})}}class Oi extends f.E{constructor(i,s,u,d){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>f.e({},this._options,{type:this.type,data:this._data}),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(d),this._data=s.data,this._options=f.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const m=f.N/this.tileSize;this.workerOptions=f.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*m,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*m,extent:f.N,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:f.N,radius:(s.clusterRadius||50)*m,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData(),this}updateData(i){return this._updateWorkerData(i),this}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=i.clusterRadius),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=i.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(i,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id},s),this}getClusterChildren(i,s){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id},s),this}getClusterLeaves(i,s,u,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:i,limit:s,offset:u},d),this}_updateWorkerData(i){const s=f.e({},this.workerOptions);i?s.dataDiff=i:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(f.h.resolveURL(this._data),Ge.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new f.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,s,((u,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new f.k("dataabort",{dataType:"source"}));let m=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(m=d.resourceTiming[this.id].slice(0)),u)return void this.fire(new f.j(u));const x={dataType:"source"};this._collectResourceTiming&&m&&m.length>0&&f.e(x,{resourceTiming:m}),this.fire(new f.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new f.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))}))}loaded(){return this._pendingLoads===0}loadTile(i,s){const u=i.actor?"reloadTile":"loadTile";i.actor=this.actor;const d={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.request=this.actor.send(u,d,((m,x)=>(delete i.request,i.unloadVectorData(),i.aborted?s(null):m?s(m):(i.loadVectorData(x,this.map.painter,u==="reloadTile"),s(null)))))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0}unloadTile(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var ii=f.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Wi extends f.E{constructor(i,s,u,d){super(),this.load=(m,x)=>{this._loaded=!1,this.fire(new f.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=nt.getImage(this.map._requestManager.transformRequest(this.url,Ge.Image),((w,T)=>{this._request=null,this._loaded=!0,w?this.fire(new f.j(w)):T&&(this.image=T,m&&(this.coordinates=m),x&&x(),this._finishLoading())}))},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const m=this.map.painter.context,x=m.gl;this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=f.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new qt(m,this.image,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const A=this.tiles[T];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,w=!0)}w&&this.fire(new f.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=i,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=s}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=i.url,this.load(i.coordinates,(()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new f.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(i){this.coordinates=i;const s=i.map(f.U.fromLngLat);this.tileID=(function(d){let m=1/0,x=1/0,w=-1/0,T=-1/0;for(const B of d)m=Math.min(m,B.x),x=Math.min(x,B.y),w=Math.max(w,B.x),T=Math.max(T,B.y);const A=Math.max(w-m,T-x),M=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),C=Math.pow(2,M);return new f.W(M,Math.floor((m+w)/2*C),Math.floor((x+T)/2*C))})(s),this.minzoom=this.maxzoom=this.tileID.z;const u=s.map((d=>this.tileID.getTilePoint(d)._round()));return this._boundsArray=new f.V,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,f.N,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,f.N),this._boundsArray.emplaceBack(u[2].x,u[2].y,f.N,f.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new f.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(i,s){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},s(null)):(i.state="errored",s(null))}hasTransition(){return!1}}class pn extends Wi{constructor(i,s,u,d){super(i,s,u,d),this.load=()=>{this._loaded=!1;const m=this.options;this.urls=[];for(const x of m.urls)this.urls.push(this.map._requestManager.transformRequest(x,Ge.Source).url);f.X(this.urls,((x,w)=>{this._loaded=!0,x?this.fire(new f.j(x)):w&&(this.video=w,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,x=m.gl;this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=f.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE),x.texSubImage2D(x.TEXTURE_2D,0,0,0,x.RGBA,x.UNSIGNED_BYTE,this.video)):(this.texture=new qt(m,this.video,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const A=this.tiles[T];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,w=!0)}w&&this.fire(new f.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=s}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const s=this.video.seekable;i<s.start(0)||i>s.end(0)?this.fire(new f.j(new f.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Tr extends Wi{constructor(i,s,u,d){super(i,s,u,d),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new f.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const x=this.map.painter.context,w=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=f.S.simpleSegment(0,0,4,2)),this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new qt(x,this.canvas,w.RGBA,{premultiply:!0});let T=!1;for(const A in this.tiles){const M=this.tiles[A];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,T=!0)}T&&this.fire(new f.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some((m=>!Array.isArray(m)||m.length!==2||m.some((x=>typeof x!="number"))))||this.fire(new f.j(new f.Y(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new f.j(new f.Y(`sources.${i}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new f.j(new f.Y(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new f.j(new f.Y(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new f.j(new f.Y(`sources.${i}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const wo={},mn=p=>{switch(p){case"geojson":return Oi;case"image":return Wi;case"raster":return Rt;case"raster-dem":return Pt;case"vector":return kt;case"video":return pn;case"canvas":return Tr}return wo[p]};function ps(p,i){const s=f.Z();return f.$(s,s,[1,1,0]),f.a0(s,s,[.5*p.width,.5*p.height,1]),f.a1(s,s,p.calculatePosMatrix(i.toUnwrapped()))}function jr(p,i,s,u,d,m){const x=(function(C,B,q){if(C)for(const V of C){const $=B[V];if($&&$.source===q&&$.type==="fill-extrusion")return!0}else for(const V in B){const $=B[V];if($.source===q&&$.type==="fill-extrusion")return!0}return!1})(d&&d.layers,i,p.id),w=m.maxPitchScaleFactor(),T=p.tilesIn(u,w,x);T.sort(ms);const A=[];for(const C of T)A.push({wrappedTileID:C.tileID.wrapped().key,queryResults:C.tile.queryRenderedFeatures(i,s,p._state,C.queryGeometry,C.cameraQueryGeometry,C.scale,d,m,w,ps(p.transform,C.tileID))});const M=(function(C){const B={},q={};for(const V of C){const $=V.queryResults,j=V.wrappedTileID,re=q[j]=q[j]||{};for(const ge in $){const K=$[ge],oe=re[ge]=re[ge]||{},_e=B[ge]=B[ge]||[];for(const xe of K)oe[xe.featureIndex]||(oe[xe.featureIndex]=!0,_e.push(xe))}}return B})(A);for(const C in M)M[C].forEach((B=>{const q=B.feature,V=p.getFeatureState(q.layer["source-layer"],q.id);q.source=q.layer.source,q.layer["source-layer"]&&(q.sourceLayer=q.layer["source-layer"]),q.state=V}));return M}function ms(p,i){const s=p.tileID,u=i.tileID;return s.overscaledZ-u.overscaledZ||s.canonical.y-u.canonical.y||s.wrap-u.wrap||s.canonical.x-u.canonical.x}class Vr{constructor(i,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=f.a2(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const s=i+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,s,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=(function(d,m){const x={};if(!m)return x;for(const w of d){const T=w.layerIds.map((A=>m.getLayer(A))).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map((A=>T.filter((M=>M.id===A))[0])));for(const A of T)x[A.id]=w}}return x})(i.buckets,s.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof f.a4){if(this.hasSymbolBuckets=!0,!u)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof f.a4&&m.hasRTLText){this.hasRTLText=!0,f.a5();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(d).queryRadius(m))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new f.a3}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const u in this.buckets){const d=this.buckets[u];d.uploadPending()&&d.upload(i)}const s=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new qt(i,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new qt(i,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,s,u,d,m,x,w,T,A,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:m,scale:x,tileSize:this.tileSize,pixelPosMatrix:M,transform:T,params:w,queryPadding:this.queryPadding*A},i,s,u):{}}querySourceFeatures(i,s){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const d=u.loadVTLayers(),m=s&&s.sourceLayer?s.sourceLayer:"",x=d._geojsonTileLayer||d[m];if(!x)return;const w=f.a6(s&&s.filter),{z:T,x:A,y:M}=this.tileID.canonical,C={z:T,x:A,y:M};for(let B=0;B<x.length;B++){const q=x.feature(B);if(w.needGeometry){const j=f.a7(q,!0);if(!w.filter(new f.a8(this.tileID.overscaledZ),j,this.tileID.canonical))continue}else if(!w.filter(new f.a8(this.tileID.overscaledZ),q))continue;const V=u.getId(q,m),$=new f.a9(q,T,A,M,V);$.tile=C,i.push($)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const s=this.expirationTime;if(i.cacheControl){const u=f.aa(i.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const u=Date.now();let d=!1;if(this.expirationTime>u)d=!1;else if(s)if(this.expirationTime<s)d=!0;else{const m=this.expirationTime-s;m?this.expirationTime=u+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!s.style.hasLayer(d))continue;const m=this.buckets[d],x=m.layers[0].sourceLayer||"_geojsonTileLayer",w=u[x],T=i[x];if(!w||!T||Object.keys(T).length===0)continue;m.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const A=s&&s.style&&s.style.getLayer(d);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<f.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=f.h.now()+i}setDependencies(i,s){const u={};for(const d of s)u[d]=!0;this.dependencies[i]=u}hasDependency(i,s){for(const u of i){const d=this.dependencies[u];if(d){for(const m of s)if(d[m])return!0}}return!1}}class qr{constructor(i,s){this.max=i,this.onRemove=s,this.reset()}reset(){for(const i in this.data)for(const s of this.data[i])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(i,s,u){const d=i.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const m={value:s,timeout:void 0};if(u!==void 0&&(m.timeout=setTimeout((()=>{this.remove(i,m)}),u)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const s=this.data[i].shift();return s.timeout&&clearTimeout(s.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),s.value}getByKey(i){const s=this.data[i];return s?s[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,s){if(!this.has(i))return this;const u=i.wrapped().key,d=s===void 0?0:this.data[u].indexOf(s),m=this.data[u][d];return this.data[u].splice(d,1),m.timeout&&clearTimeout(m.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(m.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(i){const s=[];for(const u in this.data)for(const d of this.data[u])i(d.value)||s.push(d);for(const u of s)this.remove(u.value.tileID,u)}}class Ee{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,s,u){const d=String(s);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][d]=this.stateChanges[i][d]||{},f.e(this.stateChanges[i][d],u),this.deletedStates[i]===null){this.deletedStates[i]={};for(const m in this.state[i])m!==d&&(this.deletedStates[i][m]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][d]===null){this.deletedStates[i][d]={};for(const m in this.state[i][d])u[m]||(this.deletedStates[i][d][m]=null)}else for(const m in u)this.deletedStates[i]&&this.deletedStates[i][d]&&this.deletedStates[i][d][m]===null&&delete this.deletedStates[i][d][m]}removeFeatureState(i,s,u){if(this.deletedStates[i]===null)return;const d=String(s);if(this.deletedStates[i]=this.deletedStates[i]||{},u&&s!==void 0)this.deletedStates[i][d]!==null&&(this.deletedStates[i][d]=this.deletedStates[i][d]||{},this.deletedStates[i][d][u]=null);else if(s!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][d])for(u in this.deletedStates[i][d]={},this.stateChanges[i][d])this.deletedStates[i][d][u]=null;else this.deletedStates[i][d]=null;else this.deletedStates[i]=null}getState(i,s){const u=String(s),d=f.e({},(this.state[i]||{})[u],(this.stateChanges[i]||{})[u]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const m=this.deletedStates[i][s];if(m===null)return{};for(const x in m)delete d[x]}return d}initializeTileState(i,s){i.setFeatureState(this.state,s)}coalesceChanges(i,s){const u={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const x in this.stateChanges[d])this.state[d][x]||(this.state[d][x]={}),f.e(this.state[d][x],this.stateChanges[d][x]),m[x]=this.state[d][x];u[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(this.deletedStates[d]===null)for(const x in this.state[d])m[x]={},this.state[d][x]={};else for(const x in this.deletedStates[d]){if(this.deletedStates[d][x]===null)this.state[d][x]={};else for(const w of Object.keys(this.deletedStates[d][x]))delete this.state[d][x][w];m[x]=this.state[d][x]}u[d]=u[d]||{},f.e(u[d],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const d in i)i[d].setFeatureState(u,s)}}class an extends f.E{constructor(i,s,u){super(),this.id=i,this.dispatcher=u,this.on("data",(d=>{d.dataType==="source"&&d.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)})),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((d,m,x,w)=>{const T=new(mn(m.type))(d,m,x,w);if(T.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${T.id}`);return T})(i,s,u,this),this._tiles={},this._cache=new qr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ee,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const s=this._tiles[i];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,s){return this._source.loadTile(i,s)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,(()=>{}))}_abortTile(i){this._source.abortTile&&this._source.abortTile(i,(()=>{})),this._source.fire(new f.k("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const u=this._tiles[s];u.upload(i),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((i=>i.tileID)).sort(Kn).map((i=>i.key))}getRenderableIds(i){const s=[];for(const u in this._tiles)this._isIdRenderable(u,i)&&s.push(this._tiles[u]);return i?s.sort(((u,d)=>{const m=u.tileID,x=d.tileID,w=new f.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),T=new f.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-x.overscaledZ||T.y-w.y||T.x-w.x})).map((u=>u.tileID.key)):s.map((u=>u.tileID)).sort(Kn).map((u=>u.key))}hasRenderableParent(i){const s=this.findLoadedParent(i,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(i,s){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(s||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,s){const u=this._tiles[i];u&&(u.state!=="loading"&&(u.state=s),this._loadTile(u,this._tileLoaded.bind(this,u,i,s)))}_tileLoaded(i,s,u,d){if(d)return i.state="errored",void(d.status!==404?this._source.fire(new f.j(d,{tile:i})):this.update(this.transform,this.terrain));i.timeAdded=f.h.now(),u==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(s,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new f.k("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const s=this.getRenderableIds();for(let d=0;d<s.length;d++){const m=s[d];if(i.neighboringTiles&&i.neighboringTiles[m]){const x=this.getTileByID(m);u(i,x),u(x,i)}}function u(d,m){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let x=m.tileID.canonical.x-d.tileID.canonical.x;const w=m.tileID.canonical.y-d.tileID.canonical.y,T=Math.pow(2,d.tileID.canonical.z),A=m.tileID.key;x===0&&w===0||Math.abs(w)>1||(Math.abs(x)>1&&(Math.abs(x+T)===1?x+=T:Math.abs(x-T)===1&&(x-=T)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,x,w),d.neighboringTiles&&d.neighboringTiles[A]&&(d.neighboringTiles[A].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,s,u,d){for(const m in this._tiles){let x=this._tiles[m];if(d[m]||!x.hasData()||x.tileID.overscaledZ<=s||x.tileID.overscaledZ>u)continue;let w=x.tileID;for(;x&&x.tileID.overscaledZ>s+1;){const A=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[A.key],x&&x.hasData()&&(w=A)}let T=w;for(;T.overscaledZ>s;)if(T=T.scaledTo(T.overscaledZ-1),i[T.key]){d[w.key]=w;break}}}findLoadedParent(i,s){if(i.key in this._loadedParentTiles){const u=this._loadedParentTiles[i.key];return u&&u.tileID.overscaledZ>=s?u:null}for(let u=i.overscaledZ-1;u>=s;u--){const d=i.scaledTo(u),m=this._getLoadedTile(d);if(m)return m}}_getLoadedTile(i){const s=this._tiles[i.key];return s&&s.hasData()?s:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const s=Math.ceil(i.width/this._source.tileSize)+1,u=Math.ceil(i.height/this._source.tileSize)+1,d=Math.floor(s*u*(this._maxTileCacheZoomLevels===null?f.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(m)}handleWrapJump(i){const s=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,s){const u={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+s),u[m.tileID.key]=m}this._tiles=u;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}update(i,s){if(this.transform=i,this.terrain=s,!this._sourceLoaded||this._paused)return;let u;this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=i.getVisibleUnwrappedCoordinates(this._source.tileID).map((M=>new f.O(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y))):(u=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(u=u.filter((M=>this._source.hasTile(M))))):u=[];const d=i.coveringZoomLevel(this._source),m=Math.max(d-an.maxOverzooming,this._source.minzoom),x=Math.max(d+an.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const C of u)if(C.canonical.z>this._source.minzoom){const B=C.scaledTo(C.canonical.z-1);M[B.key]=B;const q=C.scaledTo(Math.max(this._source.minzoom,Math.min(C.canonical.z,5)));M[q.key]=q}u=u.concat(Object.values(M))}const w=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new f.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(u,d);if(Pi(this._source.type)){const M={},C={},B=Object.keys(T),q=f.h.now();for(const V of B){const $=T[V],j=this._tiles[V];if(!j||j.fadeEndTime!==0&&j.fadeEndTime<=q)continue;const re=this.findLoadedParent($,m);re&&(this._addTile(re.tileID),M[re.tileID.key]=re.tileID),C[V]=$}this._retainLoadedChildren(C,d,x,T);for(const V in M)T[V]||(this._coveredTiles[V]=!0,T[V]=M[V]);if(s){const V={},$={};for(const j of u)this._tiles[j.key].hasData()?V[j.key]=j:$[j.key]=j;for(const j in $){const re=$[j].children(this._source.maxzoom);this._tiles[re[0].key]&&this._tiles[re[1].key]&&this._tiles[re[2].key]&&this._tiles[re[3].key]&&(V[re[0].key]=T[re[0].key]=re[0],V[re[1].key]=T[re[1].key]=re[1],V[re[2].key]=T[re[2].key]=re[2],V[re[3].key]=T[re[3].key]=re[3],delete $[j])}for(const j in $){const re=this.findLoadedParent($[j],this._source.minzoom);if(re){V[re.tileID.key]=T[re.tileID.key]=re.tileID;for(const ge in V)V[ge].isChildOf(re.tileID)&&delete V[ge]}}for(const j in this._tiles)V[j]||(this._coveredTiles[j]=!0)}}for(const M in T)this._tiles[M].clearFadeHold();const A=f.ab(this._tiles,T);for(const M of A){const C=this._tiles[M];C.hasSymbolBuckets&&!C.holdingForFade()?C.setHoldDuration(this.map._fadeDuration):C.hasSymbolBuckets&&!C.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,s){const u={},d={},m=Math.max(s-an.maxOverzooming,this._source.minzoom),x=Math.max(s+an.maxUnderzooming,this._source.minzoom),w={};for(const T of i){const A=this._addTile(T);u[T.key]=T,A.hasData()||s<this._source.maxzoom&&(w[T.key]=T)}this._retainLoadedChildren(w,s,x,u);for(const T of i){let A=this._tiles[T.key];if(A.hasData())continue;if(s+1>this._source.maxzoom){const C=T.children(this._source.maxzoom)[0],B=this.getTile(C);if(B&&B.hasData()){u[C.key]=C;continue}}else{const C=T.children(this._source.maxzoom);if(u[C[0].key]&&u[C[1].key]&&u[C[2].key]&&u[C[3].key])continue}let M=A.wasRequested();for(let C=T.overscaledZ-1;C>=m;--C){const B=T.scaledTo(C);if(d[B.key])break;if(d[B.key]=!0,A=this.getTile(B),!A&&M&&(A=this._addTile(B)),A){const q=A.hasData();if((M||q)&&(u[B.key]=B),M=A.wasRequested(),q)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const s=[];let u,d=this._tiles[i].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){u=this._loadedParentTiles[d.key];break}s.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(u=this._getLoadedTile(m),u)break;d=m}for(const m of s)this._loadedParentTiles[m]=u}}_addTile(i){let s=this._tiles[i.key];if(s)return s;s=this._cache.getAndRemove(i),s&&(this._setTileReloadTimer(i.key,s),s.tileID=i,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,s)));const u=s;return s||(s=new Vr(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,i.key,s.state))),s.uses++,this._tiles[i.key]=s,u||this._source.fire(new f.k("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(i,s){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const u=s.getExpiryTimeout();u&&(this._timers[i]=setTimeout((()=>{this._reloadTile(i,"expired"),delete this._timers[i]}),u))}_removeTile(i){const s=this._tiles[i];s&&(s.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,s,u){const d=[],m=this.transform;if(!m)return d;const x=u?m.getCameraQueryGeometry(i):i,w=i.map((V=>m.pointCoordinate(V,this.terrain))),T=x.map((V=>m.pointCoordinate(V,this.terrain))),A=this.getIds();let M=1/0,C=1/0,B=-1/0,q=-1/0;for(const V of T)M=Math.min(M,V.x),C=Math.min(C,V.y),B=Math.max(B,V.x),q=Math.max(q,V.y);for(let V=0;V<A.length;V++){const $=this._tiles[A[V]];if($.holdingForFade())continue;const j=$.tileID,re=Math.pow(2,m.zoom-$.tileID.overscaledZ),ge=s*$.queryPadding*f.N/$.tileSize/re,K=[j.getTilePoint(new f.U(M,C)),j.getTilePoint(new f.U(B,q))];if(K[0].x-ge<f.N&&K[0].y-ge<f.N&&K[1].x+ge>=0&&K[1].y+ge>=0){const oe=w.map((xe=>j.getTilePoint(xe))),_e=T.map((xe=>j.getTilePoint(xe)));d.push({tile:$,tileID:j,queryGeometry:oe,cameraQueryGeometry:_e,scale:re})}}return d}getVisibleCoordinates(i){const s=this.getRenderableIds(i).map((u=>this._tiles[u].tileID));for(const u of s)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(Pi(this._source.type)){const i=f.h.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=i)return!0}return!1}setFeatureState(i,s,u){this._state.updateState(i=i||"_geojsonTileLayer",s,u)}removeFeatureState(i,s,u){this._state.removeFeatureState(i=i||"_geojsonTileLayer",s,u)}getFeatureState(i,s){return this._state.getState(i=i||"_geojsonTileLayer",s)}setDependencies(i,s,u){const d=this._tiles[i];d&&d.setDependencies(s,u)}reloadTilesForDependencies(i,s){for(const u in this._tiles)this._tiles[u].hasDependency(i,s)&&this._reloadTile(u,"reloading");this._cache.filter((u=>!u.hasDependency(i,s)))}}function Kn(p,i){const s=Math.abs(2*p.wrap)-+(p.wrap<0),u=Math.abs(2*i.wrap)-+(i.wrap<0);return p.overscaledZ-i.overscaledZ||u-s||i.canonical.y-p.canonical.y||i.canonical.x-p.canonical.x}function Pi(p){return p==="raster"||p==="image"||p==="video"}an.maxOverzooming=10,an.maxUnderzooming=3;const $t="mapboxgl_preloaded_worker_pool";class Er{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Er.workerCount;)this.workers.push(new Worker(f.c.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach((s=>{s.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[$t]}numActive(){return Object.keys(this.active).length}}const js=Math.floor(f.h.hardwareConcurrency/2);let Ar;function Vs(){return Ar||(Ar=new Er),Ar}Er.workerCount=f.ac(globalThis)?Math.max(Math.min(js,3),1):1;class So{constructor(i,s){this.reset(i,s)}reset(i,s){this.points=i||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=f.ad(i,0,1);let s=1,u=this._distances[s];const d=i*this.paddedLength+this.padding;for(;u<d&&s<this._distances.length;)u=this._distances[++s];const m=s-1,x=this._distances[m],w=u-x,T=w>0?(d-x)/w:0;return this.points[m].mult(1-T).add(this.points[s].mult(T))}}function Gr(p,i){let s=!0;return p==="always"||p!=="never"&&i!=="never"||(s=!1),s}class qs{constructor(i,s,u){const d=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(i/u),this.yCellCount=Math.ceil(s/u);for(let x=0;x<this.xCellCount*this.yCellCount;x++)d.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=s,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,s,u,d,m){this._forEachCell(s,u,d,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(d),this.bboxes.push(m)}insertCircle(i,s,u,d){this._forEachCell(s-d,u-d,s+d,u+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(s),this.circles.push(u),this.circles.push(d)}_insertBoxCell(i,s,u,d,m,x){this.boxCells[m].push(x)}_insertCircleCell(i,s,u,d,m,x){this.circleCells[m].push(x)}_query(i,s,u,d,m,x,w){if(u<0||i>this.width||d<0||s>this.height)return[];const T=[];if(i<=0&&s<=0&&this.width<=u&&this.height<=d){if(m)return[{key:null,x1:i,y1:s,x2:u,y2:d}];for(let A=0;A<this.boxKeys.length;A++)T.push({key:this.boxKeys[A],x1:this.bboxes[4*A],y1:this.bboxes[4*A+1],x2:this.bboxes[4*A+2],y2:this.bboxes[4*A+3]});for(let A=0;A<this.circleKeys.length;A++){const M=this.circles[3*A],C=this.circles[3*A+1],B=this.circles[3*A+2];T.push({key:this.circleKeys[A],x1:M-B,y1:C-B,x2:M+B,y2:C+B})}}else this._forEachCell(i,s,u,d,this._queryCell,T,{hitTest:m,overlapMode:x,seenUids:{box:{},circle:{}}},w);return T}query(i,s,u,d){return this._query(i,s,u,d,!1,null)}hitTest(i,s,u,d,m,x){return this._query(i,s,u,d,!0,m,x).length>0}hitTestCircle(i,s,u,d,m){const x=i-u,w=i+u,T=s-u,A=s+u;if(w<0||x>this.width||A<0||T>this.height)return!1;const M=[];return this._forEachCell(x,T,w,A,this._queryCellCircle,M,{hitTest:!0,overlapMode:d,circle:{x:i,y:s,radius:u},seenUids:{box:{},circle:{}}},m),M.length>0}_queryCell(i,s,u,d,m,x,w,T){const{seenUids:A,hitTest:M,overlapMode:C}=w,B=this.boxCells[m];if(B!==null){const V=this.bboxes;for(const $ of B)if(!A.box[$]){A.box[$]=!0;const j=4*$,re=this.boxKeys[$];if(i<=V[j+2]&&s<=V[j+3]&&u>=V[j+0]&&d>=V[j+1]&&(!T||T(re))&&(!M||!Gr(C,re.overlapMode))&&(x.push({key:re,x1:V[j],y1:V[j+1],x2:V[j+2],y2:V[j+3]}),M))return!0}}const q=this.circleCells[m];if(q!==null){const V=this.circles;for(const $ of q)if(!A.circle[$]){A.circle[$]=!0;const j=3*$,re=this.circleKeys[$];if(this._circleAndRectCollide(V[j],V[j+1],V[j+2],i,s,u,d)&&(!T||T(re))&&(!M||!Gr(C,re.overlapMode))){const ge=V[j],K=V[j+1],oe=V[j+2];if(x.push({key:re,x1:ge-oe,y1:K-oe,x2:ge+oe,y2:K+oe}),M)return!0}}}return!1}_queryCellCircle(i,s,u,d,m,x,w,T){const{circle:A,seenUids:M,overlapMode:C}=w,B=this.boxCells[m];if(B!==null){const V=this.bboxes;for(const $ of B)if(!M.box[$]){M.box[$]=!0;const j=4*$,re=this.boxKeys[$];if(this._circleAndRectCollide(A.x,A.y,A.radius,V[j+0],V[j+1],V[j+2],V[j+3])&&(!T||T(re))&&!Gr(C,re.overlapMode))return x.push(!0),!0}}const q=this.circleCells[m];if(q!==null){const V=this.circles;for(const $ of q)if(!M.circle[$]){M.circle[$]=!0;const j=3*$,re=this.circleKeys[$];if(this._circlesCollide(V[j],V[j+1],V[j+2],A.x,A.y,A.radius)&&(!T||T(re))&&!Gr(C,re.overlapMode))return x.push(!0),!0}}}_forEachCell(i,s,u,d,m,x,w,T){const A=this._convertToXCellCoord(i),M=this._convertToYCellCoord(s),C=this._convertToXCellCoord(u),B=this._convertToYCellCoord(d);for(let q=A;q<=C;q++)for(let V=M;V<=B;V++)if(m.call(this,i,s,u,d,this.xCellCount*V+q,x,w,T))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,s,u,d,m,x){const w=d-i,T=m-s,A=u+x;return A*A>w*w+T*T}_circleAndRectCollide(i,s,u,d,m,x,w){const T=(x-d)/2,A=Math.abs(i-(d+T));if(A>T+u)return!1;const M=(w-m)/2,C=Math.abs(s-(m+M));if(C>M+u)return!1;if(A<=T||C<=M)return!0;const B=A-T,q=C-M;return B*B+q*q<=u*u}}function et(p,i,s,u,d){const m=f.Z();return i?(f.a0(m,m,[1/d,1/d,1]),s||f.ae(m,m,u.angle)):f.a1(m,u.labelPlaneMatrix,p),m}function En(p,i,s,u,d){if(i){const m=f.af(p);return f.a0(m,m,[d,d,1]),s||f.ae(m,m,-u.angle),m}return u.glCoordMatrix}function di(p,i,s){let u;s?(u=[p.x,p.y,s(p.x,p.y),1],f.ag(u,u,i)):(u=[p.x,p.y,0,1],H(u,u,i));const d=u[3];return{point:new f.P(u[0]/d,u[1]/d),signedDistanceFromCamera:d}}function An(p,i){return .5+p/i*.5}function xa(p,i){const s=p[0]/p[3],u=p[1]/p[3];return s>=-i[0]&&s<=i[0]&&u>=-i[1]&&u<=i[1]}function tt(p,i,s,u,d,m,x,w,T,A){const M=u?p.textSizeData:p.iconSizeData,C=f.ah(M,s.transform.zoom),B=[256/s.width*2+1,256/s.height*2+1],q=u?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;q.clear();const V=p.lineVertexArray,$=u?p.text.placedSymbolArray:p.icon.placedSymbolArray,j=s.transform.width/s.transform.height;let re=!1;for(let ge=0;ge<$.length;ge++){const K=$.get(ge);if(K.hidden||K.writingMode===f.ai.vertical&&!re){F(K.numGlyphs,q);continue}let oe;if(re=!1,A?(oe=[K.anchorX,K.anchorY,A(K.anchorX,K.anchorY),1],f.ag(oe,oe,i)):(oe=[K.anchorX,K.anchorY,0,1],H(oe,oe,i)),!xa(oe,B)){F(K.numGlyphs,q);continue}const _e=An(s.transform.cameraToCenterDistance,oe[3]),xe=f.aj(M,C,K),ze=x?xe/_e:xe*_e,je=new f.P(K.anchorX,K.anchorY),Re=di(je,d,A).point,He={projections:{},offsets:{}},yt=Fa(K,ze,!1,w,i,d,m,p.glyphOffsetArray,V,q,Re,je,He,j,T,A);re=yt.useVertical,(yt.notEnoughRoom||re||yt.needsFlipping&&Fa(K,ze,!0,w,i,d,m,p.glyphOffsetArray,V,q,Re,je,He,j,T,A).notEnoughRoom)&&F(K.numGlyphs,q)}u?p.text.dynamicLayoutVertexBuffer.updateData(q):p.icon.dynamicLayoutVertexBuffer.updateData(q)}function Xt(p,i,s,u,d,m,x,w,T,A,M,C,B){const q=w.glyphStartIndex+w.numGlyphs,V=w.lineStartIndex,$=w.lineStartIndex+w.lineLength,j=i.getoffsetX(w.glyphStartIndex),re=i.getoffsetX(q-1),ge=k(p*j,s,u,d,m,x,w.segment,V,$,T,A,M,C,B);if(!ge)return null;const K=k(p*re,s,u,d,m,x,w.segment,V,$,T,A,M,C,B);return K?{first:ge,last:K}:null}function Ft(p,i,s,u){return p===f.ai.horizontal&&Math.abs(s.y-i.y)>Math.abs(s.x-i.x)*u?{useVertical:!0}:(p===f.ai.vertical?i.y<s.y:i.x>s.x)?{needsFlipping:!0}:null}function Fa(p,i,s,u,d,m,x,w,T,A,M,C,B,q,V,$){const j=i/24,re=p.lineOffsetX*j,ge=p.lineOffsetY*j;let K;if(p.numGlyphs>1){const oe=p.glyphStartIndex+p.numGlyphs,_e=p.lineStartIndex,xe=p.lineStartIndex+p.lineLength,ze=Xt(j,w,re,ge,s,M,C,p,T,m,B,V,$);if(!ze)return{notEnoughRoom:!0};const je=di(ze.first.point,x,$).point,Re=di(ze.last.point,x,$).point;if(u&&!s){const He=Ft(p.writingMode,je,Re,q);if(He)return He}K=[ze.first];for(let He=p.glyphStartIndex+1;He<oe-1;He++)K.push(k(j*w.getoffsetX(He),re,ge,s,M,C,p.segment,_e,xe,T,m,B,V,$));K.push(ze.last)}else{if(u&&!s){const _e=di(C,d,$).point,xe=p.lineStartIndex+p.segment+1,ze=new f.P(T.getx(xe),T.gety(xe)),je=di(ze,d,$),Re=je.signedDistanceFromCamera>0?je.point:Nn(C,ze,_e,1,d,$),He=Ft(p.writingMode,_e,Re,q);if(He)return He}const oe=k(j*w.getoffsetX(p.glyphStartIndex),re,ge,s,M,C,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,T,m,B,V,$);if(!oe)return{notEnoughRoom:!0};K=[oe]}for(const oe of K)f.ak(A,oe.point,oe.angle);return{}}function Nn(p,i,s,u,d,m){const x=di(p.add(p.sub(i)._unit()),d,m).point,w=s.sub(x);return s.add(w._mult(u/w.mag()))}function Ut(p,i){const{projectionCache:s,lineVertexArray:u,labelPlaneMatrix:d,tileAnchorPoint:m,distanceFromAnchor:x,getElevation:w,previousVertex:T,direction:A,absOffsetX:M}=i;if(s.projections[p])return s.projections[p];const C=new f.P(u.getx(p),u.gety(p)),B=di(C,d,w);if(B.signedDistanceFromCamera>0)return s.projections[p]=B.point,B.point;const q=p-A;return Nn(x===0?m:new f.P(u.getx(q),u.gety(q)),C,T,M-x+1,d,w)}function gn(p,i,s){return p._unit()._perp()._mult(i*s)}function Z(p,i,s,u,d,m,x,w){const{projectionCache:T,direction:A}=w;if(T.offsets[p])return T.offsets[p];const M=s.add(i);if(p+A<u||p+A>=d)return T.offsets[p]=M,M;const C=Ut(p+A,w),B=gn(C.sub(s),x,A),q=s.add(B),V=C.add(B);return T.offsets[p]=f.al(m,M,q,V)||M,T.offsets[p]}function k(p,i,s,u,d,m,x,w,T,A,M,C,B,q){const V=u?p-i:p+i;let $=V>0?1:-1,j=0;u&&($*=-1,j=Math.PI),$<0&&(j+=Math.PI);let re,ge,K=$>0?w+x:w+x+1,oe=d,_e=d,xe=0,ze=0;const je=Math.abs(V),Re=[];let He;for(;xe+ze<=je;){if(K+=$,K<w||K>=T)return null;xe+=ze,_e=oe,ge=re;const Je={projectionCache:C,lineVertexArray:A,labelPlaneMatrix:M,tileAnchorPoint:m,distanceFromAnchor:xe,getElevation:q,previousVertex:_e,direction:$,absOffsetX:je};if(oe=Ut(K,Je),s===0)Re.push(_e),He=oe.sub(_e);else{let Tt;const _t=oe.sub(_e);Tt=_t.mag()===0?gn(Ut(K+$,Je).sub(oe),s,$):gn(_t,s,$),ge||(ge=_e.add(Tt)),re=Z(K,Tt,oe,w,T,ge,s,Je),Re.push(ge),He=re.sub(ge)}ze=He.mag()}const yt=He._mult((je-xe)/ze)._add(ge||_e),Wt=j+Math.atan2(oe.y-_e.y,oe.x-_e.x);return Re.push(yt),{point:yt,angle:B?Wt:0,path:Re}}const R=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function F(p,i){for(let s=0;s<p;s++){const u=i.length;i.resize(u+4),i.float32.set(R,3*u)}}function H(p,i,s){const u=i[0],d=i[1];return p[0]=s[0]*u+s[4]*d+s[12],p[1]=s[1]*u+s[5]*d+s[13],p[3]=s[3]*u+s[7]*d+s[15],p}const Y=100;class de{constructor(i,s=new qs(i.width+200,i.height+200,25),u=new qs(i.width+200,i.height+200,25)){this.transform=i,this.grid=s,this.ignoredGrid=u,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+Y,this.screenBottomBoundary=i.height+Y,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,s,u,d,m,x){const w=this.projectAndGetPerspectiveRatio(d,i.anchorPointX,i.anchorPointY,x),T=u*w.perspectiveRatio,A=i.x1*T+w.point.x,M=i.y1*T+w.point.y,C=i.x2*T+w.point.x,B=i.y2*T+w.point.y;return!this.isInsideGrid(A,M,C,B)||s!=="always"&&this.grid.hitTest(A,M,C,B,s,m)||w.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[A,M,C,B],offscreen:this.isOffscreen(A,M,C,B)}}placeCollisionCircles(i,s,u,d,m,x,w,T,A,M,C,B,q,V){const $=[],j=new f.P(s.anchorX,s.anchorY),re=di(j,x,V),ge=An(this.transform.cameraToCenterDistance,re.signedDistanceFromCamera),K=(M?m/ge:m*ge)/f.ap,oe=di(j,w,V).point,_e=Xt(K,d,s.lineOffsetX*K,s.lineOffsetY*K,!1,oe,j,s,u,w,{projections:{},offsets:{}},!1,V);let xe=!1,ze=!1,je=!0;if(_e){const Re=.5*B*ge+q,He=new f.P(-100,-100),yt=new f.P(this.screenRightBoundary,this.screenBottomBoundary),Wt=new So,Je=_e.first,Tt=_e.last;let _t=[];for(let jt=Je.path.length-1;jt>=1;jt--)_t.push(Je.path[jt]);for(let jt=1;jt<Tt.path.length;jt++)_t.push(Tt.path[jt]);const Ai=2.5*Re;if(T){const jt=_t.map((Qt=>di(Qt,T,V)));_t=jt.some((Qt=>Qt.signedDistanceFromCamera<=0))?[]:jt.map((Qt=>Qt.point))}let Ht=[];if(_t.length>0){const jt=_t[0].clone(),Qt=_t[0].clone();for(let $i=1;$i<_t.length;$i++)jt.x=Math.min(jt.x,_t[$i].x),jt.y=Math.min(jt.y,_t[$i].y),Qt.x=Math.max(Qt.x,_t[$i].x),Qt.y=Math.max(Qt.y,_t[$i].y);Ht=jt.x>=He.x&&Qt.x<=yt.x&&jt.y>=He.y&&Qt.y<=yt.y?[_t]:Qt.x<He.x||jt.x>yt.x||Qt.y<He.y||jt.y>yt.y?[]:f.am([_t],He.x,He.y,yt.x,yt.y)}for(const jt of Ht){Wt.reset(jt,.25*Re);let Qt=0;Qt=Wt.length<=.5*Re?1:Math.ceil(Wt.paddedLength/Ai)+1;for(let $i=0;$i<Qt;$i++){const Mi=$i/Math.max(Qt-1,1),Ua=Wt.lerp(Mi),Ji=Ua.x+Y,ya=Ua.y+Y;$.push(Ji,ya,Re,0);const Da=Ji-Re,Fi=ya-Re,ir=Ji+Re,Qa=ya+Re;if(je=je&&this.isOffscreen(Da,Fi,ir,Qa),ze=ze||this.isInsideGrid(Da,Fi,ir,Qa),i!=="always"&&this.grid.hitTestCircle(Ji,ya,Re,i,C)&&(xe=!0,!A))return{circles:[],offscreen:!1,collisionDetected:xe}}}}return{circles:!A&&xe||!ze||ge<this.perspectiveRatioCutoff?[]:$,offscreen:je,collisionDetected:xe}}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let u=1/0,d=1/0,m=-1/0,x=-1/0;for(const M of i){const C=new f.P(M.x+Y,M.y+Y);u=Math.min(u,C.x),d=Math.min(d,C.y),m=Math.max(m,C.x),x=Math.max(x,C.y),s.push(C)}const w=this.grid.query(u,d,m,x).concat(this.ignoredGrid.query(u,d,m,x)),T={},A={};for(const M of w){const C=M.key;if(T[C.bucketInstanceId]===void 0&&(T[C.bucketInstanceId]={}),T[C.bucketInstanceId][C.featureIndex])continue;const B=[new f.P(M.x1,M.y1),new f.P(M.x2,M.y1),new f.P(M.x2,M.y2),new f.P(M.x1,M.y2)];f.an(s,B)&&(T[C.bucketInstanceId][C.featureIndex]=!0,A[C.bucketInstanceId]===void 0&&(A[C.bucketInstanceId]=[]),A[C.bucketInstanceId].push(C.featureIndex))}return A}insertCollisionBox(i,s,u,d,m,x){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:m,collisionGroupID:x,overlapMode:s},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,s,u,d,m,x){const w=u?this.ignoredGrid:this.grid,T={bucketInstanceId:d,featureIndex:m,collisionGroupID:x,overlapMode:s};for(let A=0;A<i.length;A+=4)w.insertCircle(T,i[A],i[A+1],i[A+2])}projectAndGetPerspectiveRatio(i,s,u,d){let m;return d?(m=[s,u,d(s,u),1],f.ag(m,m,i)):(m=[s,u,0,1],H(m,m,i)),{point:new f.P((m[0]/m[3]+1)/2*this.transform.width+Y,(-m[1]/m[3]+1)/2*this.transform.height+Y),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}}isOffscreen(i,s,u,d){return u<Y||i>=this.screenRightBoundary||d<Y||s>this.screenBottomBoundary}isInsideGrid(i,s,u,d){return u>=0&&i<this.gridRightBoundary&&d>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const i=f.ao([]);return f.$(i,i,[-100,-100,0]),i}}function ae(p,i,s){return i*(f.N/(p.tileSize*Math.pow(2,s-p.tileID.overscaledZ)))}class W{constructor(i,s,u,d){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?s:-s))):d&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class le{constructor(i,s,u,d,m){this.text=new W(i?i.text:null,s,u,m),this.icon=new W(i?i.icon:null,s,d,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ae{constructor(i,s,u){this.text=i,this.icon=s,this.skipFade=u}}class Ce{constructor(){this.invProjMatrix=f.Z(),this.viewportMatrix=f.Z(),this.circles=[]}}class Le{constructor(i,s,u,d,m){this.bucketInstanceId=i,this.featureIndex=s,this.sourceLayerIndex=u,this.bucketIndex=d,this.tileID=m}}class At{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const s=++this.maxGroupID;this.collisionGroups[i]={ID:s,predicate:u=>u.collisionGroupID===s}}return this.collisionGroups[i]}}function It(p,i,s,u,d){const{horizontalAlign:m,verticalAlign:x}=f.au(p);return new f.P(-(m-.5)*i+u[0]*d,-(x-.5)*s+u[1]*d)}function st(p,i,s,u,d,m){const{x1:x,x2:w,y1:T,y2:A,anchorPointX:M,anchorPointY:C}=p,B=new f.P(i,s);return u&&B._rotate(d?m:-m),{x1:x+B.x,y1:T+B.y,x2:w+B.x,y2:A+B.y,anchorPointX:M,anchorPointY:C}}class pt{constructor(i,s,u,d,m){this.transform=i.clone(),this.terrain=s,this.collisionIndex=new de(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new At(d),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,s,u,d){const m=u.getBucket(s),x=u.latestFeatureIndex;if(!m||!x||s.id!==m.layerIds[0])return;const w=u.collisionBoxArray,T=m.layers[0].layout,A=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),M=u.tileSize/f.N,C=this.transform.calculatePosMatrix(u.tileID.toUnwrapped()),B=T.get("text-pitch-alignment")==="map",q=T.get("text-rotation-alignment")==="map",V=ae(u,1,this.transform.zoom),$=et(C,B,q,this.transform,V);let j=null;if(B){const ge=En(C,B,q,this.transform,V);j=f.a1([],this.transform.labelPlaneMatrix,ge)}this.retainedQueryData[m.bucketInstanceId]=new Le(m.bucketInstanceId,x,m.sourceLayerIndex,m.index,u.tileID);const re={bucket:m,layout:T,posMatrix:C,textLabelPlaneMatrix:$,labelToScreenMatrix:j,scale:A,textPixelRatio:M,holdingForFade:u.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:f.ah(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(d)for(const ge of m.sortKeyRanges){const{sortKey:K,symbolInstanceStart:oe,symbolInstanceEnd:_e}=ge;i.push({sortKey:K,symbolInstanceStart:oe,symbolInstanceEnd:_e,parameters:re})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:re})}attemptAnchorPlacement(i,s,u,d,m,x,w,T,A,M,C,B,q,V,$,j){const re=f.aq[i.textAnchor],ge=[i.textOffset0,i.textOffset1],K=It(re,u,d,ge,m),oe=this.collisionIndex.placeCollisionBox(st(s,K.x,K.y,x,w,this.transform.angle),C,T,A,M.predicate,j);if((!$||this.collisionIndex.placeCollisionBox(st($,K.x,K.y,x,w,this.transform.angle),C,T,A,M.predicate,j).box.length!==0)&&oe.box.length>0){let _e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[B.crossTileID]&&this.prevPlacement.placements[B.crossTileID]&&this.prevPlacement.placements[B.crossTileID].text&&(_e=this.prevPlacement.variableOffsets[B.crossTileID].anchor),B.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[B.crossTileID]={textOffset:ge,width:u,height:d,anchor:re,textBoxScale:m,prevAnchor:_e},this.markUsedJustification(q,re,B,V),q.allowVerticalPlacement&&(this.markUsedOrientation(q,V,B),this.placedOrientations[B.crossTileID]=V),{shift:K,placedGlyphBoxes:oe}}}placeLayerBucketPart(i,s,u){const{bucket:d,layout:m,posMatrix:x,textLabelPlaneMatrix:w,labelToScreenMatrix:T,textPixelRatio:A,holdingForFade:M,collisionBoxArray:C,partiallyEvaluatedTextSize:B,collisionGroup:q}=i.parameters,V=m.get("text-optional"),$=m.get("icon-optional"),j=f.ar(m,"text-overlap","text-allow-overlap"),re=j==="always",ge=f.ar(m,"icon-overlap","icon-allow-overlap"),K=ge==="always",oe=m.get("text-rotation-alignment")==="map",_e=m.get("text-pitch-alignment")==="map",xe=m.get("icon-text-fit")!=="none",ze=m.get("symbol-z-order")==="viewport-y",je=re&&(K||!d.hasIconData()||$),Re=K&&(re||!d.hasTextData()||V);!d.collisionArrays&&C&&d.deserializeCollisionBoxes(C);const He=this.retainedQueryData[d.bucketInstanceId].tileID,yt=this.terrain?(Je,Tt)=>this.terrain.getElevation(He,Je,Tt):null,Wt=(Je,Tt)=>{var _t,Ai;if(s[Je.crossTileID])return;if(M)return void(this.placements[Je.crossTileID]=new Ae(!1,!1,!1));let Ht=!1,jt=!1,Qt=!0,$i=null,Mi={box:null,offscreen:null},Ua={box:null},Ji=null,ya=null,Da=null,Fi=0,ir=0,Qa=0;Tt.textFeatureIndex?Fi=Tt.textFeatureIndex:Je.useRuntimeCollisionCircles&&(Fi=Je.featureIndex),Tt.verticalTextFeatureIndex&&(ir=Tt.verticalTextFeatureIndex);const bn=Tt.textBox;if(bn){const ja=ca=>{let ia=f.ai.horizontal;if(d.allowVerticalPlacement&&!ca&&this.prevPlacement){const Ja=this.prevPlacement.placedOrientations[Je.crossTileID];Ja&&(this.placedOrientations[Je.crossTileID]=Ja,ia=Ja,this.markUsedOrientation(d,ia,Je))}return ia},ba=(ca,ia)=>{if(d.allowVerticalPlacement&&Je.numVerticalGlyphVertices>0&&Tt.verticalTextBox){for(const Ja of d.writingModes)if(Ja===f.ai.vertical?(Mi=ia(),Ua=Mi):Mi=ca(),Mi&&Mi.box&&Mi.box.length)break}else Mi=ca()},La=Je.textAnchorOffsetStartIndex,Ds=Je.textAnchorOffsetEndIndex;if(Ds===La){const ca=(ia,Ja)=>{const ha=this.collisionIndex.placeCollisionBox(ia,j,A,x,q.predicate,yt);return ha&&ha.box&&ha.box.length&&(this.markUsedOrientation(d,Ja,Je),this.placedOrientations[Je.crossTileID]=Ja),ha};ba((()=>ca(bn,f.ai.horizontal)),(()=>{const ia=Tt.verticalTextBox;return d.allowVerticalPlacement&&Je.numVerticalGlyphVertices>0&&ia?ca(ia,f.ai.vertical):{box:null,offscreen:null}})),ja(Mi&&Mi.box&&Mi.box.length)}else{let ca=f.aq[(Ai=(_t=this.prevPlacement)===null||_t===void 0?void 0:_t.variableOffsets[Je.crossTileID])===null||Ai===void 0?void 0:Ai.anchor];const ia=(ha,ls,Uo)=>{const Rn=ha.x2-ha.x1,jn=ha.y2-ha.y1,Is=Je.textBoxScale,bl=xe&&ge==="never"?ls:null;let _r={box:[],offscreen:!1},Bn=j==="never"?1:2,_a="never";ca&&Bn++;for(let Si=0;Si<Bn;Si++){for(let Vn=La;Vn<Ds;Vn++){const vr=d.textAnchorOffsets.get(Vn);if(ca&&vr.textAnchor!==ca)continue;const Nt=this.attemptAnchorPlacement(vr,ha,Rn,jn,Is,oe,_e,A,x,q,_a,Je,d,Uo,bl,yt);if(Nt&&(_r=Nt.placedGlyphBoxes,_r&&_r.box&&_r.box.length))return Ht=!0,$i=Nt.shift,_r}ca?ca=null:_a=j}return _r};ba((()=>ia(bn,Tt.iconBox,f.ai.horizontal)),(()=>{const ha=Tt.verticalTextBox;return d.allowVerticalPlacement&&!(Mi&&Mi.box&&Mi.box.length)&&Je.numVerticalGlyphVertices>0&&ha?ia(ha,Tt.verticalIconBox,f.ai.vertical):{box:null,offscreen:null}})),Mi&&(Ht=Mi.box,Qt=Mi.offscreen);const Ja=ja(Mi&&Mi.box);if(!Ht&&this.prevPlacement){const ha=this.prevPlacement.variableOffsets[Je.crossTileID];ha&&(this.variableOffsets[Je.crossTileID]=ha,this.markUsedJustification(d,ha.anchor,Je,Ja))}}}if(Ji=Mi,Ht=Ji&&Ji.box&&Ji.box.length>0,Qt=Ji&&Ji.offscreen,Je.useRuntimeCollisionCircles){const ja=d.text.placedSymbolArray.get(Je.centerJustifiedTextSymbolIndex),ba=f.aj(d.textSizeData,B,ja),La=m.get("text-padding");ya=this.collisionIndex.placeCollisionCircles(j,ja,d.lineVertexArray,d.glyphOffsetArray,ba,x,w,T,u,_e,q.predicate,Je.collisionCircleDiameter,La,yt),ya.circles.length&&ya.collisionDetected&&!u&&f.w("Collisions detected, but collision boxes are not shown"),Ht=re||ya.circles.length>0&&!ya.collisionDetected,Qt=Qt&&ya.offscreen}if(Tt.iconFeatureIndex&&(Qa=Tt.iconFeatureIndex),Tt.iconBox){const ja=ba=>{const La=xe&&$i?st(ba,$i.x,$i.y,oe,_e,this.transform.angle):ba;return this.collisionIndex.placeCollisionBox(La,ge,A,x,q.predicate,yt)};Ua&&Ua.box&&Ua.box.length&&Tt.verticalIconBox?(Da=ja(Tt.verticalIconBox),jt=Da.box.length>0):(Da=ja(Tt.iconBox),jt=Da.box.length>0),Qt=Qt&&Da.offscreen}const yr=V||Je.numHorizontalGlyphVertices===0&&Je.numVerticalGlyphVertices===0,Cs=$||Je.numIconVertices===0;if(yr||Cs?Cs?yr||(jt=jt&&Ht):Ht=jt&&Ht:jt=Ht=jt&&Ht,Ht&&Ji&&Ji.box&&this.collisionIndex.insertCollisionBox(Ji.box,j,m.get("text-ignore-placement"),d.bucketInstanceId,Ua&&Ua.box&&ir?ir:Fi,q.ID),jt&&Da&&this.collisionIndex.insertCollisionBox(Da.box,ge,m.get("icon-ignore-placement"),d.bucketInstanceId,Qa,q.ID),ya&&(Ht&&this.collisionIndex.insertCollisionCircles(ya.circles,j,m.get("text-ignore-placement"),d.bucketInstanceId,Fi,q.ID),u)){const ja=d.bucketInstanceId;let ba=this.collisionCircleArrays[ja];ba===void 0&&(ba=this.collisionCircleArrays[ja]=new Ce);for(let La=0;La<ya.circles.length;La+=4)ba.circles.push(ya.circles[La+0]),ba.circles.push(ya.circles[La+1]),ba.circles.push(ya.circles[La+2]),ba.circles.push(ya.collisionDetected?1:0)}if(Je.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Je.crossTileID]=new Ae(Ht||je,jt||Re,Qt||d.justReloaded),s[Je.crossTileID]=!0};if(ze){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Je=d.getSortedSymbolIndexes(this.transform.angle);for(let Tt=Je.length-1;Tt>=0;--Tt){const _t=Je[Tt];Wt(d.symbolInstances.get(_t),d.collisionArrays[_t])}}else for(let Je=i.symbolInstanceStart;Je<i.symbolInstanceEnd;Je++)Wt(d.symbolInstances.get(Je),d.collisionArrays[Je]);if(u&&d.bucketInstanceId in this.collisionCircleArrays){const Je=this.collisionCircleArrays[d.bucketInstanceId];f.as(Je.invProjMatrix,x),Je.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}markUsedJustification(i,s,u,d){let m;m=d===f.ai.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[f.at(s)];const x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const w of x)w>=0&&(i.text.placedSymbolArray.get(w).crossTileID=m>=0&&w!==m?0:u.crossTileID)}markUsedOrientation(i,s,u){const d=s===f.ai.horizontal||s===f.ai.horizontalOnly?s:0,m=s===f.ai.vertical?s:0,x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const w of x)i.text.placedSymbolArray.get(w).placedOrientation=d;u.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let u=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const d=s?s.symbolFadeChange(i):1,m=s?s.opacities:{},x=s?s.variableOffsets:{},w=s?s.placedOrientations:{};for(const T in this.placements){const A=this.placements[T],M=m[T];M?(this.opacities[T]=new le(M,d,A.text,A.icon),u=u||A.text!==M.text.placed||A.icon!==M.icon.placed):(this.opacities[T]=new le(null,d,A.text,A.icon,A.skipFade),u=u||A.text||A.icon)}for(const T in m){const A=m[T];if(!this.opacities[T]){const M=new le(A,d,!1,!1);M.isHidden()||(this.opacities[T]=M,u=u||A.text.placed||A.icon.placed)}}for(const T in x)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=x[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:i)}updateLayerOpacities(i,s){const u={};for(const d of s){const m=d.getBucket(i);m&&d.latestFeatureIndex&&i.id===m.layerIds[0]&&this.updateBucketOpacities(m,u,d.collisionBoxArray)}}updateBucketOpacities(i,s,u){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const d=i.layers[0],m=d.layout,x=new le(null,0,!1,!1,!0),w=m.get("text-allow-overlap"),T=m.get("icon-allow-overlap"),A=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),M=m.get("text-rotation-alignment")==="map",C=m.get("text-pitch-alignment")==="map",B=m.get("icon-text-fit")!=="none",q=new le(null,0,w&&(T||!i.hasIconData()||m.get("icon-optional")),T&&(w||!i.hasTextData()||m.get("text-optional")),!0);!i.collisionArrays&&u&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(u);const V=($,j,re)=>{for(let ge=0;ge<j/4;ge++)$.opacityVertexArray.emplaceBack(re);$.hasVisibleVertices=$.hasVisibleVertices||re!==nn};for(let $=0;$<i.symbolInstances.length;$++){const j=i.symbolInstances.get($),{numHorizontalGlyphVertices:re,numVerticalGlyphVertices:ge,crossTileID:K}=j;let oe=this.opacities[K];s[K]?oe=x:oe||(oe=q,this.opacities[K]=oe),s[K]=!0;const _e=j.numIconVertices>0,xe=this.placedOrientations[j.crossTileID],ze=xe===f.ai.vertical,je=xe===f.ai.horizontal||xe===f.ai.horizontalOnly;if(re>0||ge>0){const Re=ga(oe.text);V(i.text,re,ze?nn:Re),V(i.text,ge,je?nn:Re);const He=oe.text.isHidden();[j.rightJustifiedTextSymbolIndex,j.centerJustifiedTextSymbolIndex,j.leftJustifiedTextSymbolIndex].forEach((Je=>{Je>=0&&(i.text.placedSymbolArray.get(Je).hidden=He||ze?1:0)})),j.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(j.verticalPlacedTextSymbolIndex).hidden=He||je?1:0);const yt=this.variableOffsets[j.crossTileID];yt&&this.markUsedJustification(i,yt.anchor,j,xe);const Wt=this.placedOrientations[j.crossTileID];Wt&&(this.markUsedJustification(i,"left",j,Wt),this.markUsedOrientation(i,Wt,j))}if(_e){const Re=ga(oe.icon),He=!(B&&j.verticalPlacedIconSymbolIndex&&ze);j.placedIconSymbolIndex>=0&&(V(i.icon,j.numIconVertices,He?Re:nn),i.icon.placedSymbolArray.get(j.placedIconSymbolIndex).hidden=oe.icon.isHidden()),j.verticalPlacedIconSymbolIndex>=0&&(V(i.icon,j.numVerticalIconVertices,He?nn:Re),i.icon.placedSymbolArray.get(j.verticalPlacedIconSymbolIndex).hidden=oe.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Re=i.collisionArrays[$];if(Re){let He=new f.P(0,0);if(Re.textBox||Re.verticalTextBox){let Wt=!0;if(A){const Je=this.variableOffsets[K];Je?(He=It(Je.anchor,Je.width,Je.height,Je.textOffset,Je.textBoxScale),M&&He._rotate(C?this.transform.angle:-this.transform.angle)):Wt=!1}Re.textBox&&Bt(i.textCollisionBox.collisionVertexArray,oe.text.placed,!Wt||ze,He.x,He.y),Re.verticalTextBox&&Bt(i.textCollisionBox.collisionVertexArray,oe.text.placed,!Wt||je,He.x,He.y)}const yt=!!(!je&&Re.verticalIconBox);Re.iconBox&&Bt(i.iconCollisionBox.collisionVertexArray,oe.icon.placed,yt,B?He.x:0,B?He.y:0),Re.verticalIconBox&&Bt(i.iconCollisionBox.collisionVertexArray,oe.icon.placed,!yt,B?He.x:0,B?He.y:0)}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){const $=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=$.invProjMatrix,i.placementViewportMatrix=$.viewportMatrix,i.collisionCircleArray=$.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,s){const u=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*u>i}setStale(){this.stale=!0}}function Bt(p,i,s,u,d){p.emplaceBack(i?1:0,s?1:0,u||0,d||0),p.emplaceBack(i?1:0,s?1:0,u||0,d||0),p.emplaceBack(i?1:0,s?1:0,u||0,d||0),p.emplaceBack(i?1:0,s?1:0,u||0,d||0)}const mi=Math.pow(2,25),Ii=Math.pow(2,24),ci=Math.pow(2,17),ai=Math.pow(2,16),za=Math.pow(2,9),ki=Math.pow(2,8),Ki=Math.pow(2,1);function ga(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const i=p.placed?1:0,s=Math.floor(127*p.opacity);return s*mi+i*Ii+s*ci+i*ai+s*za+i*ki+s*Ki+i}const nn=0;class Gs{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,s,u,d,m){const x=this._bucketParts;for(;this._currentTileIndex<i.length;)if(s.getBucketParts(x,d,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort(((w,T)=>w.sortKey-T.sortKey)));this._currentPartIndex<x.length;)if(s.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,m())return!0;return!1}}class la{constructor(i,s,u,d,m,x,w,T){this.placement=new pt(i,s,x,w,T),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(i,s,u){const d=f.h.now(),m=()=>!this._forceFullPlacement&&f.h.now()-d>2;for(;this._currentPlacementIndex>=0;){const x=s[i[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=w)&&(!x.maxzoom||x.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Gs(x)),this._inProgressLayer.continuePlacement(u[x.source],this.placement,this._showCollisionBoxes,x,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const Zs=512/f.N/2;class Ec{constructor(i,s,u){this.tileID=i,this.bucketInstanceId=u,this._symbolsByKey={};const d=new Map;for(let m=0;m<s.length;m++){const x=s.get(m),w=x.key,T=d.get(w);T?T.push(x):d.set(w,[x])}for(const[m,x]of d){const w={positions:x.map((T=>({x:Math.floor(T.anchorX*Zs),y:Math.floor(T.anchorY*Zs)}))),crossTileIDs:x.map((T=>T.crossTileID))};if(w.positions.length>128){const T=new f.av(w.positions.length,16,Uint16Array);for(const{x:A,y:M}of w.positions)T.add(A,M);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[m]=w}}getScaledCoordinates(i,s){const{x:u,y:d,z:m}=this.tileID.canonical,{x,y:w,z:T}=s.canonical,A=Zs/Math.pow(2,T-m),M=(w*f.N+i.anchorY)*A,C=d*f.N*Zs;return{x:Math.floor((x*f.N+i.anchorX)*A-u*f.N*Zs),y:Math.floor(M-C)}}findMatches(i,s,u){const d=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let m=0;m<i.length;m++){const x=i.get(m);if(x.crossTileID)continue;const w=this._symbolsByKey[x.key];if(!w)continue;const T=this.getScaledCoordinates(x,s);if(w.index){const A=w.index.range(T.x-d,T.y-d,T.x+d,T.y+d).sort();for(const M of A){const C=w.crossTileIDs[M];if(!u[C]){u[C]=!0,x.crossTileID=C;break}}}else if(w.positions)for(let A=0;A<w.positions.length;A++){const M=w.positions[A],C=w.crossTileIDs[A];if(Math.abs(M.x-T.x)<=d&&Math.abs(M.y-T.y)<=d&&!u[C]){u[C]=!0,x.crossTileID=C;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:i})=>i))}}class hi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class gs{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const s=Math.round((i-this.lng)/360);if(s!==0)for(const u in this.indexes){const d=this.indexes[u],m={};for(const x in d){const w=d[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+s),m[w.tileID.key]=w}this.indexes[u]=m}this.lng=i}addBucket(i,s,u){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let m=0;m<s.symbolInstances.length;m++)s.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const d=this.usedCrossTileIDs[i.overscaledZ];for(const m in this.indexes){const x=this.indexes[m];if(Number(m)>i.overscaledZ)for(const w in x){const T=x[w];T.tileID.isChildOf(i)&&T.findMatches(s.symbolInstances,i,d)}else{const w=x[i.scaledTo(Number(m)).key];w&&w.findMatches(s.symbolInstances,i,d)}}for(let m=0;m<s.symbolInstances.length;m++){const x=s.symbolInstances.get(m);x.crossTileID||(x.crossTileID=u.generate(),d[x.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Ec(i,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(i,s){for(const u of s.getCrossTileIDsLists())for(const d of u)delete this.usedCrossTileIDs[i][d]}removeStaleBuckets(i){let s=!1;for(const u in this.indexes){const d=this.indexes[u];for(const m in d)i[d[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,d[m]),delete d[m],s=!0)}return s}}class Pl{constructor(){this.layerIndexes={},this.crossTileIDs=new hi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,s,u){let d=this.layerIndexes[i.id];d===void 0&&(d=this.layerIndexes[i.id]=new gs);let m=!1;const x={};d.handleWrapJump(u);for(const w of s){const T=w.getBucket(i);T&&i.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(w.tileID,T,this.crossTileIDs)&&(m=!0),x[T.bucketInstanceId]=!0)}return d.removeStaleBuckets(x)&&(m=!0),m}pruneUnusedLayers(i){const s={};i.forEach((u=>{s[u]=!0}));for(const u in this.layerIndexes)s[u]||delete this.layerIndexes[u]}}const Ha=(p,i)=>f.x(p,i&&i.filter((s=>s.identifier!=="source.canvas"))),zn=f.F(f.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Nh=f.F(f.ax,["setCenter","setZoom","setBearing","setPitch"]),yn=f.aw();class Ma extends f.E{constructor(i,s={}){super(),this.map=i,this.dispatcher=new se(Vs(),this,i._getMapId()),this.imageManager=new bi,this.imageManager.setEventedParent(this),this.glyphManager=new Se(i._requestManager,s.localIdeographFontFamily),this.lineAtlas=new si(256,512),this.crossTileSymbolIndex=new Pl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new f.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",f.az());const u=this;this._rtlTextPluginCallback=Ma.registerForPluginStateChange((d=>{u.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:d.pluginStatus,pluginURL:d.pluginURL},((m,x)=>{if(f.aA(m),x&&x.every((w=>w)))for(const w in u.sourceCaches){const T=u.sourceCaches[w].getSource().type;T!=="vector"&&T!=="geojson"||u.sourceCaches[w].reload()}}))})),this.on("data",(d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const m=this.sourceCaches[d.sourceId];if(!m)return;const x=m.getSource();if(x&&x.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===x.id&&this._validateLayer(T)}}))}loadURL(i,s={},u){this.fire(new f.k("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const d=this.map._requestManager.transformRequest(i,Ge.Style);this._request=f.f(d,((m,x)=>{this._request=null,m?this.fire(new f.j(m)):x&&this._load(x,s,u)}))}loadJSON(i,s={},u){this.fire(new f.k("dataloading",{dataType:"style"})),this._request=f.h.frame((()=>{this._request=null,s.validate=s.validate!==!1,this._load(i,s,u)}))}loadEmpty(){this.fire(new f.k("dataloading",{dataType:"style"})),this._load(yn,{validate:!1})}_load(i,s,u){var d;const m=s.transformStyle?s.transformStyle(u,i):i;if(!s.validate||!Ha(this,f.y(m))){this._loaded=!0,this.stylesheet=m;for(const x in m.sources)this.addSource(x,m.sources[x],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new Gt(this.stylesheet.light),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new f.k("data",{dataType:"style"})),this.fire(new f.k("style.load"))}}_createLayers(){const i=f.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",i),this._order=i.map((s=>s.id)),this._layers={},this._serializedLayers=null;for(const s of i){const u=f.aC(s);u.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=u}}_loadSprite(i,s=!1,u=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=(function(d,m,x,w){const T=Et(d),A=T.length,M=x>1?"@2x":"",C={},B={},q={};for(const{id:V,url:$}of T){const j=m.transformRequest(m.normalizeSpriteURL($,M,".json"),Ge.SpriteJSON),re=`${V}_${j.url}`;C[re]=f.f(j,((oe,_e)=>{delete C[re],B[V]=_e,pi(w,B,q,oe,A)}));const ge=m.transformRequest(m.normalizeSpriteURL($,M,".png"),Ge.SpriteImage),K=`${V}_${ge.url}`;C[K]=nt.getImage(ge,((oe,_e)=>{delete C[K],q[V]=_e,pi(w,B,q,oe,A)}))}return{cancel(){for(const V of Object.values(C))V.cancel()}}})(i,this.map._requestManager,this.map.getPixelRatio(),((d,m)=>{if(this._spriteRequest=null,d)this.fire(new f.j(d));else if(m)for(const x in m){this._spritesImagesIds[x]=[];const w=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter((T=>!(T in m))):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in m[x]){const A=x==="default"?T:`${x}:${T}`;this._spritesImagesIds[x].push(A),A in this.imageManager.images?this.imageManager.updateImage(A,m[x][T],!1):this.imageManager.addImage(A,m[x][T]),s&&(this._changedImages[A]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.k("data",{dataType:"style"})),u&&u(d)}))}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.k("data",{dataType:"style"}))}_validateLayer(i){const s=this.sourceCaches[i.source];if(!s)return;const u=i.sourceLayer;if(!u)return;const d=s.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(u)===-1)&&this.fire(new f.j(new Error(`Source layer "${u}" does not exist on source "${d.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i){const s=this._serializedAllLayers();if(!i||i.length===0)return Object.values(s);const u=[];for(const d of i)s[d]&&u.push(s[d]);return u}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const s=Object.keys(this._layers);for(const u of s){const d=this._layers[u];d.type!=="custom"&&(i[u]=d.serialize())}return i}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const s=this._changed;if(this._changed){const d=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(d.length||m.length)&&this._updateWorkerLayers(d,m);for(const x in this._updatedSources){const w=this._updatedSources[x];if(w==="reload")this._reloadSource(x);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}const u={};for(const d in this.sourceCaches){const m=this.sourceCaches[d];u[d]=m.used,m.used=!1}for(const d of this._order){const m=this._layers[d];m.recalculate(i,this._availableImages),!m.isHidden(i.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const d in u){const m=this.sourceCaches[d];u[d]!==m.used&&m.fire(new f.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(i),this.z=i.zoom,s&&this.fire(new f.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(i),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,s={}){this._checkLoaded();const u=this.serialize();if(i=s.transformStyle?s.transformStyle(u,i):i,Ha(this,f.y(i)))return!1;(i=f.aD(i)).layers=f.aB(i.layers);const d=f.aE(u,i).filter((x=>!(x.command in Nh)));if(d.length===0)return!1;const m=d.filter((x=>!(x.command in zn)));if(m.length>0)throw new Error(`Unimplemented: ${m.map((x=>x.command)).join(", ")}.`);for(const x of d)x.command!=="setTransition"&&this[x.command].apply(this,x.args);return this.stylesheet=i,this._serializedLayers=null,!0}addImage(i,s){if(this.getImage(i))return this.fire(new f.j(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,s),this._afterImageUpdated(i)}updateImage(i,s){this.imageManager.updateImage(i,s)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new f.j(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,s,u={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(f.y.source,`sources.${i}`,s,null,u))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const d=this.sourceCaches[i]=new an(i,s,this.dispatcher);d.style=this,d.setEventedParent(this,(()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:i}))),d.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===i)return this.fire(new f.j(new Error(`Source "${i}" cannot be removed while layer "${u}" is using it.`)));const s=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],s.fire(new f.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,s){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const u=this.sourceCaches[i].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(s),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,s,u={}){this._checkLoaded();const d=i.id;if(this.getLayer(d))return void this.fire(new f.j(new Error(`Layer "${d}" already exists on this map.`)));let m;if(i.type==="custom"){if(Ha(this,f.aF(i)))return;m=f.aC(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(d,i.source),i=f.aD(i),i=f.e(i,{source:d})),this._validate(f.y.layer,`layers.${d}`,i,{arrayIndex:-1},u))return;m=f.aC(i),this._validateLayer(m),m.setEventedParent(this,{layer:{id:d}})}const x=s?this._order.indexOf(s):this._order.length;if(s&&x===-1)this.fire(new f.j(new Error(`Cannot add layer "${d}" before non-existing layer "${s}".`)));else{if(this._order.splice(x,0,d),this._layerOrderChanged=!0,this._layers[d]=m,this._removedLayers[d]&&m.source&&m.type!=="custom"){const w=this._removedLayers[d];delete this._removedLayers[d],w.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(i,s){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new f.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===s)return;const u=this._order.indexOf(i);this._order.splice(u,1);const d=s?this._order.indexOf(s):this._order.length;s&&d===-1?this.fire(new f.j(new Error(`Cannot move layer "${i}" before non-existing layer "${s}".`))):(this._order.splice(d,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const s=this._layers[i];if(!s)return void this.fire(new f.j(new Error(`Cannot remove non-existing layer "${i}".`)));s.setEventedParent(null);const u=this._order.indexOf(i);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=s,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],s.onRemove&&s.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,s,u){this._checkLoaded();const d=this.getLayer(i);d?d.minzoom===s&&d.maxzoom===u||(s!=null&&(d.minzoom=s),u!=null&&(d.maxzoom=u),this._updateLayer(d)):this.fire(new f.j(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,s,u={}){this._checkLoaded();const d=this.getLayer(i);if(d){if(!f.aG(d.filter,s))return s==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(f.y.filter,`layers.${d.id}.filter`,s,null,u)||(d.filter=f.aD(s),this._updateLayer(d)))}else this.fire(new f.j(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return f.aD(this.getLayer(i).filter)}setLayoutProperty(i,s,u,d={}){this._checkLoaded();const m=this.getLayer(i);m?f.aG(m.getLayoutProperty(s),u)||(m.setLayoutProperty(s,u,d),this._updateLayer(m)):this.fire(new f.j(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,s){const u=this.getLayer(i);if(u)return u.getLayoutProperty(s);this.fire(new f.j(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,s,u,d={}){this._checkLoaded();const m=this.getLayer(i);m?f.aG(m.getPaintProperty(s),u)||(m.setPaintProperty(s,u,d)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new f.j(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,s){return this.getLayer(i).getPaintProperty(s)}setFeatureState(i,s){this._checkLoaded();const u=i.source,d=i.sourceLayer,m=this.sourceCaches[u];if(m===void 0)return void this.fire(new f.j(new Error(`The source '${u}' does not exist in the map's style.`)));const x=m.getSource().type;x==="geojson"&&d?this.fire(new f.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||d?(i.id===void 0&&this.fire(new f.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(d,i.id,s)):this.fire(new f.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,s){this._checkLoaded();const u=i.source,d=this.sourceCaches[u];if(d===void 0)return void this.fire(new f.j(new Error(`The source '${u}' does not exist in the map's style.`)));const m=d.getSource().type,x=m==="vector"?i.sourceLayer:void 0;m!=="vector"||x?s&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new f.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(x,i.id,s):this.fire(new f.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const s=i.source,u=i.sourceLayer,d=this.sourceCaches[s];if(d!==void 0)return d.getSource().type!=="vector"||u?(i.id===void 0&&this.fire(new f.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(u,i.id)):void this.fire(new f.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new f.j(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return f.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=f.aH(this.sourceCaches,(m=>m.serialize())),s=this._serializeByIds(this._order),u=this.map.getTerrain()||void 0,d=this.stylesheet;return f.aI({version:d.version,name:d.name,metadata:d.metadata,light:d.light,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:i,layers:s,terrain:u},(m=>m!==void 0))}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const s=x=>this._layers[x].type==="fill-extrusion",u={},d=[];for(let x=this._order.length-1;x>=0;x--){const w=this._order[x];if(s(w)){u[w]=x;for(const T of i){const A=T[w];if(A)for(const M of A)d.push(M)}}}d.sort(((x,w)=>w.intersectionZ-x.intersectionZ));const m=[];for(let x=this._order.length-1;x>=0;x--){const w=this._order[x];if(s(w))for(let T=d.length-1;T>=0;T--){const A=d[T].feature;if(u[A.layer.id]<x)break;m.push(A),d.pop()}else for(const T of i){const A=T[w];if(A)for(const M of A)m.push(M.feature)}}return m}queryRenderedFeatures(i,s,u){s&&s.filter&&this._validate(f.y.filter,"queryRenderedFeatures.filter",s.filter,null,s);const d={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new f.j(new Error("parameters.layers must be an Array."))),[];for(const w of s.layers){const T=this._layers[w];if(!T)return this.fire(new f.j(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];d[T.source]=!0}}const m=[];s.availableImages=this._availableImages;const x=this._serializedAllLayers();for(const w in this.sourceCaches)s.layers&&!d[w]||m.push(jr(this.sourceCaches[w],this._layers,x,i,s,u));return this.placement&&m.push((function(w,T,A,M,C,B,q){const V={},$=B.queryRenderedSymbols(M),j=[];for(const re of Object.keys($).map(Number))j.push(q[re]);j.sort(ms);for(const re of j){const ge=re.featureIndex.lookupSymbolFeatures($[re.bucketInstanceId],T,re.bucketIndex,re.sourceLayerIndex,C.filter,C.layers,C.availableImages,w);for(const K in ge){const oe=V[K]=V[K]||[],_e=ge[K];_e.sort(((xe,ze)=>{const je=re.featureSortOrder;if(je){const Re=je.indexOf(xe.featureIndex);return je.indexOf(ze.featureIndex)-Re}return ze.featureIndex-xe.featureIndex}));for(const xe of _e)oe.push(xe)}}for(const re in V)V[re].forEach((ge=>{const K=ge.feature,oe=A[w[re].source].getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=oe}));return V})(this._layers,x,this.sourceCaches,i,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(i,s){s&&s.filter&&this._validate(f.y.filter,"querySourceFeatures.filter",s.filter,null,s);const u=this.sourceCaches[i];return u?(function(d,m){const x=d.getRenderableIds().map((A=>d.getTileByID(A))),w=[],T={};for(let A=0;A<x.length;A++){const M=x[A],C=M.tileID.canonical.key;T[C]||(T[C]=!0,M.querySourceFeatures(w,m))}return w})(u,s):[]}addSourceType(i,s,u){return mn(i)?u(new Error(`A source type called "${i}" already exists.`)):(((d,m)=>{wo[d]=m})(i,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:s.workerSourceURL},u):u(null,null))}getLight(){return this.light.getLight()}setLight(i,s={}){this._checkLoaded();const u=this.light.getLight();let d=!1;for(const x in i)if(!f.aG(i[x],u[x])){d=!0;break}if(!d)return;const m={now:f.h.now(),transition:f.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,s),this.light.updateTransitions(m)}_validate(i,s,u,d,m={}){return(!m||m.validate!==!1)&&Ha(this,i.call(f.y,f.e({key:s,style:this.serialize(),value:u,styleSpec:f.v},d)))}_remove(i=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),f.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const u=this.sourceCaches[s];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const s in this.sourceCaches)this.sourceCaches[s].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,s,u,d,m=!1){let x=!1,w=!1;const T={};for(const A of this._order){const M=this._layers[A];if(M.type!=="symbol")continue;if(!T[M.source]){const B=this.sourceCaches[M.source];T[M.source]=B.getRenderableIds(!0).map((q=>B.getTileByID(q))).sort(((q,V)=>V.tileID.overscaledZ-q.tileID.overscaledZ||(q.tileID.isLessThan(V.tileID)?-1:1)))}const C=this.crossTileSymbolIndex.addLayer(M,T[M.source],i.center.lng);x=x||C}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(f.h.now(),i.zoom))&&(this.pauseablePlacement=new la(i,this.map.terrain,this._order,m,s,u,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(f.h.now()),w=!0),x&&this.pauseablePlacement.placement.setStale()),w||x)for(const A of this._order){const M=this._layers[A];M.type==="symbol"&&this.placement.updateLayerOpacities(M,T[M.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(f.h.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,s,u){this.imageManager.getImages(s.icons,u),this._updateTilesForChangedImages();const d=this.sourceCaches[s.source];d&&d.setDependencies(s.tileID.key,s.type,s.icons)}getGlyphs(i,s,u){this.glyphManager.getGlyphs(s.stacks,u);const d=this.sourceCaches[s.source];d&&d.setDependencies(s.tileID.key,s.type,[""])}getResource(i,s,u){return f.m(s,u)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,s={}){this._checkLoaded(),i&&this._validate(f.y.glyphs,"glyphs",i,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,s,u={},d){this._checkLoaded();const m=[{id:i,url:s}],x=[...Et(this.stylesheet.sprite),...m];this._validate(f.y.sprite,"sprite",x,null,u)||(this.stylesheet.sprite=x,this._loadSprite(m,!0,d))}removeSprite(i){this._checkLoaded();const s=Et(this.stylesheet.sprite);if(s.find((u=>u.id===i))){if(this._spritesImagesIds[i])for(const u of this._spritesImagesIds[i])this.imageManager.removeImage(u),this._changedImages[u]=!0;s.splice(s.findIndex((u=>u.id===i)),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.k("data",{dataType:"style"}))}else this.fire(new f.j(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return Et(this.stylesheet.sprite)}setSprite(i,s={},u){this._checkLoaded(),i&&this._validate(f.y.sprite,"sprite",i,null,s)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,u):(this._unloadSprite(),u&&u(null)))}}Ma.registerForPluginStateChange=f.aK;var Qn=f.Q([{name:"a_pos",type:"Int16",components:2}]),Xa="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Qi={prelude:yi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:yi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:yi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:yi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:yi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:yi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:yi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:yi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:yi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:yi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:yi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:yi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:yi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:yi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:yi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:yi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:yi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:yi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:yi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:yi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:yi("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Xa),terrainDepth:yi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Xa),terrainCoords:yi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Xa)};function yi(p,i){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=i.match(/attribute ([\w]+) ([\w]+)/g),d=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=m?m.concat(d):d,w={};return{fragmentSource:p=p.replace(s,((T,A,M,C,B)=>(w[B]=!0,A==="define"?`
#ifndef HAS_UNIFORM_u_${B}
varying ${M} ${C} ${B};
#else
uniform ${M} ${C} u_${B};
#endif
`:`
#ifdef HAS_UNIFORM_u_${B}
    ${M} ${C} ${B} = u_${B};
#endif
`))),vertexSource:i=i.replace(s,((T,A,M,C,B)=>{const q=C==="float"?"vec2":"vec4",V=B.match(/color/)?"color":q;return w[B]?A==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
attribute ${M} ${q} a_${B};
varying ${M} ${C} ${B};
#else
uniform ${M} ${C} u_${B};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = a_${B};
#else
    ${M} ${C} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = unpack_mix_${V}(a_${B}, u_${B}_t);
#else
    ${M} ${C} ${B} = u_${B};
#endif
`:A==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
attribute ${M} ${q} a_${B};
#else
uniform ${M} ${C} u_${B};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${M} ${C} ${B} = a_${B};
#else
    ${M} ${C} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${M} ${C} ${B} = unpack_mix_${V}(a_${B}, u_${B}_t);
#else
    ${M} ${C} ${B} = u_${B};
#endif
`})),staticAttributes:u,staticUniforms:x}}class Zr{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,s,u,d,m,x,w,T,A){this.context=i;let M=this.boundPaintVertexBuffers.length!==d.length;for(let C=0;!M&&C<d.length;C++)this.boundPaintVertexBuffers[C]!==d[C]&&(M=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==u||M||this.boundIndexBuffer!==m||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==A?this.freshBind(s,u,d,m,x,w,T,A):(i.bindVertexArray.set(this.vao),w&&w.bind(),m&&m.dynamicDraw&&m.bind(),T&&T.bind(),A&&A.bind())}freshBind(i,s,u,d,m,x,w,T){const A=i.numAttributes,M=this.context,C=M.gl;this.vao&&this.destroy(),this.vao=M.createVertexArray(),M.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=d,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,s.enableAttributes(C,i);for(const B of u)B.enableAttributes(C,i);x&&x.enableAttributes(C,i),w&&w.enableAttributes(C,i),T&&T.enableAttributes(C,i),s.bind(),s.setVertexAttribPointers(C,i,m);for(const B of u)B.bind(),B.setVertexAttribPointers(C,i,m);x&&(x.bind(),x.setVertexAttribPointers(C,i,m)),d&&d.bind(),w&&(w.bind(),w.setVertexAttribPointers(C,i,m)),T&&(T.bind(),T.setVertexAttribPointers(C,i,m)),M.currentNumAttributes=A}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ea(p){const i=[];for(let s=0;s<p.length;s++){if(p[s]===null)continue;const u=p[s].split(" ");i.push(u.pop())}return i}class $s{constructor(i,s,u,d,m,x){const w=i.gl;this.program=w.createProgram();const T=ea(s.staticAttributes),A=u?u.getBinderAttributes():[],M=T.concat(A),C=Qi.prelude.staticUniforms?ea(Qi.prelude.staticUniforms):[],B=s.staticUniforms?ea(s.staticUniforms):[],q=u?u.getBinderUniforms():[],V=C.concat(B).concat(q),$=[];for(const xe of V)$.indexOf(xe)<0&&$.push(xe);const j=u?u.defines():[];m&&j.push("#define OVERDRAW_INSPECTOR;"),x&&j.push("#define TERRAIN3D;");const re=j.concat(Qi.prelude.fragmentSource,s.fragmentSource).join(`
`),ge=j.concat(Qi.prelude.vertexSource,s.vertexSource).join(`
`),K=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(K,re),w.compileShader(K),!w.getShaderParameter(K,w.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${w.getShaderInfoLog(K)}`);w.attachShader(this.program,K);const oe=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(oe,ge),w.compileShader(oe),!w.getShaderParameter(oe,w.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${w.getShaderInfoLog(oe)}`);w.attachShader(this.program,oe),this.attributes={};const _e={};this.numAttributes=M.length;for(let xe=0;xe<this.numAttributes;xe++)M[xe]&&(w.bindAttribLocation(this.program,xe,M[xe]),this.attributes[M[xe]]=xe);if(w.linkProgram(this.program),!w.getProgramParameter(this.program,w.LINK_STATUS))throw new Error(`Program failed to link: ${w.getProgramInfoLog(this.program)}`);w.deleteShader(oe),w.deleteShader(K);for(let xe=0;xe<$.length;xe++){const ze=$[xe];if(ze&&!_e[ze]){const je=w.getUniformLocation(this.program,ze);je&&(_e[ze]=je)}}this.fixedUniforms=d(i,_e),this.terrainUniforms=((xe,ze)=>({u_depth:new f.aL(xe,ze.u_depth),u_terrain:new f.aL(xe,ze.u_terrain),u_terrain_dim:new f.aM(xe,ze.u_terrain_dim),u_terrain_matrix:new f.aN(xe,ze.u_terrain_matrix),u_terrain_unpack:new f.aO(xe,ze.u_terrain_unpack),u_terrain_exaggeration:new f.aM(xe,ze.u_terrain_exaggeration)}))(i,_e),this.binderUniforms=u?u.getUniforms(i,_e):[]}draw(i,s,u,d,m,x,w,T,A,M,C,B,q,V,$,j,re,ge){const K=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(u),i.setStencilMode(d),i.setColorMode(m),i.setCullFace(x),T){i.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,T.depthTexture),i.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,T.texture);for(const _e in this.terrainUniforms)this.terrainUniforms[_e].set(T[_e])}for(const _e in this.fixedUniforms)this.fixedUniforms[_e].set(w[_e]);$&&$.setUniforms(i,this.binderUniforms,q,{zoom:V});let oe=0;switch(s){case K.LINES:oe=2;break;case K.TRIANGLES:oe=3;break;case K.LINE_STRIP:oe=1}for(const _e of B.get()){const xe=_e.vaos||(_e.vaos={});(xe[A]||(xe[A]=new Zr)).bind(i,this,M,$?$.getPaintVertexBuffers():[],C,_e.vertexOffset,j,re,ge),K.drawElements(s,_e.primitiveLength*oe,K.UNSIGNED_SHORT,_e.primitiveOffset*oe*2)}}}function Jn(p,i,s){const u=1/ae(s,1,i.transform.tileZoom),d=Math.pow(2,s.tileID.overscaledZ),m=s.tileSize*Math.pow(2,i.transform.tileZoom)/d,x=m*(s.tileID.canonical.x+s.tileID.wrap*d),w=m*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[u,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[x>>16,w>>16],u_pixel_coord_lower:[65535&x,65535&w]}}const Mn=(p,i,s,u)=>{const d=i.style.light,m=d.properties.get("position"),x=[m.x,m.y,m.z],w=(function(){var A=new f.A(9);return f.A!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[5]=0,A[6]=0,A[7]=0),A[0]=1,A[4]=1,A[8]=1,A})();d.properties.get("anchor")==="viewport"&&(function(A,M){var C=Math.sin(M),B=Math.cos(M);A[0]=B,A[1]=C,A[2]=0,A[3]=-C,A[4]=B,A[5]=0,A[6]=0,A[7]=0,A[8]=1})(w,-i.transform.angle),(function(A,M,C){var B=M[0],q=M[1],V=M[2];A[0]=B*C[0]+q*C[3]+V*C[6],A[1]=B*C[1]+q*C[4]+V*C[7],A[2]=B*C[2]+q*C[5]+V*C[8]})(x,x,w);const T=d.properties.get("color");return{u_matrix:p,u_lightpos:x,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+s,u_opacity:u}},zr=(p,i,s,u,d,m,x)=>f.e(Mn(p,i,s,u),Jn(m,i,x),{u_height_factor:-Math.pow(2,d.overscaledZ)/x.tileSize/8}),Au=p=>({u_matrix:p}),Jo=(p,i,s,u)=>f.e(Au(p),Jn(s,i,u)),$r=(p,i)=>({u_matrix:p,u_world:i}),Wo=(p,i,s,u,d)=>f.e(Jo(p,i,s,u),{u_world:d}),Hr=(p,i,s,u)=>{const d=p.transform;let m,x;if(u.paint.get("circle-pitch-alignment")==="map"){const w=ae(s,1,d.zoom);m=!0,x=[w,w]}else m=!1,x=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:p.translatePosMatrix(i.posMatrix,s,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:x}},ys=(p,i,s)=>{const u=ae(s,1,i.zoom),d=Math.pow(2,i.zoom-s.tileID.overscaledZ),m=s.tileID.overscaleFactor();return{u_matrix:p,u_camera_to_center_distance:i.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[i.pixelsToGLUnits[0]/(u*d),i.pixelsToGLUnits[1]/(u*d)],u_overscale_factor:m}},el=(p,i,s=1)=>({u_matrix:p,u_color:i,u_overlay:0,u_overlay_scale:s}),zu=p=>({u_matrix:p}),Ac=(p,i,s,u)=>({u_matrix:p,u_extrude_scale:ae(i,1,s),u_intensity:u});function tl(p,i){const s=Math.pow(2,i.canonical.z),u=i.canonical.y;return[new f.U(0,u/s).toLngLat().lat,new f.U(0,(u+1)/s).toLngLat().lat]}const Mu=(p,i,s,u)=>{const d=p.transform;return{u_matrix:To(p,i,s,u),u_ratio:1/ae(i,1,d.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},zc=(p,i,s,u,d)=>f.e(Mu(p,i,s,d),{u_image:0,u_image_height:u}),Nl=(p,i,s,u,d)=>{const m=p.transform,x=Fl(i,m);return{u_matrix:To(p,i,s,d),u_texsize:i.imageAtlasTexture.size,u_ratio:1/ae(i,1,m.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[x,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Mr=(p,i,s,u,d,m)=>{const x=p.lineAtlas,w=Fl(i,p.transform),T=s.layout.get("line-cap")==="round",A=x.getDash(u.from,T),M=x.getDash(u.to,T),C=A.width*d.fromScale,B=M.width*d.toScale;return f.e(Mu(p,i,s,m),{u_patternscale_a:[w/C,-A.height/2],u_patternscale_b:[w/B,-M.height/2],u_sdfgamma:x.width/(256*Math.min(C,B)*p.pixelRatio)/2,u_image:0,u_tex_y_a:A.y,u_tex_y_b:M.y,u_mix:d.t})};function Fl(p,i){return 1/ae(p,1,i.tileZoom)}function To(p,i,s,u){return p.translatePosMatrix(u?u.posMatrix:i.tileID.posMatrix,i,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const Hs=(p,i,s,u,d)=>{return{u_matrix:p,u_tl_parent:i,u_scale_parent:s,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(x=d.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(m=d.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Xs(d.paint.get("raster-hue-rotate"))};var m,x};function Xs(p){p*=Math.PI/180;const i=Math.sin(p),s=Math.cos(p);return[(2*s+1)/3,(-Math.sqrt(3)*i-s+1)/3,(Math.sqrt(3)*i-s+1)/3]}const Ul=(p,i,s,u,d,m,x,w,T,A)=>{const M=d.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:M.cameraToCenterDistance,u_pitch:M.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:M.width/M.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:m,u_label_plane_matrix:x,u_coord_matrix:w,u_is_text:+T,u_pitch_with_map:+u,u_texsize:A,u_texture:0}},il=(p,i,s,u,d,m,x,w,T,A,M)=>{const C=d.transform;return f.e(Ul(p,i,s,u,d,m,x,w,T,A),{u_gamma_scale:u?Math.cos(C._pitch)*C.cameraToCenterDistance:1,u_device_pixel_ratio:d.pixelRatio,u_is_halo:1})},_s=(p,i,s,u,d,m,x,w,T,A)=>f.e(il(p,i,s,u,d,m,x,w,!0,T),{u_texsize_icon:A,u_texture_icon:1}),vs=(p,i,s)=>({u_matrix:p,u_opacity:i,u_color:s}),Ca=(p,i,s,u,d,m)=>f.e((function(x,w,T,A){const M=T.imageManager.getPattern(x.from.toString()),C=T.imageManager.getPattern(x.to.toString()),{width:B,height:q}=T.imageManager.getPixelSize(),V=Math.pow(2,A.tileID.overscaledZ),$=A.tileSize*Math.pow(2,T.transform.tileZoom)/V,j=$*(A.tileID.canonical.x+A.tileID.wrap*V),re=$*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:M.tl,u_pattern_br_a:M.br,u_pattern_tl_b:C.tl,u_pattern_br_b:C.br,u_texsize:[B,q],u_mix:w.t,u_pattern_size_a:M.displaySize,u_pattern_size_b:C.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/ae(A,1,T.transform.tileZoom),u_pixel_coord_upper:[j>>16,re>>16],u_pixel_coord_lower:[65535&j,65535&re]}})(u,m,s,d),{u_matrix:p,u_opacity:i}),Eo={fillExtrusion:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_lightpos:new f.aP(p,i.u_lightpos),u_lightintensity:new f.aM(p,i.u_lightintensity),u_lightcolor:new f.aP(p,i.u_lightcolor),u_vertical_gradient:new f.aM(p,i.u_vertical_gradient),u_opacity:new f.aM(p,i.u_opacity)}),fillExtrusionPattern:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_lightpos:new f.aP(p,i.u_lightpos),u_lightintensity:new f.aM(p,i.u_lightintensity),u_lightcolor:new f.aP(p,i.u_lightcolor),u_vertical_gradient:new f.aM(p,i.u_vertical_gradient),u_height_factor:new f.aM(p,i.u_height_factor),u_image:new f.aL(p,i.u_image),u_texsize:new f.aQ(p,i.u_texsize),u_pixel_coord_upper:new f.aQ(p,i.u_pixel_coord_upper),u_pixel_coord_lower:new f.aQ(p,i.u_pixel_coord_lower),u_scale:new f.aP(p,i.u_scale),u_fade:new f.aM(p,i.u_fade),u_opacity:new f.aM(p,i.u_opacity)}),fill:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix)}),fillPattern:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_image:new f.aL(p,i.u_image),u_texsize:new f.aQ(p,i.u_texsize),u_pixel_coord_upper:new f.aQ(p,i.u_pixel_coord_upper),u_pixel_coord_lower:new f.aQ(p,i.u_pixel_coord_lower),u_scale:new f.aP(p,i.u_scale),u_fade:new f.aM(p,i.u_fade)}),fillOutline:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_world:new f.aQ(p,i.u_world)}),fillOutlinePattern:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_world:new f.aQ(p,i.u_world),u_image:new f.aL(p,i.u_image),u_texsize:new f.aQ(p,i.u_texsize),u_pixel_coord_upper:new f.aQ(p,i.u_pixel_coord_upper),u_pixel_coord_lower:new f.aQ(p,i.u_pixel_coord_lower),u_scale:new f.aP(p,i.u_scale),u_fade:new f.aM(p,i.u_fade)}),circle:(p,i)=>({u_camera_to_center_distance:new f.aM(p,i.u_camera_to_center_distance),u_scale_with_map:new f.aL(p,i.u_scale_with_map),u_pitch_with_map:new f.aL(p,i.u_pitch_with_map),u_extrude_scale:new f.aQ(p,i.u_extrude_scale),u_device_pixel_ratio:new f.aM(p,i.u_device_pixel_ratio),u_matrix:new f.aN(p,i.u_matrix)}),collisionBox:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_camera_to_center_distance:new f.aM(p,i.u_camera_to_center_distance),u_pixels_to_tile_units:new f.aM(p,i.u_pixels_to_tile_units),u_extrude_scale:new f.aQ(p,i.u_extrude_scale),u_overscale_factor:new f.aM(p,i.u_overscale_factor)}),collisionCircle:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_inv_matrix:new f.aN(p,i.u_inv_matrix),u_camera_to_center_distance:new f.aM(p,i.u_camera_to_center_distance),u_viewport_size:new f.aQ(p,i.u_viewport_size)}),debug:(p,i)=>({u_color:new f.aR(p,i.u_color),u_matrix:new f.aN(p,i.u_matrix),u_overlay:new f.aL(p,i.u_overlay),u_overlay_scale:new f.aM(p,i.u_overlay_scale)}),clippingMask:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix)}),heatmap:(p,i)=>({u_extrude_scale:new f.aM(p,i.u_extrude_scale),u_intensity:new f.aM(p,i.u_intensity),u_matrix:new f.aN(p,i.u_matrix)}),heatmapTexture:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_world:new f.aQ(p,i.u_world),u_image:new f.aL(p,i.u_image),u_color_ramp:new f.aL(p,i.u_color_ramp),u_opacity:new f.aM(p,i.u_opacity)}),hillshade:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_image:new f.aL(p,i.u_image),u_latrange:new f.aQ(p,i.u_latrange),u_light:new f.aQ(p,i.u_light),u_shadow:new f.aR(p,i.u_shadow),u_highlight:new f.aR(p,i.u_highlight),u_accent:new f.aR(p,i.u_accent)}),hillshadePrepare:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_image:new f.aL(p,i.u_image),u_dimension:new f.aQ(p,i.u_dimension),u_zoom:new f.aM(p,i.u_zoom),u_unpack:new f.aO(p,i.u_unpack)}),line:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_ratio:new f.aM(p,i.u_ratio),u_device_pixel_ratio:new f.aM(p,i.u_device_pixel_ratio),u_units_to_pixels:new f.aQ(p,i.u_units_to_pixels)}),lineGradient:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_ratio:new f.aM(p,i.u_ratio),u_device_pixel_ratio:new f.aM(p,i.u_device_pixel_ratio),u_units_to_pixels:new f.aQ(p,i.u_units_to_pixels),u_image:new f.aL(p,i.u_image),u_image_height:new f.aM(p,i.u_image_height)}),linePattern:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_texsize:new f.aQ(p,i.u_texsize),u_ratio:new f.aM(p,i.u_ratio),u_device_pixel_ratio:new f.aM(p,i.u_device_pixel_ratio),u_image:new f.aL(p,i.u_image),u_units_to_pixels:new f.aQ(p,i.u_units_to_pixels),u_scale:new f.aP(p,i.u_scale),u_fade:new f.aM(p,i.u_fade)}),lineSDF:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_ratio:new f.aM(p,i.u_ratio),u_device_pixel_ratio:new f.aM(p,i.u_device_pixel_ratio),u_units_to_pixels:new f.aQ(p,i.u_units_to_pixels),u_patternscale_a:new f.aQ(p,i.u_patternscale_a),u_patternscale_b:new f.aQ(p,i.u_patternscale_b),u_sdfgamma:new f.aM(p,i.u_sdfgamma),u_image:new f.aL(p,i.u_image),u_tex_y_a:new f.aM(p,i.u_tex_y_a),u_tex_y_b:new f.aM(p,i.u_tex_y_b),u_mix:new f.aM(p,i.u_mix)}),raster:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_tl_parent:new f.aQ(p,i.u_tl_parent),u_scale_parent:new f.aM(p,i.u_scale_parent),u_buffer_scale:new f.aM(p,i.u_buffer_scale),u_fade_t:new f.aM(p,i.u_fade_t),u_opacity:new f.aM(p,i.u_opacity),u_image0:new f.aL(p,i.u_image0),u_image1:new f.aL(p,i.u_image1),u_brightness_low:new f.aM(p,i.u_brightness_low),u_brightness_high:new f.aM(p,i.u_brightness_high),u_saturation_factor:new f.aM(p,i.u_saturation_factor),u_contrast_factor:new f.aM(p,i.u_contrast_factor),u_spin_weights:new f.aP(p,i.u_spin_weights)}),symbolIcon:(p,i)=>({u_is_size_zoom_constant:new f.aL(p,i.u_is_size_zoom_constant),u_is_size_feature_constant:new f.aL(p,i.u_is_size_feature_constant),u_size_t:new f.aM(p,i.u_size_t),u_size:new f.aM(p,i.u_size),u_camera_to_center_distance:new f.aM(p,i.u_camera_to_center_distance),u_pitch:new f.aM(p,i.u_pitch),u_rotate_symbol:new f.aL(p,i.u_rotate_symbol),u_aspect_ratio:new f.aM(p,i.u_aspect_ratio),u_fade_change:new f.aM(p,i.u_fade_change),u_matrix:new f.aN(p,i.u_matrix),u_label_plane_matrix:new f.aN(p,i.u_label_plane_matrix),u_coord_matrix:new f.aN(p,i.u_coord_matrix),u_is_text:new f.aL(p,i.u_is_text),u_pitch_with_map:new f.aL(p,i.u_pitch_with_map),u_texsize:new f.aQ(p,i.u_texsize),u_texture:new f.aL(p,i.u_texture)}),symbolSDF:(p,i)=>({u_is_size_zoom_constant:new f.aL(p,i.u_is_size_zoom_constant),u_is_size_feature_constant:new f.aL(p,i.u_is_size_feature_constant),u_size_t:new f.aM(p,i.u_size_t),u_size:new f.aM(p,i.u_size),u_camera_to_center_distance:new f.aM(p,i.u_camera_to_center_distance),u_pitch:new f.aM(p,i.u_pitch),u_rotate_symbol:new f.aL(p,i.u_rotate_symbol),u_aspect_ratio:new f.aM(p,i.u_aspect_ratio),u_fade_change:new f.aM(p,i.u_fade_change),u_matrix:new f.aN(p,i.u_matrix),u_label_plane_matrix:new f.aN(p,i.u_label_plane_matrix),u_coord_matrix:new f.aN(p,i.u_coord_matrix),u_is_text:new f.aL(p,i.u_is_text),u_pitch_with_map:new f.aL(p,i.u_pitch_with_map),u_texsize:new f.aQ(p,i.u_texsize),u_texture:new f.aL(p,i.u_texture),u_gamma_scale:new f.aM(p,i.u_gamma_scale),u_device_pixel_ratio:new f.aM(p,i.u_device_pixel_ratio),u_is_halo:new f.aL(p,i.u_is_halo)}),symbolTextAndIcon:(p,i)=>({u_is_size_zoom_constant:new f.aL(p,i.u_is_size_zoom_constant),u_is_size_feature_constant:new f.aL(p,i.u_is_size_feature_constant),u_size_t:new f.aM(p,i.u_size_t),u_size:new f.aM(p,i.u_size),u_camera_to_center_distance:new f.aM(p,i.u_camera_to_center_distance),u_pitch:new f.aM(p,i.u_pitch),u_rotate_symbol:new f.aL(p,i.u_rotate_symbol),u_aspect_ratio:new f.aM(p,i.u_aspect_ratio),u_fade_change:new f.aM(p,i.u_fade_change),u_matrix:new f.aN(p,i.u_matrix),u_label_plane_matrix:new f.aN(p,i.u_label_plane_matrix),u_coord_matrix:new f.aN(p,i.u_coord_matrix),u_is_text:new f.aL(p,i.u_is_text),u_pitch_with_map:new f.aL(p,i.u_pitch_with_map),u_texsize:new f.aQ(p,i.u_texsize),u_texsize_icon:new f.aQ(p,i.u_texsize_icon),u_texture:new f.aL(p,i.u_texture),u_texture_icon:new f.aL(p,i.u_texture_icon),u_gamma_scale:new f.aM(p,i.u_gamma_scale),u_device_pixel_ratio:new f.aM(p,i.u_device_pixel_ratio),u_is_halo:new f.aL(p,i.u_is_halo)}),background:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_opacity:new f.aM(p,i.u_opacity),u_color:new f.aR(p,i.u_color)}),backgroundPattern:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_opacity:new f.aM(p,i.u_opacity),u_image:new f.aL(p,i.u_image),u_pattern_tl_a:new f.aQ(p,i.u_pattern_tl_a),u_pattern_br_a:new f.aQ(p,i.u_pattern_br_a),u_pattern_tl_b:new f.aQ(p,i.u_pattern_tl_b),u_pattern_br_b:new f.aQ(p,i.u_pattern_br_b),u_texsize:new f.aQ(p,i.u_texsize),u_mix:new f.aM(p,i.u_mix),u_pattern_size_a:new f.aQ(p,i.u_pattern_size_a),u_pattern_size_b:new f.aQ(p,i.u_pattern_size_b),u_scale_a:new f.aM(p,i.u_scale_a),u_scale_b:new f.aM(p,i.u_scale_b),u_pixel_coord_upper:new f.aQ(p,i.u_pixel_coord_upper),u_pixel_coord_lower:new f.aQ(p,i.u_pixel_coord_lower),u_tile_units_to_pixels:new f.aM(p,i.u_tile_units_to_pixels)}),terrain:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_texture:new f.aL(p,i.u_texture),u_ele_delta:new f.aM(p,i.u_ele_delta)}),terrainDepth:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_ele_delta:new f.aM(p,i.u_ele_delta)}),terrainCoords:(p,i)=>({u_matrix:new f.aN(p,i.u_matrix),u_texture:new f.aL(p,i.u_texture),u_terrain_coords_id:new f.aM(p,i.u_terrain_coords_id),u_ele_delta:new f.aM(p,i.u_ele_delta)})};class xs{constructor(i,s,u){this.context=i;const d=i.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Wn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ao{constructor(i,s,u,d){this.length=s.length,this.attributes=u,this.itemSize=s.bytesPerElement,this.dynamicDraw=d,this.context=i;const m=i.gl;this.buffer=m.createBuffer(),i.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,s){for(let u=0;u<this.attributes.length;u++){const d=s.attributes[this.attributes[u].name];d!==void 0&&i.enableVertexAttribArray(d)}}setVertexAttribPointers(i,s,u){for(let d=0;d<this.attributes.length;d++){const m=this.attributes[d],x=s.attributes[m.name];x!==void 0&&i.vertexAttribPointer(x,m.components,i[Wn[m.type]],!1,this.itemSize,m.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Xr=new WeakMap;function Yr(p){var i;if(Xr.has(p))return Xr.get(p);{const s=(i=p.getParameter(p.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return Xr.set(p,s),s}}class Jt{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ys extends Jt{getDefault(){return f.aT.transparent}set(i){const s=this.current;(i.r!==s.r||i.g!==s.g||i.b!==s.b||i.a!==s.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Cn extends Jt{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class Gi extends Jt{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Kr extends Jt{getDefault(){return[!0,!0,!0,!0]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||i[2]!==s[2]||i[3]!==s[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Ks extends Jt{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class bs extends Jt{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Cu extends Jt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const s=this.current;(i.func!==s.func||i.ref!==s.ref||i.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class al extends Jt{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||i[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class zo extends Jt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;i?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=i,this.dirty=!1}}class Qs extends Jt{getDefault(){return[0,1]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Mo extends Jt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;i?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=i,this.dirty=!1}}class nl extends Jt{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Mc extends Jt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;i?s.enable(s.BLEND):s.disable(s.BLEND),this.current=i,this.dirty=!1}}class Cc extends Jt{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Co extends Jt{getDefault(){return f.aT.transparent}set(i){const s=this.current;(i.r!==s.r||i.g!==s.g||i.b!==s.b||i.a!==s.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Du extends Jt{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class Fh extends Jt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;i?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=i,this.dirty=!1}}class Uh extends Jt{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class jh extends Jt{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class Vh extends Jt{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class qh extends Jt{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class jl extends Jt{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||i[2]!==s[2]||i[3]!==s[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Vl extends Jt{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Iu extends Jt{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class ku extends Jt{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Do extends Jt{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class ql extends Jt{getDefault(){return null}set(i){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Dc extends Jt{getDefault(){return null}set(i){var s;if(i===this.current&&!this.dirty)return;const u=this.gl;Yr(u)?u.bindVertexArray(i):(s=u.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class Lu extends Jt{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Js extends Jt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Ru extends Jt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class ws extends Jt{constructor(i,s){super(i),this.context=i,this.parent=s}getDefault(){return null}}class Io extends ws{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class Ic extends ws{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Bu extends ws{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class _i{constructor(i,s,u,d,m){this.context=i,this.width=s,this.height=u;const x=i.gl,w=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new Io(i,w),d)this.depthAttachment=m?new Bu(i,w):new Ic(i,w);else if(m)throw new Error("Stencil cannot be setted without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const i=this.context.gl,s=this.colorAttachment.get();if(s&&i.deleteTexture(s),this.depthAttachment){const u=this.depthAttachment.get();u&&i.deleteRenderbuffer(u)}i.deleteFramebuffer(this.framebuffer)}}class ta{constructor(i,s,u){this.blendFunction=i,this.blendColor=s,this.mask=u}}ta.Replace=[1,0],ta.disabled=new ta(ta.Replace,f.aT.transparent,[!1,!1,!1,!1]),ta.unblended=new ta(ta.Replace,f.aT.transparent,[!0,!0,!0,!0]),ta.alphaBlended=new ta([1,771],f.aT.transparent,[!0,!0,!0,!0]);class Gh{constructor(i){var s,u;if(this.gl=i,this.clearColor=new Ys(this),this.clearDepth=new Cn(this),this.clearStencil=new Gi(this),this.colorMask=new Kr(this),this.depthMask=new Ks(this),this.stencilMask=new bs(this),this.stencilFunc=new Cu(this),this.stencilOp=new al(this),this.stencilTest=new zo(this),this.depthRange=new Qs(this),this.depthTest=new Mo(this),this.depthFunc=new nl(this),this.blend=new Mc(this),this.blendFunc=new Cc(this),this.blendColor=new Co(this),this.blendEquation=new Du(this),this.cullFace=new Fh(this),this.cullFaceSide=new Uh(this),this.frontFace=new jh(this),this.program=new Vh(this),this.activeTexture=new qh(this),this.viewport=new jl(this),this.bindFramebuffer=new Vl(this),this.bindRenderbuffer=new Iu(this),this.bindTexture=new ku(this),this.bindVertexBuffer=new Do(this),this.bindElementBuffer=new ql(this),this.bindVertexArray=new Dc(this),this.pixelStoreUnpack=new Lu(this),this.pixelStoreUnpackPremultiplyAlpha=new Js(this),this.pixelStoreUnpackFlipY=new Ru(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),Yr(i)){this.HALF_FLOAT=i.HALF_FLOAT;const d=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=i.RGBA16F)!==null&&s!==void 0?s:d?.RGBA16F_EXT,this.RGB16F=(u=i.RGB16F)!==null&&u!==void 0?u:d?.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const d=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=d?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,s){return new xs(this,i,s)}createVertexBuffer(i,s,u){return new Ao(this,i,s,u)}createRenderbuffer(i,s,u){const d=this.gl,m=d.createRenderbuffer();return this.bindRenderbuffer.set(m),d.renderbufferStorage(d.RENDERBUFFER,i,s,u),this.bindRenderbuffer.set(null),m}createFramebuffer(i,s,u,d){return new _i(this,i,s,u,d)}clear({color:i,depth:s,stencil:u}){const d=this.gl;let m=0;i&&(m|=d.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(m|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),u!==void 0&&(m|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),d.clear(m)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){f.aG(i.blendFunction,ta.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return Yr(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var s;return Yr(this.gl)?this.gl.deleteVertexArray(i):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}class ni{constructor(i,s,u){this.func=i,this.mask=s,this.range=u}}ni.ReadOnly=!1,ni.ReadWrite=!0,ni.disabled=new ni(519,ni.ReadOnly,[0,1]);const Ws=7680;class Zi{constructor(i,s,u,d,m,x){this.test=i,this.ref=s,this.mask=u,this.fail=d,this.depthFail=m,this.pass=x}}Zi.disabled=new Zi({func:519,mask:0},0,0,Ws,Ws,Ws);class Li{constructor(i,s,u){this.enable=i,this.mode=s,this.frontFace=u}}let rl;function Ou(p,i,s,u,d,m,x){const w=p.context,T=w.gl,A=p.useProgram("collisionBox"),M=[];let C=0,B=0;for(let K=0;K<u.length;K++){const oe=u[K],_e=i.getTile(oe),xe=_e.getBucket(s);if(!xe)continue;let ze=oe.posMatrix;d[0]===0&&d[1]===0||(ze=p.translatePosMatrix(oe.posMatrix,_e,d,m));const je=x?xe.textCollisionBox:xe.iconCollisionBox,Re=xe.collisionCircleArray;if(Re.length>0){const He=f.Z(),yt=ze;f.aU(He,xe.placementInvProjMatrix,p.transform.glCoordMatrix),f.aU(He,He,xe.placementViewportMatrix),M.push({circleArray:Re,circleOffset:B,transform:yt,invTransform:He,coord:oe}),C+=Re.length/4,B=C}je&&A.draw(w,T.LINES,ni.disabled,Zi.disabled,p.colorModeForRenderPass(),Li.disabled,ys(ze,p.transform,_e),p.style.map.terrain&&p.style.map.terrain.getTerrainData(oe),s.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,null,p.transform.zoom,null,null,je.collisionVertexBuffer)}if(!x||!M.length)return;const q=p.useProgram("collisionCircle"),V=new f.aV;V.resize(4*C),V._trim();let $=0;for(const K of M)for(let oe=0;oe<K.circleArray.length/4;oe++){const _e=4*oe,xe=K.circleArray[_e+0],ze=K.circleArray[_e+1],je=K.circleArray[_e+2],Re=K.circleArray[_e+3];V.emplace($++,xe,ze,je,Re,0),V.emplace($++,xe,ze,je,Re,1),V.emplace($++,xe,ze,je,Re,2),V.emplace($++,xe,ze,je,Re,3)}(!rl||rl.length<2*C)&&(rl=(function(K){const oe=2*K,_e=new f.aX;_e.resize(oe),_e._trim();for(let xe=0;xe<oe;xe++){const ze=6*xe;_e.uint16[ze+0]=4*xe+0,_e.uint16[ze+1]=4*xe+1,_e.uint16[ze+2]=4*xe+2,_e.uint16[ze+3]=4*xe+2,_e.uint16[ze+4]=4*xe+3,_e.uint16[ze+5]=4*xe+0}return _e})(C));const j=w.createIndexBuffer(rl,!0),re=w.createVertexBuffer(V,f.aW.members,!0);for(const K of M){const oe={u_matrix:K.transform,u_inv_matrix:K.invTransform,u_camera_to_center_distance:(ge=p.transform).cameraToCenterDistance,u_viewport_size:[ge.width,ge.height]};q.draw(w,T.TRIANGLES,ni.disabled,Zi.disabled,p.colorModeForRenderPass(),Li.disabled,oe,p.style.map.terrain&&p.style.map.terrain.getTerrainData(K.coord),s.id,re,j,f.S.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,p.transform.zoom,null,null,null)}var ge;re.destroy(),j.destroy()}Li.disabled=new Li(!1,1029,2305),Li.backCCW=new Li(!0,1029,2305);const Gl=f.ao(new Float32Array(16));function sl(p,i,s,u,d,m){const{horizontalAlign:x,verticalAlign:w}=f.au(p);return new f.P((-(x-.5)*i/d+u[0])*m,(-(w-.5)*s/d+u[1])*m)}function ol(p,i,s,u,d,m,x,w,T,A,M){const C=p.text.placedSymbolArray,B=p.text.dynamicLayoutVertexArray,q=p.icon.dynamicLayoutVertexArray,V={};B.clear();for(let $=0;$<C.length;$++){const j=C.get($),re=j.hidden||!j.crossTileID||p.allowVerticalPlacement&&!j.placedOrientation?null:u[j.crossTileID];if(re){const ge=new f.P(j.anchorX,j.anchorY),K=di(ge,s?x:m,M),oe=An(d.cameraToCenterDistance,K.signedDistanceFromCamera);let _e=f.aj(p.textSizeData,T,j)*oe/f.ap;s&&(_e*=p.tilePixelRatio/w);const{width:xe,height:ze,anchor:je,textOffset:Re,textBoxScale:He}=re,yt=sl(je,xe,ze,Re,He,_e),Wt=s?di(ge.add(yt),m,M).point:K.point.add(i?yt.rotate(-d.angle):yt),Je=p.allowVerticalPlacement&&j.placedOrientation===f.ai.vertical?Math.PI/2:0;for(let Tt=0;Tt<j.numGlyphs;Tt++)f.ak(B,Wt,Je);A&&j.associatedIconIndex>=0&&(V[j.associatedIconIndex]={shiftedAnchor:Wt,angle:Je})}else F(j.numGlyphs,B)}if(A){q.clear();const $=p.icon.placedSymbolArray;for(let j=0;j<$.length;j++){const re=$.get(j);if(re.hidden)F(re.numGlyphs,q);else{const ge=V[j];if(ge)for(let K=0;K<re.numGlyphs;K++)f.ak(q,ge.shiftedAnchor,ge.angle);else F(re.numGlyphs,q)}}p.icon.dynamicLayoutVertexBuffer.updateData(q)}p.text.dynamicLayoutVertexBuffer.updateData(B)}function Zl(p,i,s){return s.iconsInText&&i?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function Qr(p,i,s,u,d,m,x,w,T,A,M,C){const B=p.context,q=B.gl,V=p.transform,$=w==="map",j=T==="map",re=w!=="viewport"&&s.layout.get("symbol-placement")!=="point",ge=$&&!j&&!re,K=!s.layout.get("symbol-sort-key").isConstant();let oe=!1;const _e=p.depthModeForSublayer(0,ni.ReadOnly),xe=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ze=[];for(const je of u){const Re=i.getTile(je),He=Re.getBucket(s);if(!He)continue;const yt=d?He.text:He.icon;if(!yt||!yt.segments.get().length||!yt.hasVisibleVertices)continue;const Wt=yt.programConfigurations.get(s.id),Je=d||He.sdfIcons,Tt=d?He.textSizeData:He.iconSizeData,_t=j||V.pitch!==0,Ai=p.useProgram(Zl(Je,d,He),Wt),Ht=f.ah(Tt,V.zoom),jt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(je);let Qt,$i,Mi,Ua,Ji=[0,0],ya=null;if(d)$i=Re.glyphAtlasTexture,Mi=q.LINEAR,Qt=Re.glyphAtlasTexture.size,He.iconsInText&&(Ji=Re.imageAtlasTexture.size,ya=Re.imageAtlasTexture,Ua=_t||p.options.rotating||p.options.zooming||Tt.kind==="composite"||Tt.kind==="camera"?q.LINEAR:q.NEAREST);else{const ca=s.layout.get("icon-size").constantOr(0)!==1||He.iconsNeedLinear;$i=Re.imageAtlasTexture,Mi=Je||p.options.rotating||p.options.zooming||ca||_t?q.LINEAR:q.NEAREST,Qt=Re.imageAtlasTexture.size}const Da=ae(Re,1,p.transform.zoom),Fi=et(je.posMatrix,j,$,p.transform,Da),ir=En(je.posMatrix,j,$,p.transform,Da),Qa=xe&&He.hasTextData(),bn=s.layout.get("icon-text-fit")!=="none"&&Qa&&He.hasIconData();if(re){const ca=p.style.map.terrain?(Ja,ha)=>p.style.map.terrain.getElevation(je,Ja,ha):null,ia=s.layout.get("text-rotation-alignment")==="map";tt(He,je.posMatrix,p,d,Fi,ir,j,A,ia,ca)}const yr=p.translatePosMatrix(je.posMatrix,Re,m,x),Cs=re||d&&xe||bn?Gl:Fi,ja=p.translatePosMatrix(ir,Re,m,x,!0),ba=Je&&s.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let La;La=Je?He.iconsInText?_s(Tt.kind,Ht,ge,j,p,yr,Cs,ja,Qt,Ji):il(Tt.kind,Ht,ge,j,p,yr,Cs,ja,d,Qt):Ul(Tt.kind,Ht,ge,j,p,yr,Cs,ja,d,Qt);const Ds={program:Ai,buffers:yt,uniformValues:La,atlasTexture:$i,atlasTextureIcon:ya,atlasInterpolation:Mi,atlasInterpolationIcon:Ua,isSDF:Je,hasHalo:ba};if(K&&He.canOverlap){oe=!0;const ca=yt.segments.get();for(const ia of ca)ze.push({segments:new f.S([ia]),sortKey:ia.sortKey,state:Ds,terrainData:jt})}else ze.push({segments:yt.segments,sortKey:0,state:Ds,terrainData:jt})}oe&&ze.sort(((je,Re)=>je.sortKey-Re.sortKey));for(const je of ze){const Re=je.state;if(B.activeTexture.set(q.TEXTURE0),Re.atlasTexture.bind(Re.atlasInterpolation,q.CLAMP_TO_EDGE),Re.atlasTextureIcon&&(B.activeTexture.set(q.TEXTURE1),Re.atlasTextureIcon&&Re.atlasTextureIcon.bind(Re.atlasInterpolationIcon,q.CLAMP_TO_EDGE)),Re.isSDF){const He=Re.uniformValues;Re.hasHalo&&(He.u_is_halo=1,Pu(Re.buffers,je.segments,s,p,Re.program,_e,M,C,He,je.terrainData)),He.u_is_halo=0}Pu(Re.buffers,je.segments,s,p,Re.program,_e,M,C,Re.uniformValues,je.terrainData)}}function Pu(p,i,s,u,d,m,x,w,T,A){const M=u.context;d.draw(M,M.gl.TRIANGLES,m,x,w,Li.disabled,T,A,s.id,p.layoutVertexBuffer,p.indexBuffer,i,s.paint,u.transform.zoom,p.programConfigurations.get(s.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function ll(p,i,s,u,d){if(!s||!u||!u.imageAtlas)return;const m=u.imageAtlas.patternPositions;let x=m[s.to.toString()],w=m[s.from.toString()];if(!x&&w&&(x=w),!w&&x&&(w=x),!x||!w){const T=d.getPaintProperty(i);x=m[T],w=m[T]}x&&w&&p.setConstantPatternPositions(x,w)}function ul(p,i,s,u,d,m,x){const w=p.context.gl,T="fill-pattern",A=s.paint.get(T),M=A&&A.constantOr(1),C=s.getCrossfadeParameters();let B,q,V,$,j;x?(q=M&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",B=w.LINES):(q=M?"fillPattern":"fill",B=w.TRIANGLES);const re=A.constantOr(null);for(const ge of u){const K=i.getTile(ge);if(M&&!K.patternsLoaded())continue;const oe=K.getBucket(s);if(!oe)continue;const _e=oe.programConfigurations.get(s.id),xe=p.useProgram(q,_e),ze=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ge);M&&(p.context.activeTexture.set(w.TEXTURE0),K.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),_e.updatePaintBuffers(C)),ll(_e,T,re,K,s);const je=ze?ge:null,Re=p.translatePosMatrix(je?je.posMatrix:ge.posMatrix,K,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(x){$=oe.indexBuffer2,j=oe.segments2;const He=[w.drawingBufferWidth,w.drawingBufferHeight];V=q==="fillOutlinePattern"&&M?Wo(Re,p,C,K,He):$r(Re,He)}else $=oe.indexBuffer,j=oe.segments,V=M?Jo(Re,p,C,K):Au(Re);xe.draw(p.context,B,d,p.stencilModeForClipping(ge),m,Li.disabled,V,ze,s.id,oe.layoutVertexBuffer,$,j,s.paint,p.transform.zoom,_e)}}function ko(p,i,s,u,d,m,x){const w=p.context,T=w.gl,A="fill-extrusion-pattern",M=s.paint.get(A),C=M.constantOr(1),B=s.getCrossfadeParameters(),q=s.paint.get("fill-extrusion-opacity"),V=M.constantOr(null);for(const $ of u){const j=i.getTile($),re=j.getBucket(s);if(!re)continue;const ge=p.style.map.terrain&&p.style.map.terrain.getTerrainData($),K=re.programConfigurations.get(s.id),oe=p.useProgram(C?"fillExtrusionPattern":"fillExtrusion",K);C&&(p.context.activeTexture.set(T.TEXTURE0),j.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),K.updatePaintBuffers(B)),ll(K,A,V,j,s);const _e=p.translatePosMatrix($.posMatrix,j,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),xe=s.paint.get("fill-extrusion-vertical-gradient"),ze=C?zr(_e,p,xe,q,$,B,j):Mn(_e,p,xe,q);oe.draw(w,w.gl.TRIANGLES,d,m,x,Li.backCCW,ze,ge,s.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,s.paint,p.transform.zoom,K,p.style.map.terrain&&re.centroidVertexBuffer)}}function kc(p,i,s,u,d,m,x){const w=p.context,T=w.gl,A=s.fbo;if(!A)return;const M=p.useProgram("hillshade"),C=p.style.map.terrain&&p.style.map.terrain.getTerrainData(i);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,A.colorAttachment.get()),M.draw(w,T.TRIANGLES,d,m,x,Li.disabled,((B,q,V,$)=>{const j=V.paint.get("hillshade-shadow-color"),re=V.paint.get("hillshade-highlight-color"),ge=V.paint.get("hillshade-accent-color");let K=V.paint.get("hillshade-illumination-direction")*(Math.PI/180);V.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=B.transform.angle);const oe=!B.options.moving;return{u_matrix:$?$.posMatrix:B.transform.calculatePosMatrix(q.tileID.toUnwrapped(),oe),u_image:0,u_latrange:tl(0,q.tileID),u_light:[V.paint.get("hillshade-exaggeration"),K],u_shadow:j,u_highlight:re,u_accent:ge}})(p,s,u,C?i:null),C,u.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}function eo(p,i,s,u,d,m){const x=p.context,w=x.gl,T=i.dem;if(T&&T.data){const A=T.dim,M=T.stride,C=T.getPixels();if(x.activeTexture.set(w.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||p.getTileTexture(M),i.demTexture){const q=i.demTexture;q.update(C,{premultiply:!1}),q.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else i.demTexture=new qt(x,C,w.RGBA,{premultiply:!1}),i.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);x.activeTexture.set(w.TEXTURE0);let B=i.fbo;if(!B){const q=new qt(x,{width:A,height:A,data:null},w.RGBA);q.bind(w.LINEAR,w.CLAMP_TO_EDGE),B=i.fbo=x.createFramebuffer(A,A,!0,!1),B.colorAttachment.set(q.texture)}x.bindFramebuffer.set(B.framebuffer),x.viewport.set([0,0,A,A]),p.useProgram("hillshadePrepare").draw(x,w.TRIANGLES,u,d,m,Li.disabled,((q,V)=>{const $=V.stride,j=f.Z();return f.aS(j,0,f.N,-f.N,0,0,1),f.$(j,j,[0,-f.N,0]),{u_matrix:j,u_image:1,u_dimension:[$,$],u_zoom:q.overscaledZ,u_unpack:V.getUnpackVector()}})(i.tileID,T),null,s.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function cl(p,i,s,u,d,m){const x=u.paint.get("raster-fade-duration");if(!m&&x>0){const w=f.h.now(),T=(w-p.timeAdded)/x,A=i?(w-i.timeAdded)/x:-1,M=s.getSource(),C=d.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),B=!i||Math.abs(i.tileID.overscaledZ-C)>Math.abs(p.tileID.overscaledZ-C),q=B&&p.refreshedUponExpiration?1:f.ad(B?T:1-A,0,1);return p.refreshedUponExpiration&&T>=1&&(p.refreshedUponExpiration=!1),i?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}const Lc=new f.aT(1,0,0,1),to=new f.aT(0,1,0,1),$l=new f.aT(0,0,1,1),Nu=new f.aT(1,0,1,1),Hl=new f.aT(0,1,1,1);function io(p,i,s,u){dl(p,0,i+s/2,p.transform.width,s,u)}function hl(p,i,s,u){dl(p,i-s/2,0,s,p.transform.height,u)}function dl(p,i,s,u,d,m){const x=p.context,w=x.gl;w.enable(w.SCISSOR_TEST),w.scissor(i*p.pixelRatio,s*p.pixelRatio,u*p.pixelRatio,d*p.pixelRatio),x.clear({color:m}),w.disable(w.SCISSOR_TEST)}function Fu(p,i,s){const u=p.context,d=u.gl,m=s.posMatrix,x=p.useProgram("debug"),w=ni.disabled,T=Zi.disabled,A=p.colorModeForRenderPass(),M="$debug",C=p.style.map.terrain&&p.style.map.terrain.getTerrainData(s);u.activeTexture.set(d.TEXTURE0);const B=i.getTileByID(s.key).latestRawTileData,q=Math.floor((B&&B.byteLength||0)/1024),V=i.getTile(s).tileSize,$=512/Math.min(V,512)*(s.overscaledZ/p.transform.zoom)*.5;let j=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(j+=` => ${s.overscaledZ}`),(function(re,ge){re.initDebugOverlayCanvas();const K=re.debugOverlayCanvas,oe=re.context.gl,_e=re.debugOverlayCanvas.getContext("2d");_e.clearRect(0,0,K.width,K.height),_e.shadowColor="white",_e.shadowBlur=2,_e.lineWidth=1.5,_e.strokeStyle="white",_e.textBaseline="top",_e.font="bold 36px Open Sans, sans-serif",_e.fillText(ge,5,5),_e.strokeText(ge,5,5),re.debugOverlayTexture.update(K),re.debugOverlayTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE)})(p,`${j} ${q}kB`),x.draw(u,d.TRIANGLES,w,T,ta.alphaBlended,Li.disabled,el(m,f.aT.transparent,$),null,M,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),x.draw(u,d.LINE_STRIP,w,T,A,Li.disabled,el(m,f.aT.red),C,M,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function ua(p,i,s){const u=p.context,d=u.gl,m=p.colorModeForRenderPass(),x=new ni(d.LEQUAL,ni.ReadWrite,p.depthRangeFor3D),w=p.useProgram("terrain"),T=i.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,p.width,p.height]);for(const A of s){const M=p.renderToTexture.getTexture(A),C=i.getTerrainData(A.tileID);u.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,M.texture);const B={u_matrix:p.transform.calculatePosMatrix(A.tileID.toUnwrapped()),u_texture:0,u_ele_delta:i.getMeshFrameDelta(p.transform.zoom)};w.draw(u,d.TRIANGLES,x,Zi.disabled,m,Li.backCCW,B,C,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class ao{constructor(i,s){this.context=new Gh(i),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:f.Z(),renderTime:0},this.setup(),this.numSublayers=an.maxUnderzooming+an.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Pl}resize(i,s,u){if(this.width=Math.floor(i*u),this.height=Math.floor(s*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const i=this.context,s=new f.a_;s.emplaceBack(0,0),s.emplaceBack(f.N,0),s.emplaceBack(0,f.N),s.emplaceBack(f.N,f.N),this.tileExtentBuffer=i.createVertexBuffer(s,Qn.members),this.tileExtentSegments=f.S.simpleSegment(0,0,4,2);const u=new f.a_;u.emplaceBack(0,0),u.emplaceBack(f.N,0),u.emplaceBack(0,f.N),u.emplaceBack(f.N,f.N),this.debugBuffer=i.createVertexBuffer(u,Qn.members),this.debugSegments=f.S.simpleSegment(0,0,4,5);const d=new f.V;d.emplaceBack(0,0,0,0),d.emplaceBack(f.N,0,f.N,0),d.emplaceBack(0,f.N,0,f.N),d.emplaceBack(f.N,f.N,f.N,f.N),this.rasterBoundsBuffer=i.createVertexBuffer(d,ii.members),this.rasterBoundsSegments=f.S.simpleSegment(0,0,4,2);const m=new f.a_;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(m,Qn.members),this.viewportSegments=f.S.simpleSegment(0,0,4,2);const x=new f.a$;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(x);const w=new f.b0;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(w);const T=this.context.gl;this.stencilClearMode=new Zi({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const i=this.context,s=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=f.Z();f.aS(u,0,this.width,this.height,0,0,1),f.a0(u,u,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,s.TRIANGLES,ni.disabled,this.stencilClearMode,ta.disabled,Li.disabled,zu(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,s){if(this.currentStencilSource===i.source||!i.isTileClipped()||!s||!s.length)return;this.currentStencilSource=i.source;const u=this.context,d=u.gl;this.nextStencilID+s.length>256&&this.clearStencil(),u.setColorMode(ta.disabled),u.setDepthMode(ni.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of s){const w=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(x);m.draw(u,d.TRIANGLES,ni.disabled,new Zi({func:d.ALWAYS,mask:0},w,255,d.KEEP,d.KEEP,d.REPLACE),ta.disabled,Li.disabled,zu(x.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,s=this.context.gl;return new Zi({func:s.NOTEQUAL,mask:255},i,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(i){const s=this.context.gl;return new Zi({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(i){const s=this.context.gl,u=i.sort(((x,w)=>w.overscaledZ-x.overscaledZ)),d=u[u.length-1].overscaledZ,m=u[0].overscaledZ-d+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const x={};for(let w=0;w<m;w++)x[w+d]=new Zi({func:s.GEQUAL,mask:255},w+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=m,[x,u]}return[{[d]:Zi.disabled},u]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new ta([i.CONSTANT_COLOR,i.ONE],new f.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ta.unblended:ta.alphaBlended}depthModeForSublayer(i,s,u){if(!this.opaquePassEnabledForLayer())return ni.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new ni(u||this.context.gl.LEQUAL,s,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,s){this.style=i,this.options=s,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(f.h.now()),this.imageManager.beginFrame();const u=this.style._order,d=this.style.sourceCaches,m={},x={},w={};for(const T in d){const A=d[T];A.used&&A.prepare(this.context),m[T]=A.getVisibleCoordinates(),x[T]=m[T].slice().reverse(),w[T]=A.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<u.length;T++)if(this.style._layers[u[T]].is3D()){this.opaquePassCutoff=T;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const T=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!f.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||T.length)&&(f.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(A,M){const C=A.context,B=C.gl,q=ta.unblended,V=new ni(B.LEQUAL,ni.ReadWrite,[0,1]),$=M.getTerrainMesh(),j=M.sourceCache.getRenderableTiles(),re=A.useProgram("terrainDepth");C.bindFramebuffer.set(M.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),C.clear({color:f.aT.transparent,depth:1});for(const ge of j){const K=M.getTerrainData(ge.tileID),oe={u_matrix:A.transform.calculatePosMatrix(ge.tileID.toUnwrapped()),u_ele_delta:M.getMeshFrameDelta(A.transform.zoom)};re.draw(C,B.TRIANGLES,V,Zi.disabled,q,Li.backCCW,oe,K,"terrain",$.vertexBuffer,$.indexBuffer,$.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,A.width,A.height])})(this,this.style.map.terrain),(function(A,M){const C=A.context,B=C.gl,q=ta.unblended,V=new ni(B.LEQUAL,ni.ReadWrite,[0,1]),$=M.getTerrainMesh(),j=M.getCoordsTexture(),re=M.sourceCache.getRenderableTiles(),ge=A.useProgram("terrainCoords");C.bindFramebuffer.set(M.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),C.clear({color:f.aT.transparent,depth:1}),M.coordsIndex=[];for(const K of re){const oe=M.getTerrainData(K.tileID);C.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,j.texture);const _e={u_matrix:A.transform.calculatePosMatrix(K.tileID.toUnwrapped()),u_terrain_coords_id:(255-M.coordsIndex.length)/255,u_texture:0,u_ele_delta:M.getMeshFrameDelta(A.transform.zoom)};ge.draw(C,B.TRIANGLES,V,Zi.disabled,q,Li.backCCW,_e,oe,"terrain",$.vertexBuffer,$.indexBuffer,$.segments),M.coordsIndex.push(K.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,A.width,A.height])})(this,this.style.map.terrain))}this.renderPass="offscreen";for(const T of u){const A=this.style._layers[T];if(!A.hasOffscreenPass()||A.isHidden(this.transform.zoom))continue;const M=x[A.source];(A.type==="custom"||M.length)&&this.renderLayer(this,d[A.source],A,M)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?f.aT.black:f.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[u[this.currentLayer]],A=d[T.source],M=m[T.source];this._renderTileClippingMasks(T,M),this.renderLayer(this,A,T,M)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const T=this.style._layers[u[this.currentLayer]],A=d[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const M=(T.type==="symbol"?w:x)[T.source];this._renderTileClippingMasks(T,m[T.source]),this.renderLayer(this,A,T,M)}if(this.options.showTileBoundaries){const T=(function(A,M){let C=null;const B=Object.values(A._layers).flatMap((j=>j.source&&!j.isHidden(M)?[A.sourceCaches[j.source]]:[])),q=B.filter((j=>j.getSource().type==="vector")),V=B.filter((j=>j.getSource().type!=="vector")),$=j=>{(!C||C.getSource().maxzoom<j.getSource().maxzoom)&&(C=j)};return q.forEach((j=>$(j))),C||V.forEach((j=>$(j))),C})(this.style,this.transform.zoom);T&&(function(A,M,C){for(let B=0;B<C.length;B++)Fu(A,M,C[B])})(this,T,T.getVisibleCoordinates())}this.options.showPadding&&(function(T){const A=T.transform.padding;io(T,T.transform.height-(A.top||0),3,Lc),io(T,A.bottom||0,3,to),hl(T,A.left||0,3,$l),hl(T,T.transform.width-(A.right||0),3,Nu);const M=T.transform.centerPoint;(function(C,B,q,V){dl(C,B-1,q-10,2,20,V),dl(C,B-10,q-1,20,2,V)})(T,M.x,T.transform.height-M.y,Hl)})(this),this.context.setDefault()}renderLayer(i,s,u,d){if(!u.isHidden(this.transform.zoom)&&(u.type==="background"||u.type==="custom"||(d||[]).length))switch(this.id=u.id,u.type){case"symbol":(function(m,x,w,T,A){if(m.renderPass!=="translucent")return;const M=Zi.disabled,C=m.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(B,q,V,$,j,re,ge){const K=q.transform,oe=j==="map",_e=re==="map";for(const xe of B){const ze=$.getTile(xe),je=ze.getBucket(V);if(!je||!je.text||!je.text.segments.get().length)continue;const Re=f.ah(je.textSizeData,K.zoom),He=ae(ze,1,q.transform.zoom),yt=et(xe.posMatrix,_e,oe,q.transform,He),Wt=V.layout.get("icon-text-fit")!=="none"&&je.hasIconData();if(Re){const Je=Math.pow(2,K.zoom-ze.tileID.overscaledZ);ol(je,oe,_e,ge,K,yt,xe.posMatrix,Je,Re,Wt,q.style.map.terrain?(Tt,_t)=>q.style.map.terrain.getElevation(xe,Tt,_t):null)}}})(T,m,w,x,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),A),w.paint.get("icon-opacity").constantOr(1)!==0&&Qr(m,x,w,T,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),M,C),w.paint.get("text-opacity").constantOr(1)!==0&&Qr(m,x,w,T,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),M,C),x.map.showCollisionBoxes&&(Ou(m,x,w,T,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),!0),Ou(m,x,w,T,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),!1))})(i,s,u,d,this.style.placement.variableOffsets);break;case"circle":(function(m,x,w,T){if(m.renderPass!=="translucent")return;const A=w.paint.get("circle-opacity"),M=w.paint.get("circle-stroke-width"),C=w.paint.get("circle-stroke-opacity"),B=!w.layout.get("circle-sort-key").isConstant();if(A.constantOr(1)===0&&(M.constantOr(1)===0||C.constantOr(1)===0))return;const q=m.context,V=q.gl,$=m.depthModeForSublayer(0,ni.ReadOnly),j=Zi.disabled,re=m.colorModeForRenderPass(),ge=[];for(let K=0;K<T.length;K++){const oe=T[K],_e=x.getTile(oe),xe=_e.getBucket(w);if(!xe)continue;const ze=xe.programConfigurations.get(w.id),je=m.useProgram("circle",ze),Re=xe.layoutVertexBuffer,He=xe.indexBuffer,yt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(oe),Wt={programConfiguration:ze,program:je,layoutVertexBuffer:Re,indexBuffer:He,uniformValues:Hr(m,oe,_e,w),terrainData:yt};if(B){const Je=xe.segments.get();for(const Tt of Je)ge.push({segments:new f.S([Tt]),sortKey:Tt.sortKey,state:Wt})}else ge.push({segments:xe.segments,sortKey:0,state:Wt})}B&&ge.sort(((K,oe)=>K.sortKey-oe.sortKey));for(const K of ge){const{programConfiguration:oe,program:_e,layoutVertexBuffer:xe,indexBuffer:ze,uniformValues:je,terrainData:Re}=K.state;_e.draw(q,V.TRIANGLES,$,j,re,Li.disabled,je,Re,w.id,xe,ze,K.segments,w.paint,m.transform.zoom,oe)}})(i,s,u,d);break;case"heatmap":(function(m,x,w,T){if(w.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const A=m.context,M=A.gl,C=Zi.disabled,B=new ta([M.ONE,M.ONE],f.aT.transparent,[!0,!0,!0,!0]);(function(q,V,$){const j=q.gl;q.activeTexture.set(j.TEXTURE1),q.viewport.set([0,0,V.width/4,V.height/4]);let re=$.heatmapFbo;if(re)j.bindTexture(j.TEXTURE_2D,re.colorAttachment.get()),q.bindFramebuffer.set(re.framebuffer);else{const ge=j.createTexture();j.bindTexture(j.TEXTURE_2D,ge),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.LINEAR),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.LINEAR),re=$.heatmapFbo=q.createFramebuffer(V.width/4,V.height/4,!1,!1),(function(K,oe,_e,xe){var ze,je;const Re=K.gl,He=(ze=K.HALF_FLOAT)!==null&&ze!==void 0?ze:Re.UNSIGNED_BYTE,yt=(je=K.RGBA16F)!==null&&je!==void 0?je:Re.RGBA;Re.texImage2D(Re.TEXTURE_2D,0,yt,oe.width/4,oe.height/4,0,Re.RGBA,He,null),xe.colorAttachment.set(_e)})(q,V,ge,re)}})(A,m,w),A.clear({color:f.aT.transparent});for(let q=0;q<T.length;q++){const V=T[q];if(x.hasRenderableParent(V))continue;const $=x.getTile(V),j=$.getBucket(w);if(!j)continue;const re=j.programConfigurations.get(w.id),ge=m.useProgram("heatmap",re),{zoom:K}=m.transform;ge.draw(A,M.TRIANGLES,ni.disabled,C,B,Li.disabled,Ac(V.posMatrix,$,K,w.paint.get("heatmap-intensity")),null,w.id,j.layoutVertexBuffer,j.indexBuffer,j.segments,w.paint,m.transform.zoom,re)}A.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),(function(A,M){const C=A.context,B=C.gl,q=M.heatmapFbo;if(!q)return;C.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,q.colorAttachment.get()),C.activeTexture.set(B.TEXTURE1);let V=M.colorRampTexture;V||(V=M.colorRampTexture=new qt(C,M.colorRamp,B.RGBA)),V.bind(B.LINEAR,B.CLAMP_TO_EDGE),A.useProgram("heatmapTexture").draw(C,B.TRIANGLES,ni.disabled,Zi.disabled,A.colorModeForRenderPass(),Li.disabled,(($,j,re,ge)=>{const K=f.Z();f.aS(K,0,$.width,$.height,0,0,1);const oe=$.context.gl;return{u_matrix:K,u_world:[oe.drawingBufferWidth,oe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:j.paint.get("heatmap-opacity")}})(A,M),null,M.id,A.viewportBuffer,A.quadTriangleIndexBuffer,A.viewportSegments,M.paint,A.transform.zoom)})(m,w))})(i,s,u,d);break;case"line":(function(m,x,w,T){if(m.renderPass!=="translucent")return;const A=w.paint.get("line-opacity"),M=w.paint.get("line-width");if(A.constantOr(1)===0||M.constantOr(1)===0)return;const C=m.depthModeForSublayer(0,ni.ReadOnly),B=m.colorModeForRenderPass(),q=w.paint.get("line-dasharray"),V=w.paint.get("line-pattern"),$=V.constantOr(1),j=w.paint.get("line-gradient"),re=w.getCrossfadeParameters(),ge=$?"linePattern":q?"lineSDF":j?"lineGradient":"line",K=m.context,oe=K.gl;let _e=!0;for(const xe of T){const ze=x.getTile(xe);if($&&!ze.patternsLoaded())continue;const je=ze.getBucket(w);if(!je)continue;const Re=je.programConfigurations.get(w.id),He=m.context.program.get(),yt=m.useProgram(ge,Re),Wt=_e||yt.program!==He,Je=m.style.map.terrain&&m.style.map.terrain.getTerrainData(xe),Tt=V.constantOr(null);if(Tt&&ze.imageAtlas){const Ht=ze.imageAtlas,jt=Ht.patternPositions[Tt.to.toString()],Qt=Ht.patternPositions[Tt.from.toString()];jt&&Qt&&Re.setConstantPatternPositions(jt,Qt)}const _t=Je?xe:null,Ai=$?Nl(m,ze,w,re,_t):q?Mr(m,ze,w,q,re,_t):j?zc(m,ze,w,je.lineClipsArray.length,_t):Mu(m,ze,w,_t);if($)K.activeTexture.set(oe.TEXTURE0),ze.imageAtlasTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),Re.updatePaintBuffers(re);else if(q&&(Wt||m.lineAtlas.dirty))K.activeTexture.set(oe.TEXTURE0),m.lineAtlas.bind(K);else if(j){const Ht=je.gradients[w.id];let jt=Ht.texture;if(w.gradientVersion!==Ht.version){let Qt=256;if(w.stepInterpolant){const $i=x.getSource().maxzoom,Mi=xe.canonical.z===$i?Math.ceil(1<<m.transform.maxZoom-xe.canonical.z):1;Qt=f.ad(f.aY(je.maxLineLength/f.N*1024*Mi),256,K.maxTextureSize)}Ht.gradient=f.aZ({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:Qt,image:Ht.gradient||void 0,clips:je.lineClipsArray}),Ht.texture?Ht.texture.update(Ht.gradient):Ht.texture=new qt(K,Ht.gradient,oe.RGBA),Ht.version=w.gradientVersion,jt=Ht.texture}K.activeTexture.set(oe.TEXTURE0),jt.bind(w.stepInterpolant?oe.NEAREST:oe.LINEAR,oe.CLAMP_TO_EDGE)}yt.draw(K,oe.TRIANGLES,C,m.stencilModeForClipping(xe),B,Li.disabled,Ai,Je,w.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,w.paint,m.transform.zoom,Re,je.layoutVertexBuffer2),_e=!1}})(i,s,u,d);break;case"fill":(function(m,x,w,T){const A=w.paint.get("fill-color"),M=w.paint.get("fill-opacity");if(M.constantOr(1)===0)return;const C=m.colorModeForRenderPass(),B=w.paint.get("fill-pattern"),q=m.opaquePassEnabledForLayer()&&!B.constantOr(1)&&A.constantOr(f.aT.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===q){const V=m.depthModeForSublayer(1,m.renderPass==="opaque"?ni.ReadWrite:ni.ReadOnly);ul(m,x,w,T,V,C,!1)}if(m.renderPass==="translucent"&&w.paint.get("fill-antialias")){const V=m.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,ni.ReadOnly);ul(m,x,w,T,V,C,!0)}})(i,s,u,d);break;case"fill-extrusion":(function(m,x,w,T){const A=w.paint.get("fill-extrusion-opacity");if(A!==0&&m.renderPass==="translucent"){const M=new ni(m.context.gl.LEQUAL,ni.ReadWrite,m.depthRangeFor3D);if(A!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))ko(m,x,w,T,M,Zi.disabled,ta.disabled),ko(m,x,w,T,M,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const C=m.colorModeForRenderPass();ko(m,x,w,T,M,Zi.disabled,C)}}})(i,s,u,d);break;case"hillshade":(function(m,x,w,T){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const A=m.context,M=m.depthModeForSublayer(0,ni.ReadOnly),C=m.colorModeForRenderPass(),[B,q]=m.renderPass==="translucent"?m.stencilConfigForOverlap(T):[{},T];for(const V of q){const $=x.getTile(V);$.needsHillshadePrepare!==void 0&&$.needsHillshadePrepare&&m.renderPass==="offscreen"?eo(m,$,w,M,Zi.disabled,C):m.renderPass==="translucent"&&kc(m,V,$,w,M,B[V.overscaledZ],C)}A.viewport.set([0,0,m.width,m.height])})(i,s,u,d);break;case"raster":(function(m,x,w,T){if(m.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!T.length)return;const A=m.context,M=A.gl,C=x.getSource(),B=m.useProgram("raster"),q=m.colorModeForRenderPass(),[V,$]=C instanceof Wi?[{},T]:m.stencilConfigForOverlap(T),j=$[$.length-1].overscaledZ,re=!m.options.moving;for(const ge of $){const K=m.depthModeForSublayer(ge.overscaledZ-j,w.paint.get("raster-opacity")===1?ni.ReadWrite:ni.ReadOnly,M.LESS),oe=x.getTile(ge);oe.registerFadeDuration(w.paint.get("raster-fade-duration"));const _e=x.findLoadedParent(ge,0),xe=cl(oe,_e,x,w,m.transform,m.style.map.terrain);let ze,je;const Re=w.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;A.activeTexture.set(M.TEXTURE0),oe.texture.bind(Re,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),A.activeTexture.set(M.TEXTURE1),_e?(_e.texture.bind(Re,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),ze=Math.pow(2,_e.tileID.overscaledZ-oe.tileID.overscaledZ),je=[oe.tileID.canonical.x*ze%1,oe.tileID.canonical.y*ze%1]):oe.texture.bind(Re,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);const He=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ge),yt=He?ge:null,Wt=yt?yt.posMatrix:m.transform.calculatePosMatrix(ge.toUnwrapped(),re),Je=Hs(Wt,je||[0,0],ze||1,xe,w);C instanceof Wi?B.draw(A,M.TRIANGLES,K,Zi.disabled,q,Li.disabled,Je,He,w.id,C.boundsBuffer,m.quadTriangleIndexBuffer,C.boundsSegments):B.draw(A,M.TRIANGLES,K,V[ge.overscaledZ],q,Li.disabled,Je,He,w.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(i,s,u,d);break;case"background":(function(m,x,w,T){const A=w.paint.get("background-color"),M=w.paint.get("background-opacity");if(M===0)return;const C=m.context,B=C.gl,q=m.transform,V=q.tileSize,$=w.paint.get("background-pattern");if(m.isPatternMissing($))return;const j=!$&&A.a===1&&M===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==j)return;const re=Zi.disabled,ge=m.depthModeForSublayer(0,j==="opaque"?ni.ReadWrite:ni.ReadOnly),K=m.colorModeForRenderPass(),oe=m.useProgram($?"backgroundPattern":"background"),_e=T||q.coveringTiles({tileSize:V,terrain:m.style.map.terrain});$&&(C.activeTexture.set(B.TEXTURE0),m.imageManager.bind(m.context));const xe=w.getCrossfadeParameters();for(const ze of _e){const je=T?ze.posMatrix:m.transform.calculatePosMatrix(ze.toUnwrapped()),Re=$?Ca(je,M,m,$,{tileID:ze,tileSize:V},xe):vs(je,M,A),He=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ze);oe.draw(C,B.TRIANGLES,ge,re,K,Li.disabled,Re,He,w.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(i,0,u,d);break;case"custom":(function(m,x,w){const T=m.context,A=w.implementation;if(m.renderPass==="offscreen"){const M=A.prerender;M&&(m.setCustomLayerDefaults(),T.setColorMode(m.colorModeForRenderPass()),M.call(A,T.gl,m.transform.customLayerMatrix()),T.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),T.setColorMode(m.colorModeForRenderPass()),T.setStencilMode(Zi.disabled);const M=A.renderingMode==="3d"?new ni(m.context.gl.LEQUAL,ni.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,ni.ReadOnly);T.setDepthMode(M),A.render(T.gl,m.transform.customLayerMatrix()),T.setDirty(),m.setBaseState(),T.bindFramebuffer.set(null)}})(i,0,u)}}translatePosMatrix(i,s,u,d,m){if(!u[0]&&!u[1])return i;const x=m?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(x){const A=Math.sin(x),M=Math.cos(x);u=[u[0]*M-u[1]*A,u[0]*A+u[1]*M]}const w=[m?u[0]:ae(s,u[0],this.transform.zoom),m?u[1]:ae(s,u[1],this.transform.zoom),0],T=new Float32Array(16);return f.$(T,i,w),T}saveTileTexture(i){const s=this._tileTextures[i.size[0]];s?s.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const s=this._tileTextures[i];return s&&s.length>0?s.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const s=this.imageManager.getPattern(i.from.toString()),u=this.imageManager.getPattern(i.to.toString());return!s||!u}useProgram(i,s){this.cache=this.cache||{};const u=i+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new $s(this.context,Qi[i],s,Eo[i],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new qt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:s}=this.context.gl;return this.width!==i||this.height!==s}}class Dn{constructor(i,s){this.points=i,this.planes=s}static fromInvProjectionMatrix(i,s,u){const d=Math.pow(2,u),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((w=>{const T=1/(w=f.ag([],w,i))[3]/s*d;return f.b3(w,w,[T,T,1/w[3],T])})),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((w=>{const T=(function(B,q){var V=q[0],$=q[1],j=q[2],re=V*V+$*$+j*j;return re>0&&(re=1/Math.sqrt(re)),B[0]=q[0]*re,B[1]=q[1]*re,B[2]=q[2]*re,B})([],(function(B,q,V){var $=q[0],j=q[1],re=q[2],ge=V[0],K=V[1],oe=V[2];return B[0]=j*oe-re*K,B[1]=re*ge-$*oe,B[2]=$*K-j*ge,B})([],Dt([],m[w[0]],m[w[1]]),Dt([],m[w[2]],m[w[1]]))),A=-((M=T)[0]*(C=m[w[1]])[0]+M[1]*C[1]+M[2]*C[2]);var M,C;return T.concat(A)}));return new Dn(m,x)}}class Lo{constructor(i,s){this.min=i,this.max=s,this.center=(function(u,d,m){return u[0]=.5*d[0],u[1]=.5*d[1],u[2]=.5*d[2],u})([],(function(u,d,m){return u[0]=d[0]+m[0],u[1]=d[1]+m[1],u[2]=d[2]+m[2],u})([],this.min,this.max))}quadrant(i){const s=[i%2==0,i<2],u=St(this.min),d=St(this.max);for(let m=0;m<s.length;m++)u[m]=s[m]?this.min[m]:this.center[m],d[m]=s[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new Lo(u,d)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let d=0;d<i.planes.length;d++){const m=i.planes[d];let x=0;for(let w=0;w<s.length;w++)f.b4(m,s[w])>=0&&x++;if(x===0)return 0;x!==s.length&&(u=!1)}if(u)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let w=0;w<i.points.length;w++){const T=i.points[w][d]-this.min[d];m=Math.min(m,T),x=Math.max(x,T)}if(x<0||m>this.max[d]-this.min[d])return 0}return 1}}class fl{constructor(i=0,s=0,u=0,d=0){if(isNaN(i)||i<0||isNaN(s)||s<0||isNaN(u)||u<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=s,this.left=u,this.right=d}interpolate(i,s,u){return s.top!=null&&i.top!=null&&(this.top=f.B.number(i.top,s.top,u)),s.bottom!=null&&i.bottom!=null&&(this.bottom=f.B.number(i.bottom,s.bottom,u)),s.left!=null&&i.left!=null&&(this.left=f.B.number(i.left,s.left,u)),s.right!=null&&i.right!=null&&(this.right=f.B.number(i.right,s.right,u)),this}getCenter(i,s){const u=f.ad((this.left+i-this.right)/2,0,i),d=f.ad((this.top+s-this.bottom)/2,0,s);return new f.P(u,d)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new fl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class rn{constructor(i,s,u,d,m){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=m===void 0||!!m,this._minZoom=i||0,this._maxZoom=s||22,this._minPitch=u??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new f.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fl,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const i=new rn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.apply(this),i}apply(i){this.tileSize=i.tileSize,this.latRange=i.latRange,this.width=i.width,this.height=i.height,this._center=i._center,this._elevation=i._elevation,this._minEleveationForCurrentTile=i._minEleveationForCurrentTile,this.zoom=i.zoom,this.angle=i.angle,this._fov=i._fov,this._pitch=i._pitch,this._unmodified=i._unmodified,this._edgeInsets=i._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new f.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const s=-f.b5(i,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=(function(){var u=new f.A(4);return f.A!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u})(),(function(u,d,m){var x=d[0],w=d[1],T=d[2],A=d[3],M=Math.sin(m),C=Math.cos(m);u[0]=x*C+T*M,u[1]=w*C+A*M,u[2]=x*-M+T*C,u[3]=w*-M+A*C})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const s=f.ad(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const s=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.tileZoom=Math.max(0,Math.floor(s)),this.scale=this.zoomScale(s),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,s,u){this._unmodified=!1,this._edgeInsets.interpolate(i,s,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const s=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(i){const s=[new f.b6(0,i)];if(this._renderWorldCopies){const u=this.pointCoordinate(new f.P(0,0)),d=this.pointCoordinate(new f.P(this.width,0)),m=this.pointCoordinate(new f.P(this.width,this.height)),x=this.pointCoordinate(new f.P(0,this.height)),w=Math.floor(Math.min(u.x,d.x,m.x,x.x)),T=Math.floor(Math.max(u.x,d.x,m.x,x.x)),A=1;for(let M=w-A;M<=T+A;M++)M!==0&&s.push(new f.b6(M,i))}return s}coveringTiles(i){var s,u;let d=this.coveringZoomLevel(i);const m=d;if(i.minzoom!==void 0&&d<i.minzoom)return[];i.maxzoom!==void 0&&d>i.maxzoom&&(d=i.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),w=f.U.fromLngLat(this.center),T=Math.pow(2,d),A=[T*x.x,T*x.y,0],M=[T*w.x,T*w.y,0],C=Dn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d);let B=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(B=d);const q=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,V=K=>({aabb:new Lo([K*T,0,0],[(K+1)*T,T,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),$=[],j=[],re=d,ge=i.reparseOverscaled?m:d;if(this._renderWorldCopies)for(let K=1;K<=3;K++)$.push(V(-K)),$.push(V(K));for($.push(V(0));$.length>0;){const K=$.pop(),oe=K.x,_e=K.y;let xe=K.fullyVisible;if(!xe){const yt=K.aabb.intersects(C);if(yt===0)continue;xe=yt===2}const ze=i.terrain?A:M,je=K.aabb.distanceX(ze),Re=K.aabb.distanceY(ze),He=Math.max(Math.abs(je),Math.abs(Re));if(K.zoom===re||He>q+(1<<re-K.zoom)-2&&K.zoom>=B){const yt=re-K.zoom,Wt=A[0]-.5-(oe<<yt),Je=A[1]-.5-(_e<<yt);j.push({tileID:new f.O(K.zoom===re?ge:K.zoom,K.wrap,K.zoom,oe,_e),distanceSq:Pe([M[0]-.5-oe,M[1]-.5-_e]),tileDistanceToCamera:Math.sqrt(Wt*Wt+Je*Je)})}else for(let yt=0;yt<4;yt++){const Wt=(oe<<1)+yt%2,Je=(_e<<1)+(yt>>1),Tt=K.zoom+1;let _t=K.aabb.quadrant(yt);if(i.terrain){const Ai=new f.O(Tt,K.wrap,Tt,Wt,Je),Ht=i.terrain.getMinMaxElevation(Ai),jt=(s=Ht.minElevation)!==null&&s!==void 0?s:this.elevation,Qt=(u=Ht.maxElevation)!==null&&u!==void 0?u:this.elevation;_t=new Lo([_t.min[0],_t.min[1],jt],[_t.max[0],_t.max[1],Qt])}$.push({aabb:_t,zoom:Tt,x:Wt,y:Je,wrap:K.wrap,fullyVisible:xe})}}return j.sort(((K,oe)=>K.distanceSq-oe.distanceSq)).map((K=>K.tileID))}resize(i,s){this.width=i,this.height=s,this.pixelsToGLUnits=[2/i,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const s=f.ad(i.lat,-this.maxValidLatitude,this.maxValidLatitude);return new f.P(f.G(i.lng)*this.worldSize,f.H(s)*this.worldSize)}unproject(i){return new f.U(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){const s=this.pointLocation(this.centerPoint,i),u=i.getElevationForLngLatZoom(s,this.tileZoom);if(!(this.elevation-u))return;const d=this.getCameraPosition(),m=f.U.fromLngLat(d.lngLat,d.altitude),x=f.U.fromLngLat(s,u),w=m.x-x.x,T=m.y-x.y,A=m.z-x.z,M=Math.sqrt(w*w+T*T+A*A),C=this.scaleZoom(this.cameraToCenterDistance/M/this.tileSize);this._elevation=u,this._center=s,this.zoom=C}setLocationAtPoint(i,s){const u=this.pointCoordinate(s),d=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(i),x=new f.U(m.x-(u.x-d.x),m.y-(u.y-d.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,s){return s?this.coordinatePoint(this.locationCoordinate(i),s.getElevationForLngLatZoom(i,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,s){return this.coordinateLocation(this.pointCoordinate(i,s))}locationCoordinate(i){return f.U.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,s){if(s){const B=s.pointCoordinate(i);if(B!=null)return B}const u=[i.x,i.y,0,1],d=[i.x,i.y,1,1];f.ag(u,u,this.pixelMatrixInverse),f.ag(d,d,this.pixelMatrixInverse);const m=u[3],x=d[3],w=u[1]/m,T=d[1]/x,A=u[2]/m,M=d[2]/x,C=A===M?0:(0-A)/(M-A);return new f.U(f.B.number(u[0]/m,d[0]/x,C)/this.worldSize,f.B.number(w,T,C)/this.worldSize)}coordinatePoint(i,s=0,u=this.pixelMatrix){const d=[i.x*this.worldSize,i.y*this.worldSize,s,1];return f.ag(d,d,u),new f.P(d[0]/d[3],d[1]/d[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new Ze().extend(this.pointLocation(new f.P(0,i))).extend(this.pointLocation(new f.P(this.width,i))).extend(this.pointLocation(new f.P(this.width,this.height))).extend(this.pointLocation(new f.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ze([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(i,s=!1){const u=i.key,d=s?this._alignedPosMatrixCache:this._posMatrixCache;if(d[u])return d[u];const m=i.canonical,x=this.worldSize/this.zoomScale(m.z),w=m.x+Math.pow(2,m.z)*i.wrap,T=f.ao(new Float64Array(16));return f.$(T,T,[w*x,m.y*x,0]),f.a0(T,T,[x/f.N,x/f.N,1]),f.a1(T,s?this.alignedProjMatrix:this.projMatrix,T),d[u]=new Float32Array(T),d[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let i,s,u,d,m=-90,x=90,w=-180,T=180;const A=this.size,M=this._unmodified;if(this.latRange){const q=this.latRange;m=f.H(q[1])*this.worldSize,x=f.H(q[0])*this.worldSize,i=x-m<A.y?A.y/(x-m):0}if(this.lngRange){const q=this.lngRange;w=f.b5(f.G(q[0])*this.worldSize,0,this.worldSize),T=f.b5(f.G(q[1])*this.worldSize,0,this.worldSize),T<w&&(T+=this.worldSize),s=T-w<A.x?A.x/(T-w):0}const C=this.point,B=Math.max(s||0,i||0);if(B)return this.center=this.unproject(new f.P(s?(T+w)/2:C.x,i?(x+m)/2:C.y)),this.zoom+=this.scaleZoom(B),this._unmodified=M,void(this._constraining=!1);if(this.latRange){const q=C.y,V=A.y/2;q-V<m&&(d=m+V),q+V>x&&(d=x-V)}if(this.lngRange){const q=(w+T)/2,V=f.b5(C.x,q-this.worldSize/2,q+this.worldSize/2),$=A.x/2;V-$<w&&(u=w+$),V+$>T&&(u=T-$)}u===void 0&&d===void 0||(this.center=this.unproject(new f.P(u!==void 0?u:C.x,d!==void 0?d:C.y)).wrap()),this._unmodified=M,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,s=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=f.b7(1,this.center.lat)*this.worldSize;let d=f.ao(new Float64Array(16));f.a0(d,d,[this.width/2,-this.height/2,1]),f.$(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=f.ao(new Float64Array(16)),f.a0(d,d,[1,-1,1]),f.$(d,d,[-1,-1,0]),f.a0(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),x=Math.min(this.elevation,this._minEleveationForCurrentTile),w=m-x*this._pixelPerMeter/Math.cos(this._pitch),T=x<0?w:m,A=Math.PI/2+this._pitch,M=this._fov*(.5+i.y/this.height),C=Math.sin(M)*T/Math.sin(f.ad(Math.PI-A-M,.01,Math.PI-.01)),B=this.getHorizon(),q=2*Math.atan(B/this.cameraToCenterDistance)*(.5+i.y/(2*B)),V=Math.sin(q)*T/Math.sin(f.ad(Math.PI-A-q,.01,Math.PI-.01)),$=Math.min(C,V),j=1.01*(Math.cos(Math.PI/2-this._pitch)*$+T),re=this.height/50;d=new Float64Array(16),f.b8(d,this._fov,this.width/this.height,re,j),d[8]=2*-i.x/this.width,d[9]=2*i.y/this.height,f.a0(d,d,[1,-1,1]),f.$(d,d,[0,0,-this.cameraToCenterDistance]),f.b9(d,d,this._pitch),f.ae(d,d,this.angle),f.$(d,d,[-s,-u,0]),this.mercatorMatrix=f.a0([],d,[this.worldSize,this.worldSize,this.worldSize]),f.a0(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=f.a1(new Float64Array(16),this.labelPlaneMatrix,d),f.$(d,d,[0,0,-this.elevation]),this.projMatrix=d,this.invProjMatrix=f.as([],d),this.pixelMatrix3D=f.a1(new Float64Array(16),this.labelPlaneMatrix,d);const ge=this.width%2/2,K=this.height%2/2,oe=Math.cos(this.angle),_e=Math.sin(this.angle),xe=s-Math.round(s)+oe*ge+_e*K,ze=u-Math.round(u)+oe*K+_e*ge,je=new Float64Array(d);if(f.$(je,je,[xe>.5?xe-1:xe,ze>.5?ze-1:ze,0]),this.alignedProjMatrix=je,d=f.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new f.P(0,0)),s=[i.x*this.worldSize,i.y*this.worldSize,0,1];return f.ag(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new f.P(0,i))}getCameraQueryGeometry(i){const s=this.getCameraPoint();if(i.length===1)return[i[0],s];{let u=s.x,d=s.y,m=s.x,x=s.y;for(const w of i)u=Math.min(u,w.x),d=Math.min(d,w.y),m=Math.max(m,w.x),x=Math.max(x,w.y);return[new f.P(u,d),new f.P(m,d),new f.P(m,x),new f.P(u,x),new f.P(u,d)]}}}function fr(p,i){let s,u=!1,d=null,m=null;const x=()=>{d=null,u&&(p.apply(m,s),d=setTimeout(x,i),u=!1)};return(...w)=>(u=!0,m=this,s=w,d||x(),d)}class Ro{constructor(i){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let u;return s.split("&").map((d=>d.split("="))).forEach((d=>{d[0]===this._hashName&&(u=d)})),(u&&u[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(s.length>=3&&!s.some((u=>isNaN(u)))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:u,pitch:+(s[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,s)}catch{}},this._updateHash=fr(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(i){const s=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,d=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,d),x=Math.round(s.lng*m)/m,w=Math.round(s.lat*m)/m,T=this._map.getBearing(),A=this._map.getPitch();let M="";if(M+=i?`/${x}/${w}/${u}`:`${u}/${w}/${x}`,(T||A)&&(M+="/"+Math.round(10*T)/10),A&&(M+=`/${Math.round(A)}`),this._hashName){const C=this._hashName;let B=!1;const q=window.location.hash.slice(1).split("&").map((V=>{const $=V.split("=")[0];return $===C?(B=!0,`${$}=${M}`):V})).filter((V=>V));return B||q.push(`${C}=${M}`),`#${q.join("&")}`}return`#${M}`}}const no={linearity:.3,easing:f.ba(0,0,.3,1)},Uu=f.e({deceleration:2500,maxSpeed:1400},no),ju=f.e({deceleration:20,maxSpeed:1400},no),Xl=f.e({deceleration:1e3,maxSpeed:360},no),Rc=f.e({deceleration:1e3,maxSpeed:90},no);class ro{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:f.h.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,s=f.h.now();for(;i.length>0&&s-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new f.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)s.zoom+=m.zoomDelta||0,s.bearing+=m.bearingDelta||0,s.pitch+=m.pitchDelta||0,m.panDelta&&s.pan._add(m.panDelta),m.around&&(s.around=m.around),m.pinchAround&&(s.pinchAround=m.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(s.pan.mag()){const m=Jr(s.pan.mag(),u,f.e({},Uu,i||{}));d.offset=s.pan.mult(m.amount/s.pan.mag()),d.center=this._map.transform.center,er(d,m)}if(s.zoom){const m=Jr(s.zoom,u,ju);d.zoom=this._map.transform.zoom+m.amount,er(d,m)}if(s.bearing){const m=Jr(s.bearing,u,Xl);d.bearing=this._map.transform.bearing+f.ad(m.amount,-179,179),er(d,m)}if(s.pitch){const m=Jr(s.pitch,u,Rc);d.pitch=this._map.transform.pitch+m.amount,er(d,m)}if(d.zoom||d.bearing){const m=s.pinchAround===void 0?s.around:s.pinchAround;d.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),f.e(d,{noMoveStart:!0})}}function er(p,i){(!p.duration||p.duration<i.duration)&&(p.duration=i.duration,p.easing=i.easing)}function Jr(p,i,s){const{maxSpeed:u,linearity:d,deceleration:m}=s,x=f.ad(p*d/(i/1e3),-u,u),w=Math.abs(x)/(m*d);return{easing:s.easing,duration:1e3*w,amount:x*(w/2)}}class _n extends f.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,s,u,d={}){const m=U.mousePos(s.getCanvasContainer(),u),x=s.unproject(m);super(i,f.e({point:m,lngLat:x,originalEvent:u},d)),this._defaultPrevented=!1,this.target=s}}class Bo extends f.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,s,u){const d=i==="touchend"?u.changedTouches:u.touches,m=U.touchPos(s.getCanvasContainer(),d),x=m.map((T=>s.unproject(T))),w=m.reduce(((T,A,M,C)=>T.add(A.div(C.length))),new f.P(0,0));super(i,{points:m,point:w,lngLats:x,lngLat:s.unproject(w),originalEvent:u}),this._defaultPrevented=!1}}class Ss extends f.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,s,u){super(i,{originalEvent:u}),this._defaultPrevented=!1}}class so{constructor(i,s){this._map=i,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new Ss(i.type,this._map,i))}mousedown(i,s){return this._mousedownPos=s,this._firePreventable(new _n(i.type,this._map,i))}mouseup(i){this._map.fire(new _n(i.type,this._map,i))}click(i,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new _n(i.type,this._map,i))}dblclick(i){return this._firePreventable(new _n(i.type,this._map,i))}mouseover(i){this._map.fire(new _n(i.type,this._map,i))}mouseout(i){this._map.fire(new _n(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Bo(i.type,this._map,i))}touchmove(i){this._map.fire(new Bo(i.type,this._map,i))}touchend(i){this._map.fire(new Bo(i.type,this._map,i))}touchcancel(i){this._map.fire(new Bo(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Yl{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new _n(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _n("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new _n(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wr{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.pointLocation(f.P.convert(i),this._map.terrain)}}class Ts{constructor(i,s){this._map=i,this._tr=new Wr(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,s){this.isEnabled()&&i.shiftKey&&i.button===0&&(U.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(i,s){if(!this._active)return;const u=s;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=u,this._box||(this._box=U.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const m=Math.min(d.x,u.x),x=Math.max(d.x,u.x),w=Math.min(d.y,u.y),T=Math.max(d.y,u.y);U.setTransform(this._box,`translate(${m}px,${w}px)`),this._box.style.width=x-m+"px",this._box.style.height=T-w+"px"}mouseupWindow(i,s){if(!this._active||i.button!==0)return;const u=this._startPos,d=s;if(this.reset(),U.suppressClick(),u.x!==d.x||u.y!==d.y)return this._map.fire(new f.k("boxzoomend",{originalEvent:i})),{cameraAnimation:m=>m.fitScreenCoordinates(u,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(U.remove(this._box),this._box=null),U.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,s){return this._map.fire(new f.k(i,{originalEvent:s}))}}function Fn(p,i){if(p.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${i.length}`);const s={};for(let u=0;u<p.length;u++)s[p[u].identifier]=i[u];return s}class Cr{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,s,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),u.length===this.numTouches&&(this.centroid=(function(d){const m=new f.P(0,0);for(const x of d)m._add(x);return m.div(d.length)})(s),this.touches=Fn(u,s)))}touchmove(i,s,u){if(this.aborted||!this.centroid)return;const d=Fn(u,s);for(const m in this.touches){const x=d[m];(!x||x.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(i,s,u){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class pl{constructor(i){this.singleTap=new Cr(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,s,u){this.singleTap.touchstart(i,s,u)}touchmove(i,s,u){this.singleTap.touchmove(i,s,u)}touchend(i,s,u){const d=this.singleTap.touchend(i,s,u);if(d){const m=i.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(d)<30;if(m&&x||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class es{constructor(i){this._tr=new Wr(i),this._zoomIn=new pl({numTouches:1,numTaps:2}),this._zoomOut=new pl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,s,u){this._zoomIn.touchstart(i,s,u),this._zoomOut.touchstart(i,s,u)}touchmove(i,s,u){this._zoomIn.touchmove(i,s,u),this._zoomOut.touchmove(i,s,u)}touchend(i,s,u){const d=this._zoomIn.touchend(i,s,u),m=this._zoomOut.touchend(i,s,u),x=this._tr;return d?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(d)},{originalEvent:i})}):m?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(m)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ts{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const s=this._moveFunction(...i);if(s.bearingDelta||s.pitchDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(i,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=s.length?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,s){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const d=s.length?s[0]:s;return!this._moved&&d.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(u,d))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&U.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Zh={0:1,2:2};class Kl{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const s=U.mouseButton(i);this._eventButton=s}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!(function(s,u){const d=Zh[u];return s.buttons===void 0||(s.buttons&d)!==d})(i,this._eventButton)}isValidEndEvent(i){return U.mouseButton(i)===this._eventButton}}class Vu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}const Oo=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=function(i){i.preventDefault()}},sn=({enable:p,clickTolerance:i,bearingDegreesPerPixelMoved:s=.8})=>{const u=new Kl({checkCorrectEvent:d=>U.mouseButton(d)===0&&d.ctrlKey||U.mouseButton(d)===2});return new ts({clickTolerance:i,move:(d,m)=>({bearingDelta:(m.x-d.x)*s}),moveStateManager:u,enable:p,assignEvents:Oo})},tr=({enable:p,clickTolerance:i,pitchDegreesPerPixelMoved:s=-.5})=>{const u=new Kl({checkCorrectEvent:d=>U.mouseButton(d)===0&&d.ctrlKey||U.mouseButton(d)===2});return new ts({clickTolerance:i,move:(d,m)=>({pitchDelta:(m.y-d.y)*s}),moveStateManager:u,enable:p,assignEvents:Oo})};class rt{constructor(i,s){this._minTouches=i.cooperativeGestures?2:1,this._clickTolerance=i.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new f.P(0,0),setTimeout((()=>{this._cancelCooperativeMessage=!1}),200)}touchstart(i,s,u){return this._calculateTransform(i,s,u)}touchmove(i,s,u){if(this._map._cooperativeGestures&&(this._minTouches===2&&u.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(i,!1,u.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(u.length<this._minTouches))return i.preventDefault(),this._calculateTransform(i,s,u)}touchend(i,s,u){this._calculateTransform(i,s,u),this._active&&u.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,s,u){u.length>0&&(this._active=!0);const d=Fn(u,s),m=new f.P(0,0),x=new f.P(0,0);let w=0;for(const A in d){const M=d[A],C=this._touches[A];C&&(m._add(M),x._add(M.sub(C)),w++,d[A]=M)}if(this._touches=d,w<this._minTouches||!x.mag())return;const T=x.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class is{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,s,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([s[0],s[1]]))}touchmove(i,s,u){if(!this._firstTwoTouches)return;i.preventDefault();const[d,m]=this._firstTwoTouches,x=Dr(u,s,d),w=Dr(u,s,m);if(!x||!w)return;const T=this._aroundCenter?null:x.add(w).div(2);return this._move([x,w],T,i)}touchend(i,s,u){if(!this._firstTwoTouches)return;const[d,m]=this._firstTwoTouches,x=Dr(u,s,d),w=Dr(u,s,m);x&&w||(this._active&&U.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Dr(p,i,s){for(let u=0;u<p.length;u++)if(p[u].identifier===s)return i[u]}function as(p,i){return Math.log(p/i)/Math.LN2}class ml extends is{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,s){const u=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(as(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:as(this._distance,u),pinchAround:s}}}function ot(p,i){return 180*p.angleWith(i)/Math.PI}class ns extends is{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,s){const u=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ot(this._vector,u),pinchAround:s}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const s=25/(Math.PI*this._minDiameter)*360,u=ot(i,this._startVector);return Math.abs(u)<s}}function Ql(p){return Math.abs(p.y)>Math.abs(p.x)}class Jl extends is{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,s,u){super.touchstart(i,s,u),this._currentTouchCount=u.length}_start(i){this._lastPoints=i,Ql(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,s,u){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const d=i[0].sub(this._lastPoints[0]),m=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,m,u.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(d.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(i,s,u){if(this._valid!==void 0)return this._valid;const d=i.mag()>=2,m=s.mag()>=2;if(!d&&!m)return;if(!d||!m)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const x=i.y>0==s.y>0;return Ql(i)&&Ql(s)&&x}}const Es={panStep:100,bearingStep:15,pitchStep:10};class Bc{constructor(i){this._tr=new Wr(i);const s=Es;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let s=0,u=0,d=0,m=0,x=0;switch(i.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:i.shiftKey?u=-1:(i.preventDefault(),m=-1);break;case 39:i.shiftKey?u=1:(i.preventDefault(),m=1);break;case 38:i.shiftKey?d=1:(i.preventDefault(),x=-1);break;case 40:i.shiftKey?d=-1:(i.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(u=0,d=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:In,zoom:s?Math.round(T.zoom)+s*(i.shiftKey?2:1):T.zoom,bearing:T.bearing+u*this._bearingStep,pitch:T.pitch+d*this._pitchStep,offset:[-m*this._panStep,-x*this._panStep],center:T.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function In(p){return p*(2-p)}const Wl=4.000244140625;class rs{constructor(i,s){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=i,this._tr=new Wr(i),this._el=i.getCanvasContainer(),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!i[this._map._metaKey])return;i.preventDefault()}let s=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const u=f.h.now(),d=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,s!==0&&s%Wl==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(d*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),i.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=i,this._delta-=s,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=U.mousePos(this._el,i),u=this._tr;this._around=f.L.convert(this._aroundCenter?u.center:u.unproject(s)),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>Wl?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const A=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(A*T))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,u=this._startZoom,d=this._easing;let m,x=!1;if(this._type==="wheel"&&u&&d){const w=Math.min((f.h.now()-this._lastWheelEventTime)/200,1),T=d(w);m=f.B.number(u,s,T),w<1?this._frameId||(this._frameId=!0):x=!0}else m=s,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:m-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let s=f.bb;if(this._prevEase){const u=this._prevEase,d=(f.h.now()-u.start)/u.duration,m=u.easing(d+.01)-u.easing(d),x=.27/Math.sqrt(m*m+1e-4)*.01,w=Math.sqrt(.0729-x*x);s=f.ba(x,w,.25,1)}return this._prevEase={start:f.h.now(),duration:i,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class eu{constructor(i,s){this._clickZoom=i,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Po{constructor(i){this._tr=new Wr(i),this.reset()}reset(){this._active=!1}dblclick(i,s){return i.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ss{constructor(){this._tap=new pl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,s,u){if(!this._swipePoint)if(this._tapTime){const d=s[0],m=i.timeStamp-this._tapTime<500,x=this._tapPoint.dist(d)<30;m&&x?u.length>0&&(this._swipePoint=d,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(i,s,u)}touchmove(i,s,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const d=s[0],m=d.y-this._swipePoint.y;return this._swipePoint=d,i.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(i,s,u)}touchend(i,s,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const d=this._tap.touchend(i,s,u);d&&(this._tapTime=i.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gl{constructor(i,s,u){this._el=i,this._mousePan=s,this._touchPan=u}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class vn{constructor(i,s,u){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=s,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ir{constructor(i,s,u,d){this._el=i,this._touchZoom=s,this._touchRotate=u,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const No=p=>p.zoom||p.drag||p.pitch||p.rotate;class kn extends f.k{}function kr(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class As{constructor(i,s){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,m)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=d.type==="renderFrame"?void 0:d,w={needsRenderFrame:!1},T={},A={},M=d.touches,C=M?this._getMapTouches(M):void 0,B=C?U.touchPos(this._el,C):U.mousePos(this._el,d);for(const{handlerName:$,handler:j,allowed:re}of this._handlers){if(!j.isEnabled())continue;let ge;this._blockedByActive(A,re,$)?j.reset():j[m||d.type]&&(ge=j[m||d.type](d,B,C),this.mergeHandlerResult(w,T,ge,$,x),ge&&ge.needsRenderFrame&&this._triggerRenderFrame()),(ge||j.isActive())&&(A[$]=j)}const q={};for(const $ in this._previousActiveHandlers)A[$]||(q[$]=x);this._previousActiveHandlers=A,(Object.keys(q).length||kr(w))&&(this._changes.push([w,T,q]),this._triggerRenderFrame()),(Object.keys(A).length||kr(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=w;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ro(i),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,m,x]of this._listeners)U.addEventListener(d,m,d===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[i,s,u]of this._listeners)U.removeEventListener(i,s,i===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(i){const s=this._map,u=s.getCanvasContainer();this._add("mapEvent",new so(s,i));const d=s.boxZoom=new Ts(s,i);this._add("boxZoom",d),i.interactive&&i.boxZoom&&d.enable();const m=new es(s),x=new Po(s);s.doubleClickZoom=new eu(x,m),this._add("tapZoom",m),this._add("clickZoom",x),i.interactive&&i.doubleClickZoom&&s.doubleClickZoom.enable();const w=new ss;this._add("tapDragZoom",w);const T=s.touchPitch=new Jl(s);this._add("touchPitch",T),i.interactive&&i.touchPitch&&s.touchPitch.enable(i.touchPitch);const A=sn(i),M=tr(i);s.dragRotate=new vn(i,A,M),this._add("mouseRotate",A,["mousePitch"]),this._add("mousePitch",M,["mouseRotate"]),i.interactive&&i.dragRotate&&s.dragRotate.enable();const C=(({enable:re,clickTolerance:ge})=>{const K=new Kl({checkCorrectEvent:oe=>U.mouseButton(oe)===0&&!oe.ctrlKey});return new ts({clickTolerance:ge,move:(oe,_e)=>({around:_e,panDelta:_e.sub(oe)}),activateOnStart:!0,moveStateManager:K,enable:re,assignEvents:Oo})})(i),B=new rt(i,s);s.dragPan=new gl(u,C,B),this._add("mousePan",C),this._add("touchPan",B,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&s.dragPan.enable(i.dragPan);const q=new ns,V=new ml;s.touchZoomRotate=new Ir(u,V,q,w),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",V,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&s.touchZoomRotate.enable(i.touchZoomRotate);const $=s.scrollZoom=new rs(s,(()=>this._triggerRenderFrame()));this._add("scrollZoom",$,["mousePan"]),i.interactive&&i.scrollZoom&&s.scrollZoom.enable(i.scrollZoom);const j=s.keyboard=new Bc(s);this._add("keyboard",j),i.interactive&&i.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new Yl(s))}_add(i,s,u){this._handlers.push({handlerName:i,handler:s,allowed:u}),this._handlersById[i]=s}stop(i){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!No(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,s,u){for(const d in i)if(d!==u&&(!s||s.indexOf(d)<0))return!0;return!1}_getMapTouches(i){const s=[];for(const u of i)this._el.contains(u.target)&&s.push(u);return s}mergeHandlerResult(i,s,u,d,m){if(!u)return;f.e(i,u);const x={handlerName:d,originalEvent:u.originalEvent||m};u.zoomDelta!==void 0&&(s.zoom=x),u.panDelta!==void 0&&(s.drag=x),u.pitchDelta!==void 0&&(s.pitch=x),u.bearingDelta!==void 0&&(s.rotate=x)}_applyChanges(){const i={},s={},u={};for(const[d,m,x]of this._changes)d.panDelta&&(i.panDelta=(i.panDelta||new f.P(0,0))._add(d.panDelta)),d.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(i.around=d.around),d.pinchAround!==void 0&&(i.pinchAround=d.pinchAround),d.noInertia&&(i.noInertia=d.noInertia),f.e(s,m),f.e(u,x);this._updateMapTransform(i,s,u),this._changes=[]}_updateMapTransform(i,s,u){const d=this._map,m=d._getTransformForUpdate(),x=d.terrain;if(!(kr(i)||x&&this._terrainMovement))return this._fireEvents(s,u,!0);let{panDelta:w,zoomDelta:T,bearingDelta:A,pitchDelta:M,around:C,pinchAround:B}=i;B!==void 0&&(C=B),d._stop(!0),C=C||d.transform.centerPoint;const q=m.pointLocation(w?C.sub(w):C);A&&(m.bearing+=A),M&&(m.pitch+=M),T&&(m.zoom+=T),x?this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(w)):m.setLocationAtPoint(q,C):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(q,C),this._map.once("moveend",(()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,m.recalculateZoom(d.terrain)}))):m.setLocationAtPoint(q,C),d._applyUpdatedTransform(m),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(s,u,!0)}_fireEvents(i,s,u){const d=No(this._eventsInProgress),m=No(i),x={};for(const M in i){const{originalEvent:C}=i[M];this._eventsInProgress[M]||(x[`${M}start`]=C),this._eventsInProgress[M]=i[M]}!d&&m&&this._fireEvent("movestart",m.originalEvent);for(const M in x)this._fireEvent(M,x[M]);m&&this._fireEvent("move",m.originalEvent);for(const M in i){const{originalEvent:C}=i[M];this._fireEvent(M,C)}const w={};let T;for(const M in this._eventsInProgress){const{handlerName:C,originalEvent:B}=this._eventsInProgress[M];this._handlersById[C].isActive()||(delete this._eventsInProgress[M],T=s[C]||B,w[`${M}end`]=T)}for(const M in w)this._fireEvent(M,w[M]);const A=No(this._eventsInProgress);if(u&&(d||m)&&!A){this._updatingCamera=!0;const M=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),C=B=>B!==0&&-this._bearingSnap<B&&B<this._bearingSnap;!M||!M.essential&&f.h.prefersReducedMotion?(this._map.fire(new f.k("moveend",{originalEvent:T})),C(this._map.getBearing())&&this._map.resetNorth()):(C(M.bearing||this._map.getBearing())&&(M.bearing=0),M.freezeElevation=!0,this._map.easeTo(M,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(i,s){this._map.fire(new f.k(i,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((i=>{delete this._frameId,this.handleEvent(new kn("renderFrame",{timeStamp:i})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class yl extends f.E{constructor(i,s){super(),this._renderFrameCallback=()=>{const u=Math.min((f.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=s.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new f.L(this.transform.center.lng,this.transform.center.lat)}setCenter(i,s){return this.jumpTo({center:i},s)}panBy(i,s,u){return i=f.P.convert(i).mult(-1),this.panTo(this.transform.center,f.e({offset:i},s),u)}panTo(i,s,u){return this.easeTo(f.e({center:i},s),u)}getZoom(){return this.transform.zoom}setZoom(i,s){return this.jumpTo({zoom:i},s),this}zoomTo(i,s,u){return this.easeTo(f.e({zoom:i},s),u)}zoomIn(i,s){return this.zoomTo(this.getZoom()+1,i,s),this}zoomOut(i,s){return this.zoomTo(this.getZoom()-1,i,s),this}getBearing(){return this.transform.bearing}setBearing(i,s){return this.jumpTo({bearing:i},s),this}getPadding(){return this.transform.padding}setPadding(i,s){return this.jumpTo({padding:i},s),this}rotateTo(i,s,u){return this.easeTo(f.e({bearing:i},s),u)}resetNorth(i,s){return this.rotateTo(0,f.e({duration:1e3},i),s),this}resetNorthPitch(i,s){return this.easeTo(f.e({bearing:0,pitch:0,duration:1e3},i),s),this}snapToNorth(i,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,s):this}getPitch(){return this.transform.pitch}setPitch(i,s){return this.jumpTo({pitch:i},s),this}cameraForBounds(i,s){i=Ze.convert(i);const u=s&&s.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),u,s)}_cameraForBoxAndBearing(i,s,u,d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=f.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const _e=d.padding;d.padding={top:_e,bottom:_e,right:_e,left:_e}}d.padding=f.e(m,d.padding);const x=this.transform,w=x.padding,T=x.project(f.L.convert(i)),A=x.project(f.L.convert(s)),M=T.rotate(-u*Math.PI/180),C=A.rotate(-u*Math.PI/180),B=new f.P(Math.max(M.x,C.x),Math.max(M.y,C.y)),q=new f.P(Math.min(M.x,C.x),Math.min(M.y,C.y)),V=B.sub(q),$=(x.width-(w.left+w.right+d.padding.left+d.padding.right))/V.x,j=(x.height-(w.top+w.bottom+d.padding.top+d.padding.bottom))/V.y;if(j<0||$<0)return void f.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const re=Math.min(x.scaleZoom(x.scale*Math.min($,j)),d.maxZoom),ge=f.P.convert(d.offset),K=new f.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(u*Math.PI/180),oe=ge.add(K).mult(x.scale/x.zoomScale(re));return{center:x.unproject(T.add(A).div(2).sub(oe)),zoom:re,bearing:u}}fitBounds(i,s,u){return this._fitInternal(this.cameraForBounds(i,s),s,u)}fitScreenCoordinates(i,s,u,d,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(f.P.convert(i)),this.transform.pointLocation(f.P.convert(s)),u,d),d,m)}_fitInternal(i,s,u){return i?(delete(s=f.e(i,s)).padding,s.linear?this.easeTo(s,u):this.flyTo(s,u)):this}jumpTo(i,s){this.stop();const u=this._getTransformForUpdate();let d=!1,m=!1,x=!1;return"zoom"in i&&u.zoom!==+i.zoom&&(d=!0,u.zoom=+i.zoom),i.center!==void 0&&(u.center=f.L.convert(i.center)),"bearing"in i&&u.bearing!==+i.bearing&&(m=!0,u.bearing=+i.bearing),"pitch"in i&&u.pitch!==+i.pitch&&(x=!0,u.pitch=+i.pitch),i.padding==null||u.isPaddingEqual(i.padding)||(u.padding=i.padding),this._applyUpdatedTransform(u),this.fire(new f.k("movestart",s)).fire(new f.k("move",s)),d&&this.fire(new f.k("zoomstart",s)).fire(new f.k("zoom",s)).fire(new f.k("zoomend",s)),m&&this.fire(new f.k("rotatestart",s)).fire(new f.k("rotate",s)).fire(new f.k("rotateend",s)),x&&this.fire(new f.k("pitchstart",s)).fire(new f.k("pitch",s)).fire(new f.k("pitchend",s)),this.fire(new f.k("moveend",s))}calculateCameraOptionsFromTo(i,s,u,d=0){const m=f.U.fromLngLat(i,s),x=f.U.fromLngLat(u,d),w=x.x-m.x,T=x.y-m.y,A=x.z-m.z,M=Math.hypot(w,T,A);if(M===0)throw new Error("Can't calculate camera options with same From and To");const C=Math.hypot(w,T),B=this.transform.scaleZoom(this.transform.cameraToCenterDistance/M/this.transform.tileSize),q=180*Math.atan2(w,-T)/Math.PI;let V=180*Math.acos(C/M)/Math.PI;return V=A<0?90-V:90+V,{center:x.toLngLat(),zoom:B,pitch:V,bearing:q}}easeTo(i,s){this._stop(!1,i.easeId),((i=f.e({offset:[0,0],duration:500,easing:f.bb},i)).animate===!1||!i.essential&&f.h.prefersReducedMotion)&&(i.duration=0);const u=this._getTransformForUpdate(),d=this.getZoom(),m=this.getBearing(),x=this.getPitch(),w=this.getPadding(),T="zoom"in i?+i.zoom:d,A="bearing"in i?this._normalizeBearing(i.bearing,m):m,M="pitch"in i?+i.pitch:x,C="padding"in i?i.padding:u.padding,B=f.P.convert(i.offset);let q=u.centerPoint.add(B);const V=u.pointLocation(q),$=f.L.convert(i.center||V);this._normalizeCenter($);const j=u.project(V),re=u.project($).sub(j),ge=u.zoomScale(T-d);let K,oe;i.around&&(K=f.L.convert(i.around),oe=u.locationPoint(K));const _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||T!==d,this._rotating=this._rotating||m!==A,this._pitching=this._pitching||M!==x,this._padding=!u.isPaddingEqual(C),this._easeId=i.easeId,this._prepareEase(s,i.noMoveStart,_e),this.terrain&&this._prepareElevation($),this._ease((xe=>{if(this._zooming&&(u.zoom=f.B.number(d,T,xe)),this._rotating&&(u.bearing=f.B.number(m,A,xe)),this._pitching&&(u.pitch=f.B.number(x,M,xe)),this._padding&&(u.interpolatePadding(w,C,xe),q=u.centerPoint.add(B)),this.terrain&&!i.freezeElevation&&this._updateElevation(xe),K)u.setLocationAtPoint(K,oe);else{const ze=u.zoomScale(u.zoom-d),je=T>d?Math.min(2,ge):Math.max(.5,ge),Re=Math.pow(je,1-xe),He=u.unproject(j.add(re.mult(xe*Re)).mult(ze));u.setLocationAtPoint(u.renderWorldCopies?He.wrap():He,q)}this._applyUpdatedTransform(u),this._fireMoveEvents(s)}),(xe=>{this.terrain&&this._finalizeElevation(),this._afterEase(s,xe)}),i),this}_prepareEase(i,s,u={}){this._moving=!0,s||u.moving||this.fire(new f.k("movestart",i)),this._zooming&&!u.zooming&&this.fire(new f.k("zoomstart",i)),this._rotating&&!u.rotating&&this.fire(new f.k("rotatestart",i)),this._pitching&&!u.pitching&&this.fire(new f.k("pitchstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&s!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(u-(s-(u*i+this._elevationStart))/(1-i)),this._elevationTarget=s}this.transform.elevation=f.B.number(this._elevationStart,this._elevationTarget,i)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(i){if(!this.transformCameraUpdate)return;const s=i.clone(),{center:u,zoom:d,pitch:m,bearing:x,elevation:w}=this.transformCameraUpdate(s);u&&(s.center=u),d!==void 0&&(s.zoom=d),m!==void 0&&(s.pitch=m),x!==void 0&&(s.bearing=x),w!==void 0&&(s.elevation=w),this.transform.apply(s)}_fireMoveEvents(i){this.fire(new f.k("move",i)),this._zooming&&this.fire(new f.k("zoom",i)),this._rotating&&this.fire(new f.k("rotate",i)),this._pitching&&this.fire(new f.k("pitch",i))}_afterEase(i,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const u=this._zooming,d=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new f.k("zoomend",i)),d&&this.fire(new f.k("rotateend",i)),m&&this.fire(new f.k("pitchend",i)),this.fire(new f.k("moveend",i))}flyTo(i,s){if(!i.essential&&f.h.prefersReducedMotion){const _t=f.F(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_t,s)}this.stop(),i=f.e({offset:[0,0],speed:1.2,curve:1.42,easing:f.bb},i);const u=this._getTransformForUpdate(),d=this.getZoom(),m=this.getBearing(),x=this.getPitch(),w=this.getPadding(),T="zoom"in i?f.ad(+i.zoom,u.minZoom,u.maxZoom):d,A="bearing"in i?this._normalizeBearing(i.bearing,m):m,M="pitch"in i?+i.pitch:x,C="padding"in i?i.padding:u.padding,B=u.zoomScale(T-d),q=f.P.convert(i.offset);let V=u.centerPoint.add(q);const $=u.pointLocation(V),j=f.L.convert(i.center||$);this._normalizeCenter(j);const re=u.project($),ge=u.project(j).sub(re);let K=i.curve;const oe=Math.max(u.width,u.height),_e=oe/B,xe=ge.mag();if("minZoom"in i){const _t=f.ad(Math.min(i.minZoom,d,T),u.minZoom,u.maxZoom),Ai=oe/u.zoomScale(_t-d);K=Math.sqrt(Ai/xe*2)}const ze=K*K;function je(_t){const Ai=(_e*_e-oe*oe+(_t?-1:1)*ze*ze*xe*xe)/(2*(_t?_e:oe)*ze*xe);return Math.log(Math.sqrt(Ai*Ai+1)-Ai)}function Re(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function He(_t){return(Math.exp(_t)+Math.exp(-_t))/2}const yt=je(!1);let Wt=function(_t){return He(yt)/He(yt+K*_t)},Je=function(_t){return oe*((He(yt)*(Re(Ai=yt+K*_t)/He(Ai))-Re(yt))/ze)/xe;var Ai},Tt=(je(!0)-yt)/K;if(Math.abs(xe)<1e-6||!isFinite(Tt)){if(Math.abs(oe-_e)<1e-6)return this.easeTo(i,s);const _t=_e<oe?-1:1;Tt=Math.abs(Math.log(_e/oe))/K,Je=function(){return 0},Wt=function(Ai){return Math.exp(_t*K*Ai)}}return i.duration="duration"in i?+i.duration:1e3*Tt/("screenSpeed"in i?+i.screenSpeed/K:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=m!==A,this._pitching=M!==x,this._padding=!u.isPaddingEqual(C),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(j),this._ease((_t=>{const Ai=_t*Tt,Ht=1/Wt(Ai);u.zoom=_t===1?T:d+u.scaleZoom(Ht),this._rotating&&(u.bearing=f.B.number(m,A,_t)),this._pitching&&(u.pitch=f.B.number(x,M,_t)),this._padding&&(u.interpolatePadding(w,C,_t),V=u.centerPoint.add(q)),this.terrain&&!i.freezeElevation&&this._updateElevation(_t);const jt=_t===1?j:u.unproject(re.add(ge.mult(Je(Ai))).mult(Ht));u.setLocationAtPoint(u.renderWorldCopies?jt.wrap():jt,V),this._applyUpdatedTransform(u),this._fireMoveEvents(s)}),(()=>{this.terrain&&this._finalizeElevation(),this._afterEase(s)}),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,s)}if(!i){const u=this.handlers;u&&u.stop(!1)}return this}_ease(i,s,u){u.animate===!1||u.duration===0?(i(1),s()):(this._easeStart=f.h.now(),this._easeOptions=u,this._onEaseFrame=i,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,s){i=f.b5(i,-180,180);const u=Math.abs(i-s);return Math.abs(i-360-s)<u&&(i-=360),Math.abs(i+360-s)<u&&(i+=360),i}_normalizeCenter(i){const s=this.transform;if(!s.renderWorldCopies||s.lngRange)return;const u=i.lng-s.center.lng;i.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(f.L.convert(i),this.transform.tileZoom)-this.transform.elevation:null}}class Ya{constructor(i={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options&&this.options.compact,this._container=U.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=U.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=U.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){U.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,s){const u=this._map._getUIString(`AttributionControl.${s}`);i.title=u,i.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map((d=>typeof d!="string"?"":d))):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const s=this._map.style.sourceCaches;for(const d in s){const m=s[d];if(m.used||m.usedForTerrain){const x=m.getSource();x.attribution&&i.indexOf(x.attribution)<0&&i.push(x.attribution)}}i=i.filter((d=>String(d).trim())),i.sort(((d,m)=>d.length-m.length)),i=i.filter(((d,m)=>{for(let x=m+1;x<i.length;x++)if(i[x].indexOf(d)>=0)return!1;return!0}));const u=i.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,i.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class oi{constructor(i={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const u=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=U.create("div","maplibregl-ctrl");const s=U.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){U.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class xn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const s=++this._id;return this._queue.push({callback:i,id:s,cancelled:!1}),s}remove(i){const s=this._currentlyRunning,u=s?this._queue.concat(s):this._queue;for(const d of u)if(d.id===i)return void(d.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const u of s)if(!u.cancelled&&(u.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Lr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var pr=f.Q([{name:"a_pos3d",type:"Int16",components:3}]);class mr extends f.E{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,s){this.sourceCache.update(i,s),this._renderableTilesKeys=[];const u={};for(const d of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))u[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),f.aS(d.posMatrix,0,f.N,0,f.N,0,1),this._tiles[d.key]=new Vr(d,this.tileSize));for(const d in this._tiles)u[d]||delete this._tiles[d]}freeRtt(i){for(const s in this._tiles){const u=this._tiles[s];(!i||u.tileID.equals(i)||u.tileID.isChildOf(i)||i.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((i=>this.getTileByID(i)))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){const s={};for(const u of this._renderableTilesKeys){const d=this._tiles[u].tileID;if(d.canonical.equals(i.canonical)){const m=i.clone();m.posMatrix=new Float64Array(16),f.aS(m.posMatrix,0,f.N,0,f.N,0,1),s[u]=m}else if(d.canonical.isChildOf(i.canonical)){const m=i.clone();m.posMatrix=new Float64Array(16);const x=d.canonical.z-i.canonical.z,w=d.canonical.x-(d.canonical.x>>x<<x),T=d.canonical.y-(d.canonical.y>>x<<x),A=f.N>>x;f.aS(m.posMatrix,0,A,0,A,0,1),f.$(m.posMatrix,m.posMatrix,[-w*A,-T*A,0]),s[u]=m}else if(i.canonical.isChildOf(d.canonical)){const m=i.clone();m.posMatrix=new Float64Array(16);const x=i.canonical.z-d.canonical.z,w=i.canonical.x-(i.canonical.x>>x<<x),T=i.canonical.y-(i.canonical.y>>x<<x),A=f.N>>x;f.aS(m.posMatrix,0,f.N,0,f.N,0,1),f.$(m.posMatrix,m.posMatrix,[w*A,T*A,0]),f.a0(m.posMatrix,m.posMatrix,[1/2**x,1/2**x,0]),s[u]=m}}return s}getSourceTile(i,s){const u=this.sourceCache._source;let d=i.overscaledZ-this.deltaZoom;if(d>u.maxzoom&&(d=u.maxzoom),d<u.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(d).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!m||!m.dem)&&s)for(;d>=u.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(i.scaledTo(d--).key);return m}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter((s=>s.timeAdded>=i))}}class Rr{constructor(i,s,u){this.painter=i,this.sourceCache=new mr(s),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,s,u,d=f.N){var m;if(!(s>=0&&s<d&&u>=0&&u<d))return 0;const x=this.getTerrainData(i),w=(m=x.tile)===null||m===void 0?void 0:m.dem;if(!w)return 0;const T=(function(V,$,j){var re=$[0],ge=$[1];return V[0]=j[0]*re+j[4]*ge+j[12],V[1]=j[1]*re+j[5]*ge+j[13],V})([],[s/d*f.N,u/d*f.N],x.u_terrain_matrix),A=[T[0]*w.dim,T[1]*w.dim],M=Math.floor(A[0]),C=Math.floor(A[1]),B=A[0]-M,q=A[1]-C;return w.get(M,C)*(1-B)*(1-q)+w.get(M+1,C)*B*(1-q)+w.get(M,C+1)*(1-B)*q+w.get(M+1,C+1)*B*q}getElevationForLngLatZoom(i,s){const{tileID:u,mercatorX:d,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(i,s);return this.getElevation(u,d%f.N,m%f.N,f.N)}getElevation(i,s,u,d=f.N){return this.getDEMElevation(i,s,u,d)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const d=this.painter.context,m=new f.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new qt(d,m,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new qt(d,new f.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=f.ao([])}const s=this.sourceCache.getSourceTile(i,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const d=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new qt(d,s.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),s.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const u=s&&s+s.tileID.key+i.key;if(u&&!this._demMatrixCache[u]){const d=this.sourceCache.sourceCache._source.maxzoom;let m=i.canonical.z-s.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=d?m=i.canonical.z-d:f.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=i.canonical.x-(i.canonical.x>>m<<m),w=i.canonical.y-(i.canonical.y>>m<<m),T=f.bc(new Float64Array(16),[1/(f.N<<m),1/(f.N<<m),0]);f.$(T,T,[x*f.N,w*f.N,0]),this._demMatrixCache[i.key]={matrix:T,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(i){const s=this.painter,u=s.width/devicePixelRatio,d=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new qt(s.context,{width:u,height:d,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new qt(s.context,{width:u,height:d,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(u,d,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,u,d))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,x=0;m<this._coordsTextureSize;m++)for(let w=0;w<this._coordsTextureSize;w++,x+=4)s[x+0]=255&w,s[x+1]=255&m,s[x+2]=w>>8<<4|m>>8,s[x+3]=0;const u=new f.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),d=new qt(i,u,i.gl.RGBA,{premultiply:!1});return d.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(i){const s=new Uint8Array(4),u=this.painter.context,d=u.gl;u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,s),u.bindFramebuffer.set(null);const m=s[0]+(s[2]>>4<<8),x=s[1]+((15&s[2])<<8),w=this.coordsIndex[255-s[3]],T=w&&this.sourceCache.getTileByID(w);if(!T)return null;const A=this._coordsTextureSize,M=(1<<T.tileID.canonical.z)*A;return new f.U(this._allowMercatorOverflow(i,(T.tileID.canonical.x*A+m)/M),(T.tileID.canonical.y*A+x)/M,this.getElevation(T.tileID,m,x,A))}getTerrainMesh(){if(this._mesh)return this._mesh;const i=this.painter.context,s=new f.bd,u=new f.b0,d=this.meshSize,m=f.N/d,x=d*d;for(let C=0;C<=d;C++)for(let B=0;B<=d;B++)s.emplaceBack(B*m,C*m,0);for(let C=0;C<x;C+=d+1)for(let B=0;B<d;B++)u.emplaceBack(B+C,d+B+C+1,d+B+C+2),u.emplaceBack(B+C,d+B+C+2,B+C+1);const w=s.length,T=w+2*(d+1);for(const C of[0,1])for(let B=0;B<=d;B++)for(const q of[0,1])s.emplaceBack(B*m,C*f.N,q);for(let C=0;C<2*d;C+=2)u.emplaceBack(T+C,T+C+1,T+C+3),u.emplaceBack(T+C,T+C+3,T+C+2),u.emplaceBack(w+C,w+C+3,w+C+1),u.emplaceBack(w+C,w+C+2,w+C+3);const A=s.length,M=A+2*(d+1);for(const C of[0,1])for(let B=0;B<=d;B++)for(const q of[0,1])s.emplaceBack(C*f.N,B*m,q);for(let C=0;C<2*d;C+=2)u.emplaceBack(A+C,A+C+1,A+C+3),u.emplaceBack(A+C,A+C+3,A+C+2),u.emplaceBack(M+C,M+C+3,M+C+1),u.emplaceBack(M+C,M+C+2,M+C+3);return this._mesh={indexBuffer:i.createIndexBuffer(u),vertexBuffer:i.createVertexBuffer(s,pr.members),segments:f.S.simpleSegment(0,0,s.length,u.length)},this._mesh}getMeshFrameDelta(i){return 2*Math.PI*f.be/Math.pow(2,i)/5}getMinTileElevationForLngLatZoom(i,s){var u;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(i,s);return(u=this.getMinMaxElevation(d).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(i){const s=this.getTerrainData(i).tile,u={minElevation:null,maxElevation:null};return s&&s.dem&&(u.minElevation=s.dem.min*this.exaggeration,u.maxElevation=s.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(i,s){const u=f.U.fromLngLat(i.wrap()),d=(1<<s)*f.N,m=u.x*d,x=u.y*d,w=Math.floor(m/f.N),T=Math.floor(x/f.N);return{tileID:new f.O(s,0,s,w,T),mercatorX:m,mercatorY:x}}_allowMercatorOverflow(i,s){const u=i.x<this.painter.width/2;let d=f.bf(s);const m=this.painter.transform.center.lng;return u&&Math.sign(d)>0&&Math.sign(m)<0||!u&&Math.sign(d)<0&&Math.sign(m)>0?(d=360*Math.sign(m)+d,f.G(d)):s}}class Oc{constructor(i,s,u){this._context=i,this._size=s,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new qt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(u.texture),{id:i,fbo:s,texture:u,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((s=>i.id!==s)),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((i=>!i.inUse))===!1}}const Ka={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Fo{constructor(i,s){this.painter=i,this.terrain=s,this.pool=new Oc(i.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter((u=>!i._layers[u].isHidden(s))),this._coordsDescendingInv={};for(const u in i.sourceCaches){this._coordsDescendingInv[u]={};const d=i.sourceCaches[u].getVisibleCoordinates();for(const m of d){const x=this.terrain.sourceCache.getTerrainCoords(m);for(const w in x)this._coordsDescendingInv[u][w]||(this._coordsDescendingInv[u][w]=[]),this._coordsDescendingInv[u][w].push(x[w])}}this._coordsDescendingInvStr={};for(const u of i._order){const d=i._layers[u],m=d.source;if(Ka[d.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const x in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][x]=this._coordsDescendingInv[m][x].map((w=>w.key)).sort().join()}}for(const u of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[d][u.tileID.key];m&&m!==u.rttCoords[d]&&(u.rtt=[])}}renderLayer(i){if(i.isHidden(this.painter.transform.zoom))return!1;const s=i.type,u=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if(Ka[s]&&(this._prevType&&Ka[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(i.id),!d))return!0;if(Ka[this._prevType]||Ka[s]&&d){this._prevType=s;const m=this._stacks.length-1,x=this._stacks[m]||[];for(const w of this._renderableTiles){if(this.pool.isFull()&&(ua(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(w),w.rtt[m]){const A=this.pool.getObjectForId(w.rtt[m].id);if(A.stamp===w.rtt[m].stamp){this.pool.useObject(A);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),w.rtt[m]={id:T.id,stamp:T.stamp},u.context.bindFramebuffer.set(T.fbo.framebuffer),u.context.clear({color:f.aT.transparent,stencil:0}),u.currentStencilSource=void 0;for(let A=0;A<x.length;A++){const M=u.style._layers[x[A]],C=M.source?this._coordsDescendingInv[M.source][w.tileID.key]:[w.tileID];u.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),u._renderTileClippingMasks(M,C),u.renderLayer(u,u.style.sourceCaches[M.source],M,C),M.source&&(w.rttCoords[M.source]=this._coordsDescendingInvStr[M.source][w.tileID.key])}}return ua(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Ka[s]}return!1}}const wt=Oe,mt={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:f.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Ri=p=>{p.touchstart=p.dragStart,p.touchmoveWindow=p.dragMove,p.touchend=p.dragEnd},li={showCompass:!0,showZoom:!0,visualizePitch:!1};class Br{constructor(i,s,u=!1){this.mousedown=x=>{this.startMouse(f.e({},x,{ctrlKey:!0,preventDefault:()=>x.preventDefault()}),U.mousePos(this.element,x)),U.addEventListener(window,"mousemove",this.mousemove),U.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.moveMouse(x,U.mousePos(this.element,x))},this.mouseup=x=>{this.mouseRotate.dragEnd(x),this.mousePitch&&this.mousePitch.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=U.touchPos(this.element,x.targetTouches)[0],this.startTouch(x,this._startPos),U.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),U.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=U.touchPos(this.element,x.targetTouches)[0],this.moveTouch(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=i.dragRotate._mouseRotate.getClickTolerance(),m=i.dragRotate._mousePitch.getClickTolerance();this.element=s,this.mouseRotate=sn({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:x,clickTolerance:w,bearingDegreesPerPixelMoved:T=.8})=>{const A=new Vu;return new ts({clickTolerance:w,move:(M,C)=>({bearingDelta:(C.x-M.x)*T}),moveStateManager:A,enable:x,assignEvents:Ri})})({clickTolerance:d,enable:!0}),this.map=i,u&&(this.mousePitch=tr({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:x,clickTolerance:w,pitchDegreesPerPixelMoved:T=-.5})=>{const A=new Vu;return new ts({clickTolerance:w,move:(M,C)=>({pitchDelta:(C.y-M.y)*T}),moveStateManager:A,enable:x,assignEvents:Ri})})({clickTolerance:m,enable:!0})),U.addEventListener(s,"mousedown",this.mousedown),U.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),U.addEventListener(s,"touchcancel",this.reset)}startMouse(i,s){this.mouseRotate.dragStart(i,s),this.mousePitch&&this.mousePitch.dragStart(i,s),U.disableDrag()}startTouch(i,s){this.touchRotate.dragStart(i,s),this.touchPitch&&this.touchPitch.dragStart(i,s),U.disableDrag()}moveMouse(i,s){const u=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(i,s)||{};if(d&&u.setBearing(u.getBearing()+d),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(i,s)||{};m&&u.setPitch(u.getPitch()+m)}}moveTouch(i,s){const u=this.map,{bearingDelta:d}=this.touchRotate.dragMove(i,s)||{};if(d&&u.setBearing(u.getBearing()+d),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(i,s)||{};m&&u.setPitch(u.getPitch()+m)}}off(){const i=this.element;U.removeEventListener(i,"mousedown",this.mousedown),U.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),U.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),U.removeEventListener(window,"touchend",this.touchend),U.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){U.enableDrag(),U.removeEventListener(window,"mousemove",this.mousemove),U.removeEventListener(window,"mouseup",this.mouseup),U.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),U.removeEventListener(window,"touchend",this.touchend)}}let wi;function _l(p,i,s){if(p=new f.L(p.lng,p.lat),i){const u=new f.L(p.lng-360,p.lat),d=new f.L(p.lng+360,p.lat),m=s.locationPoint(p).distSqr(i);s.locationPoint(u).distSqr(i)<m?p=u:s.locationPoint(d).distSqr(i)<m&&(p=d)}for(;Math.abs(p.lng-s.center.lng)>180;){const u=s.locationPoint(p);if(u.x>=0&&u.y>=0&&u.x<=s.width&&u.y<=s.height)break;p.lng>s.center.lng?p.lng-=360:p.lng+=360}return p}const ka={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qu(p,i,s){const u=p.classList;for(const d in ka)u.remove(`maplibregl-${s}-anchor-${d}`);u.add(`maplibregl-${s}-anchor-${i}`)}class zs extends f.E{constructor(i){if(super(),this._onKeyPress=s=>{const u=s.code,d=s.charCode||s.keyCode;u!=="Space"&&u!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=s=>{const u=s.originalEvent.target,d=this._element;this._popup&&(u===d||d.contains(u))&&this.togglePopup()},this._update=s=>{if(!this._map)return;const u=this._map.loaded()&&!this._map.isMoving();(s?.type==="terrain"||s?.type==="render"&&!u)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=_l(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m=`rotateX(${this._map.getPitch()}deg)`),s&&s.type!=="moveend"||(this._pos=this._pos.round()),U.setTransform(this._element,`${ka[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${d}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout((()=>{const x=this._map.unproject(this._pos),w=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=x.distanceTo(this._lngLat)>20*w?"0.2":"1.0",this._opacityTimeout=null}),100))},this._onMove=s=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new f.k("dragstart"))),this.fire(new f.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new f.k("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=f.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=U.create("div"),this._element.setAttribute("aria-label","Map marker");const s=U.createNS("http://www.w3.org/2000/svg","svg"),u=41,d=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${u}px`),s.setAttributeNS(null,"width",`${d}px`),s.setAttributeNS(null,"viewBox",`0 0 ${d} ${u}`);const m=U.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const x=U.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const w=U.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const re of T){const ge=U.createNS("http://www.w3.org/2000/svg","ellipse");ge.setAttributeNS(null,"opacity","0.04"),ge.setAttributeNS(null,"cx","10.5"),ge.setAttributeNS(null,"cy","5.80029008"),ge.setAttributeNS(null,"rx",re.rx),ge.setAttributeNS(null,"ry",re.ry),w.appendChild(ge)}const A=U.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill",this._color);const M=U.createNS("http://www.w3.org/2000/svg","path");M.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),A.appendChild(M);const C=U.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"opacity","0.25"),C.setAttributeNS(null,"fill","#000000");const B=U.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),C.appendChild(B);const q=U.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");const V=U.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(8.0, 8.0)");const $=U.createNS("http://www.w3.org/2000/svg","circle");$.setAttributeNS(null,"fill","#000000"),$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"cx","5.5"),$.setAttributeNS(null,"cy","5.5"),$.setAttributeNS(null,"r","5.4999962");const j=U.createNS("http://www.w3.org/2000/svg","circle");j.setAttributeNS(null,"fill","#FFFFFF"),j.setAttributeNS(null,"cx","5.5"),j.setAttributeNS(null,"cy","5.5"),j.setAttributeNS(null,"r","5.4999962"),V.appendChild($),V.appendChild(j),x.appendChild(w),x.appendChild(A),x.appendChild(C),x.appendChild(q),x.appendChild(V),s.appendChild(x),s.setAttributeNS(null,"height",u*this._scale+"px"),s.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(s),this._offset=f.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(s=>{s.preventDefault()})),this._element.addEventListener("mousedown",(s=>{s.preventDefault()})),qu(this._element,this._anchor,"marker"),i&&i.className)for(const s of i.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),U.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=f.L.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const d=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?i.remove():i.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(i){return this._offset=f.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Ni={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let zi=0,Ms=!1;const os={maxWidth:100,unit:"metric"};function oo(p,i,s){const u=s&&s.maxWidth||100,d=p._container.clientHeight/2,m=p.unproject([0,d]),x=p.unproject([u,d]),w=m.distanceTo(x);if(s&&s.unit==="imperial"){const T=3.2808*w;T>5280?Un(i,u,T/5280,p._getUIString("ScaleControl.Miles")):Un(i,u,T,p._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?Un(i,u,w/1852,p._getUIString("ScaleControl.NauticalMiles")):w>=1e3?Un(i,u,w/1e3,p._getUIString("ScaleControl.Kilometers")):Un(i,u,w,p._getUIString("ScaleControl.Meters"))}function Un(p,i,s,u){const d=(function(m){const x=Math.pow(10,`${Math.floor(m)}`.length-1);let w=m/x;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:(function(T){const A=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*A)/A})(w),x*w})(s);p.style.width=i*(d/s)+"px",p.innerHTML=`${d}&nbsp;${u}`}const gr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Or=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ln(p){if(p){if(typeof p=="number"){const i=Math.round(Math.abs(p)/Math.SQRT2);return{center:new f.P(0,0),top:new f.P(0,p),"top-left":new f.P(i,i),"top-right":new f.P(-i,i),bottom:new f.P(0,-p),"bottom-left":new f.P(i,-i),"bottom-right":new f.P(-i,-i),left:new f.P(p,0),right:new f.P(-p,0)}}if(p instanceof f.P||Array.isArray(p)){const i=f.P.convert(p);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:f.P.convert(p.center||[0,0]),top:f.P.convert(p.top||[0,0]),"top-left":f.P.convert(p["top-left"]||[0,0]),"top-right":f.P.convert(p["top-right"]||[0,0]),bottom:f.P.convert(p.bottom||[0,0]),"bottom-left":f.P.convert(p["bottom-left"]||[0,0]),"bottom-right":f.P.convert(p["bottom-right"]||[0,0]),left:f.P.convert(p.left||[0,0]),right:f.P.convert(p.right||[0,0])}}return Ln(new f.P(0,0))}const vl={extend:(p,...i)=>f.e(p,...i),run(p){p()},logToElement(p,i=!1,s="log"){const u=window.document.getElementById(s);u&&(i&&(u.innerHTML=""),u.innerHTML+=`<br>${p}`)}},xl=Oe;class ri{static get version(){return xl}static get workerCount(){return Er.workerCount}static set workerCount(i){Er.workerCount=i}static get maxParallelImageRequests(){return f.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(i){f.c.MAX_PARALLEL_IMAGE_REQUESTS=i}static get workerUrl(){return f.c.WORKER_URL}static set workerUrl(i){f.c.WORKER_URL=i}static addProtocol(i,s){f.c.REGISTERED_PROTOCOLS[i]=s}static removeProtocol(i){delete f.c.REGISTERED_PROTOCOLS[i]}}return ri.Map=class extends yl{constructor(p){if(f.bg.mark(f.bh.create),(p=f.e({},mt,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new rn(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),{bearingSnap:p.bearingSnap}),this._cooperativeGesturesOnWheel=i=>{this._onCooperativeGesture(i,i[this._metaKey],1)},this._contextLost=i=>{i.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new f.k("webglcontextlost",{originalEvent:i}))},this._contextRestored=i=>{this._setupPainter(),this.resize(),this._update(),this.fire(new f.k("webglcontextrestored",{originalEvent:i}))},this._onMapScroll=i=>{if(i.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._cooperativeGestures=p.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._renderTaskQueue=new xn,this._controls=[],this._mapId=f.a2(),this._locale=f.e({},Lr,p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this._imageQueueHandle=nt.addThrottleControl((()=>this.isMoving())),this._requestManager=new it(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let i=!1;const s=fr((u=>{this._trackResize&&!this._removed&&this.resize(u)._update()}),50);this._resizeObserver=new ResizeObserver((u=>{i?s(u):i=!0})),this._resizeObserver.observe(this._container)}this.handlers=new As(this,p),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=p.hash&&new Ro(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,f.e({},p.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new Ya({customAttribution:p.customAttribution})),p.maplibreLogo&&this.addControl(new oi,p.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(i=>{this._update(i.dataType==="style"),this.fire(new f.k(`${i.dataType}data`,i))})),this.on("dataloading",(i=>{this.fire(new f.k(`${i.dataType}dataloading`,i))})),this.on("dataabort",(i=>{this.fire(new f.k("sourcedataabort",i))}))}_getMapId(){return this._mapId}addControl(p,i){if(i===void 0&&(i=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new f.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=p.onAdd(this);this._controls.push(p);const u=this._controlPositions[i];return i.indexOf("bottom")!==-1?u.insertBefore(s,u.firstChild):u.appendChild(s),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new f.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(p);return i>-1&&this._controls.splice(i,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}calculateCameraOptionsFromTo(p,i,s,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,i,s,u)}resize(p){var i;const s=this._containerDimensions(),u=s[0],d=s[1],m=this._getClampedPixelRatio(u,d);if(this._resizeCanvas(u,d,m),this.painter.resize(u,d,m),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const T=this._getClampedPixelRatio(u,d);this._resizeCanvas(u,d,T),this.painter.resize(u,d,T)}this.transform.resize(u,d),(i=this._requestedCameraState)===null||i===void 0||i.resize(u,d);const x=!this._moving;return x&&(this.stop(),this.fire(new f.k("movestart",p)).fire(new f.k("move",p))),this.fire(new f.k("resize",p)),x&&this.fire(new f.k("moveend",p)),this}_getClampedPixelRatio(p,i){const{0:s,1:u}=this._maxCanvasSize,d=this.getPixelRatio(),m=p*d,x=i*d;return Math.min(m>s?s/m:1,x>u?u/x:1)*d}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(Ze.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(p){return this._cooperativeGestures=p,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(p){return this.transform.locationPoint(f.L.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.pointLocation(f.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,i,s){if(p==="mouseenter"||p==="mouseover"){let u=!1;return{layer:i,listener:s,delegates:{mousemove:m=>{const x=this.getLayer(i)?this.queryRenderedFeatures(m.point,{layers:[i]}):[];x.length?u||(u=!0,s.call(this,new _n(p,this,m.originalEvent,{features:x}))):u=!1},mouseout:()=>{u=!1}}}}if(p==="mouseleave"||p==="mouseout"){let u=!1;return{layer:i,listener:s,delegates:{mousemove:x=>{(this.getLayer(i)?this.queryRenderedFeatures(x.point,{layers:[i]}):[]).length?u=!0:u&&(u=!1,s.call(this,new _n(p,this,x.originalEvent)))},mouseout:x=>{u&&(u=!1,s.call(this,new _n(p,this,x.originalEvent)))}}}}{const u=d=>{const m=this.getLayer(i)?this.queryRenderedFeatures(d.point,{layers:[i]}):[];m.length&&(d.features=m,s.call(this,d),delete d.features)};return{layer:i,listener:s,delegates:{[p]:u}}}}on(p,i,s){if(s===void 0)return super.on(p,i);const u=this._createDelegatedListener(p,i,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(u);for(const d in u.delegates)this.on(d,u.delegates[d]);return this}once(p,i,s){if(s===void 0)return super.once(p,i);const u=this._createDelegatedListener(p,i,s);for(const d in u.delegates)this.once(d,u.delegates[d]);return this}off(p,i,s){return s===void 0?super.off(p,i):(this._delegatedListeners&&this._delegatedListeners[p]&&(u=>{const d=this._delegatedListeners[p];for(let m=0;m<d.length;m++){const x=d[m];if(x.layer===i&&x.listener===s){for(const w in x.delegates)this.off(w,x.delegates[w]);return d.splice(m,1),this}}})(),this)}queryRenderedFeatures(p,i){if(!this.style)return[];let s;const u=p instanceof f.P||Array.isArray(p),d=u?p:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(u?{}:p)||{},d instanceof f.P||typeof d[0]=="number")s=[f.P.convert(d)];else{const m=f.P.convert(d[0]),x=f.P.convert(d[1]);s=[m,new f.P(x.x,m.y),x,new f.P(m.x,x.y),m]}return this.style.queryRenderedFeatures(s,i,this.transform)}querySourceFeatures(p,i){return this.style.querySourceFeatures(p,i)}setStyle(p,i){return(i=f.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(p,i))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const i=this._locale[p];if(i==null)throw new Error(`Missing UI string '${p}'`);return i}_updateStyle(p,i){if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(p,i)));const s=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new Ma(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,i,s):this.style.loadJSON(p,i,s),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ma(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,i){if(typeof p=="string"){const s=this._requestManager.transformRequest(p,Ge.Style);f.f(s,((u,d)=>{u?this.fire(new f.j(u)):d&&this._updateDiff(d,i)}))}else typeof p=="object"&&this._updateDiff(p,i)}_updateDiff(p,i){try{this.style.setState(p,i)&&this._update(!0)}catch(s){f.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(p,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():f.w("There is no style added to the map.")}addSource(p,i){return this._lazyInitEmptyStyle(),this.style.addSource(p,i),this._update(!0)}isSourceLoaded(p){const i=this.style&&this.style.sourceCaches[p];if(i!==void 0)return i.loaded();this.fire(new f.j(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const i=this.style.sourceCaches[p.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);for(const s in this.style._layers){const u=this.style._layers[s];u.type==="hillshade"&&u.source===p.source&&f.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Rr(this.painter,i,p),this.painter.renderToTexture=new Fo(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=s=>{s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==p.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new f.k("terrain",{terrain:p})),this}getTerrain(){var p,i;return(i=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const i in p){const s=p[i]._tiles;for(const u in s){const d=s[u];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}addSourceType(p,i,s){return this._lazyInitEmptyStyle(),this.style.addSourceType(p,i,s)}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,i,s={}){const{pixelRatio:u=1,sdf:d=!1,stretchX:m,stretchY:x,content:w}=s;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||f.a(i))){if(i.width===void 0||i.height===void 0)return this.fire(new f.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:A,data:M}=i,C=i;return this.style.addImage(p,{data:new f.R({width:T,height:A},new Uint8Array(M)),pixelRatio:u,stretchX:m,stretchY:x,content:w,sdf:d,version:0,userImage:C}),C.onAdd&&C.onAdd(this,p),this}}{const{width:T,height:A,data:M}=f.h.getImageData(i);this.style.addImage(p,{data:new f.R({width:T,height:A},M),pixelRatio:u,stretchX:m,stretchY:x,content:w,sdf:d,version:0})}}updateImage(p,i){const s=this.style.getImage(p);if(!s)return this.fire(new f.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=i instanceof HTMLImageElement||f.a(i)?f.h.getImageData(i):i,{width:d,height:m,data:x}=u;if(d===void 0||m===void 0)return this.fire(new f.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==s.data.width||m!==s.data.height)return this.fire(new f.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(i instanceof HTMLImageElement||f.a(i));return s.data.replace(x,w),this.style.updateImage(p,s),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new f.j(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,i){nt.getImage(this._requestManager.transformRequest(p,Ge.Image),i)}listImages(){return this.style.listImages()}addLayer(p,i){return this._lazyInitEmptyStyle(),this.style.addLayer(p,i),this._update(!0)}moveLayer(p,i){return this.style.moveLayer(p,i),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,i,s){return this.style.setLayerZoomRange(p,i,s),this._update(!0)}setFilter(p,i,s={}){return this.style.setFilter(p,i,s),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,i,s,u={}){return this.style.setPaintProperty(p,i,s,u),this._update(!0)}getPaintProperty(p,i){return this.style.getPaintProperty(p,i)}setLayoutProperty(p,i,s,u={}){return this.style.setLayoutProperty(p,i,s,u),this._update(!0)}getLayoutProperty(p,i){return this.style.getLayoutProperty(p,i)}setGlyphs(p,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,i,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,i,s,(u=>{u||this._update(!0)})),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,i,(s=>{s||this._update(!0)})),this}setLight(p,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,i),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(p,i){return this.style.setFeatureState(p,i),this._update()}removeFeatureState(p,i){return this.style.removeFeatureState(p,i),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,i=0;return this._container&&(p=this._container.clientWidth||400,i=this._container.clientHeight||300),[p,i]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const i=this._canvasContainer=U.create("div","maplibregl-canvas-container",p);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=U.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),u=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],u);const d=this._controlContainer=U.create("div","maplibregl-control-container",p),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((x=>{m[x]=U.create("div",`maplibregl-ctrl-${x} `,d)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=U.create("div","maplibregl-cooperative-gesture-screen",this._container);let p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${p}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){U.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(p,i,s){this._canvas.width=Math.floor(s*p),this._canvas.height=Math.floor(s*i),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const p={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let i=null;this._canvas.addEventListener("webglcontextcreationerror",(u=>{i={requestedAttributes:p},u&&(i.statusMessage=u.statusMessage,i.type=u.type)}),{once:!0});const s=this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p);if(!s){const u="Failed to initialize WebGL";throw i?(i.message=u,new Error(JSON.stringify(i))):new Error(u)}this.painter=new ao(s,this.transform),ut.testSupport(s)}_onCooperativeGesture(p,i,s){return!i&&s<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout((()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")}),100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,m=f.h.now();this.style.zoomHistory.update(d,m);const x=new f.a8(d,{now:m,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),w=x.crossFadingFactor();w===1&&w===this._crossFadingFactor||(s=!0,this._crossFadingFactor=w),this.style.update(x)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new f.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,f.bg.mark(f.bh.load),this.fire(new f.k("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new f.k("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,f.bg.mark(f.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),nt.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),U.remove(this._canvasContainer),U.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),f.bg.clearMetrics(),this._removed=!0,this.fire(new f.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=f.h.frame((p=>{f.bg.frame(p),this._frame=null,this._render(p)})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return wt}getCameraTargetElevation(){return this.transform.elevation}},ri.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const i=this._map.getZoom(),s=i===this._map.getMaxZoom(),u=i===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=i},this._setButtonTitle=(i,s)=>{const u=this._map._getUIString(`NavigationControl.${s}`);i.title=u,i.setAttribute("aria-label",u)},this.options=f.e({},li,p),this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(i=>i.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(i=>this._map.zoomIn({},{originalEvent:i}))),U.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(i=>this._map.zoomOut({},{originalEvent:i}))),U.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})})),this._compassIcon=U.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Br(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){U.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,i){const s=U.create("button",p,this._container);return s.type="button",s.addEventListener("click",i),s}},ri.GeolocateControl=class extends f.E{constructor(p){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new f.k("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new f.k("geolocate",i)),this._finish()}},this._updateCamera=i=>{const s=new f.L(i.coords.longitude,i.coords.latitude),u=i.coords.accuracy,d=this._map.getBearing(),m=f.e({bearing:d},this.options.fitBoundsOptions),x=Ze.fromLngLat(s,u);this._map.fitBounds(x,m,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const s=new f.L(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&Ms)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new f.k("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=i=>{if(this._map){if(this._container.addEventListener("contextmenu",(s=>s.preventDefault())),this._geolocateButton=U.create("button","maplibregl-ctrl-geolocate",this._container),U.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",i===!1){f.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=U.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new zs({element:this._dotElement}),this._circleElement=U.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new zs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new f.k("trackuserlocationend")))}))}},this.options=f.e({},Ni,p)}onAdd(p){return this._map=p,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),(function(i,s=!1){wi===void 0||s?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then((u=>{wi=u.state!=="denied",i(wi)})).catch((()=>{wi=!!window.navigator.geolocation,i(wi)})):(wi=!!window.navigator.geolocation,i(wi)):i(wi)})(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),U.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,zi=0,Ms=!1}_isOutOfMapMaxBounds(p){const i=this._map.getMaxBounds(),s=p.coords;return i&&(s.longitude<i.getWest()||s.longitude>i.getEast()||s.latitude<i.getSouth()||s.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const p=this._map.getBounds(),i=p.getSouthEast(),s=p.getNorthEast(),u=i.distanceTo(s),d=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return f.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new f.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":zi--,Ms=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new f.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new f.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),zi++,zi>1?(p={maximumAge:6e5,timeout:0},Ms=!0):(p=this.options.positionOptions,Ms=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},ri.AttributionControl=Ya,ri.LogoControl=oi,ri.ScaleControl=class{constructor(p){this._onMove=()=>{oo(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,oo(this._map,this._container,this.options)},this.options=f.e({},os,p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){U.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},ri.FullscreenControl=class extends f.E{constructor(p={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:f.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){U.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=U.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);U.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new f.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new f.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},ri.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=p}onAdd(p){return this._map=p,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=U.create("button","maplibregl-ctrl-terrain",this._container),U.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){U.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},ri.Popup=class extends f.E{constructor(p){super(),this.remove=()=>(this._content&&U.remove(this._content),this._container&&(U.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new f.k("close")),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=U.create("div","maplibregl-popup",this._map.getContainer()),this._tip=U.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=_l(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!i)return;const s=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);let u=this.options.anchor;const d=Ln(this.options.offset);if(!u){const x=this._container.offsetWidth,w=this._container.offsetHeight;let T;T=s.y+d.bottom.y<w?["top"]:s.y>this._map.transform.height-w?["bottom"]:[],s.x<x/2?T.push("left"):s.x>this._map.transform.width-x/2&&T.push("right"),u=T.length===0?"bottom":T.join("-")}const m=s.add(d[u]).round();U.setTransform(this._container,`${ka[u]} translate(${m.x}px,${m.y}px)`),qu(this._container,u,"popup")},this._onClose=()=>{this.remove()},this.options=f.e(Object.create(gr),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new f.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=f.L.convert(p),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const i=document.createDocumentFragment(),s=document.createElement("body");let u;for(s.innerHTML=p;u=s.firstChild,u;)i.appendChild(u);return this.setDOMContent(i)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=U.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){this._container&&this._container.classList.add(p)}removeClassName(p){this._container&&this._container.classList.remove(p)}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}_createCloseButton(){this.options.closeButton&&(this._closeButton=U.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Or);p&&p.focus()}},ri.Marker=zs,ri.Style=Ma,ri.LngLat=f.L,ri.LngLatBounds=Ze,ri.Point=f.P,ri.MercatorCoordinate=f.U,ri.Evented=f.E,ri.AJAXError=f.bi,ri.config=f.c,ri.CanvasSource=Tr,ri.GeoJSONSource=Oi,ri.ImageSource=Wi,ri.RasterDEMTileSource=Pt,ri.RasterTileSource=Rt,ri.VectorTileSource=kt,ri.VideoSource=pn,ri.setRTLTextPlugin=f.bj,ri.getRTLTextPluginStatus=f.bk,ri.prewarm=function(){Vs().acquire($t)},ri.clearPrewarmedResources=function(){const p=Ar;p&&(p.isPreloaded()&&p.numActive()===1?(p.release($t),Ar=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},vl.extend(ri,{isSafari:f.ac,getPerformanceMetrics:f.bg.getPerformanceMetrics}),ri}));var Fe=Ve;return Fe}))})(Kf)),Kf.exports}var Cm=Mm();const Fd=ym(Cm),Dm="FeatureCollection",Im=[{type:"Feature",properties:{name:"safe_zone",color:"green"},geometry:{type:"Polygon",coordinates:[[[-1.8971911052954624,51.673292471500815],[-1.9007367325216364,51.672850067696174],[-1.903260196944018,51.67141717795067],[-1.9019186082634008,51.66888144630593],[-1.8975850638765905,51.66884182437272],[-1.8955833283849017,51.67180676997219],[-1.8971911052954624,51.673292471500815]]]}},{type:"Feature",properties:{name:"danger_zone",color:"red"},geometry:{type:"Polygon",coordinates:[[[-1.9290772606398434,51.67561914471952],[-1.936729106903499,51.67235323149549],[-1.935644837189642,51.666012845300145],[-1.9279000535221087,51.666012845300145],[-1.9186372922544308,51.66952898725427],[-1.9159111284031098,51.67471623932332],[-1.9236868912065859,51.67606098548177],[-1.9290772606398434,51.67561914471952]]]}}],Yp={type:Dm,features:Im},km=ne=>{const ye=new Fd.LngLatBounds;let Me=!1;const Q=Ve=>{if(Array.isArray(Ve)){if(typeof Ve[0]=="number"&&typeof Ve[1]=="number"){ye.extend(Ve),Me=!0;return}Ve.forEach(Q)}};return ne?.features?.forEach(Ve=>{Q(Ve?.geometry?.coordinates)}),Me?ye:null};function Lm({apiKey:ne,region:ye="eu-west-2",styleName:Me="Standard",colorScheme:Q="Light",center:Ve=[-123.115898,49.295868],zoom:$e=11,height:Fe="100vh",geoJsonUrl:f,mapRef:Oe}){const U=Mt.useRef(null),ut=Mt.useRef(null),Ue=Oe??ut;return Mt.useEffect(()=>{if(!U.current)return;const pe=typeof Q=="string"&&Q.toLowerCase()==="dark"?"Dark":"Light",ft=encodeURIComponent(Me),ct=new Fd.Map({container:U.current,style:`https://maps.geo.${ye}.amazonaws.com/v2/styles/${ft}/descriptor?key=${ne}&color-scheme=${pe}`,center:Ve,zoom:$e});ct.on("error",Ge=>{if(Ge?.error?.message?.includes("Expected value to be of type number")){console.debug("MapLibre suppressed non-fatal error:",Ge.error?.message);return}console.error("MapLibre error:",Ge.error||Ge)}),ct.on("load",()=>{ct.resize()});const Qe=()=>{ct.resize()};window.addEventListener("resize",Qe);let nt;return typeof ResizeObserver<"u"&&(nt=new ResizeObserver(()=>{ct.resize()}),nt.observe(U.current)),ct.addControl(new Fd.NavigationControl,"top-left"),Ue.current=ct,()=>{Ue.current=null,window.removeEventListener("resize",Qe),nt&&nt.disconnect(),ct.remove()}},[ne,ye,Me,Q,Ve,$e,Ue]),Mt.useEffect(()=>{const pe=Ue.current;if(!pe)return;const ft="fake-s3-features",ct=`${ft}-polygon-fill`,Qe=`${ft}-polygon-outline`,nt=`${ft}-points`;let Ge=null,it=!0;const bt=Pe=>JSON.parse(JSON.stringify(Pe)),St=Pe=>{const Et=pe.getSource(ft);Et&&typeof Et.setData=="function"?Et.setData(Pe):(pe.getLayer(nt)&&pe.removeLayer(nt),pe.getLayer(Qe)&&pe.removeLayer(Qe),pe.getLayer(ct)&&pe.removeLayer(ct),Et&&pe.removeSource(ft),pe.addSource(ft,{type:"geojson",data:Pe}),pe.addLayer({id:ct,type:"fill",source:ft,filter:["==","$type","Polygon"],paint:{"fill-color":["coalesce",["get","color"],"#4F46E5"],"fill-opacity":.3}}),pe.addLayer({id:Qe,type:"line",source:ft,filter:["==","$type","Polygon"],paint:{"line-color":"#312E81","line-width":2}}),pe.addLayer({id:nt,type:"circle",source:ft,filter:["==","$type","Point"],paint:{"circle-radius":6,"circle-color":["coalesce",["get","color"],"#DC2626"],"circle-stroke-color":"#FFFFFF","circle-stroke-width":2}})),pe.resize();const pi=km(Pe);pi&&pe.fitBounds(pi,{padding:40,maxZoom:13,duration:800})},Vt=async()=>{if(!it)return;Ge&&Ge.abort();const Pe=new AbortController;Ge=Pe;let Et=null,pi=!1;const qt=async()=>{if(!f)return null;const xi=await fetch(f,{mode:"cors",signal:Pe.signal});if(!xi.ok)throw new Error(`GeoJSON fetch failed: ${xi.status} ${xi.statusText}`);return xi.json()};try{Et=await qt()}catch(xi){if(xi.name==="AbortError")return;console.warn("Remote GeoJSON failed to load – falling back to embedded hazard zones dataset.",xi),Et=bt(Yp),pi=!0}if(Et||(Et=bt(Yp),pi=!0),!Et){console.error("MapLibreMap could not load any GeoJSON data for geofenced segments.");return}it&&(St(Et),pi&&console.info("MapLibreMap is rendering geofence polygons from the embedded fallback dataset."))},Dt=()=>{Vt()};return pe.loaded()?Vt():pe.once("load",Dt),()=>{it=!1,Ge&&Ge.abort(),pe.off("load",Dt)}},[f,Ue]),ee.jsx("div",{ref:U,style:{height:Fe,width:"100%"}})}const Rm="modulepreload",Bm=function(ne){return"/"+ne},Kp={},bp=function(ye,Me,Q){let Ve=Promise.resolve();if(Me&&Me.length>0){let Oe=function(U){return Promise.all(U.map(ut=>Promise.resolve(ut).then(Ue=>({status:"fulfilled",value:Ue}),Ue=>({status:"rejected",reason:Ue}))))};document.getElementsByTagName("link");const Fe=document.querySelector("meta[property=csp-nonce]"),f=Fe?.nonce||Fe?.getAttribute("nonce");Ve=Oe(Me.map(U=>{if(U=Bm(U),U in Kp)return;Kp[U]=!0;const ut=U.endsWith(".css"),Ue=ut?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${U}"]${Ue}`))return;const pe=document.createElement("link");if(pe.rel=ut?"stylesheet":Rm,ut||(pe.as="script"),pe.crossOrigin="",pe.href=U,f&&pe.setAttribute("nonce",f),document.head.appendChild(pe),ut)return new Promise((ft,ct)=>{pe.addEventListener("load",ft),pe.addEventListener("error",()=>ct(new Error(`Unable to preload CSS for ${U}`)))})}))}function $e(Fe){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=Fe,window.dispatchEvent(f),!f.defaultPrevented)throw Fe}return Ve.then(Fe=>{for(const f of Fe||[])f.status==="rejected"&&$e(f.reason);return ye().catch($e)})},wp=ne=>{if(ne==null)return"";if(Array.isArray(ne))return ne.map(ye=>ye==null?"":typeof ye=="object"?JSON.stringify(ye):String(ye)).join("; ");if(typeof ne=="object")try{return JSON.stringify(ne)}catch{return"[object]"}return String(ne)},Om=ne=>{const ye=wp(ne),Me=/[",\n]/.test(ye),Q=ye.replace(/"/g,'""');return Me?`"${Q}"`:Q},Qp=(ne,ye)=>{const Me=URL.createObjectURL(ne),Q=document.createElement("a");Q.href=Me,Q.download=ye,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(Me)};function Pm({pinData:ne,isLoading:ye,error:Me}){const[Q,Ve]=Mt.useState(!1),[$e,Fe]=Mt.useState(!1),f=Mt.useRef(null),Oe=Mt.useMemo(()=>{if(!ne||!Array.isArray(ne)||ne.length===0)return null;const ct=new Set;ne.forEach(Ge=>{Object.keys(Ge||{}).forEach(it=>ct.add(it))});const Qe=Array.from(ct),nt=ne.map(Ge=>Qe.map(it=>wp(Ge?Ge[it]:"")));return{headers:Qe,rows:nt}},[ne]);if(Mt.useEffect(()=>{if(!$e)return;const ct=nt=>{f.current&&!f.current.contains(nt.target)&&Fe(!1)},Qe=nt=>{nt.key==="Escape"&&Fe(!1)};return document.addEventListener("mousedown",ct),document.addEventListener("keydown",Qe),()=>{document.removeEventListener("mousedown",ct),document.removeEventListener("keydown",Qe)}},[$e]),Mt.useEffect(()=>{Q&&Fe(!1)},[Q]),ye)return ee.jsx("div",{style:{position:"fixed",top:"20px",right:"20px",backgroundColor:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",minWidth:"280px",zIndex:1e3,fontFamily:"sans-serif"},children:ee.jsx("div",{style:{color:"#6B7280",fontSize:"14px"},children:"Loading statistics..."})});if(Me)return ee.jsx("div",{style:{position:"fixed",bottom:"20px",left:"20px",backgroundColor:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",minWidth:"280px",zIndex:1e3,fontFamily:"sans-serif"},children:ee.jsx("div",{style:{color:"#DC2626",fontSize:"14px"},children:"Error loading statistics"})});if(!Oe)return null;const U=ne.length,ut=ne.filter(ct=>ct.to_evacuate===!0).length,Ue=ne.filter(ct=>ct.to_evacuate===!1).length,pe=async ct=>{if(!Oe)return;const Qe=new Date().toISOString().slice(0,10);if(ct==="csv"){const nt=Oe.rows.map(bt=>bt.map(St=>Om(St)).join(",")),Ge=[Oe.headers.join(","),...nt].join(`\r
`),it=new Blob([Ge],{type:"text/csv;charset=utf-8;"});Qp(it,`entitled-persons-${Qe}.csv`);return}if(ct==="pdf"){const[{default:nt},{default:Ge}]=await Promise.all([bp(()=>import("./jspdf.es.min-C0U12b_I.js").then(bt=>bt.j),[]),bp(()=>import("./jspdf.plugin.autotable-iy_ebv8X.js"),[])]),it=new nt({orientation:"landscape"});it.setFontSize(16),it.text("Entitled Persons",14,18),it.setFontSize(10),it.text(`Generated ${new Date().toLocaleString()}`,14,26),Ge(it,{startY:32,head:[Oe.headers],body:Oe.rows,styles:{fontSize:8,cellWidth:"wrap"},headStyles:{fillColor:[29,78,216],textColor:255},alternateRowStyles:{fillColor:[241,245,249]}}),it.save(`entitled-persons-${Qe}.pdf`);return}if(ct==="docx"){const nt=await bp(()=>import("./index-YX0gPAOe.js"),[]),{Document:Ge,HeadingLevel:it,Packer:bt,Paragraph:St,Table:Vt,TableCell:Dt,TableRow:Pe,TextRun:Et,WidthType:pi}=nt,qt=[new Pe({children:Oe.headers.map(va=>new Dt({children:[new St({children:[new Et({text:va,bold:!0})]})]}))}),...Oe.rows.map(va=>new Pe({children:va.map(Bi=>new Dt({children:[new St({text:wp(Bi)})]}))}))],xi=new Ge({sections:[{properties:{},children:[new St({text:"Entitled Persons",heading:it.HEADING_1}),new St({text:`Generated ${new Date().toLocaleString()}`}),new Vt({width:{size:100,type:pi.PERCENTAGE},rows:qt})]}]}),bi=await bt.toBlob(xi);Qp(bi,`entitled-persons-${Qe}.docx`)}},ft=ct=>{Fe(!1),pe(ct).catch(Qe=>{console.error(`Failed to export as ${ct}`,Qe)})};return Q?ee.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",backgroundColor:"white",padding:"12px 16px",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",zIndex:1e3,fontFamily:"sans-serif",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px"},onClick:()=>Ve(!1),children:[ee.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1F2937"},children:"Statistics"}),ee.jsx("span",{style:{fontSize:"12px",color:"#6B7280",backgroundColor:"#F3F4F6",padding:"2px 8px",borderRadius:"4px",fontWeight:"600"},children:U}),ee.jsx("span",{style:{fontSize:"18px",color:"#6B7280",lineHeight:"1"},children:"▼"})]}):ee.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",backgroundColor:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",minWidth:"280px",zIndex:1e3,fontFamily:"sans-serif"},children:[ee.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px",gap:"12px"},children:[ee.jsx("h3",{style:{margin:"0",fontSize:"18px",fontWeight:"600",color:"#1F2937"},children:"Entitled Persons Statistics"}),ee.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[ee.jsxs("div",{ref:f,style:{position:"relative"},children:[ee.jsxs("button",{type:"button",onClick:()=>Fe(ct=>!ct),style:{backgroundColor:"#1D4ED8",border:"none",color:"white",cursor:"pointer",padding:"6px 10px",borderRadius:"6px",fontSize:"13px",fontWeight:"600",fontFamily:"sans-serif",boxShadow:"0 1px 2px rgba(15,23,42,0.15)",display:"flex",alignItems:"center",gap:"6px"},title:"Download current pin data",children:["Export",ee.jsx("span",{style:{fontSize:"10px"},children:$e?"^":"v"})]}),$e&&ee.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",right:0,backgroundColor:"white",borderRadius:"8px",boxShadow:"0 12px 24px rgba(15,23,42,0.18)",border:"1px solid #E5E7EB",minWidth:"180px",overflow:"hidden",zIndex:1100},children:[ee.jsx("button",{type:"button",onClick:()=>ft("csv"),style:{display:"block",width:"100%",padding:"10px 14px",background:"none",border:"none",textAlign:"left",fontSize:"13px",fontFamily:"sans-serif",cursor:"pointer",color:"#1F2937"},children:"Export CSV"}),ee.jsx("div",{style:{height:"1px",backgroundColor:"#F3F4F6"}}),ee.jsx("button",{type:"button",onClick:()=>ft("pdf"),style:{display:"block",width:"100%",padding:"10px 14px",background:"none",border:"none",textAlign:"left",fontSize:"13px",fontFamily:"sans-serif",cursor:"pointer",color:"#1F2937"},children:"Export PDF"}),ee.jsx("div",{style:{height:"1px",backgroundColor:"#F3F4F6"}}),ee.jsx("button",{type:"button",onClick:()=>ft("docx"),style:{display:"block",width:"100%",padding:"10px 14px",background:"none",border:"none",textAlign:"left",fontSize:"13px",fontFamily:"sans-serif",cursor:"pointer",color:"#1F2937"},children:"Export Word"})]})]}),ee.jsx("button",{onClick:()=>Ve(!0),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#6B7280",fontSize:"18px",lineHeight:"1",fontFamily:"sans-serif"},title:"Minimize",children:"▲"})]})]}),ee.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:"12px"},children:[ee.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",backgroundColor:"#F3F4F6",borderRadius:"6px"},children:[ee.jsx("span",{style:{fontSize:"14px",color:"#4B5563",fontWeight:"500",paddingRight:"5px"},children:"Total People"}),ee.jsx("span",{style:{fontSize:"20px",fontWeight:"700",color:"#1F2937"},children:U})]}),ee.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"6px"},children:[ee.jsx("span",{style:{fontSize:"14px",color:"#991B1B",fontWeight:"500",paddingRight:"5px"},children:"To Evacuate"}),ee.jsx("span",{style:{fontSize:"20px",fontWeight:"700",color:"#DC2626"},children:ut})]}),ee.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",backgroundColor:"#D1FAE5",borderRadius:"6px"},children:[ee.jsx("span",{style:{fontSize:"14px",color:"#065F46",fontWeight:"500",paddingRight:"5px"},children:"Not To Evacuate"}),ee.jsx("span",{style:{fontSize:"20px",fontWeight:"700",color:"#059669"},children:Ue})]})]})]})}function Nm({properties:ne,onSendMessage:ye}){const[Me,Q]=Mt.useState(""),[Ve,$e]=Mt.useState(""),[Fe,f]=Mt.useState(""),[Oe,U]=Mt.useState(""),[ut,Ue]=Mt.useState(!1),[pe,ft]=Mt.useState(null),ct=async()=>{if(!(!Me.trim()||!Ve.trim())){Ue(!0),ft(null);try{await ye(Me,Ve,Fe,Oe),ft("success"),Q(""),$e(""),f(""),U("")}catch(nt){ft("error"),console.error("Failed to send message:",nt)}finally{Ue(!1)}}},Qe=nt=>{nt.key==="Enter"&&!nt.shiftKey&&(nt.preventDefault(),ct())};return ee.jsxs("div",{style:{fontFamily:"sans-serif",width:"auto",maxWidth:"min(420px, calc(100vw - 4rem))",padding:"12px",boxSizing:"border-box"},children:[ee.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:"16px",color:"#1F2937"},children:ne.name||"Unknown"}),ee.jsxs("div",{style:{fontSize:"13px",color:"#4B5563",lineHeight:"1.5"},children:[ne.id&&ee.jsxs("p",{style:{margin:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},children:[ee.jsx("strong",{children:"ID:"})," ",ne.id]}),ne.description&&ee.jsxs("p",{style:{margin:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},children:[ee.jsx("strong",{children:"Description:"})," ",ne.description]}),ee.jsxs("p",{style:{margin:"5px 0"},children:[ee.jsx("strong",{children:"To Evacuate:"})," ",ne.to_evacuate==="true"?"Yes":"No"]}),ee.jsxs("p",{style:{margin:"5px 0"},children:[ee.jsx("strong",{children:"Location:"})," ",parseFloat(ne.latitude).toFixed(4),","," ",parseFloat(ne.longitude).toFixed(4)]}),ne.timestamp&&ee.jsxs("p",{style:{margin:"5px 0",fontSize:"11px",color:"#6B7280"},children:[ee.jsx("strong",{children:"Timestamp:"})," ",new Date(ne.timestamp).toLocaleString()]})]}),ee.jsxs("div",{style:{marginTop:"15px",paddingTop:"10px",borderTop:"1px solid #E5E7EB"},children:[ee.jsx("input",{type:"text",value:Me,onChange:nt=>Q(nt.target.value),onKeyPress:Qe,placeholder:"Enter title...",disabled:ut,style:{width:"100%",padding:"8px",fontSize:"13px",border:"1px solid #D1D5DB",borderRadius:"4px",marginBottom:"8px",boxSizing:"border-box"}}),ee.jsx("textarea",{value:Ve,onChange:nt=>$e(nt.target.value),placeholder:"Enter description...",disabled:ut,rows:"3",style:{width:"100%",padding:"8px",fontSize:"13px",border:"1px solid #D1D5DB",borderRadius:"4px",marginBottom:"8px",boxSizing:"border-box",resize:"vertical"}}),ee.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[ee.jsx("input",{type:"number",step:"any",value:Fe,onChange:nt=>f(nt.target.value),placeholder:"Target latitude...",disabled:ut,style:{flex:1,padding:"8px",fontSize:"13px",border:"1px solid #D1D5DB",borderRadius:"4px",boxSizing:"border-box"}}),ee.jsx("input",{type:"number",step:"any",value:Oe,onChange:nt=>U(nt.target.value),placeholder:"Target longitude...",disabled:ut,style:{flex:1,padding:"8px",fontSize:"13px",border:"1px solid #D1D5DB",borderRadius:"4px",boxSizing:"border-box"}})]}),ee.jsx("button",{onClick:ct,disabled:ut||!Me.trim()||!Ve.trim(),style:{width:"100%",padding:"8px",fontSize:"13px",backgroundColor:ut||!Me.trim()||!Ve.trim()?"#9CA3AF":"#3B82F6",color:"white",border:"none",borderRadius:"4px",cursor:ut||!Me.trim()||!Ve.trim()?"not-allowed":"pointer",fontWeight:"500"},children:ut?"Sending...":"Send"}),pe==="success"&&ee.jsx("p",{style:{margin:"5px 0 0 0",fontSize:"12px",color:"#10B981"},children:"Message sent successfully!"}),pe==="error"&&ee.jsx("p",{style:{margin:"5px 0 0 0",fontSize:"12px",color:"#EF4444"},children:"Failed to send message"})]})]})}function Fm({pinJsonUrl:ne,mapRef:ye,messageEndpoint:Me,onPinData:Q,onLoadingChange:Ve,onPinError:$e}){const[Fe,f]=Mt.useState(null),[Oe,U]=Mt.useState(null),[ut,Ue]=Mt.useState(!1),pe=Mt.useRef(new Map),ft=Mt.useRef(!1);Mt.useEffect(()=>{if(!ne)return;const Qe=new AbortController;return Ue(!0),(async()=>{try{const Ge=await fetch(ne,{signal:Qe.signal});if(!Ge.ok)throw new Error(`Pin data failed to fetch: ${Ge.status}`);const it=await Ge.json();ft.current=!1,f(it),U(null),Ue(!1)}catch(Ge){Ge.name!=="AbortError"&&(console.error("Failed to load pin data:",Ge),U(Ge.message),Ue(!1))}})(),()=>{Qe.abort()}},[ne]),Mt.useEffect(()=>{typeof Q=="function"&&Q(Fe)},[Fe,Q]),Mt.useEffect(()=>{typeof Ve=="function"&&Ve(ut)},[ut,Ve]),Mt.useEffect(()=>{typeof $e=="function"&&$e(Oe)},[Oe,$e]),Mt.useEffect(()=>{(!Fe||Fe.length===0)&&(ft.current=!1)},[Fe]);const ct=Mt.useCallback(async(Qe,nt,Ge,it)=>{const bt=Me||"https://ksip4rkha0.execute-api.eu-west-2.amazonaws.com/messaging-router",St={title:Qe,description:nt,timestamp:new Date().toISOString()};Ge&&it&&(St.targetLatitude=parseFloat(Ge),St.targetLongitude=parseFloat(it));const Vt=await fetch(bt,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(St)});if(!Vt.ok)throw new Error(`Failed to send message: ${Vt.status}`);return Vt.json()},[Me]);return Mt.useEffect(()=>{const Qe=ye?.current;if(!Qe||!Fe)return;const nt="pin-data-source",Ge="pin-data-layer",it=pe.current,bt=()=>{try{Qe.getLayer(Ge)&&Qe.removeLayer(Ge),Qe.getSource(nt)&&Qe.removeSource(nt);const St=Fe.map((Dt,Pe)=>{const Et=Number(Dt.longitude),pi=Number(Dt.latitude);if(!Number.isFinite(Et)||!Number.isFinite(pi))return console.warn("Skipping pin with invalid coordinates",Dt),null;const qt=Dt.to_evacuate,xi=typeof qt=="boolean"?qt:typeof qt=="string"?qt.trim().toLowerCase()==="true":!!qt;return{type:"Feature",geometry:{type:"Point",coordinates:[Et,pi]},properties:{...Dt,id:Dt.id||Pe,longitude:Et,latitude:pi,to_evacuate:xi}}}).filter(Boolean),Vt={type:"FeatureCollection",features:St};if(Qe.addSource(nt,{type:"geojson",data:Vt}),Qe.addLayer({id:Ge,type:"circle",source:nt,paint:{"circle-radius":8,"circle-color":["case",["==",["get","to_evacuate"],!0],"#EF4444",["==",["get","to_evacuate"],!1],"#10B981","#6B7280"],"circle-stroke-color":"#FFFFFF","circle-stroke-width":2}}),Qe.on("click",Ge,Dt=>{const Pe=Dt.features[0].geometry.coordinates.slice(),Et=Dt.features[0].properties;for(;Math.abs(Dt.lngLat.lng-Pe[0])>180;)Pe[0]+=Dt.lngLat.lng>Pe[0]?360:-360;const pi=document.createElement("div"),qt=new Fd.Popup({closeButton:!0,closeOnClick:!1,maxWidth:"min(420px, calc(100vw - 4rem))",offset:15}).setLngLat(Pe).setDOMContent(pi).addTo(Qe),xi=am.createRoot(pi);xi.render(ee.jsx(Nm,{properties:Et,onSendMessage:ct})),it.set(qt,xi),qt.on("close",()=>{const bi=it.get(qt);bi&&(bi.unmount(),it.delete(qt))})}),Qe.on("mouseenter",Ge,()=>{Qe.getCanvas().style.cursor="pointer"}),Qe.on("mouseleave",Ge,()=>{Qe.getCanvas().style.cursor=""}),!ft.current&&St.length>0){const Dt=St.map(Pe=>Pe?.geometry?.coordinates).filter(Pe=>Array.isArray(Pe)&&typeof Pe[0]=="number"&&typeof Pe[1]=="number");if(Dt.length===1)Qe.easeTo({center:Dt[0],zoom:Math.max(Qe.getZoom()||0,12.5),duration:900}),ft.current=!0;else if(Dt.length>1){let Pe=null;Dt.forEach(Et=>{Pe?Pe.extend(Et):Pe=new Fd.LngLatBounds(Et,Et)}),Pe&&(Qe.fitBounds(Pe,{padding:80,maxZoom:13,duration:900}),ft.current=!0)}}console.log(`Added ${St.length} pins to the map`)}catch(St){console.error("Failed to add pins to map:",St)}};return Qe.loaded()?bt():Qe.once("load",bt),()=>{Qe.getLayer(Ge)&&Qe.removeLayer(Ge),Qe.getSource(nt)&&Qe.removeSource(nt),it.forEach(St=>St.unmount()),it.clear()}},[Fe,ye,ct]),ne?ee.jsx(Pm,{pinData:Fe,isLoading:ut,error:Oe}):null}const Um="/assets/GARDIAN-BaO8PsqI.jpg",jm="/assets/UKGovLogo-szTXqjTy.jpg",Vm="/assets/UKMilLogo-7f1Y6bRU.jpg",rm=["severe weather","storm","flood","flash flooding","wildfire","brush fire","earthquake","landslide","mudslide","hurricane","typhoon","tsunami","volcanic eruption","heatwave","riot","civil unrest","casualties","fatalities"],qm={lat:51.5074,lon:-.1278,city:"London",locality:"London",principalSubdivision:"England",countryName:"United Kingdom",countryCode:"GB"},Gm="https://api.bigdatacloud.net/data/reverse-geocode-client",Zm=1440*60*1e3,$m=Zm*365,Hf=typeof Intl<"u"&&typeof Intl.RelativeTimeFormat<"u"?new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}):null;function Hm(ne){return!ne||typeof ne!="string"?"":ne.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim()}function Xm(ne){if(!ne||typeof ne!="string")return"";if(typeof window>"u"||typeof DOMParser>"u")return ne;const Me=new DOMParser().parseFromString(ne,"text/html");return Me.documentElement?.textContent||Me.body?.textContent||ne}function Tc(ne){if(!ne||typeof ne!="string")return"";const ye=ne.replace(/"/g,"").trim();return ye?/\s/.test(ye)?`"${ye}"`:ye:""}function Jp(ne){if(!ne||typeof ne!="string")return"";let ye=ne.replace(/\([^)]*\)/g," ");if(ye=ye.split(",")[0]||ye,ye=ye.replace(/\s+/g," ").trim(),!ye)return"";if(/united kingdom/i.test(ye))return"United Kingdom";const Me=ye.split(" ");return Me.length>4&&(ye=Me.slice(0,4).join(" ")),/^the\s+/i.test(ye)&&(ye=ye.replace(/^the\s+/i,"")),ye}function Wp(ne){if(!(ne instanceof Date))return"";const ye=ne.getUTCFullYear(),Me=String(ne.getUTCMonth()+1).padStart(2,"0"),Q=String(ne.getUTCDate()).padStart(2,"0");return`${ye}-${Me}-${Q}`}function Ym(ne="/search"){const ye="".trim();if(ye)try{const Me=ye.endsWith("/")?ye:`${ye}/`;return new URL(ne.replace(/^\//,""),Me)}catch(Me){console.warn("Invalid VITE_GUARDIAN_PROXY_URL – falling back to direct Guardian endpoint.",Me)}return new URL(`https://content.guardianapis.com${ne}`)}function sm(){const ne=new Date;return{start:new Date(ne.getTime()-$m),end:ne}}function om(ne){if(!ne)return null;if(ne instanceof Date)return ne.toISOString();if(typeof ne=="number")return new Date(ne).toISOString();if(typeof ne=="string"){const ye=ne.trim();if(/^\d{8}T\d{6}Z$/.test(ye)){const Q=ye.slice(0,4),Ve=ye.slice(4,6),$e=ye.slice(6,8),Fe=ye.slice(9,11),f=ye.slice(11,13),Oe=ye.slice(13,15);return`${Q}-${Ve}-${$e}T${Fe}:${f}:${Oe}Z`}if(/^\d{14}$/.test(ye)){const Q=ye.slice(0,4),Ve=ye.slice(4,6),$e=ye.slice(6,8),Fe=ye.slice(8,10),f=ye.slice(10,12),Oe=ye.slice(12,14);return`${Q}-${Ve}-${$e}T${Fe}:${f}:${Oe}Z`}const Me=new Date(ye);if(!Number.isNaN(Me.getTime()))return Me.toISOString()}return null}function em(ne){const ye=om(ne);return ye?new Date(ye).getTime():0}function Km(ne){const ye=om(ne);if(!ye)return"";const Me=new Date(ye).getTime();if(Number.isNaN(Me))return"";const Q=Me-Date.now(),Ve=Math.round(Q/6e4);if(!Hf)return new Date(ye).toLocaleString(void 0,{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"});if(Math.abs(Ve)<1)return"just now";if(Math.abs(Ve)<90)return Hf.format(Ve,"minute");const $e=Math.round(Q/36e5);if(Math.abs($e)<36)return Hf.format($e,"hour");const Fe=Math.round(Q/864e5);return Math.abs(Fe)<14?Hf.format(Fe,"day"):new Date(ye).toLocaleDateString(void 0,{day:"numeric",month:"short"})}async function Qm(ne){const ye={...qm};if(typeof navigator>"u"||!navigator.geolocation)return ye;const Me=await new Promise($e=>{navigator.geolocation.getCurrentPosition(Fe=>$e(Fe),()=>$e(null),{maximumAge:3e5,timeout:8e3})});if(!Me)return ye;const{latitude:Q,longitude:Ve}=Me.coords||{};if(typeof Q!="number"||typeof Ve!="number")return ye;try{const $e=new URL(Gm);$e.searchParams.set("latitude",Q),$e.searchParams.set("longitude",Ve),$e.searchParams.set("localityLanguage","en");const Fe=await fetch($e.toString(),{signal:ne});if(!Fe.ok)throw new Error(`Geocode HTTP ${Fe.status}`);const f=await Fe.json();return{lat:Q,lon:Ve,city:f.city||f.locality||ye.city,locality:f.locality,principalSubdivision:f.principalSubdivision||f.region||ye.principalSubdivision,countryName:f.countryName||ye.countryName,countryCode:(f.countryCode||ye.countryCode||"GB").toUpperCase()}}catch($e){if($e?.name==="AbortError")throw $e;return{...ye,lat:Q,lon:Ve}}}function Jm(ne){const ye=new Set;return(ne||[]).filter(Me=>Me&&(Me.title||Me.description||Me.url)).filter(Me=>{const Q=(Me.url||Me.title||Me.id||"").toLowerCase();return Q?ye.has(Q)?!1:(ye.add(Q),!0):!0}).sort((Me,Q)=>em(Q.publishedAt)-em(Me.publishedAt))}async function Wm(ne,ye){const Me="a05f03505b1a70b7bfaeeb53211d5457",Q=[ne?.principalSubdivision,ne?.countryName].filter((it,bt,St)=>it&&St.indexOf(it)===bt).map(Tc);if(ne?.city&&Q.length<3){const it=Tc(ne.city);it&&!Q.includes(it)&&Q.unshift(it)}const Ve=[...Q],$e=[...rm],Fe=6,f=190,Oe=()=>{const it=`(${$e.map(Tc).join(" OR ")})`,bt=Ve.length?`(${Ve.join(" OR ")})`:"";return bt?`${it} AND ${bt}`:it};let U=Oe();for(;U.length>f&&$e.length>Fe;)$e.pop(),U=Oe();for(;U.length>f&&Ve.length>1;)Ve.pop(),U=Oe();U.length>f&&Ve.length&&(Ve.length=0,U=Oe()),U.length>f&&$e.length>Fe&&($e.length=Fe,U=Oe());const{start:ut,end:Ue}=sm(),pe=new URL("https://gnews.io/api/v4/search");pe.searchParams.set("q",U),pe.searchParams.set("token",Me),pe.searchParams.set("lang","en"),ne?.countryCode&&pe.searchParams.set("country",ne.countryCode.toLowerCase()),pe.searchParams.set("max","15"),pe.searchParams.set("in","title,description"),pe.searchParams.set("from",ut.toISOString()),pe.searchParams.set("to",Ue.toISOString());const ft=await fetch(pe.toString(),{signal:ye}),ct=await ft.text();if(!ft.ok){const it=ct.trim().split(/\r?\n/).filter(Boolean)[0]||`HTTP ${ft.status}`;throw new Error(it)}let Qe=null;if((ft.headers.get("content-type")||"").includes("json"))try{Qe=JSON.parse(ct)}catch{throw new Error("Received malformed JSON from GDELT")}else{const it=ct.trim().split(/\r?\n/).filter(Boolean)[0]||"Unexpected response from GDELT";throw new Error(it)}return(Array.isArray(Qe?.articles)?Qe.articles:[]).map((it,bt)=>({id:`gnews-${it.url||bt}`,source:it.source?.name||"GNews",title:(it.title||"").trim(),description:(it.description||"").trim(),url:it.url,imageUrl:it.image,publishedAt:it.publishedAt}))}async function eg(ne,ye){const Me="5002da04-eae3-455b-8d62-585c3c58a908",$e=[ne?.city,ne?.locality,ne?.principalSubdivision,ne?.countryName].map(Jp).filter((Ge,it,bt)=>Ge&&bt.indexOf(Ge)===it).map(Tc),Fe=[...rm],f=[...$e],Oe=()=>{const Ge=`(${Fe.map(Tc).join(" OR ")})`,it=f.length?`(${f.join(" OR ")})`:"";return it?`${Ge} AND ${it}`:Ge};let U=Oe();for(;U.length>240&&Fe.length>6;)Fe.pop(),U=Oe();for(;U.length>240&&f.length>1;)f.pop(),U=Oe();U.length>240&&f.length&&(f.length=0,U=Oe()),U.length>240&&Fe.length>6&&(Fe.length=6,U=Oe());const ut=["storm","flood","wildfire","earthquake","hurricane"].map(Tc).filter(Boolean),Ue=Tc(Jp(ne?.city||ne?.locality||ne?.principalSubdivision||ne?.countryName));let pe=ut.join(" OR ");ut.length>1&&(pe=`(${pe})`),Ue&&(pe=`${pe} AND ${Ue}`);const ft=Ge=>{const{start:it,end:bt}=sm(),St=Ym("/search");return St.searchParams.set("api-key",Me),St.searchParams.set("order-by","newest"),St.searchParams.set("page-size","20"),St.searchParams.set("show-fields","trailText,thumbnail"),St.searchParams.set("q",Ge),St.searchParams.set("from-date",Wp(it)),St.searchParams.set("to-date",Wp(bt)),St},ct=[U];if(pe&&pe.trim())if(pe!==U)ct.push(pe);else{const Ge=ut[0]||"storm",it=Ue?`${Ge} AND ${Ue}`:Ge;it!==U&&ct.push(it)}const Qe=Array.from(new Set(ct.filter(Ge=>typeof Ge=="string"&&Ge.trim())));let nt=null;for(const Ge of Qe){const it=ft(Ge);let bt;try{bt=await fetch(it.toString(),{signal:ye})}catch(Pe){if(Pe?.name==="TypeError"){nt=new Error("Guardian request blocked by browser. Configure VITE_GUARDIAN_PROXY_URL or use the bundled /guardian-api proxy.");continue}throw Pe}const St=await bt.text();if(!bt.ok){if(bt.status===400)try{const Pe=JSON.parse(St),Et=Pe?.response?.message||Pe?.message||"Guardian rejected the search query.";nt=new Error(Et);continue}catch{nt=new Error("Guardian rejected the search query.");continue}throw new Error(`Guardian HTTP ${bt.status}`)}let Vt;try{Vt=JSON.parse(St)}catch{throw new Error("Received malformed JSON from Guardian")}return(Array.isArray(Vt?.response?.results)?Vt.response.results:[]).map(Pe=>({id:`guardian-${Pe.id}`,source:"The Guardian",title:(Pe.webTitle||"").trim(),description:Xm(Hm(Pe.fields?.trailText)),url:Pe.webUrl,imageUrl:Pe.fields?.thumbnail,publishedAt:Pe.webPublicationDate}))}throw nt||new Error("Unable to fetch Guardian articles.")}function tg(){const[ne,ye]=Mt.useState([]),[Me,Q]=Mt.useState("loading"),[Ve,$e]=Mt.useState(null),[Fe,f]=Mt.useState(null),[Oe,U]=Mt.useState([]);Mt.useEffect(()=>{let pe=!1;const ft=new AbortController;async function ct(){try{Q("loading"),$e(null),U([]);const Qe=await Qm(ft.signal);if(pe)return;f(Qe);const nt=[{label:"GNews",runner:()=>Wm(Qe,ft.signal)},{label:"The Guardian",runner:()=>eg(Qe,ft.signal)}],Ge=await Promise.all(nt.map(async({label:Vt,runner:Dt})=>{try{const Pe=await Dt();return{label:Vt,ok:!0,payload:Pe}}catch(Pe){return{label:Vt,ok:!1,error:Pe}}}));if(pe)return;const it=[],bt=[];Ge.forEach(Vt=>{if(Vt.ok)it.push(...Vt.payload||[]);else if(Vt.error?.name!=="AbortError"){let Dt=Vt.error?.message||String(Vt.error);typeof Dt=="string"&&Dt.startsWith("Missing VITE_")&&(Dt=`set ${Dt.replace("Missing ","")} in your .env`),bt.push(`${Vt.label}: ${Dt}`)}});const St=Jm(it);ye(St),U(bt),St.length?(Q("loaded"),bt.length&&$e("Some sources did not respond. Showing partial results.")):(Q("empty"),bt.length?$e("Unable to find relevant articles in every source."):$e("No recent incident reports found for this area."))}catch(Qe){if(pe||Qe?.name==="AbortError")return;Q("error"),$e(Qe?.message||"Failed to load news feed.")}}return ct(),()=>{pe=!0,ft.abort()}},[]);const ut=Mt.useMemo(()=>Fe?[Fe.city,Fe.principalSubdivision,Fe.countryName].filter((ft,ct,Qe)=>ft&&Qe.indexOf(ft)===ct).join(", "):"",[Fe]),Ue=Mt.useMemo(()=>Me==="loading"?ee.jsx("div",{className:"news-status","aria-live":"polite",children:"Locating and fetching live incident reports…"}):Me==="error"?ee.jsx("div",{className:"news-status news-status--error",role:"alert",children:Ve||"Unable to load news feed."}):Me==="empty"?ee.jsx("div",{className:"news-status","aria-live":"polite",children:Ve||"No recent incident reports found."}):ee.jsx("ul",{className:"news-list","aria-label":"Incident news items",children:ne.map(pe=>ee.jsxs("li",{className:"news-item",children:[pe.imageUrl?ee.jsx("div",{className:"news-thumb",children:ee.jsx("img",{src:pe.imageUrl,alt:"",loading:"lazy",onError:ft=>{ft.currentTarget.style.display="none"}})}):null,ee.jsxs("div",{className:"news-body",children:[pe.title?ee.jsx("div",{className:"news-title",children:pe.url?ee.jsx("a",{href:pe.url,target:"_blank",rel:"noreferrer",children:pe.title}):pe.title}):null,pe.source||pe.publishedAt?ee.jsxs("div",{className:"news-meta",children:[pe.source?ee.jsx("span",{className:"news-tag",children:pe.source}):null,pe.publishedAt?ee.jsx("span",{className:"news-meta-time",children:Km(pe.publishedAt)}):null]}):null,pe.description?ee.jsx("div",{className:"news-desc",children:pe.description}):null]})]},pe.id))}),[Me,ne,Ve]);return ee.jsxs("div",{className:"news-feed",children:[ut?ee.jsxs("div",{className:"news-context","aria-live":"polite",children:["Monitoring incidents near ",ee.jsx("strong",{children:ut})]}):null,Ue,Oe.length?ee.jsx("div",{className:"news-footnote",role:"note",children:Oe.map((pe,ft)=>ee.jsxs("div",{children:["- ",pe]},ft))}):null]})}const tm=1440*60*1e3,ig=300*1e3,ag=600*1e3;function Xf(ne,ye){try{const Me=localStorage.getItem(ne);if(!Me)return null;const Q=JSON.parse(Me);return!Q||!Q.ts||!Q.data||Date.now()-Q.ts>ye?null:Q.data}catch{return null}}function Yf(ne,ye){try{localStorage.setItem(ne,JSON.stringify({ts:Date.now(),data:ye}))}catch{}}function Nd(ne,ye){if(ne==null||Number.isNaN(ne))return"–";const Me=ye==="imperial"?"°F":ye==="metric"?"°C":"K";return`${Math.round(ne)}${Me}`}function im(ne){return typeof ne!="number"?"–":Math.round(ne*3.6)}function ng(ne,ye){if(!ne?.list?.length)return[];const Me=new Map;for(const Q of ne.list){const Ve=(Q.dt+ye)*1e3,$e=new Date(Ve),Fe=`${$e.getUTCFullYear()}-${$e.getUTCMonth()}-${$e.getUTCDate()}`;let f=Me.get(Fe);f||(f={items:[],min:1/0,max:-1/0,repr:Q},Me.set(Fe,f)),f.items.push(Q),f.min=Math.min(f.min,Q.main?.temp_min??Q.main?.temp??1/0),f.max=Math.max(f.max,Q.main?.temp_max??Q.main?.temp??-1/0);const Oe=new Date(Ve).getUTCHours(),U=new Date((f.repr.dt+ye)*1e3).getUTCHours();Math.abs(Oe-12)<Math.abs(U-12)&&(f.repr=Q)}return Array.from(Me.values()).slice(0,5)}function rg({placeQuery:ne="De Vere Cotswold Water Park, Cirencester, GB",lat:ye,lon:Me,units:Q="metric",lang:Ve="en",showHourly:$e=6}){const Fe="0125f1f6b83463fa10fdd61d9ad63e14",[f,Oe]=Mt.useState(null),[U,ut]=Mt.useState(null),[Ue,pe]=Mt.useState(null),[ft,ct]=Mt.useState(!0),[Qe,nt]=Mt.useState(null),[Ge,it]=Mt.useState(null),[bt,St]=Mt.useState("idle");Mt.useEffect(()=>{if(ye!=null&&Me!=null){it(null),St("skipped");return}if(typeof window>"u"||typeof navigator>"u"||!navigator.geolocation){St("unsupported");return}let Kt=!1;return St("resolving"),navigator.geolocation.getCurrentPosition(Se=>{if(Kt)return;const{latitude:Ye,longitude:gt}=Se.coords;it({lat:Ye,lon:gt}),St("resolved")},Se=>{Kt||(console.warn("Geolocation unavailable, falling back to preset location",Se),it(null),St("failed"))},{maximumAge:300*1e3,timeout:8e3,enableHighAccuracy:!1}),()=>{Kt=!0}},[ye,Me]),Mt.useEffect(()=>{let Kt=!1;async function Se(){const Ye=ye!=null&&Me!=null;try{let gt=Ye?ye:Ge?.lat,Gt=Ye?Me:Ge?.lon,si=Ye?null:Ge?.name;if(gt&&Gt){if(!Ye&&!si&&bt==="resolved"){const kt=`owm:reverse:${gt},${Gt}`;let Rt=Xf(kt,tm);if(!Rt)try{const Pt=`https://api.openweathermap.org/geo/1.0/reverse?lat=${gt}&lon=${Gt}&limit=1&appid=${Fe}`,Oi=await fetch(Pt);if(!Oi.ok)throw new Error(`Reverse geocoding failed (${Oi.status})`);const ii=await Oi.json();if(Array.isArray(ii)&&ii.length>0){const Wi=ii[0];Rt={name:`${Wi.name}${Wi.state?", "+Wi.state:""}, ${Wi.country}`},Yf(kt,Rt)}}catch(Pt){console.warn("Reverse geocoding failed, using generic label",Pt)}si=Rt?.name||"Current location",!Kt&&si&&!Ge?.name&&it(Pt=>Pt&&{...Pt,name:si})}}else{if(!Ye&&(bt==="idle"||bt==="resolving")){ct(!0),nt(null);return}const kt=`owm:geocode:${ne}`;let Pt=Xf(kt,tm);if(!Pt){const Oi=`https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(ne)}&limit=1&appid=${Fe}`,ii=await fetch(Oi);if(!ii.ok)throw new Error(`Geocoding failed (${ii.status})`);const Wi=await ii.json();if(!Wi?.length)throw new Error("Location not found");const pn=Wi[0];Pt={lat:pn.lat,lon:pn.lon,name:`${pn.name}${pn.state?", "+pn.state:""}, ${pn.country}`},Yf(kt,Pt)}gt=Pt.lat,Gt=Pt.lon,si=Pt.name}ct(!0),nt(null),Oe({lat:gt,lon:Gt,name:si||ne});const se=`owm:wx:${gt},${Gt},${Q}`,Ie=`owm:fc:${gt},${Gt},${Q}`;let Ze=Xf(se,ig);if(!Ze){const kt=`https://api.openweathermap.org/data/2.5/weather?lat=${gt}&lon=${Gt}&units=${Q}&lang=${Ve}&appid=${Fe}`,Rt=await fetch(kt);if(!Rt.ok)throw new Error(`Weather failed (${Rt.status})`);Ze=await Rt.json(),Yf(se,Ze)}let ht=Xf(Ie,ag);if(!ht){const kt=`https://api.openweathermap.org/data/2.5/forecast?lat=${gt}&lon=${Gt}&units=${Q}&lang=${Ve}&appid=${Fe}`,Rt=await fetch(kt);if(!Rt.ok)throw new Error(`Forecast failed (${Rt.status})`);ht=await Rt.json(),Yf(Ie,ht)}Kt||(ut(Ze),pe(ht))}catch(gt){Kt||nt(gt.message||"Weather fetch failed")}finally{Kt||ct(!1)}}return Se(),()=>{Kt=!0}},[ne,ye,Me,Q,Ve,Fe,Ge?.lat,Ge?.lon,bt]);const Vt=Mt.useMemo(()=>Ue?.city?.timezone??U?.timezone??0,[Ue,U]),Dt=Mt.useMemo(()=>ng(Ue,Vt),[Ue,Vt]),Pe=Mt.useMemo(()=>Ue?.list?.length?Ue.list.slice(0,$e):[],[Ue,$e]);if(ft)return ee.jsx("div",{className:"weather-status",children:"Loading weather…"});if(Qe)return ee.jsx("div",{className:"weather-status weather-status--error",role:"alert",children:Qe});if(!U||!Ue)return ee.jsx("div",{className:"weather-status",children:"No data."});const Et=U.weather?.[0]?.icon,pi=U.weather?.[0]?.description,qt=Et?`https://openweathermap.org/img/wn/${Et}@2x.png`:null,xi=im(U.wind?.speed),bi=im(U.wind?.gust),va=U.main?.humidity,Bi=U.visibility!=null?Math.round(U.visibility/1e3):null;return ee.jsxs("div",{className:"weather-grid","aria-live":"polite",children:[ee.jsxs("section",{className:"wx-card wx-card--current","aria-label":"Current conditions",children:[ee.jsxs("div",{className:"wx-current-head",children:[ee.jsxs("div",{className:"wx-current-title",children:[ee.jsx("div",{className:"wx-place",children:f?.name||ne}),ee.jsx("div",{className:"wx-desc",children:pi?pi[0].toUpperCase()+pi.slice(1):""})]}),qt?ee.jsx("img",{className:"wx-icon",src:qt,alt:pi||""}):null]}),ee.jsxs("div",{className:"wx-current-body",children:[ee.jsx("div",{className:"wx-temp",children:Nd(U.main?.temp,Q)}),ee.jsxs("ul",{className:"wx-meta","aria-label":"Weather details",children:[ee.jsxs("li",{children:[ee.jsx("span",{children:"Feels"}),ee.jsx("strong",{children:Nd(U.main?.feels_like,Q)})]}),ee.jsxs("li",{children:[ee.jsx("span",{children:"Wind"}),ee.jsxs("strong",{children:[xi," km/h",bi?` (gust ${bi})`:""]})]}),ee.jsxs("li",{children:[ee.jsx("span",{children:"Humidity"}),ee.jsx("strong",{children:va!=null?`${va}%`:"–"})]}),ee.jsxs("li",{children:[ee.jsx("span",{children:"Visibility"}),ee.jsx("strong",{children:Bi!=null?`${Bi} km`:"–"})]})]})]})]}),ee.jsxs("section",{className:"wx-card wx-card--hourly","aria-label":"Upcoming hours",children:[ee.jsxs("h3",{className:"wx-subtitle",children:["Next ",Pe.length*3," hours"]}),ee.jsx("div",{className:"wx-hourly",children:Pe.map((Kt,Se)=>{const Ye=Kt.weather?.[0]?.icon,Gt=new Date((Kt.dt+Vt)*1e3).getUTCHours().toString().padStart(2,"0");return ee.jsxs("div",{className:"wx-hour",children:[ee.jsxs("div",{className:"wx-hour-time",children:[Gt,":00"]}),Ye?ee.jsx("img",{className:"wx-hour-icon",src:`https://openweathermap.org/img/wn/${Ye}.png`,alt:"",loading:"lazy"}):null,ee.jsx("div",{className:"wx-hour-temp",children:Nd(Kt.main?.temp,Q)})]},Kt.dt+":"+Se)})})]}),ee.jsxs("section",{className:"wx-card wx-card--daily","aria-label":"5-day forecast",children:[ee.jsx("h3",{className:"wx-subtitle",children:"5-day outlook"}),ee.jsx("div",{className:"wx-daily",children:Dt.map((Kt,Se)=>{const gt=new Date((Kt.repr.dt+Vt)*1e3).toLocaleDateString(void 0,{weekday:"short"}),Gt=Kt.repr.weather?.[0]?.icon;return ee.jsxs("div",{className:"wx-day",children:[ee.jsx("div",{className:"wx-day-name",children:gt}),Gt?ee.jsx("img",{className:"wx-day-icon",src:`https://openweathermap.org/img/wn/${Gt}.png`,alt:"",loading:"lazy"}):null,ee.jsxs("div",{className:"wx-day-range",children:[ee.jsx("span",{className:"wx-min",children:Nd(Kt.min,Q)}),ee.jsx("span",{className:"wx-max",children:Nd(Kt.max,Q)})]})]},Se)})})]})]})}const sg="https://rvryhicxm6.execute-api.eu-west-2.amazonaws.com/Prod",og="https://i.natgeofe.com/k/7d906c71-1105-4048-b32b-a55b1b04e3bc/OG_Floods_KIDS_0922.jpg?w=1436&h=922";function lg({endpoint:ne=sg,photoUrl:ye=og}){const[Me,Q]=Mt.useState(null),[Ve,$e]=Mt.useState(!0),[Fe,f]=Mt.useState(null);Mt.useEffect(()=>{const ut=new AbortController;$e(!0),f(null),Q(null);async function Ue(){try{const pe=await fetch(ne,{signal:ut.signal});if(!pe.ok)throw new Error(`HTTP ${pe.status}`);const ft=await pe.json();Q(ft)}catch(pe){pe.name!=="AbortError"&&f(pe.message||"Failed to load AI assessment")}finally{$e(!1)}}return Ue(),()=>ut.abort()},[ne]);const Oe=Mt.useMemo(()=>{const ut=Array.isArray(Me?.Items)?Me.Items:[];let Ue=null,pe=-1/0;return ut.forEach(ft=>{const ct=ft?.labels?.M;if(!ct)return;const Qe=Object.keys(ct).find(bt=>bt.toLowerCase()==="flood");if(!Qe)return;const nt=ct[Qe]?.S;if(typeof nt!="string")return;const Ge=parseFloat(nt.replace(/[^0-9.]+/g,"")),it=Number.isFinite(Ge)?Ge:0;it>pe&&(pe=it,Ue=nt)}),Ue},[Me]),U=Mt.useMemo(()=>Ve?ee.jsx("div",{className:"ai-status",children:"Loading AI tags…"}):Fe?ee.jsx("div",{className:"ai-status ai-status--error",children:Fe}):Oe?ee.jsx("div",{className:"ai-card","aria-label":"AI assessed scene",children:ee.jsxs("div",{className:"ai-row",children:[ee.jsxs("div",{className:"ai-tag",children:[ee.jsx("span",{className:"ai-chip ai-chip--critical","aria-label":"Critical hazard",children:"Flood"}),ee.jsx("span",{className:"ai-conf",children:Oe})]}),ee.jsx("a",{className:"ai-thumb",href:ye,target:"_blank",rel:"noreferrer",children:ee.jsx("img",{src:ye,alt:"AI-assessed flood scene",loading:"lazy"})})]})}):ee.jsx("div",{className:"ai-status",children:"No critical flood tags found."}),[Ve,Fe,Oe,ye]);return ee.jsx("div",{className:"ai-wrapper",children:U})}const Tp=ne=>{if(typeof ne=="boolean")return ne;if(typeof ne=="string"){const ye=ne.trim().toLowerCase();if(ye==="true")return!0;if(ye==="false")return!1}return null},ug=ne=>{if(!ne)return"Time unknown";const ye=new Date(ne);return Number.isNaN(ye.getTime())?"Time unknown":ye.toLocaleString(void 0,{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"})},cg=ne=>{const ye={total:ne.length,evacuate:0,hold:0,unknown:0};return ne.forEach(Me=>{const Q=Tp(Me?.to_evacuate);Q===!0?ye.evacuate+=1:Q===!1?ye.hold+=1:ye.unknown+=1}),ye},hg=ne=>{const ye=Me=>{const Q=Tp(Me?.to_evacuate);return Q===!0?0:Q===!1?1:2};return[...ne].sort((Me,Q)=>{const Ve=ye(Me)-ye(Q);if(Ve!==0)return Ve;const $e=new Date(Me?.timestamp||0).getTime();return new Date(Q?.timestamp||0).getTime()-$e})};function dg({items:ne,isLoading:ye,error:Me}){const Q=Array.isArray(ne)?ne:[],{orderedRequests:Ve,summary:$e}=Mt.useMemo(()=>({orderedRequests:hg(Q),summary:cg(Q)}),[Q]);return ye?ee.jsxs("div",{className:"requests-placeholder",children:[ee.jsx("div",{className:"requests-loading-line requests-loading-line--wide"}),ee.jsx("div",{className:"requests-loading-line"}),ee.jsx("div",{className:"requests-loading-line requests-loading-line--short"})]}):Me?ee.jsxs("div",{className:"requests-error",children:[ee.jsx("span",{className:"requests-error__title",children:"Unable to load requests"}),ee.jsx("span",{className:"requests-error__detail",children:Me})]}):$e.total===0?ee.jsxs("div",{className:"requests-empty",children:[ee.jsx("span",{className:"requests-empty__title",children:"No active requests"}),ee.jsx("span",{className:"requests-empty__detail",children:"New evacuation or assistance calls will appear here as field teams log them."})]}):ee.jsxs("div",{className:"requests-content",children:[ee.jsxs("div",{className:"requests-summary",children:[ee.jsxs("div",{className:"requests-summary__metric",children:[ee.jsx("span",{className:"metric-label",children:"Total tracked"}),ee.jsx("span",{className:"metric-value",children:$e.total})]}),ee.jsxs("div",{className:"requests-summary__metric requests-summary__metric--urgent",children:[ee.jsx("span",{className:"metric-label",children:"Evac required"}),ee.jsx("span",{className:"metric-value",children:$e.evacuate})]}),ee.jsxs("div",{className:"requests-summary__metric requests-summary__metric--stable",children:[ee.jsx("span",{className:"metric-label",children:"Shelter in place"}),ee.jsx("span",{className:"metric-value",children:$e.hold})]}),ee.jsxs("div",{className:"requests-summary__metric requests-summary__metric--unknown",children:[ee.jsx("span",{className:"metric-label",children:"Pending triage"}),ee.jsx("span",{className:"metric-value",children:$e.unknown})]})]}),ee.jsx("div",{className:"requests-list",children:Ve.map(Fe=>{const f=Tp(Fe?.to_evacuate),Oe=f===!0?"Evacuation required":f===!1?"Holding safe":"Pending review",U=f===!0?"request-card__status--urgent":f===!1?"request-card__status--stable":"request-card__status--pending";return ee.jsxs("article",{className:"request-card",children:[ee.jsxs("div",{className:"request-card__header",children:[ee.jsxs("div",{children:[ee.jsx("h3",{className:"request-card__title",children:Fe?.name||"Unknown individual"}),Fe?.id?ee.jsxs("p",{className:"request-card__id",children:["ID: ",Fe.id]}):null]}),ee.jsx("span",{className:`request-card__status ${U}`,children:Oe})]}),Fe?.description?ee.jsx("p",{className:"request-card__description",children:Fe.description}):ee.jsx("p",{className:"request-card__description request-card__description--muted",children:"Awaiting field note update."}),ee.jsxs("div",{className:"request-card__meta",children:[ee.jsxs("span",{className:"request-card__meta-item",children:[ee.jsx("span",{className:"meta-label",children:"Last update"}),ee.jsx("span",{className:"meta-value",children:ug(Fe?.timestamp)})]}),ee.jsxs("span",{className:"request-card__meta-item",children:[ee.jsx("span",{className:"meta-label",children:"Location"}),ee.jsx("span",{className:"meta-value",children:Fe?.latitude&&Fe?.longitude?`${Number.parseFloat(Fe.latitude).toFixed(3)}, ${Number.parseFloat(Fe.longitude).toFixed(3)}`:"Unknown"})]})]})]},Fe?.id||Fe?.name)})})]})}function fg(){const ne=()=>{if(typeof window>"u")return"dark";const Pe=window.localStorage.getItem("gardian-theme");return Pe==="light"||Pe==="dark"?Pe:window.matchMedia?.("(prefers-color-scheme: light)")?.matches?"light":"dark"},[ye,Me]=Mt.useState(ne);Mt.useEffect(()=>{typeof window>"u"||(window.localStorage.setItem("gardian-theme",ye),document.documentElement.setAttribute("data-app-theme",ye),document.documentElement.style.colorScheme=ye==="dark"?"dark":"light")},[ye]);const Q=()=>{Me(Pe=>Pe==="dark"?"light":"dark")},Ve=[{name:"PJHQ Watchkeeper",summary:"Permanent Joint Headquarters - UK Strategic Command",channel:"24/7 Ops Room",value:"+44 1923 956 100",href:"tel:+441923956100",secondary:"Secure Email: pjhq-watchkeeper@mod.uk",external:!1},{name:"Land Operations Centre",summary:"Army Headquarters Land Ops Centre",channel:"Immediate Tasking Desk",value:"+44 1980 615 555",href:"tel:+441980615555",secondary:"Signal: land.ops@classified.mod.uk",external:!1},{name:"GCHQ GCO",summary:"GCHQ Global Communications Operations",channel:"Secure Coordination Cell",value:"+44 1242 221 491",href:"tel:+441242221491",secondary:"CTS Link: gco-ops@gchq.gov.uk",external:!1},{name:"UK Embassy Duty Officer",summary:"FCDO Consular Liaison",channel:"Consular Hotline",value:"+44 20 7008 5000",href:"tel:+442070085000",secondary:"Web: https://www.gov.uk/guidance/contact-the-fcdo",external:!0},{name:"FCDO Crisis Coordination Cell",summary:"Foreign, Commonwealth & Development Office",channel:"Crisis Response Desk",value:"+44 20 7008 1500",href:"tel:+442070081500",secondary:"Secure Email: crisis.cell@fcdo.gov.uk",external:!1},{name:"Local Police Station",summary:"Host Nation Law Enforcement Liaison",channel:"Duty Desk",value:"+00 123 456 7890",href:"tel:+001234567890",secondary:"Radio: VHF Channel 12",external:!1},{name:"Local Hospital Command",summary:"Medical Coordination Centre",channel:"Clinical Operations",value:"+00 123 456 7811",href:"tel:+001234567811",secondary:"MedNet: hospital.ops@health.gov",external:!1},{name:"Local Government Liaison",summary:"Regional Emergency Management Office",channel:"Civil Authority Liaison",value:"+00 123 456 7822",href:"tel:+001234567822",secondary:"Email: liaison@region.gov",external:!1},{name:"UKSF HQ Duty Officer",summary:"United Kingdom Special Forces Headquarters",channel:"Duty Officer",value:"+44 1980 555 990",href:"tel:+441980555990",secondary:"Secure Voice: STU III 7412",external:!1},{name:"Fire and Rescue HQ",summary:"Host Nation Fire and Rescue Command",channel:"Incident Coordination",value:"+00 123 456 7833",href:"tel:+001234567833",secondary:"Dispatch: firecontrol@civdef.gov",external:!1}],$e="v1.public.eyJqdGkiOiI2OGY4YzIxMy0wNzQ5LTRlNWMtYmZkMC03NzIyNGI2MzExZTUifZAsoqYxhG8hGCUGyxPccm8osBiLTAOid1yFXGtxS8SvOqx_01qxKTAoiV-8JwucISjz4ZKhhv9WLM5wOnQKWfL1hdu-p4x2cSy6E_dH2rMRPXuIe3G2mbcpOPzIsVJi3Ugel_chnVmeJLgqXUlI8SLKCd8hxTUiMNv1U8w35KNgPuxNWHcn3TumzGWbcTl2Fhvyzsuo7-ecrpAs_J8n6DP35PiNGspbiIXuhCZeUwC7t_c0TJ3ilBDz8eW6QeFtGcef0uFNCLPWdYaKTVv4FEKLMLtKzuXcdQQmnbDpSDZFwv4th7xScAzlr5fuqPivHcI0NAEUb_DnoGu4lgR_cxQ.Mzc3ODIwNDMtZWI3YS00NWY5LThjNTktM2UwMmJlOGFhZmY3",Fe="https://zones-of-interest.s3.eu-west-2.amazonaws.com/hazard_zones.json",f="https://ksip4rkha0.execute-api.eu-west-2.amazonaws.com/entitled-persons",Oe=Mt.useRef(null),U=Mt.useMemo(()=>[-1.9085,51.6719],[]),ut=12.5,[Ue,pe]=Mt.useState([]),[ft,ct]=Mt.useState(!1),[Qe,nt]=Mt.useState(null),Ge=Mt.useCallback(Pe=>{pe(Array.isArray(Pe)?Pe:[])},[]),it=Mt.useCallback(Pe=>{ct(!!Pe)},[]),bt=Mt.useCallback(Pe=>{nt(Pe||null)},[]),St=ft?"Updating":Qe?"Data issue":`${Ue.length} tracked`,Vt=()=>{window.print()},Dt=()=>ee.jsxs(ee.Fragment,{children:[ee.jsxs("section",{className:"map-panel",children:[ee.jsxs("div",{className:"map-card",children:[ee.jsx(Lm,{apiKey:$e,geoJsonUrl:Fe,height:"100%",mapRef:Oe,center:U,zoom:ut}),ee.jsx(Fm,{pinJsonUrl:f,mapRef:Oe,onPinData:Ge,onLoadingChange:it,onPinError:bt})]}),ee.jsxs("div",{className:"map-footnote",children:[ee.jsx("span",{className:"status-indicator",children:"Live Feed"}),ee.jsxs("span",{className:"refresh-indicator","aria-label":"Map refreshes every ninety seconds",children:[ee.jsx("span",{className:"refresh-indicator__icon","aria-hidden":"true"}),ee.jsx("span",{className:"refresh-indicator__copy",children:"90s auto-refresh"})]}),ee.jsx("span",{className:"footnote-text",children:"Data refreshes automatically as new JDP field reports arrive."})]})]}),ee.jsx("section",{className:"intel-panel",children:ee.jsxs("div",{className:"intel-content",children:[ee.jsx("h2",{children:"Local News Reports"}),ee.jsx(tg,{})]})}),ee.jsx("section",{className:"ai-panel",children:ee.jsxs("div",{className:"ai-content",children:[ee.jsx("h2",{children:"AI Scene Assessment"}),ee.jsx(lg,{})]})}),ee.jsxs("section",{className:"weather-panel",children:[ee.jsxs("div",{className:"weather-header",children:[ee.jsx("h2",{children:"Operational Weather Outlook"}),ee.jsx("span",{className:"weather-badge",children:"Live"})]}),ee.jsx(rg,{placeQuery:"De Vere Cotswold Water Park, Cirencester, GB",units:"metric"})]}),ee.jsxs("section",{className:"requests-panel",children:[ee.jsxs("div",{className:"requests-header",children:[ee.jsx("h2",{children:"Evacuation & Assistance Requests"}),ee.jsx("span",{className:"requests-badge",children:St})]}),ee.jsx(dg,{items:Ue,isLoading:ft,error:Qe})]}),ee.jsx("section",{className:"contacts-panel",children:ee.jsxs("div",{className:"contacts-content",children:[ee.jsxs("div",{className:"contacts-header",children:[ee.jsx("h2",{children:"Quick Contacts"}),ee.jsx("span",{className:"contacts-subtitle",children:"Priority lines for command coordination and reachback"})]}),ee.jsx("div",{className:"contacts-grid",children:Ve.map(Pe=>{const Et=Pe.external?{target:"_blank",rel:"noreferrer"}:{};return ee.jsxs("a",{className:"contact-card",href:Pe.href,...Et,children:[ee.jsx("span",{className:"contact-title",children:Pe.name}),ee.jsx("span",{className:"contact-subtitle",children:Pe.summary}),ee.jsx("span",{className:"contact-channel",children:Pe.channel}),ee.jsx("span",{className:"contact-value",children:Pe.value}),Pe.secondary?ee.jsx("span",{className:"contact-secondary",children:Pe.secondary}):null]},Pe.name)})})]})}),ee.jsx("section",{className:"reference-panel",children:ee.jsxs("div",{className:"reference-content",children:[ee.jsx("h2",{children:"Doctrine & Support References"}),ee.jsxs("div",{className:"reference-links",children:[ee.jsxs("a",{className:"reference-card",href:"https://www.gov.uk/government/publications/jdp-3-51-non-combatant-evacuation-operations",target:"_blank",rel:"noreferrer",children:[ee.jsx("span",{className:"reference-label",children:"JDP 3-51"}),ee.jsx("span",{className:"reference-title",children:"Non-Combatant Evacuation Operations Guidance"}),ee.jsx("span",{className:"reference-meta",children:"gov.uk - Doctrine Publication"})]}),ee.jsxs("a",{className:"reference-card",href:"https://www.gov.uk/government/publications/allied-joint-doctrine-for-non-combatant-evacuation-operations-ajp-342",target:"_blank",rel:"noreferrer",children:[ee.jsx("span",{className:"reference-label",children:"AJP-3.4.2"}),ee.jsx("span",{className:"reference-title",children:"Allied Joint Doctrine for Non-Combatant Evacuation Operations"}),ee.jsx("span",{className:"reference-meta",children:"gov.uk - NATO Reference"})]}),ee.jsxs("a",{className:"reference-card",href:"https://www.gov.uk/guidance/contact-the-fcdo",target:"_blank",rel:"noreferrer",children:[ee.jsx("span",{className:"reference-label",children:"FCDO Support"}),ee.jsx("span",{className:"reference-title",children:"Contact the Foreign, Commonwealth & Development Office"}),ee.jsx("span",{className:"reference-meta",children:"gov.uk - Assistance Channel"})]})]})]})})]});return ee.jsxs("div",{className:"map-page","data-theme":ye,children:[ee.jsx("header",{className:"dashboard-header",children:ee.jsxs("div",{className:"header-content",children:[ee.jsxs("div",{className:"header-text",children:[ee.jsx("h1",{children:"GARDIAN"}),ee.jsxs("div",{className:"header-meta",children:[ee.jsx("p",{className:"header-subtitle",children:ee.jsx("span",{children:"Geospatial Aid Response & Disaster Information Analysis Network"})}),ee.jsx("p",{className:"header-doctrine",children:ee.jsx("span",{children:"Aligned to JDP-3-51 to assist with disaster relief and non-combatant evacuations (NEO)"})})]})]}),ee.jsxs("div",{className:"header-actions",children:[ee.jsxs("button",{type:"button",className:"theme-toggle",onClick:Q,"aria-label":`Activate ${ye==="dark"?"light":"dark"} mode`,"aria-pressed":ye==="light",children:[ee.jsx("span",{className:"theme-toggle__icon","aria-hidden":"true",children:ye==="dark"?"☀️":"🌙"}),ee.jsxs("span",{children:[ye==="dark"?"Light":"Dark"," Mode"]})]}),ee.jsx("div",{className:"header-logo","aria-hidden":"true",children:ee.jsx("img",{className:"header-logo__primary",src:Um,alt:"GARDIAN crest"})}),ee.jsx("button",{type:"button",className:"export-dashboard-button export-dashboard-button--header",onClick:Vt,"aria-label":"Export dashboard",children:"Export Dashboard"})]})]})}),ee.jsx("main",{className:"dashboard-main",children:Dt()}),ee.jsx("footer",{className:"dashboard-footer","aria-label":"Solution attribution",children:ee.jsxs("div",{className:"footer-content",children:[ee.jsx("img",{className:"footer-logo",src:jm,alt:"UK Government crest"}),ee.jsx("p",{className:"footer-credit",children:"Created by Team 3 for the Defence Hackathon 2025"}),ee.jsx("img",{className:"footer-logo",src:Vm,alt:"UK Military crest"})]})})]})}am.createRoot(document.getElementById("root")).render(ee.jsx(Mt.StrictMode,{children:ee.jsx(fg,{})}));export{bp as _,pg as c,ym as g};
